function $E(a){var b=typeof a=="string"?document.getElementById(a):a;if(b!=null){return b}return null}function $C(a){return document.createElement(a)}function $N(a){return document.getElementsByName(a)}function $T(a,b){return a.getElementsByTagName(b)}function Jobs(a){this.option=a||{};this._jobTable=[[],[],[],[]]}function v6SendLog(a,b){}function v7sendLog(a,b,c){if(!a){return false}if(a.split("_").length==3){Lib.checkAuthor();if($isLogin){a+="_"+$UID}}if(typeof scope=="undefined"){window.scope={};scope.$pageid=""}b=b||scope.$pageid;c=c||"";Utils.Io.JsLoad.request("http://hits.sinajs.cn/A2/b.html?type="+a+"&pageid="+b+"&msg="+c,{onComplete:function(){}})}function showError(a,b){var c=$SYSMSG[a]||a;winDialog.alert(c,{icon:b||"01"})}function msnrefreshWindow(){function j(a,c){trace("has Account");if(a){trace("alt:"+a);var d=$C("iframe");d.setAttribute("height",0);d.setAttribute("width",0);document.body.appendChild(d);d.src="https://login.sina.com.cn/sso/login.php?entry=blogmsn&service=blogmsn&alt="+encodeURIComponent(a)+"&savestate=7&returntype=TEXT";(function(){var a=arguments.callee;if(!a.count)a.count=0;if(a.count++>10){trace("放弃获取SUP");d.parentNode.removeChild(d);return}trace("尝试获取SUP, count:"+a.count);if(b("SUP")){trace("获取到 SUP"+b("SUP"));window.location.reload();return}setTimeout(a,1e3)})()}else{window.location.reload()}}function k(){trace("noAccount");window.location.href="http://blog.sina.com.cn/blog_rebuild/msn/interface/connect_user_confirm.php"}function l(a){var b=new Date;b.setTime(b.getTime()-1);document.cookie=a+"=_pass;path=/;domain=.blog.sina.com.cn;expires="+b.toGMTString()}function m(a){if(!a||a==""){return null}try{return window.eval("("+a+")")}catch(b){return null}}var a=Utils.Cookie.setCookie;var b=Utils.Cookie.getCookie;clearTimeout(msnRefreshTimer);var c=b("reg_token");if(c){trace("token find out...");a("reg_token","","","/",".blog.sina.com.cn")}else{trace("no token...");msnRefreshTimer=setTimeout(msnrefreshWindow,1e3);return}var d;var e;var f;var g=b("c_uid");var h=b("msnLinkCB");var i=b("AlT");a("msnLoginComeFrom",window.location.href,1,"/",".blog.sina.com.cn");if(h){d=h.split("_");e=d[0];f=d[1]}if(g!=e)return;switch(f){case"noCid":break;case"loginError":break;case"unlink":l("msnLinkCB");k(c);break;case"done":l("msnLinkCB");a("loginFromMsn","msn",24,"/",".blog.sina.com.cn");j(i,c);break;case"pass":break}}function CustomsDialog(a,b){this.nodesPattern=/[^\{\}]+(?=\})/g;this._dialog=DialogManager.create(a,b);this.entity=this._dialog.entity;this.templateString="";this.nodes={};var c=this;(function(){c._dialog.onDrag=function(){if($IE6){if(this.getProperty().isFixed){this.setPosition({x:parseInt(this.entity.style.left)-document.documentElement.scrollLeft,y:parseInt(this.entity.style.top)-document.documentElement.scrollTop})}}else{if(this.getProperty().isFixed){this.setPosition({x:parseInt(this.entity.style.left),y:parseInt(this.entity.style.top)})}}c.onDrag()};c.updateNodes();if(c.nodes.btnClose){Core.Events.addEvent(c.nodes.btnClose,function(){var a=Core.Events.getEvent();if(a){a.cancelBubble=true}},"mousedown")}})();this._hiddenDialog=function(){c.hidden()};this._closeDialog=function(){c.close()}}function rockIt(a,b,c,d,e,f,g){function k(a){if(a){return a.getAttribute("rotationId")}else{return parseInt(Math.random()*1e4)+ +(new Date)}}function l(a){clearInterval(i[a].timer);for(var b in i[a]){delete i[a][b]}delete i[a]}function m(a,b){var c=j[i[a]["mode"]];var d=i[a];var e=d.node.style;var f=d["duration"];var g=d["startPos"][0];var h=d["endPos"][0]-d["startPos"][0];e.left=c(b,g,h,f)+"px";g=d["startPos"][1];h=d["endPos"][1]-d["startPos"][1];e.top=c(b,g,h,f)+"px";g=0;h=d["round"]==0||b==f?0:Math.PI*2*d["round"];n(d.node,c(b,g,h,f))}function n(a,b){costheta=Math.cos(b);sintheta=Math.sin(b);if($IE){a.style.filter="progid:DXImageTransform.Microsoft.Matrix(M11="+costheta+",M12="+ -sintheta+",M21="+sintheta+",M22="+costheta+',SizingMethod="auto expand")'}else if($FF){a.style["MozTransform"]="matrix("+costheta+", "+sintheta+", "+ -sintheta+", "+costheta+", 0, 0)"}else if(/WebKit/i.test(navigator.userAgent)){a.style["WebkitTransform"]="matrix("+costheta+", "+sintheta+", "+ -sintheta+", "+costheta+", 0, 0)"}}function o(){var a=i[h].node.style;a.position="";a.left="";a.top=""}if(!a)return;var h=k(a);if(!h){a.setAttribute("rotationId",h=k())}var i=rockIt.instances||(rockIt.instances={});if(i[h]){l(h)}var j=Ui.Transition;window.$transitions=j;if(typeof g.begin=="function"){g.begin()}a.style.position="absolute";document.body.appendChild(a);i[h]={node:a,startPos:b,endPos:c,round:d,func:g,sTime:+(new Date),duration:e,mode:f||"simple",degree:0,timer:0};i[h].timer=setInterval(function(){var a=+(new Date);if(i[h]["sTime"]+i[h]["duration"]<a){m(h,i[h]["duration"]);if(typeof g.end=="function"){g.end({clear:o})}l(h)}else{m(h,a-i[h]["sTime"])}},15)}function clickSendRandomLog(){v7sendLog("79_01_14",scope.$pageid,"")}function mouseoverSendRandomLog(){v7sendLog("79_01_13",scope.$pageid,"")}function changeFontSize(a){var b,c="字体大小：";var d="<strong>#</strong>&nbsp;",e=3,f=["小","中","大"];c+=(new Array(4)).join(d);switch(a){case 2:b="fontSize_L";break;case 0:b="fontSize_S";break;case 1:default:b="fontSize_M";break}c=c.replace(/(<strong>)(#)(<\/strong>)/g,function(b,c,d,g){e--;if(e!=a){return'<a href="#" onclick="changeFontSize('+e+');return false;">'+f[e]+"</a>"}else{return c+f[a]+g}});$E("articleFontManage").innerHTML=c.substring(0,c.length-6);if(typeof attentionWorldCup!="undefined"){$E("articlebody").className="worldcup_article "+b}else{$E("articlebody").className="artical "+b}}function commonLog(a){var b=window.clog_img=new Image;b.onload=b.onerror=function(){window.clog_img=null};b.src=a+(a.indexOf("?")>0?"&__rnd=":"?")+Math.random();b=null}function main(){var a=window.location.href.indexOf("tj=1")>-1;if(a){v7sendLog("42_01_07")}var b=Lib.Listener;b.add("tray-ad-tips");var c=new Jobs;c.add("suda");c.add("tray");c.add("trayTipsAd");c.add("renderAd");c.add("showTB680");c.add("digger");c.add("articleDigger");c.add("recordVisitor");c.add("renderReblogDiv");c.add("articleCommentV2");c.add("blogNotice");c.add("trashPv");c.add("adNoticeChannel");c.add("imageLazyLoad");c.add("articleComp1");c.add("articleNumberV2");c.add("articleCommentPostV2");c.add("quote");c.add("quote_list");c.add("dynamicVoteView");c.add("updownurl");c.add("articleComp2");c.add("sharePhoto");c.add("templateClone",3);c.add("favGames");c.add("teams_wc");c.add("calendar_wc");c.add("phone_attention_add",3);c.add("randomScroll",3);c.add("audioCheck",3);c.add("subscribe",3);c.add("articleShare",3);c.add("report_bodyArticle");c.add("flashtemplate",3);c.add("stylefix",3);c.add("miniBlogAttention");c.add("baby_headPhoto");c.add("baby_babyBarFlashDetect");c.add("scrollAd");c.add("static");c.add("blog365Slide");c.add("SinglesDay");c.add("selectionShare");c.add("qingRecommend",3);c.add("qingRecomNew",3);c.add("tranVideo");c.add("errorTips");c.add("toZoneStatic",3);c.add("tjAd",3);c.add("searchToQing",3);c.add("showSlideBox",3);c.add("showSlideBtn",3);c.add("xingqu",3);c.add("osl_article",3);c.add("padSwitch");c.add("loginFollow");c.add("uatrack");c.add("blogTip");c.add("commentForCheck");c.add("diYuanXin");c.add("xgBlogAD");c.add("hotAdvertise");c.add("rightAD");c.start()}if(typeof Sina=="undefined"){Sina={}}Sina.pkg=function(a){if(!a||!a.length){return null}var b=a.split(".");var c=Sina;for(var d=b[0]=="Sina"?1:0;d<b.length;++d){c[b[d]]=c[b[d]]||{};c=c[b[d]]}return c};try{document.execCommand("BackgroundImageCache",false,true)}catch(e){}(function(){var a=function(a,b){var c=a;return function(){return c.apply(b,arguments)}};var b="Debug";if(window[b]==null||typeof window[b].log=="undefined"){window[b]={cacheData:[],base_url:"http://sjs.sinajs.cn/bind2/",product:scope.$PRODUCT_NAME,baseColor:{1:{color:"#FFF",bgcolor:"#E00"},2:{color:"#F00"},3:{color:"#FFF000"},4:{color:"#0F0"},5:{color:"#FFF"}},fatal:function(a){this.addData(a,1)},error:function(a){this.addData(a,2)},warning:function(a){this.addData(a,3)},info:function(a){this.addData(a,4)},log:function(a){this.addData(a,5)},dir:function(a){this.addData(a,5)},addData:function(a,b,c,d){if(a==null){return}if(typeof a!="object"){a=a.toString()}var e={type:b||"5",color:c||this.baseColor[b].color,bgcolor:d||this.baseColor[b].bgcolor};this.cacheData.push([a,e]);if(this.initFinished==true){this.showCurrentData([a,e])}}};window.trace=a(window[b].log,window[b]);window.traceError=a(window[b].error,window[b])}})();Sina.pkg("Core");if(typeof Core=="undefined"){Core=Sina.Core}Sina.pkg("Core.Array");Core.Array.foreach=function(a,b){if(a==null&&a.constructor!=Array){return[]}var c=0,d=a.length,e=[];while(c<d){var f=b(a[c],c);if(f!==null){e[e.length]=f}c++}return e};Sina.pkg("Core.Events");(function(a){function j(a,b){var c;for(c in b){a[c]=b[c]}}var b=navigator.userAgent.toLowerCase();var c={$winXP:/windows nt 5.1/.test(b),$winVista:/windows nt 6.0/.test(b),$win7:/windows nt 6.1/.test(b),$macOS:/mac/.test(b)};var d={$OPERA:false,$IE6:false,$IE7:false,$IE8:false,$IE9:false,$SAFARI:false,$FF2:false,$FF3:false,$FF4:false,$FF:false,$CHROME:false,$TT:false,$360:false,$SOGO:false,$Maxthon:false};var e={$IE:0,$MOZ:false,$WEBKIT:false,$KHTML:false};if(/opera/.test(b)||a.opera){d.$OPERA=true}else if(/chrome\/(\S+)/.test(b)){d.$CHROME=true}else if(/safari\/(\S+)/.test(b)){d.$SAFARI=true}else if(/msie/.test(b)){e.$IE=true;if(/360se/.test(b)){d.$360=true}else if(/tencenttraveler/.test(b)){d.$TT=true}else if(/se\s\S+\smetasr\s\d+\.\d+/.test(b)){d.$SOGO=true}var f=b.match(/msie (\d+)/);var g=parseInt(f[1]);e.$IE=g;if(g===8){d.$IE8=true}else if(g===6){d.$IE6=true}else if(g===9){d.$IE9=true}else if(g===7){d.$IE7=true}else if(g===10){d.$IE10=true}}else if(/firefox/.test(b)){var f=b.match(/firefox\/(\d+)/);d.$FF=parseInt(f[1]);if(/firefox\/3/.test(b)){d.$FF3=true}else if(/firefox\/4/.test(b)){d.$FF4=true}else if(/firefox\/2/.test(b)){d.$FF2=true}}try{var h=window.external;d.$Maxthon=h.max_version?true:false}catch(i){}if(/applewebkit\/(\S+)/.test(b)){e.$WEBKIT=true}else if(/khtml\/(\S+)/.test(b)){e.$KHTML=true}else if(/rv:([^\)]+)\) gecko\/\d{8}/.test(b)){e.$MOZ=true}d.$MOBILE=/mobile/i.test(b);if(!d.$MOBILE){d.$MOBILE=/HTC/.test(b)}j(a,d);j(a,e);j(a,c)})(window);Core.Events.addEvent=function(a,b,c,d){var e=typeof a=="string"?$E(a):a;if(e==null){trace("addEvent 找不到对象："+a);return}if(typeof d=="undefined"){d=false}if(typeof c=="undefined"){c="click"}if(e.addEventListener){if(c=="mousewheel"&&$FF){c="DOMMouseScroll"}e.addEventListener(c,b,d);return true}else if(e.attachEvent){var f=e.attachEvent("on"+c,b);return true}else{e["on"+c]=b}};Core.Events.removeEvent=function(a,b,c){var d=$E(a);if(d==null){trace("removeEvent 找不到对象："+a);return}if(typeof b!="function"){return}if(typeof c=="undefined"){c="click"}if(d.addEventListener){d.removeEventListener(c,b,false)}else if(d.attachEvent){d.detachEvent("on"+c,b)}b[c]=null};Sina.pkg("Core.Function");Core.Function.bind3=function(a,b,c){c=c==null?[]:c;var d=a;return function(){return d.apply(b,c)}};Core.Array.findit=function(a,b){var c=-1;Core.Array.foreach(a,function(a,d){if(b==a){c=d}});return c};window.onerror=function(a,b,c){trace("Error occured:"+a+"<br/>file:"+b+"<br/>line:"+c+"<br/>");return true};Jobs.prototype={_registedJobTable:{},errorMsg:[],_registJob:function(a,b){this._registedJobTable[a]=b},error:function(a){Debug.error(a);this.errorMsg.push(a)},add:function(a,b){b=b||1;if(Core.Array.findit(this._jobTable[b],a)==-1){this._jobTable[b].push(a)}else{this.error("Error: Job <b>"+a+"</b> is existed now.")}},start:function(){if(this.option.onStart!=null){this.option.onStart()}var a=this._registedJobTable;var b=this._jobTable[1].concat(this._jobTable[2]);var c=this;this.fe=Core.Function.bind3(c.focus,c,[]);var d=function(){if(c._jobTable[3].length==0){if(c.option.onEnd!=null){c.option.onEnd()}return}Core.Events.addEvent(document.body,c.fe,"focus");Core.Events.addEvent(window,c.fe,"scroll");Core.Events.addEvent(document.body,c.fe,"mousemove");Core.Events.addEvent(document.body,c.fe,"mouseover")};this.queue(b,d)},focus:function(){var a=this;if(this.focusdown){Core.Events.removeEvent(document.body,a.fe,"focus");Core.Events.removeEvent(window,a.fe,"scroll");Core.Events.removeEvent(document.body,a.fe,"mousemove");Core.Events.removeEvent(document.body,a.fe,"mouseover");a.fe=null;return}this.focusdown=true;var b=this._jobTable[3];this.queue(b,this.option.onEnd)},queue:function(a,b){var c=this;var d=function(){return(new Date).valueOf()};var e=this._registedJobTable;var f=a.length;var g=0;var h=window.setInterval(function(){if(g>=f){clearInterval(h);h=null;if(b!=null){b()}return}var j=a[g];var k=e[j];g++;if(typeof k=="undefined"){c.error("<b>Job["+j+"] is undefiend!!!</b>");return}var l=true;var m=d();try{k.call()}catch(n){c.error("<b>Job["+j+"] failed!!!</b>"+n.message+"");if(b!=null){b()}l=false;throw n}finally{if(l){var o=d();Debug.info("<b>Job["+j+"] done in "+(o-m)+"ms.</b>")}}},10)},call:function(a,b){if(typeof this._registedJobTable[a]!="undefined"){this._registedJobTable[a].apply(this,b)}else{trace("<b>Job["+a+"] is undefined!!!</b>",{color:"#900",bgColor:"#FFF;"})}}};$registJob=function(a,b){Jobs.prototype._registJob(a,b)};$callJob=function(a){var b=[];if(arguments.length>1){Core.Array.foreach(arguments,function(a,c){b[c]=a});b.shift()}Jobs.prototype.call(a,b)};if(typeof Lib=="undefined"){Lib={}}Lib.pkg=function(a){if(!a||!a.length){return null}var b=a.split(".");var c=Lib;for(var d=b[0]=="Lib"?1:0;d<b.length;++d){c[b[d]]=c[b[d]]||{};c=c[b[d]]}return c};Lib.register=function(a,b){var c=a.split(".");var d={},e,f=Lib;while(e=c.shift()){if(c.length){if(f[e]===undefined){f[e]={}}f=f[e]}else{if(f[e]===undefined){f[e]=b(Lib)}}}};Lib.register("Listener",function(){var a={};a.listeners={};return{add:function(b){if(a.listeners[b]){throw new Error("listener '"+b+"' has registed!")}a.listeners[b]=[]},remove:function(b){if(a.listeners[b]){a.listeners[b]=null;return true}return false},notify:function(b,c){var d=a.listeners[b],e=null;if(!d){return}for(var f=0,g=d.length;f<g;f++){e=d[f];e.callBack.call(e.scope,c)}},on:function(b){var c=arguments,d=null;for(var e=0,f=c.length;e<f;e++){d=c[e];if(!this.isListen(d)){if(!a.listeners[d.name]){a.listeners[d.name]=[]}a.listeners[d.name].push(d)}}},off:function(b){var c=a.listeners[b.name];if(!c){return true}var d=null;for(var e=0,f=c.length;e<f;e++){d=c[e];if(d.callBack==b.callBack&&d.scope==b.scope){c.splice(e,1)}}},isListen:function(b){var c=a.listeners[b.name];var d=null;if(!c){return false}for(var e=0,f=c.length;e<f;e++){d=c[e];if(d.callBack==b.callBack&&d.scope==b.scope){return true}}return false}}});Sina.pkg("Core.Dom");Core.Dom.insertHTML=function(a,b,c){a=$E(a)||document.body;c=c.toLowerCase()||"beforeend";if(a.insertAdjacentHTML){switch(c){case"beforebegin":a.insertAdjacentHTML("BeforeBegin",b);return a.previousSibling;case"afterbegin":a.insertAdjacentHTML("AfterBegin",b);return a.firstChild;case"beforeend":a.insertAdjacentHTML("BeforeEnd",b);return a.lastChild;case"afterend":a.insertAdjacentHTML("AfterEnd",b);return a.nextSibling}throw'Illegal insertion point -> "'+c+'"'}var d=a.ownerDocument.createRange();var e;switch(c){case"beforebegin":d.setStartBefore(a);e=d.createContextualFragment(b);a.parentNode.insertBefore(e,a);return a.previousSibling;case"afterbegin":if(a.firstChild){d.setStartBefore(a.firstChild);e=d.createContextualFragment(b);a.insertBefore(e,a.firstChild);return a.firstChild}else{a.innerHTML=b;return a.firstChild}break;case"beforeend":if(a.lastChild){d.setStartAfter(a.lastChild);e=d.createContextualFragment(b);a.appendChild(e);return a.lastChild}else{a.innerHTML=b;return a.lastChild}break;case"afterend":d.setStartAfter(a);e=d.createContextualFragment(b);a.parentNode.insertBefore(e,a.nextSibling);return a.nextSibling}throw'Illegal insertion point -> "'+c+'"'};Core.Dom.setStyle=function(a,b,c){switch(b){case"opacity":a.style.filter="alpha(opacity="+c*100+")";if(!a.currentStyle||!a.currentStyle.hasLayout){a.style.zoom=1}break;case"float":b="styleFloat";default:a.style[b]=c}};if(!$IE||!($IE<9)){Core.Dom.setStyle=function(a,b,c){if(b=="float"){b="cssFloat"}a.style[b]=c}}Sina.pkg("Core.String");Core.String.formatNumber=function(a){a=a+"";return a.replace(/(\d{1,3})(?=(\d{3})+(?:$|\.))/g,"$1,")};Core.String.encodeHTML=function(a){var b=document.createElement("div");b.appendChild(document.createTextNode(a));return b.innerHTML.replace(/\s/g,"&nbsp;")};Core.String.trimHead=function(a){return a.replace(/^(\u3000|\s|\t)*/gi,"")};Core.String.trimTail=function(a){return a.replace(/(\u3000|\s|\t)*$/gi,"")};Core.String.trim=function(a){return Core.String.trimHead(Core.String.trimTail(a))};Sina.pkg("Utils");if(typeof Utils=="undefined"){Utils=Sina.Utils}Sina.pkg("Utils.Io");Sina.pkg("Core.System");(function(){var a=function(a,b){var c;try{if(typeof b!="undefined"){for(c in a){if(b[c]!=null){a[c]=b[c]}}}}finally{c=null;return a}};Core.System.parseParam=a})();Utils.Url=function(a){a=a||"";this.url=a;this.query={};this.parse()};Utils.Url.prototype={parse:function(a){if(a){this.url=a}this.parseAnchor();this.parseParam()},parseAnchor:function(){var a=this.url.match(/\#(.*)/);a=a?a[1]:null;this._anchor=a;if(a!=null){this.anchor=this.getNameValuePair(a);this.url=this.url.replace(/\#.*/,"")}},parseParam:function(){var a=this.url.match(/\?([^\?]*)/);a=a?a[1]:null;if(a!=null){this.url=this.url.replace(/\?([^\?]*)/,"");this.query=this.getNameValuePair(a)}},getNameValuePair:function(a){var b={};a.replace(/([^&=]*)(?:\=([^&]*))?/gim,function(a,c,d){if(c==""){return}b[c]=d||""});return b},getParam:function(a){return this.query[a]||""},clearParam:function(){this.query={}},setParam:function(a,b){if(a==null||a==""||typeof a!="string"){throw new Error("no param name set")}this.query=this.query||{};this.query[a]=b},setParams:function(a){this.query=a},serialize:function(a){var b=[];for(var c in a){if(a[c]==null||a[c]==""){b.push(c+"=")}else{b.push(c+"="+a[c])}}return b.join("&")},toString:function(){var a=this.serialize(this.query);return this.url+(a.length>0?"?"+a:"")+(this.anchor?"#"+this.serialize(this.anchor):"")},getHashStr:function(a){return this.anchor?"#"+this.serialize(this.anchor):a?"#":""}};Core.String.encodeDoubleByte=function(a){if(typeof a!="string"){return a}return encodeURIComponent(a)};Utils.Io.JsLoad={};(function(){function a(a,c){b(a,c);var d=a.urls;var e,f=d.length;for(e=0;e<f;e++){var g=$C("script");g.src=d[e].url;g.charset=d[e].charset;g.onload=g.onerror=g.onreadystatechange=function(){if(g&&g.readyState&&g.readyState!="loaded"&&g.readyState!="complete"){return}c.script_loaded_num++;g.onload=g.onreadystatechange=g.onerror=null;if(!1!==a.isRemove){g.src="";g.parentNode.removeChild(g)}g=null};document.getElementsByTagName("head")[0].appendChild(g)}}function b(a,b){var c=a.urls;var d=a.GET;var e,f=c.length;var g,h,i,j;for(e=0;e<f;e++){j=window.parseInt(Math.random()*1e8);h=new Utils.Url(c[e].url);for(g in d){if(a.noencode==true){h.setParam(g,d[g])}else{h.setParam(g,Core.String.encodeDoubleByte(d[g]))}}i=h.getParam("varname")||"requestId_"+j;if(a.noreturn!=true){h.setParam("varname",i)}b.script_var_arr.push(i);c[e].url=h.toString();c[e].charset=c[e].charset||a.charset}}function c(b,c){var d={isRemove:!0,urls:[],charset:"utf-8",noreturn:false,noencode:false,timeout:-1,POST:{},GET:{},onComplete:null,onException:null};var e={script_loaded_num:0,is_timeout:false,is_loadcomplete:false,script_var_arr:[]};d.urls=typeof b=="string"?[{url:b}]:b;Core.System.parseParam(d,c);a(d,e);(function(){if(d.noreturn==true&&d.onComplete==null){return}var a,b=[];if(e.script_loaded_num==d.urls.length){e.is_loadcomplete=true;if(d.onComplete!=null){for(a=0;a<e.script_var_arr.length;a++){b.push(window[e.script_var_arr[a]])}if(e.script_var_arr.length<2){d.onComplete(b[0])}else{d.onComplete(b)}}return}if(e.is_timeout==true){return}setTimeout(arguments.callee,50)})();if(d.timeout>0){setTimeout(function(){if(e.is_loadcomplete!=true){if(d.onException!=null){d.onException()}e.is_timeout=true}},d.timeout)}}Utils.Io.JsLoad.request=function(a,b){new c(a,b)}})();Sina.pkg("Core.Class");Core.Class.AsPrototype={};Core.Class.create=function(){return function(a){if(a!=Core.Class.AsPrototype){this.initialize.apply(this,arguments)}}};Lib.pkg("Lib.Component");Lib.Component=Core.Class.create();Lib.Component.instances=Lib.Component.instances||{};Lib.Component.compSize={};Lib.Component.getInitCompSize=function(){if(scope.component_lists!=null){var a=scope.component_lists;for(var b in a){if(a[b].list.length>0){Core.Array.foreach(a[b].list,function(c){Lib.Component.compSize[c]=a[b].size})}}return true}else{return null}};Lib.Component.refresh=function(a,b){b=b||{};try{if(Lib.Component.instances[a]==null){if(typeof Lib.Component["Comp_"+a]=="undefined"){$registComp(a,{},"static")}Lib.Component.instances[a]=new Lib.Component["Comp_"+a](a)}}catch(c){}Debug.log("刷新组件 "+a+" ，新宽度是 "+b.width);Debug.log("组件 "+a+" 增加管理链接："+b.addManage);Lib.Component.instances[a].reload(b.width,b.addManage,b.forceRefresh)};Lib.Component.set=function(a){Debug.log("展开组件 "+a+" 的设置功能");if(Lib.Component.instances[a]==null){Lib.Component.instances[a]=new Lib.Component["Comp_"+a](a)}Lib.Component.instances[a].getUserSet()};Core.Class.extend=function(a,b,c){for(var d in b){if(c!=null){if(!a[d]){a[d]=b[d]}}else{a[d]=b[d]}}return a};Core.Class.define=function(a,b,c){if(a&&a.__isClass&&a.__isClass()){throw new Error("class cnt be used as another class' constructor : "+a)}b=b||Object;c=c||{};c.initialize=a||c.initialize||b.prototype.initialize||function(){};if(typeof c.initialize!="function"){throw new Error("only function can be used as constructor")}c.__isClass=function(){return true};var d=Core.Class.create();d.__isClass=c.__isClass;var e=b==Object?{}:new b(Core.Class.AsPrototype);d.prototype=Core.Class.extend(e,c);return d};$registComp=Lib.Component.registComp=function(a,b,c){c=c==null?Lib.Component.Comp:Lib.Component["Comp_"+c];c=c||Lib.Component.Comp;b.compId=a;Lib.Component["Comp_"+a]=Core.Class.define(null,c,b)};Core.Function.bind2=function(a,b){var c=a;return function(){return c.apply(b,arguments)}};Function.prototype.bind2=function(a){var b=this;return function(){return b.apply(a,arguments)}};Core.Dom.getElementsByClass=function(a,b,c){a=a||document;var d=[];c=" "+c+" ";var e=a.getElementsByTagName(b),f=e.length;for(var g=0;g<f;++g){var h=e[g];if(h.nodeType==1){var i=" "+h.className+" ";if(i.indexOf(c)!=-1){d[d.length]=h}}}return d};Core.Dom.byClz=Core.Dom.getElementsByClass;Core.Dom.removeNode=function(a){a=$E(a)||a;try{a.parentNode.removeChild(a)}catch(b){}};Lib.Component.Comp=Core.Class.create();Lib.Component.Comp.prototype={initialize:function(a){if(this.isInit==true||a==null||Lib.Component.compSize[a]==null){return}else{this.isInit=true;this.compId=a;this.size=Lib.Component.compSize[a];Lib.Component.instances[a]=this;return this}},compId:null,getContainer:function(){return $E("module_"+this.compId)},getTitle:function(){return Core.Dom.getElementsByClass($E("module_"+this.compId),"span","title")[0]},getManage:function(){var a=Core.Dom.getElementsByClass($E("module_"+this.compId),"span","edit");if(a.length!=0){return a[0]}else{Debug.error("组件添加管理链接失败，检查组件"+this.compId+"标题栏 SPAN[class=edit] 是否存在");return null}},getContent:function(){var a=Core.Dom.getElementsByClass($E("module_"+this.compId),"div","SG_connBody");if(a.length!=0){return a[0]}else{Debug.error("组件内容节点获取失败，检查组件"+this.compId+"内 DIV[class=SG_connBody] 是否存在");return null}},load:function(){trace("load compId="+this.compId);this.setContent("")},reload:function(a){this.clearContent();this.load()},setTitle:function(a){var b=this.getTitle();if(b){b.innerHTML=a||""}},setManage:function(){var a=this.getManage();if($isAdmin&&a){a.innerHTML='<span class="move"><a href="#" '+'onclick="funcMoveUpDown.up('+this.compId+');return false;">↑</a><a href="#" '+'onclick="funcMoveUpDown.down('+this.compId+');return false;">↓</a></span>'+'<a href="#" onclick="hiddenComponents(\''+this.compId+'\');return false;" class="CP_a_fuc">[<cite>隐藏</cite>]</a>'}},setContent:function(a){a=typeof a=="string"?a:a+"";this.getContent().innerHTML=a||""},clearContent:function(){this.getContent().innerHTML=""},remove:function(){Core.Dom.removeNode(this.getContainer());this.finalize()},finalize:function(){this.isInit=null;Lib.Component.instances[this.compId]=null}};var $SYSMSG={};$SYSMSG.extend=function(a,b){for(var c in a){$SYSMSG[c]=!!b==false?a[c]:$SYSMSG[c]}};$SYSMSG.extend({A80001:"暂无内容。",A80002:"暂无内容。",A80101:"组件加载失败，请刷新。",A80201:"你要删除留下的访问记录吗？",A80202:'<div class="CP_w_cnt SG_txtb">删除后一小时内不会在此留下访问记录。</div>',A80203:"确实要删除此访问记录吗？",A80204:['<ul class="CP_w_part SG_txtb">'+'<li><input type="checkbox" id="comp_12_deleteToBlack" class="CP_w_fm1" />'+'<label for="comp_12_deleteToBlack" >将此人加入黑名单</label></li>'+'</ul><div class="CP_w_cnt SG_txtb">加入黑名单的用户无法和你沟通。</div>'].join(""),A02003:"已添加过此模块，不能重复添加。",A02004:"抱歉，该模块不能被克隆。",A02005:"抱歉，您的博客尚未升级，请<a href='http://blog.sina.com.cn/u/#UID' target='_blank'>升级</a>后再“添加到您的博客”。",A02006:"模块已成功添加到你的博客。",A02007:"确实要隐藏此模块吗？隐藏后可在“页面设置”中恢复。",A02008:"确实要隐藏此模块吗？此模块活动时间已结束，隐藏后不可恢复。"});$registComp("dynamic",{render_210:function(){},render_510:function(){},render_730:function(){},show:function(a){this.setContent(a)},showEmpty:function(a){this.setContent('<div class="SG_nodata2">'+(a||$SYSMSG.A80001)+"</div>")},showError:function(a){this.setContent(a)},setManage:function(){if($isAdmin&&this.getManage()){this.getManage().innerHTML='<span class="move"><a href="#" '+'onclick="funcMoveUpDown.up('+this.compId+');return false;">↑</a><a href="#" '+'onclick="funcMoveUpDown.down('+this.compId+');return false;">↓</a></span>'+'<a href="#" onclick="hiddenComponents(\''+this.compId+'\');return false;" class="CP_a_fuc">[<cite>隐藏</cite>]</a>'}},reload:function(a,b,c){var d=a==null||a&&(a==210||a==510||a==730);if(!d){Debug.error("请检查传入的组件尺寸是否正确。"+a);return}this.size=a||this.size;this.getContent().innerHTML='<div class="wdtLoading"><img src="http://simg.sinajs.cn/blog7style/'+'images/common/loading.gif" />加载中…</div>';this.isSetOn=null;Debug.log("this.isSetOn : "+this.isSetOn);if(c==true||this.cacheData==null){Debug.log("强制刷新："+this.compId);this.load()}else{Debug.log("缓存刷新："+this.compId);this["render_"+this.size]()}if(b){this.setManage()}}});Sina.pkg("Utils.Cookie");Utils.Cookie.getCookie=function(a){a=a.replace(/([\.\[\]\$])/g,"\\$1");var b=new RegExp(a+"=([^;]*)?;","i");var c=document.cookie+";";var d=c.match(b);if(d){return d[1]||""}else{return""}};Core.System.keyValue=function(a,b){var c=a.match(new RegExp("(\\?|&)"+b+"=([^&]*)(&|$)"));if(c!=null)return c[2];return null};Lib.checkAuthor=function(){var a=unescape(Utils.Cookie.getCookie("SUP"));if(a&&a!=""){$UID=Core.System.keyValue(a,"uid");$nick=decodeURIComponent(Core.System.keyValue(a,"nick"));$isLogin=!!$UID;if(typeof scope.$uid=="undefined"){$isAdmin=false}else{$isAdmin=scope.$uid==$UID}}else{a=Utils.Cookie.getCookie("SU");if(a&&a!=""){var b=a.match(/^([^:]*:){2}(\d{5,11})/);$UID=b&&b[2]||null;window.$isLogin=!!$UID;if(typeof scope.$uid=="undefined"){window.$isAdmin=false}else{window.$isAdmin=scope.$uid==$UID}}else{$UID=null;$isLogin=false;$isAdmin=false}}};Core.Array.uniq=function(a){var b=[],c;for(var d=0;d<a.length;d++){c=a[d];if(Core.Array.findit(b,c)==-1){b.push(c)}}return b};Lib.Uic={_interfaceMultiquery:"http://uic.sso.sina.com.cn/uic/Mutiquery.php",cacheNickName:{},getNickName:function(a,b,c){a=Core.Array.uniq(a)||[];c=c||10;var d=Core.String.trim;var e=this.cacheNickName,f=[],g=[];var h={};for(var i=0,j=a.length;i<j;i++){if(typeof e[a[i]]=="undefined"&&e[a[i]]==null){var k=$E("ownernick");var l=d(scope.$pageid);if(a[i]==scope.$uid&&k!=null&&l!="articleM"&&l!="article"&&l!="personal"&&l!="personalM"&&l!="index"&&l!="indexM"){h[a[i]]=d(k.textContent||k.innerText);continue}if(a[i]==$UID&&scope.nickname!=null){h[a[i]]=d(scope.nickname);continue}f.push(a[i])}else{h[a[i]]=e[a[i]]||a[i]}}if(f.length==0){b(h);h=null}else{var m=[];for(var i=0;i<f.length;i++){g[i]=1}if(f.length>0){if(g.length>0){g="["+g.toString().replace(/,$/g,"")+"]"}f="["+f.toString().replace(/,$/g,"")+"]";m.push({url:this._interfaceMultiquery+"?UID=0&Check=null&UIDS="+f+"&UserInfoTypes="+g+"&ProductType=2"})}var n=function(a){Utils.Io.JsLoad.request(a[0].url,{onComplete:function(a){if(a){var c=a.UserInfos;for(var d=0;d<c.length;d++){h[c[d][0]]=c[d][2][1];Lib.Uic.cacheNickName[c[d][0]]=c[d][2][1]}b(h)}}});if(m.length>0){setTimeout(function(){n(m.splice(0,1))},10)}};if(m.length>0){setTimeout(function(){n(m.splice(0,1))},10)}}}};$registComp("901",{load:function(){Lib.checkAuthor();if($isAdmin==false&&$isLogin){this.loadIsFriend()}else if($isAdmin==false&&!$isLogin){this.isFriend=false;this.loadOnline()}else{this.isOnline=true;this.showOnlineInfo()}this.loadNickname();this.loadOtherInfo()},loadIsFriend:function(){if($_GLOBAL.mashAddFriend){this.mashAddFriend=true;return}var a=new Interface("http://control.blog.sina.com.cn/riaapi/profile/IsFriend.php","jsload");a.request({GET:{friend_uids:scope.$uid,version:7},onSuccess:function(a){this.friendSuccessCallback(a)}.bind2(this),onError:function(a){this.friendErrorCallback()}.bind2(this),onFail:function(){this.friendErrorCallback()}.bind2(this)})},friendSuccessCallback:function(a){for(var b=0,c=a.length;b<c;b++){if(a[b].uid==scope.$uid){this.isFriend=a[b].status==1?true:false}}this.isFriend=this.isFriend!=null?this.isFriend:false;this.loadOnline()},friendErrorCallback:function(){this.isFriend=false;this.loadOnline()},loadOnline:function(){if($isAdmin){this.isOnline=true;this.showOnlineInfo()}else{var a=Utils.Io.JsLoad.request("http://online.sso.sina.com.cn/status/MutiqueryVProduct.php",{GET:{UIDS:"["+scope.$uid+"]",Check:scope.$key,ProductType:"1000",Verbose:"0",noencode:true},onComplete:Core.Function.bind2(function(a){try{var b=a.Status;this.isOnline=b[0]==1?true:false}catch(c){this.isOnline=$isAdmin?true:false}this.showVisitButton();this.showOnlineInfo()},this),onException:Core.Function.bind2(function(){this.isOnline=false;this.showVisitButton();this.showOnlineInfo()},this)})}},loadNickname:function(){Lib.Uic.getNickName([scope.$uid],Core.Function.bind2(function(a){this.showNickName(a)},this))},showOnlineInfo:function(){},showNickName:function(){},showVisitButton:function(){},loadOtherInfo:function(){},mashAddFriend:false,reload:function(a,b,c){var d=a==null||a&&(a==210||a==510||a==730);if(!d){Debug.error("请检查传入的组件尺寸是否正确。"+a);return}this.size=a||this.size;if(c==true||this.cacheData==null){this.load()}else{this["render_"+this.size]()}if(b){this.setManage()}}},"dynamic");Core.String.j2o=function(a){if(!a||a==""){return null}try{var b=window.eval("("+a+")");return b}catch(c){trace("j2o : 数据分析出错");traceError(c);return null}};Utils.Io.Ijax={arrTaskLists:[],createLoadingIframe:function(){if(this.loadFrames!=null){return false}var a="loadingIframe_thread"+Math.ceil(Math.random()*1e4);var b="loadingIframe_thread"+Math.ceil((Math.random()+1)*1e4);this.loadFrames=[a,b];var c='<iframe id="'+a+'" name="'+a+'" class="invisible"	              scrolling="no" src=""	              allowTransparency="true" style="display:none;" frameborder="0"	              ></iframe>				  <iframe id="'+b+'" name="'+b+'" class="invisible"	              scrolling="no" src=""	              allowTransparency="true" style="display:none;" frameborder="0"	              ></iframe>';var d=$C("div");d.id="ijax_iframes";d.innerHTML=c;trace("创建 Ijax 需要的 iframe");document.body.appendChild(d);var e=setInterval(Core.Function.bind2(function(){if($E(this.loadFrames[0])!=null&&$E(this.loadFrames[1])!=null){clearInterval(e);e=null;this.loadingIframe={thread1:{container:$E(this.loadFrames[0]),isBusy:false},thread2:{container:$E(this.loadFrames[1]),isBusy:false}};this.loadByList()}},this),10)},isIjaxReady:function(){if(typeof this.loadingIframe=="undefined"){return false}for(var a in this.loadingIframe){if(this.loadingIframe[a].isBusy==false){this.loadingIframe[a].isBusy=true;return this.loadingIframe[a]}}return false},request:function(a,b){var c={};c.url=a;c.option=b||{};this.arrTaskLists.push(c);if(this.loadFrames==null){this.createLoadingIframe()}else{this.loadByList()}},loadByList:function(){if(this.arrTaskLists.length==0){return false}var a=this.isIjaxReady();if(a==false){return false}var b=this.arrTaskLists[0];this.loadData(b.url,b.option,a);this.arrTaskLists.shift()},loadData:function(a,b,c){var d=new Utils.Url(a);if(b.GET){for(var e in b.GET){d.setParam(e,Core.String.encodeDoubleByte(b.GET[e]))}}if(!/\bdomain\b/.test(a)){d.setParam("domain","1")}d=d.toString();var f=c.container;f.listener=Core.Function.bind2(function(){try{var a=f.contentWindow.document,e;var g=Core.Dom.byClz(a,"textarea","")[0];if(typeof g!="undefined"){e=g.value}else{e=a.body.innerHTML}if(b.onComplete){b.onComplete(e)}else{b.onException()}}catch(h){traceError(h);if(b.onException){b.onException(h.message,d.toString())}}c.isBusy=false;Core.Events.removeEvent(f,f.listener,"load");this.loadByList()},this);Core.Events.addEvent(f,f.listener,"load");if(b.POST){var g=$C("form");g.id="IjaxForm";g.action=d;g.method="post";g.target=f.id;for(var h in b.POST){var i;if(b.noEncode){i=Core.String.encodeDoubleByte(b.POST[h])}else{i=b.POST[h]}var j=$C("input");j.type="hidden";j.name=h;j.value=i;g.appendChild(j)}document.body.appendChild(g);g.submit()}else{try{window.frames(f.id).location.href=d}catch(k){f.src=d}}}};Utils.Io.Ajax={createRequest:function(){var a=null;try{a=new XMLHttpRequest}catch(b){try{a=new ActiveXObject("Msxml2.XMLHTTP")}catch(c){try{a=ActiveXObject("Microsoft.XMLHTTP")}catch(d){}}}if(a==null){}else{return a}},request:function(a,b){b=b||{};b.onComplete=b.onComplete||function(){};b.onException=b.onException||function(){};b.returnType=b.returnType||"txt";b.method=b.method||"get";b.data=b.data||{};if(typeof b.GET!="undefined"&&typeof b.GET.url_random!="undefined"&&b.GET.url_random==0){this.rand=false;b.GET.url_random=null}return this.loadData(a,b)},loadData:function(url,option){var request=this.createRequest(),tmpArr=[];var _url=new Utils.Url(url);if(option.POST){for(var postkey in option.POST){var postvalue=option.POST[postkey];if(postvalue!=null){tmpArr.push(postkey+"="+Core.String.encodeDoubleByte(postvalue))}}}var sParameter=tmpArr.join("&")||"";if(option.GET){for(var key in option.GET){if(key!="url_random"){_url.setParam(key,Core.String.encodeDoubleByte(option.GET[key]))}}}if(this.rand!=false){}request.onreadystatechange=function(){if(request.readyState==4){var response,type=option.returnType;try{switch(type){case"txt":response=request.responseText;break;case"xml":if($IE){response=request.responseXML}else{var Dparser=new DOMParser;response=Dparser.parseFromString(request.responseText,"text/xml")}break;case"json":response=eval("("+request.responseText+")");break}option.onComplete(response)}catch(e){option.onException(e.message,_url);return false}}};try{if(option.POST){request.open("POST",_url,true);request.setRequestHeader("Content-Type","application/x-www-form-urlencoded");request.send(sParameter)}else{request.open("GET",_url,true);request.send(null)}}catch(e){option.onException(e.message,_url);return false}return request}};if($IE6&&typeof Utils.Io.Ijax!="undefined"){Utils.Io.Ijax.loadData=function(a,b,c){var d=new Utils.Url(a);if(b.GET){for(var e in b.GET){d.setParam(e,Core.String.encodeDoubleByte(b.GET[e]))}}if(!/\bdomain\b/.test(a)){d.setParam("domain","1")}d=d.toString();var f=c.container;f.listener=Core.Function.bind2(function(){try{var a=f.contentWindow.document,e;var g=Core.Dom.byClz(a,"textarea","")[0];if(typeof g!="undefined"){e=g.value}else{e=a.body.innerHTML}if(b.onComplete){b.onComplete(e)}else{b.onException()}}catch(h){traceError(h);if(b.onException){b.onException(h.message,d.toString())}}c.isBusy=false;Core.Events.removeEvent(f,f.listener,"load");this.loadByList()},this);Core.Events.addEvent(f,f.listener,"load");if(b.POST){var g=$C("form");g.id="IjaxForm";g.action=d;g.method="post";g.target=f.id;for(var h in b.POST){var i;if(b.noEncode){i=Core.String.encodeDoubleByte(b.POST[h])}else{i=b.POST[h]}var j=$C("input");j.type="hidden";j.name=h;j.value=i;g.appendChild(j)}document.body.appendChild(g);var k=100;function l(){if(k>0){try{g.submit()}catch(a){setTimeout(l,10)}}k--}l()}else{try{window.frames(f.id).location.href=d}catch(m){f.src=d}}}}var Interface=function(a,b){this.url=new Utils.Url(a);this.type=b.toLowerCase()};Interface.prototype={url:null,type:"",request:function(a){var b=a.onError;var c=a.onSuccess;a.onComplete=a.onSuccess=function(a){try{if(typeof a=="string"){a=a.replace(/;$/,"")}a=typeof a=="string"&&/\s*{/.test(a)?Core.String.j2o(a):a;if(a!=null&&typeof a.code=="undefined"){trace("接口数据异常："+this.url,"#F00");return}if(a!=null){if(a.code=="A00006"){c(a.data)}else{b(a)}}else{b(a)}}catch(d){traceError(d)}}.bind2(this);a.onException=a.onError=a.onFail||function(){trace("接口失败："+this.url,"#F00");if(arguments.length>0){for(var a=0,b=arguments.length;a<b;a++){if(arguments[a]&&typeof arguments[a]!="undefined"){trace("错误信息："+arguments[a].toString())}}}}.bind2(this);var d=this.url.toString();switch(this.type){case"ijax":Utils.Io.Ijax.request(d,a);break;case"ajax":Utils.Io.Ajax.request(d,a);break;case"script":case"jsload":Utils.Io.JsLoad.request(d,a);break;default:throw new Error("未指定有效的数据传输类型")}}};(function(){function a(a){function b(){}b.prototype=a;return new b}Function.prototype.$define=function(a){var b;for(b in a){this.prototype[b]=a[b]}if(this.__interface__){for(b in this.prototype){if(this.prototype[b]==="NI"){throw new Error("类定义错误，接口方法["+b+"]未实现")}}}this.prototype.constructor=this;this.$extends=this.$define=this.$implements=function(){throw new Error("$define语句定义后面不能再作其它定义")};return this};Function.prototype.$extends=function(){var b=this,c=arguments.length,d,e;if(c===0){throw new Error("$extends语句错误：未指定父类")}d=arguments[0];e=function(){d.apply(this,arguments);b.apply(this,arguments)};e.prototype=a(d.prototype);e.prototype.constructor=e;e.$super=d.prototype;return e};Function.prototype.$implements=function(){var a=Array.prototype.slice.call(arguments,0),b,c=a.length,d;while(c--){if(typeof a[c]!=="object"){throw new Error("$implements语句错误：参数必须为object类型")}for(d in a[c]){typeof this.prototype[d]==="undefined"&&(this.prototype[d]="NI")}}this.__interface__=true;this.$extends=function(){throw new Error("$extends语句错误:$extends语句不能出现在$implements定义之后")};return this}})();Core.Events.getEvent=function(){return window.event};if(!$IE||$IE>8){Core.Events.getEvent=function(){if(!$IE&&window.event){return window.event}var a=arguments.callee.caller;var b;var c=0;while(a!=null&&c<40){b=a.arguments[0];if(b&&(b.constructor==Event||b.constructor==MouseEvent)){return b}c++;a=a.caller}return b}}Core.Events.stopEvent=function(a){var b=a?a:Core.Events.getEvent();if(b!=null){b.cancelBubble=true;b.returnValue=false}};if(!$IE||$IE>8){Core.Events.stopEvent=function(a){var b=a?a:Core.Events.getEvent();if(b!=null){b.preventDefault();b.stopPropagation()}}}Sina.pkg("Ui");if(typeof Ui=="undefined"){Ui=Sina.Ui}Ui.Template=function(a){this.tmpl=a;this.pattern=/(#\{(.*?)\})/g};Ui.Template.prototype={evaluate:function(a){return this.tmpl.replace(this.pattern,function(){return a[arguments[2]]||""})},evaluateMulti:function(a,b){var c=[];Core.Array.foreach(a,Core.Function.bind2(function(d,e){e=b?a.length-e:e;c[e]=this.evaluate(d)},this));return c.join("")}};(function(){function a(a){return typeof a!=="string"&&String.prototype.slice.call(a,0,8)=="function"}function b(a,b){var c=b.call(a);return typeof c==="string"||typeof c==="number"?c:null}Core.Function.defineGetter=function(c,d,e){if(d instanceof Array&&e instanceof Array){var f=Math.min(d.length,e.length);while(f--){if(typeof d[f]==="string"&&a(e[f])){c[d[f]]={valueOf:function(a){return function(){return b(c,e[a])}}(f),toString:this.valueOf}}}}else if(typeof d==="string"&&a(e)){c[d]={valueOf:function(){return b(c,e)},toString:this.valueOf}}}})();Ui.IE6FixedController=function(){var a=this;this.node=null;this.iframeNode=null;this.__orgX=0;this.__orgY=0;this.__isBindScroll=false;this.__fixedHandle=function(){if(a.node){a.node.style.left=document.documentElement.scrollLeft+a.__orgX+"px";a.node.style.top=document.documentElement.scrollTop+a.__orgY+"px"}if(a.iframeNode){a.iframeNode.style.left=a.node.style.left;a.iframeNode.style.top=a.node.style.top}}}.$define({setFixed:function(a,b){this.updateOrgPosition();if(b&&!this.__isBindScroll){Core.Events.addEvent(window,this.__fixedHandle,"scroll");this.__isBindScroll=true}if(!b&&this.__isBindScroll){Core.Events.removeEvent(window,this.__fixedHandle,"scroll");this.__isBindScroll=false}},setPosition:function(a,b,c){if(typeof c.x!=="undefined"){if(b){a.style.left=c.x+document.documentElement.scrollLeft+"px";this.__orgX=parseInt(this.node.style.left)-document.documentElement.scrollLeft}else{a.style.left=c.x+"px"}}if(typeof c.y!=="undefined"){if(b){a.style.top=c.y+document.documentElement.scrollTop+"px";this.__orgY=parseInt(this.node.style.top)-document.documentElement.scrollTop}else{a.style.top=c.y+"px"}}typeof c.z!=="undefined"&&(a.style.zIndex=c.z)},getX:function(a,b){if(b){return parseInt(a.style.left)-document.documentElement.scrollLeft}else{return parseInt(a.style.left)}},getY:function(a,b){if(b){return parseInt(a.style.top)-document.documentElement.scrollTop}else{return parseInt(a.style.top)}},updateIframe:function(a){this.setFixed(this.iframeNode,a);a&&this.__fixedHandle()},updateOrgPosition:function(){if(!this.node){return}this.__orgX=parseInt(this.node.style.left)-document.documentElement.scrollLeft;this.__orgY=parseInt(this.node.style.top)-document.documentElement.scrollTop},destroy:function(){Core.Events.removeEvent(window,this.__fixedHandle,"scroll");this.__isBindScroll=false;this.node=null;this.iframeNode=null}});Core.Events.EventDispatcher=function(a){this.__target=a;this.__events={}}.$define({addEventListener:function(a,b){if(!this.__checkFunction(b)){return}var c=this.__events;a=a.toLowerCase();!c[a]&&(c[a]=[]);c[a].push(b)},removeEventListener:function(a,b){var c=this.__events[a];a=a.toLowerCase();if(!this.__checkFunction(b)||!c||!c.length){return}for(var d=c.length-1;d>=0;d--){c[d]==b&&c.splice(d,1)}},dispatchEvent:function(a){a=a.toLowerCase();var b=this.__events[a];if(!b||!b.length){return}var c=Array.prototype.slice.call(arguments,0);c.shift();for(var d=0,e=b.length;d<e;d++){b[d].apply(this.__target,c)}},__checkFunction:function(a){return typeof a!=="string"&&String.prototype.slice.call(a,0,8)=="function"}});Ui.IRenderer={setCanShow:function(a){},setCanHidden:function(a){},show:function(a){},hidden:function(a){},addEventListener:function(a,b){},removeEventListener:function(a,b){}};Ui.SimpleRenderer=function(){this.__canShow=true;this.__canHidden=true;this.__eventDispatcher=new Core.Events.EventDispatcher(this)}.$implements(Ui.IRenderer).$define({setCanShow:function(a){this.__canShow=!!a},setCanHidden:function(a){this.__canHidden=!!a},show:function(a){this.__eventDispatcher.dispatchEvent("beforeShow");if(this.__canShow){a.style.display="";this.__eventDispatcher.dispatchEvent("show")}return this},hidden:function(a){this.__eventDispatcher.dispatchEvent("beforeHidden");if(this.__canHidden){a.style.display="none";this.__eventDispatcher.dispatchEvent("hidden")}return this},addEventListener:function(a,b){this.__eventDispatcher.addEventListener(a,b);return this},removeEventListener:function(a,b){this.__eventDispatcher.removeEventListener(a,b);return this}});Ui.DisplayObject=function(a,b){Core.Function.defineGetter(this,["x","y","z","width","height"],[this.__getX,this.__getY,this.__getZ,this.__getWidth,this.__getHeight]);this.__renderer=null;this.__entity=b;this.__isInited=false;this.__parent=a||document.body;this.__eventDispatcher=new Core.Events.EventDispatcher(this);var c=this.__eventDispatcher;this.__onBeforeShow=function(){c.dispatchEvent("beforeShow")};this.__onShow=function(){c.dispatchEvent("show")};this.__onBeforeHidden=function(){c.dispatchEvent("beforeHidden")};this.__onHidden=function(){c.dispatchEvent("hidden")};this.__updateRenderer(Ui.SimpleRenderer)}.$define({isShow:!1,isHidden:!0,setPosition:function(a){!this.__isInited&&this.__initEntity();typeof a.x!=="undefined"&&(this.__entity.style.left=a.x+"px");typeof a.y!=="undefined"&&(this.__entity.style.top=a.y+"px");typeof a.z!=="undefined"&&(this.__entity.style.zIndex=a.z);return this},setSize:function(a){!this.__isInited&&this.__initEntity();typeof a.width!=="undefined"&&(this.__entity.style.width=a.width+"px");typeof a.height!=="undefined"&&(this.__entity.style.height=a.height+"px");return this},setRenderer:function(a){!this.__isInited&&this.__initEntity();this.__updateRenderer(a);return this},show:function(a){this.isHidden=!1;this.isShow=!0;!this.__isInited&&this.__initEntity();this.__updateRenderer(a);this.__renderer.show(this.__entity);return this},hidden:function(a){return this.hide(a)},hide:function(a){this.isHidden=!0;this.isShow=!1;!this.__isInited&&this.__initEntity();this.__updateRenderer(a);this.__renderer.hidden(this.__entity);return this},setCanShow:function(a){this.__renderer.setCanShow(a);return this},setCanHidden:function(a){this.__renderer.setCanHidden(a);return this},addEventListener:function(a,b){this.__eventDispatcher.addEventListener(a,b);return this},removeEventListener:function(a,b){this.__eventDispatcher.removeEventListener(a,b);return this},destroy:function(){if(!this.__entity){return}!this.__isInited&&this.__initEntity();this.__entity.parentNode&&this.__entity.parentNode.removeChild(this.__entity);this.__entity=null},__initEntity:function(){var a;!this.__entity&&(this.__entity=$C("div"));a=this.__entity.style;a.position="absolute";a.left=0;a.top=0;!this.__entity.parentNode&&this.__parent.appendChild(this.__entity);this.__isInited=true},__updateRenderer:function(a){if(!a){return}var b=function(){this.__renderer.addEventListener("beforeShow",this.__onBeforeShow).addEventListener("show",this.__onShow).addEventListener("beforeHidden",this.__onBeforeHidden).addEventListener("hidden",this.__onHidden)};if(!this.__renderer){this.__renderer=new a;b.call(this)}else if(this.__renderer.constructor!==a){this.__renderer.removeEventListener("beforeShow",this.__onBeforeShow).removeEventListener("show",this.__onShow).removeEventListener("beforeHidden",this.__onBeforeHidden).removeEventListener("hidden",this.__onHidden);this.__renderer=new a;b.call(this)}},__getX:function(){!this.__isInited&&this.__initEntity();return parseInt(this.__entity.style.left)},__getY:function(){!this.__isInited&&this.__initEntity();return parseInt(this.__entity.style.top)},__getZ:function(){!this.__isInited&&this.__initEntity();return parseInt(this.__entity.style.zIndex)},__getWidth:function(){!this.__isInited&&this.__initEntity();return this.__getSize(this.__entity,"offsetWidth")},__getHeight:function(){!this.__isInited&&this.__initEntity();return this.__getSize(this.__entity,"offsetHeight")},__getSize:function(a,b){var c=a,d,e=c.style.visibility;if(c.style.display=="none"){c.style.visibility="hidden";c.style.display="";d=c[b];c.style.display="none";c.style.visibility=e}else{d=c[b]}return d}});Ui.Panel=function(a,b){this.nodes={};this.uniqueID=this.__getUniqueID();this.entity=null;this.__iframe=null;this.__isSetAdamant=false;this.__templateNodesIDs=[];this.__isFixed=false;$IE6&&(this.__ie6FixedController=new Ui.IE6FixedController)}.$extends(Ui.DisplayObject).$define({setTemplate:function(a){var b=$C("div");b.innerHTML=(new Ui.Template(a)).evaluate(this.__getNodes(a,"i"));b.style.display="none";this.__parent.appendChild(b);this.__updateTemplate(b);this.nodes=this.__getNodes(a);this.entity=this.__entity;this.nodes.panel=this.entity;return this},setFixed:function(a){!this.__isInited&&this.__initEntity();var b=parseInt(this.__entity.style.left),c=parseInt(this.__entity.style.top);if($IE6){this.__ie6FixedController.setFixed(this.__entity,a);this.__isSetAdamant&&this.__ie6FixedController.setFixed(this.__iframe,a)}else{if(a&&!this.__isFixed){this.setPosition({x:b-Math.max(document.documentElement.scrollLeft,document.body.scrollLeft),y:c-Math.max(document.documentElement.scrollTop,document.body.scrollTop)});this.__entity.style.position="fixed"}if(!a&&this.__isFixed){this.setPosition({x:b+Math.max(document.documentElement.scrollLeft,document.body.scrollLeft),y:c+Math.max(document.documentElement.scrollTop,document.body.scrollTop)});this.__entity.style.position="absolute"}}this.__isFixed=!!a;this.__updateIframe();return this},setAdamant:function(a){this.__isSetAdamant=!!a;this.__isSetAdamant&&!this.__iframe&&this.__createIframe();this.__updateIframe();return this},destroy:function(){if(!this.__entity){return}Ui.Panel.$super.destroy.call(this);this.__ie6FixedController&&this.__ie6FixedController.destroy();this.__iframe&&this.__iframe.parentNode.removeChild(this.__iframe)},setPosition:function(a){!this.__isInited&&this.__initEntity();if($IE6){this.__ie6FixedController.setPosition(this.__entity,this.__isFixed,a)}else{Ui.Panel.$super.setPosition.call(this,a)}this.__updateIframe();return this},setSize:function(a){Ui.Panel.$super.setSize.call(this,a).__updateIframe();return this},show:function(a){Ui.Panel.$super.show.call(this,a).__updateIframe();return this},hidden:function(a){Ui.Panel.$super.hidden.call(this,a).__updateIframe();return this},__getX:function(){!this.__isInited&&this.__initEntity();if($IE6){return this.__ie6FixedController.getX(this.__entity,this.__isFixed)}else{return parseInt(this.__entity.style.left)}},__getY:function(){!this.__isInited&&this.__initEntity();if($IE6){return this.__ie6FixedController.getY(this.__entity,this.__isFixed)}else{return parseInt(this.__entity.style.top)}},__createIframe:function(){this.__iframe=$C("iframe");this.__iframe.frameBorder="none";this.__parent.insertBefore(this.__iframe,this.__entity);Core.Dom.setStyle(this.__iframe,"opacity",0);this.__ie6FixedController&&(this.__ie6FixedController.iframeNode=this.__iframe);this.__updateIframe()},__updateIframe:function(){if(this.__iframe){var a=this.__iframe.style;a.backgroundColor="#ffffff";a.left=this.x+"px";a.top=this.y+"px";a.width=this.width+"px";a.height=this.height+"px";a.position=this.__entity.style.position;a.display=this.__entity.style.display;a.zIndex=this.__entity.style.zIndex;$IE6&&this.__ie6FixedController.updateIframe(this.__isFixed)}},__updateIE6FCOrgPosition:function(){this.__ie6FixedController&&this.__ie6FixedController.updateOrgPosition()},__updateTemplate:function(a){var b,c,d,e,f,g=this.__entity;if(g){g.parentNode&&g.parentNode.removeChild(g);b=g.style.left;c=g.style.top;d=g.style.zIndex;e=g.style.position;f=g.style.display}else{f="none"}g=this.__entity=$E("_"+this.uniqueID+"_panel");if(!g){g=this.__entity=$E("_"+this.uniqueID+"_entity")}if(!g){throw new Error("[Panel Error]there missing identifier #{panel} in panel template")}g.style.left=b||0;g.style.top=c||0;g.style.zIndex=d||0;g.style.position=e||"absolute";g.style.display=f;this.__parent.replaceChild(g,a);this.__ie6FixedController&&(this.__ie6FixedController.node=this.__entity)},__getNodes:function(a,b){var c=b||"o",d=/\{[^\}]+(?=\})/g,e,f={},g,h;this.__templateNodesIDs=a.match(d);g=this.__templateNodesIDs;if(g){e=g.length;while(e--){h=g[e].replace("{","");switch(c){case"o":f[h]=$E("_"+this.uniqueID+"_"+h);break;case"i":f[h]="_"+this.uniqueID+"_"+h;break}}}return f},__getUniqueID:function(){return parseInt(Math.random()*1e3).toString()+(new Date).getTime().toString()},setContent:function(a){this.nodes.content&&(this.nodes.content.innerHTML=a)},getNodes:function(){return this.nodes}});Ui.Drag=function(a,b,c){var d=this;this.canDrag=true;this.isLock=false;this.lockArea={left:0,right:0,top:0,bottom:0};this.__captureNode=a;this.__dragNodes=[];this.__deltaX=[];this.__deltaY=[];this.__eventDispatcher=new Core.Events.EventDispatcher(this);this.__isDraging=false;this.__canDragX=true;this.__canDragY=true;this.__dragHandle=function(){d.__drag()};this.__mouseDownHandle=function(){d.__isDraging=true;d.__eventDispatcher.dispatchEvent("beforeDrag");d.__setCapture(true)};this.__mouseUpHandle=function(){d.__isDraging&&d.__eventDispatcher.dispatchEvent("afterDrag");d.__isDraging=false;d.__setCapture(false)};this.__initNodes(a,b,c);this.__initCaputerNode()}.$define({addEventListener:function(a,b){this.__eventDispatcher.addEventListener(a,b);return this},removeEventListener:function(a,b){this.__eventDispatcher.removeEventListener(a,b);return this},destroy:function(){Core.Events.removeEvent(this.__captureNode,this.__mouseDownHandle,"mousedown");Core.Events.removeEvent(document,this.__mouseUpHandle,"mouseup");this.__captureNode=null;this.__dragNodes=null},__initNodes:function(a,b,c){if(b){b instanceof Array?this.__dragNodes=b:this.__dragNodes.push(b);(typeof c==="undefined"||c)&&this.__dragNodes.push(this.__captureNode)}else{this.__dragNodes.push(this.__captureNode)}var d=this.__dragNodes,e=d.length;while(e--){!d[e].style.position&&(d[e].style.position="absolute");!d[e].style.left&&(d[e].style.left=0);!d[e].style.top&&(d[e].style.top=0)}},__initCaputerNode:function(){var a=this.__captureNode,b=this;Core.Events.addEvent(a,this.__mouseDownHandle,"mousedown");Core.Events.addEvent(document,this.__mouseUpHandle,"mouseup")},__setCapture:function(a){var b=this.__captureNode,c=this.__dragNodes,d=Core.Events.getEvent(),e=c.length;while(e--){this.__deltaX[e]=d.clientX-parseInt(c[e].style.left);this.__deltaY[e]=d.clientY-parseInt(c[e].style.top)}if(a){if($IE){b.setCapture();Core.Events.addEvent(b,this.__dragHandle,"mousemove")}else{Core.Events.addEvent(document,this.__dragHandle,"mousemove")}}else{if($IE){b.releaseCapture();Core.Events.removeEvent(b,this.__dragHandle,"mousemove")}else{Core.Events.removeEvent(document,this.__dragHandle,"mousemove")}}},__drag:function(){if(!this.canDrag){return}var a=this.__dragNodes,b=Core.Events.getEvent(),c=a.length,d=this.lockArea,e=0,f=0;this.__eventDispatcher.dispatchEvent("drag");while(c--){e=b.clientX-this.__deltaX[c];f=b.clientY-this.__deltaY[c];if(this.isLock){e=Math.min(Math.max(e,d.left),d.right);f=Math.min(Math.max(f,d.top),d.bottom)}a[c].style.left=e+"px";a[c].style.top=f+"px"}}});Ui.IDragger={addEventListener:function(a,b){},removeEventListener:function(a,b){},setDrag:function(a,b,c){},setLock:function(a){},setArea:function(a){},destroy:function(){}};Ui.SimpleDragger=function(){this.__drag=null;this.__eventDispatcher=new Core.Events.EventDispatcher(this)}.$implements(Ui.IDragger).$define({addEventListener:function(a,b){if(a.toLowerCase()==="afterdrag"){this.__eventDispatcher.addEventListener(a,b)}else{this.__drag.addEventListener(a,b)}return this},removeEventListener:function(a,b){if(a.toLowerCase()==="afterdrag"){this.__eventDispatcher.removeEventListener(a,b)}else{this.__drag.removeEventListener(a,b)}return this},setDrag:function(a,b,c){var d=this;this.__drag=new Ui.Drag(a,b,c);this.__drag.addEventListener("afterDrag",function(){d.__eventDispatcher.dispatchEvent("afterDrag")});return this},setLock:function(a){this.__drag.isLock=!!a;return this},setArea:function(a){this.__drag.lockArea=a;return this},destroy:function(){this.__drag.destroy()}});Ui.Dialog=function(a,b){var c=this;this.__dragger=null;this.__isBindUpadateAreaEvent=false;this.__isBindUpdateIE6AreaEvent=false;this.__beforeDragHandle=function(){c.__updateDraggerArea();c.__eventDispatcher.dispatchEvent("beforedrag")};this.__dragHandle=function(){c.__isSetAdamant&&c.__updateIframe();c.__eventDispatcher.dispatchEvent("drag")};this.__afterDragHandle=function(){c.__isFixed&&$IE6&&c.__updateIE6FCOrgPosition();c.__eventDispatcher.dispatchEvent("afterdrag")};this.__updateDraggerAreaHandle=function(){setTimeout(function(){c.__updateDraggerArea()},1)};this.__setMiddleHandle=function(){c.setMiddle()}}.$extends(Ui.Panel).$define({setTemplate:function(a){Ui.Dialog.$super.setTemplate.call(this,a);this.__initTitleBar();this.setDragger(Ui.SimpleDragger);return this},setContent:function(a){if(!this.nodes.content){return this}this.nodes.content.innerHTML=(new Ui.Template(a)).evaluate(this.__getNodes(a,"i"));this.__addContentNodes(this.__getNodes(a));return this},setFixed:function(a){Ui.Dialog.$super.setFixed.call(this,a);if(a){Core.Events.addEvent(window,this.__setMiddleHandle,"resize")}else{Core.Events.removeEvent(window,this.__setMiddleHandle,"resize")}this.__updateDraggerArea();return this},setMiddle:function(){var a=this.__getDocumentSize().height-this.height,b=(Math.sqrt(5)-1)/2,c=1,d=a*b/(b+c),e=this.__getDocumentSize().width/2-this.width/2;if(!this.__isFixed){d+=Math.max(document.documentElement.scrollTop,document.body.scrollTop);e+=Math.max(document.documentElement.scrollLeft,document.body.scrollLeft)}this.setPosition({x:Math.max(e,0),y:Math.max(d,0)});return this},setAreaLocked:function(a){if(!this.__dragger){return this}this.__dragger.setLock(a);return this},setSize:function(a){!this.__isInited&&this.__initEntity();if(this.nodes.content){typeof a.width!=="undefined"&&(this.nodes.content.style.width=a.width+"px");typeof a.height!=="undefined"&&(this.nodes.content.style.height=a.height+"px")}else{typeof a.width!=="undefined"&&(this.__entity.style.width=a.width+"px");typeof a.height!=="undefined"&&(this.__entity.style.height=a.height+"px")}return this},setDragger:function(a){if(!this.nodes.titleBar||!a){return this}if(!this.__dragger){this.__dragger=new a}else if(this.__dragger.constructor===a){return this}this.__updateDragger(a);return this},destroy:function(){if(!this.__entity){return}Ui.Dialog.$super.destroy.call(this);Core.Events.removeEvent(window,this.__updateDraggerAreaHandle,"resize");Core.Events.removeEvent(window,this.__setMiddleHandle,"resize")},__addContentNodes:function(a){var b=this.nodes,c;for(c in a){b[c]=a[c]}},__updateDragger:function(a){if(this.__dragger.constructor!==a){this.__dragger.removeEventListener("beforedrag",this.__beforeDragHandle).removeEventListener("drag",this.__dragHandle).removeEventListener("afterdrag",this.__afterDragHandle);this.__dragger.destroy();this.__dragger=new a}this.__dragger.setDrag(this.nodes.titleBar,this.__entity,false);this.__dragger.addEventListener("beforedrag",this.__beforeDragHandle).addEventListener("drag",this.__dragHandle).addEventListener("afterdrag",this.__afterDragHandle)},__updateDraggerArea:function(){var a,b,c,d;if(this.__isFixed){a=$IE6?document.documentElement.scrollLeft:0;b=$IE6?document.documentElement.scrollTop:0;c=$IE6?document.documentElement.scrollLeft+this.__getDocumentSize().width-this.width:this.__getDocumentSize().width-this.width;d=$IE6?document.documentElement.scrollTop+this.__getDocumentSize().height-this.height:this.__getDocumentSize().height-this.height}else{a=0;b=0;c=document.documentElement.scrollWidth-this.width;d=document.documentElement.scrollHeight-this.height}this.__dragger.setArea({left:a,top:b,right:c,bottom:d})},__initTitleBar:function(){if(!this.nodes.titleBar){return}var a=this.nodes.titleBar;a.style.cursor="move";if($IE){Core.Events.addEvent(a,function(){return false},"selectstart")}else{a.style.MozUserSelect="none"}},__getDocumentSize:function(){var a=document.documentElement.clientWidth||document.body.clientWidth,b=document.documentElement.clientHeight||document.body.clientHeight;return{width:a,height:b}}});Ui.ModuleDialog=function(a,b,c){this.__bgShadow=null;this.__dialog=null;this.__isInitBgShadow=false;this.__tplConfig=a;this.__iconSet=b;this.__dialogQueue=[];this.__zIndex=c&&c.zIndex||5e3;this.__cfg=c||{};this.__initDialogEvent()}.$define({alert:function(a,b){b=b||{};var c=this.__createMessageDialog(b.tplConfig||this.__tplConfig.alert,b);c.nodes.text&&(c.nodes.text.innerHTML=a||"");c.show(b.renderer||this.__cfg.renderer).addEventListener("hidden",function(){this.destroy()});c.nodes.linkOk&&c.nodes.linkOk.style.display!=="none"&&c.nodes.linkOk.focus();return c},newAlert:function(a,b,c){b.tplConfig=this.__tplConfig.newAlert;this.alert(a,b,c)},confirm:function(a,b){b=b||{};var c=this.__createMessageDialog(b.tplConfig||this.__tplConfig.confirm,b),d=this;c.nodes.text&&(c.nodes.text.innerHTML=a||"");if(c.nodes.btnCancel){c.nodes.btnCancel.innerHTML=b.textCancel||"取消";Core.Events.addEvent(c.nodes.btnCancel,function(){b.funcCancel&&b.funcCancel.call(c);c.hidden(b.renderer||d.__cfg.renderer);Core.Events.stopEvent()},"click");c.nodes.linkCancel&&Core.Events.addEvent(c.nodes.linkCancel,function(){var a=Core.Events.getEvent();if(a.keyCode=="13"){b.funcCancel&&b.funcCancel.call(c);c.hidden(b.renderer||d.__cfg.renderer)}},"keydown")}c.show(b.renderer||d.__cfg.renderer).addEventListener("hidden",function(){this.destroy()});if(b.defaultButton==0){c.nodes.linkCancel&&c.nodes.linkCancel.style.display!=="none"&&c.nodes.linkCancel.focus()}else{c.nodes.linkOk&&c.nodes.linkOk.style.display!=="none"&&c.nodes.linkOk.focus()}return c},newConfirm:function(a,b,c){b.tplConfig=this.__tplConfig.newConfirm;this.confirm(a,b,c)},create:function(a){var b=this;a=a||{};var c=new Ui.Dialog;c.setTemplate(a.tpl||this.__tplConfig.customs);a.content&&c.setContent(a.content);a.width&&!isNaN(a.width)&&c.setSize({width:a.width});a.height&&!isNaN(a.height)&&c.setSize({height:a.height});return this.__initDialog(c,a)},__initDialogEvent:function(){var a=this.__dialogQueue;Core.Events.addEvent(document,function(){var b=Core.Events.getEvent();if(a.length&&b.keyCode=="27"){a[a.length-1].hidden()}},"keydown")},__createMessageDialog:function(a,b){var c=new Ui.Dialog,d=this,e;c.setTemplate(a);b.width&&!isNaN(b.width)&&c.setSize({width:b.width});b.height&&!isNaN(b.height)&&c.setSize({height:b.height});c.nodes.subText&&(c.nodes.subText.innerHTML=b.subText||"");if(c.nodes.icon){c.nodes.icon.className=this.__iconSet[b.icon||"01"]["class"];c.nodes.icon.alt=this.__iconSet[b.icon||"01"]["alt"]}if(c.nodes.btnOk){c.nodes.btnOk.innerHTML=b.textOk||"确定";Core.Events.addEvent(c.nodes.btnOk,function(){c.hidden(b.renderer||d.__cfg.renderer);b.funcOk&&b.funcOk.call(c);Core.Events.stopEvent()},"click")}c.nodes.linkOk&&Core.Events.addEvent(c.nodes.linkOk,function(){var a=Core.Events.getEvent();if(a.keyCode=="13"){c.hidden(b.renderer||d.__cfg.renderer);b.funcOk&&b.funcOk.call(c)}},"keydown");c.setDragger(b.dragger||d.__cfg.dragger).setFixed(true).setAreaLocked(true);return this.__initDialog(c,b)},__initDialog:function(a,b){var c=this;b.zIndex&&(c.__zIndex=b.zIndex);a.nodes.titleName&&(a.nodes.titleName.innerHTML=b.title||"提示");if(a.nodes.btnClose){Core.Events.addEvent(a.nodes.btnClose,function(){var c=true;b.funcBeforeClose&&(c=b.funcBeforeClose.call(a)!==false);b.funcClose&&b.funcClose.call(a);c&&a.hidden()},"click");Core.Events.addEvent(a.nodes.btnClose,function(){Core.Events.stopEvent()},"mousedown")}a.setPosition({z:b.zIndex||c.__zIndex});a.setRenderer(b.renderer||this.__cfg.renderer);a.setDragger(b.dragger||this.__cfg.dragger);a.setMiddle();a.addEventListener("beforeHidden",function(){c.__updateDialogQueue(this,"remove")});a.addEventListener("beforeShow",function(){this.nodes.panel.parentNode.appendChild(this.nodes.panel);var a=this;if(!c.__isInitBgShadow){c.__initBGShadow(this,b.isAdamant||c.__cfg.isAdamant)}c.__setBGShadowOpacity(b.bgShadowOpacity!==0?b.bgShadowOpacity||.4:b.bgShadowOpacity);window.setTimeout(function(){c.__bgShadow.show();c.__updateDialogQueue(a,"add")},1)});a.setTitle=function(a){this.nodes.titleName&&(this.nodes.titleName.innerHTML=a)};a.setHelp=function(a){this.nodes.btnHelp&&(this.nodes.btnHelp.href=a)};a.close=function(){this.hidden()};a.getNodes=function(){return this.nodes};a.getX=function(){return this.x};a.getY=function(){return this.y};a.getWidth=function(){return this.width};a.getHeight=function(){return this.height};return a},__initBGShadow:function(a,b){var c=this.__getDocumentSize().width,d=this.__getDocumentSize().height,e=this;this.__bgShadow=new Ui.Panel;this.__bgShadow.setTemplate('<div id="#{panel}" style="background-color:black"></div>').setSize({width:c,height:d}).setAdamant(b).setFixed(true).setPosition({x:0,y:0,z:e.__zIndex});Core.Events.addEvent(window,function(){e.__bgShadow.setPosition({x:0,y:0}).setSize({width:e.__getDocumentSize().width,height:e.__getDocumentSize().height})},"resize");this.__isInitBgShadow=true},__updateDialogQueue:function(a,b){var c,d;if(b==="add"){this.__dialogQueue.push(a)}else if(b==="remove"){c=this.__dialogQueue.length;while(c--){this.__dialogQueue[c]===a&&this.__dialogQueue.splice(c,1)}}if(this.__dialogQueue.length===0){this.__bgShadow.hidden()}else{d=this.__dialogQueue[this.__dialogQueue.length-1];this.__bgShadow.nodes.panel.parentNode.insertBefore(this.__bgShadow.nodes.panel,d.nodes.panel);this.__bgShadow.__iframe&&this.__bgShadow.__iframe.parentNode.insertBefore(this.__bgShadow.__iframe,this.__bgShadow.nodes.panel);d.nodes.linkOk&&d.nodes.linkOk.style.display!=="none"&&d.nodes.linkOk.focus()}},__setBGShadowOpacity:function(a){a=isNaN(a)?0:Math.max(Math.min(a,1),0);Core.Dom.setStyle(this.__bgShadow.nodes.panel,"opacity",a)},__getDocumentSize:function(){var a=document.documentElement.clientWidth||document.body.clientWidth,b=document.documentElement.clientHeight||document.body.clientHeight;return{width:a,height:b}}});Ui.Transition={simple:function(a,b,c,d){return c*a/d+b},backEaseIn:function(a,b,c,d){var e=1.70158;return c*(a/=d)*a*((e+1)*a-e)+b},backEaseOut:function(a,b,c,d){var e=1.70158;return c*((a=a/d-1)*a*((e+1)*a+e)+1)+b},backEaseInOut:function(a,b,c,d){var e=1.70158;if((a/=d/2)<1){return c/2*a*a*(((e*=1.525)+1)*a-e)+b}return c/2*((a-=2)*a*(((e*=1.525)+1)*a+e)+2)+b},bounceEaseOut:function(a,b,c,d){if((a/=d)<1/2.75){return c*7.5625*a*a+b}else if(a<2/2.75){return c*(7.5625*(a-=1.5/2.75)*a+.75)+b}else if(a<2.5/2.75){return c*(7.5625*(a-=2.25/2.75)*a+.9375)+b}else{return c*(7.5625*(a-=2.625/2.75)*a+.984375)+b}},bounceEaseIn:function(a,b,c,d){return c-Transition.bounceEaseOut(d-a,0,c,d)+b},bounceEaseInOut:function(a,b,c,d){if(a<d/2){return Transition.bounceEaseIn(a*2,0,c,d)*.5+b}else{return Transition.bounceEaseOut(a*2-d,0,c,d)*.5+c*.5+b}},regularEaseIn:function(a,b,c,d){return c*(a/=d)*a+b},regularEaseOut:function(a,b,c,d){return-c*(a/=d)*(a-2)+b},regularEaseInOut:function(a,b,c,d){if((a/=d/2)<1){return c/2*a*a+b}return-c/2*(--a*(a-2)-1)+b},strongEaseIn:function(a,b,c,d){return c*(a/=d)*a*a*a*a+b},strongEaseOut:function(a,b,c,d){return c*((a=a/d-1)*a*a*a*a+1)+b},strongEaseInOut:function(a,b,c,d){if((a/=d/2)<1){return c/2*a*a*a*a*a+b}return c/2*((a-=2)*a*a*a*a+2)+b},elasticEaseIn:function(a,b,c,d){var e,f;if(a==0){return b}if((a/=d)==1){return b+c}f=d*.3;if(!e||e<Math.abs(c)){e=c;var g=f/4}else{var g=f/(2*Math.PI)*Math.asin(c/e)}return-(e*Math.pow(2,10*(a-=1))*Math.sin((a*d-g)*2*Math.PI/f))+b},elasticEaseOut:function(a,b,c,d){var e,f;if(a==0){return b}if((a/=d)==1){return b+c}if(!f){f=d*.3}if(!e||e<Math.abs(c)){e=c;var g=f/4}else{var g=f/(2*Math.PI)*Math.asin(c/e)}return e*Math.pow(2,-10*a)*Math.sin((a*d-g)*2*Math.PI/f)+c+b},elasticEaseInOut:function(a,b,c,d){var e,f;if(a==0){return b}if((a/=d/2)==2){return b+c}if(!f){var f=d*.3*1.5}if(!e||e<Math.abs(c)){var e=c;var g=f/4}else{var g=f/(2*Math.PI)*Math.asin(c/e)}if(a<1){return-.5*e*Math.pow(2,10*(a-=1))*Math.sin((a*d-g)*2*Math.PI/f)+b}return e*Math.pow(2,-10*(a-=1))*Math.sin((a*d-g)*2*Math.PI/f)*.5+c+b}};Ui.TweenStrategy=function(a,b,c,d){this.startValue=a||0;this.endValue=b||0;this.duration=c||0;this.motion=d||Ui.Transition.simple;this.__eventDispatcher=new Core.Events.EventDispatcher(this)}.$define({motion:null,duration:0,startValue:0,endValue:0,_itvID:0,_isTweenning:false,addEventListener:function(a,b){this.__eventDispatcher.addEventListener(a,b);return this},removeEventListener:function(a,b){this.__eventDispatcher.removeEventListener(a,b);return this},start:function(){if(this._isTweenning){return}this._isTweenning=true;var a=this,b,c=this.startValue,d=this.endValue,e=this.duration,f,g=(new Date).getTime();this._itvID=window.setInterval(function(){b=((new Date).getTime()-g)/1e3;b>a.duration&&(b=a.duration);f=a.motion(b,c,d-c,e);a.onTween&&a.onTween(f);a.__eventDispatcher.dispatchEvent("tween",f);b==a.duration&&a.stop()},25);return this},stop:function(){window.clearInterval(this._itvID);this._isTweenning=false;this.onEnd&&this.onEnd();this.__eventDispatcher.dispatchEvent("end");return this},onTween:function(a){},onEnd:function(){}});Ui.OpacityRenderer=function(){this.__canShow=true;this.__canHidden=true;this.__node=null;this.__tween=new Ui.TweenStrategy(0,0,.6,Ui.Transition.strongEaseOut);this.__state="";this.__lastState="";this.__value=0;this.__node=null;this.__eventDispatcher=new Core.Events.EventDispatcher(this);this.__initTweenEvent()}.$implements(Ui.IRenderer).$define({setCanShow:function(a){this.__canShow=!!a},setCanHidden:function(a){this.__canHidden=!!a},show:function(a){var b=this.__tween;b.stop();Core.Dom.setStyle(a,"opacity",this.__value);a.style.display="";this.__node=a;this.__state="show";this.__eventDispatcher.dispatchEvent("beforeShow");if(this.__canShow){b.startValue=this.__value;b.endValue=1;b.start()}return this},hidden:function(a){var b=this.__tween;b.stop();this.__node=a;this.__state="hidden";this.__eventDispatcher.dispatchEvent("beforeHidden");if(this.__canHidden){b.startValue=this.__value;b.endValue=0;b.start()}return this},addEventListener:function(a,b){this.__eventDispatcher.addEventListener(a,b);return this},removeEventListener:function(a,b){this.__eventDispatcher.removeEventListener(a,b);return this},__initTweenEvent:function(){var a=this;this.__tween.addEventListener("tween",function(b){a.__value=b;Core.Dom.setStyle(a.__node,"opacity",b)});this.__tween.addEventListener("end",function(){a.__node&&a.__node.style.filter&&(a.__node.style.filter="");if(a.__state!==""&&a.__state!==a.__lastState){a.__lastState=a.__state;a.__eventDispatcher.dispatchEvent(a.__state)}a.__state==="hidden"&&(a.__node.style.display="none")})}});Ui.BorderDragger=function(){this.__drag=null;this.__isBindEvent=false;this.__border=null;this.__dragNode=null;this.__isCreated=false;this.__tweenX=new Ui.TweenStrategy(0,0,.5,Ui.Transition.strongEaseOut);this.__tweenY=new Ui.TweenStrategy(0,0,.5,Ui.Transition.strongEaseOut);this.__eventDispatcher=new Core.Events.EventDispatcher(this)}.$implements(Ui.IDragger).$define({addEventListener:function(a,b){if(a.toLowerCase()==="afterdrag"){this.__eventDispatcher.addEventListener(a,b)}else{this.__drag.addEventListener(a,b)}return this},removeEventListener:function(a,b){if(a.toLowerCase()==="afterdrag"){this.__eventDispatcher.removeEventListener(a,b)}else{this.__drag.removeEventListener(a,b)}return this},setDrag:function(a,b,c){if(!this.__isCreated){this.__createBorder(b);this.__initTweenEvent(b)}this.__drag=new Ui.Drag(a,this.__border,c);this.__dragNode=b;this.__initDragEvent();return this},setLock:function(a){this.__drag.isLock=!!a;return this},setArea:function(a){this.__drag.lockArea=a;return this},destroy:function(){this.__drag.destroy()},__createBorder:function(a){this.__border=$C("div");var b=this.__border.style;b.border="2px dashed #BCC4D0";b.position="absolute";b.display="none";b.backgroundColor="transparent";b.MozUserSelect="none";document.body.appendChild(this.__border);this.__isCreated=true},__initDragEvent:function(){if(this.__isBindEvent){return}var a=this,b=this.__border.style,c=this.__dragNode.style,d=this.__tweenX,e=this.__tweenY;this.__drag.addEventListener("beforeDrag",function(){b.zIndex=c.zIndex+1;b.position=c.position;b.width=a.__dragNode.offsetWidth-4+"px";b.height=a.__dragNode.offsetHeight-4+"px";b.left=parseInt(c.left)+"px";b.top=parseInt(c.top)+"px";b.display=""});this.__drag.addEventListener("afterDrag",function(){if($IE6){c.left=parseInt(b.left)+"px";c.top=parseInt(b.top)+"px";b.display="none";a.__eventDispatcher.dispatchEvent("afterDrag")}else{d.startValue=parseInt(c.left);d.endValue=parseInt(b.left);e.startValue=parseInt(c.top);e.endValue=parseInt(b.top);d.start();e.start()}});this.__isBindEvent=true},__initTweenEvent:function(a){var b=a.style,c=this.__border.style,d=this;this.__tweenX.addEventListener("tween",function(a){b.left=a+"px"});this.__tweenY.addEventListener("tween",function(a){b.top=a+"px"});this.__tweenX.addEventListener("end",function(){c.display="none";d.__eventDispatcher.dispatchEvent("afterDrag")})}});var winDialog={};var DialogTemplate={};(function(){var a={alert:['<table id="#{panel}" class="CP_w">','<thead id="#{titleBar}">',"<tr>",'<th class="tLeft"><span></span></th>','<th class="tMid"><div class="bLyTop"><strong id="#{titleName}">提示标题</strong><cite><a id="#{btnClose}" href="#" onclick="return false;" class="CP_w_shut" title="关闭">关闭</a></cite></div></th>','<th class="tRight"><span></span></th>',"</tr>","</thead>","<tfoot>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid"><span></span></td>','<td class="tRight"><span></span></td>',"</tr>","</tfoot>","<tbody>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid">','<div id="#{content}" class="CP_layercon1">','<div class="CP_prompt">','<img id="#{icon}" class="SG_icon SG_icon201" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="50" height="50" align="absmiddle"/>','<table class="CP_w_ttl"><tr><td id="#{text}"></td></tr></table>','<div id="#{subText}" class="CP_w_cnt SG_txtb"></div>','<p class="CP_w_btns_Mid"><a id="#{linkOk}" class="SG_aBtn SG_aBtnB" href="#" onclick="return false;"><cite id="#{btnOk}"> </cite></a></p>',"</div>","</div>","</td>",'<td class="tRight"><span></span></td>',"</tr>","</tbody>","</table>"].join(""),newAlert:['<table id="#{panel}" class="CP_w">','<thead id="#{titleBar}">',"<tr>",'<th class="tLeft"><span></span></th>','<th class="tMid"><div class="bLyTop"><strong id="#{titleName}">提示</strong><cite><a id="#{btnClose}" href="#" onclick="return false;" class="CP_w_shut" title="关闭">关闭</a></cite></div></th>','<th class="tRight"><span></span></th>',"</tr>","</thead>","<tfoot>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid"><span></span></td>','<td class="tRight"><span></span></td>',"</tr>","</tfoot>","<tbody>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid">','<div class="CP_layercon2 pop_v">','<div class="v_prompt">','<img id="#{icon}" class="SG_icon SG_icon148" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="20" height="20" align="absmiddle" />','<div id="#{text}" class="v_cnt SG_txtb"></div>','<div id="#{subText}"></div>','<p class="v_btns">','<a id="#{linkOk}" class="SG_aBtn SG_aBtnB" href="#"><cite id="#{btnOk}">确定</cite></a>',"</p>","</div>","</div>","</td>",'<td class="tRight"><span></span></td>',"</tr>","</tbody>","</table>"].join(""),confirm:['<table id="#{panel}" class="CP_w">','<thead id="#{titleBar}">',"<tr>",'<th class="tLeft"><span></span></th>','<th class="tMid"><div class="bLyTop"><strong id="#{titleName}">提示标题</strong><cite><a id="#{btnClose}" href="#" onclick="return false;" class="CP_w_shut" title="关闭">关闭</a></cite></div></th>','<th class="tRight"><span></span></th>',"</tr>","</thead>","<tfoot>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid"><span></span></td>','<td class="tRight"><span></span></td>',"</tr>","</tfoot>","<tbody>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid">','<div id="#{content}" class="CP_layercon1">','<div class="CP_prompt">','<img id="#{icon}" class="SG_icon SG_icon201" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="50" height="50" align="absmiddle"/>','<table class="CP_w_ttl"><tr><td id="#{text}"></td></tr></table>','<div id="#{subText}" class="CP_w_cnt SG_txtb"></div>','<p class="CP_w_btns">','<a  id="#{linkOk}" class="SG_aBtn SG_aBtnB" href="#" onclick="return false;"><cite id="#{btnOk}"></cite></a>','<a style="margin-left:5px;" id="#{linkCancel}" class="SG_aBtn SG_aBtnB" href="#" onclick="return false;"><cite id="#{btnCancel}"> <span id="#{cancel}"></span> </cite></a></p>',"</div>","</div>","</td>",'<td class="tRight"><span></span></td>',"</tr>","</tbody>","</table>"].join(""),newConfirm:['<table id="#{panel}" class="CP_w">','<thead id="#{titleBar}">',"<tr>",'<th class="tLeft"><span></span></th>','<th class="tMid"><div class="bLyTop"><strong id="#{titleName}">提示</strong><cite><a id="#{btnClose}" href="#" onclick="return false;" class="CP_w_shut" title="关闭">关闭</a></cite></div></th>','<th class="tRight"><span></span></th>',"</tr>","</thead>","<tfoot>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid"><span></span></td>','<td class="tRight"><span></span></td>',"</tr>","</tfoot>","<tbody>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid">','<div class="CP_layercon2 pop_v">','<div class="v_prompt">','<img id="#{icon}" class="SG_icon SG_icon148" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="20" height="20" align="absmiddle" />','<div id="#{text}" class="v_cnt SG_txtb"></div>','<div id="#{subText}"></div>','<p class="v_btns">','<a id="#{linkOk}" class="SG_aBtn SG_aBtnB" href="#"><cite id="#{btnOk}">确定</cite></a>&nbsp;&nbsp;','<a id="#{linkCancel}" class="SG_aBtn SG_aBtnB SG_aBtn_g" href="#"><cite id="#{btnCancel}">取消</cite></a>',"</p>","</div>","</div>","</td>",'<td class="tRight"><span></span></td>',"</tr>","</tbody>","</table>"].join(""),customs:['<table id="#{panel}" class="CP_w">','<thead id="#{titleBar}">',"<tr>",'<th class="tLeft"><span></span></th>','<th class="tMid">','<div class="bLyTop">','<strong id="#{titleName}">提示标题</strong>','<cite><a id="#{btnClose}" href="#" onclick="return false;" class="CP_w_shut" title="关闭">关闭</a></cite>',"</div>","</th>",'<th class="tRight"><span></span></th>',"</tr>","</thead>","<tfoot>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid"><span></span></td>','<td class="tRight"><span></span></td>',"</tr>","</tfoot>","<tbody>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid" id="#{content}">',"</td>",'<td class="tRight"><span></span></td>',"</tr>","</tbody>","</table>"].join("")};var b={"01":{"class":"SG_icon SG_icon201",alt:"警告"},"02":{"class":"SG_icon SG_icon202",alt:"失败"},"03":{"class":"SG_icon SG_icon203",alt:"成功"},"04":{"class":"SG_icon SG_icon204",alt:"询问"},"05":{"class":"SG_icon SG_bigLoading",alt:"正在加载"},"06":{"class":"SG_icon SG_icon148",alt:"警告"}};var c={};var d=new Ui.ModuleDialog(a,b,{renderer:Ui.OpacityRenderer,dragger:Ui.BorderDragger,isAdamant:$IE6});winDialog.create=winDialog.createCustomsDialog=function(a,b){if(b&&typeof b==="string"){c[b]=d.create(a);return c[b]}else{return d.create(a)}};winDialog.alert=function(a,b,e){if(e&&typeof e==="string"){c[e]=d.alert(a,b);return c[e]}else{return d.alert(a,b)}};winDialog.newAlert=function(a,b,e){if(e&&typeof e==="string"){c[e]=d.newAlert(a,b);return c[e]}else{return d.newAlert(a,b)}};winDialog.confirm=function(a,b,e){if(e&&typeof e==="string"){c[e]=d.confirm(a,b);return c[e]}else{return d.confirm(a,b)}};winDialog.newConfirm=function(a,b,e){if(e&&typeof e==="string"){c[e]=d.newConfirm(a,b);return c[e]}else{return d.newConfirm(a,b)}};winDialog.getDialog=function(a){if(a&&typeof a==="string"){return c[a]}};DialogTemplate=a})();$SYSMSG.extend({A00001:"操作失败，可能系统繁忙或系统遇到未知错误，请稍后再试。也可联系新浪客服：致电4006900000。",A00002:"很抱歉，您的IP出现异常，请稍后再试",A00003:"无权限进行此操作，请重新登录。",A00004:"无权限进行此操作，请重新登录。",A00005:"操作失败，可能系统繁忙或系统遇到未知错误，请稍后再试。也可联系新浪客服：致电4006900000。",A00006:"操作成功",A00007:"无权限进行此操作，请重新登录。",A00009:"网络繁忙，请稍后再试",A00010:"无升级权限",A11007:"你还未开通新浪博客，请先<a href='http://login.sina.com.cn/hd/reg_sec.php?entry=blog'> 开通博客</a>",A00800:"对不起，您短时间点击喜欢过多，请多休息，注意身体！感谢您对新浪博客的支持和关注！"});$SYSMSG.extend({A33001:"对方已经被你加为关注了！<br/>请不要重复添加。",A33002:"对方拒绝了你的关注请求！",A33003:"关注已达上限，不能再添加新的关注了！<br/>可以到<a href='http://control.blog.sina.com.cn/blogprofile/attention.php"+"' target='_blank'>关注的人</a>去取消关注一些人，再回来关注吧。",A33004:"关注成功！",A33005:"你不能添加自己为关注！",A33008:"取消关注失败",A33009:"移除关注成功，加黑名单失败",A33010:"对不起，您短时间添加关注过多，请多休息，注意身体！感谢您对新浪博客的支持和关注！",A20013:"您已经发送多条相似内容了哦，请先休息一下吧~",A20014:"已经有很多博主发过相似评论了，换个内容会更精彩~"});Utils.Cookie.setCookie=function(a,b,c,d,e,f){var g=[];g.push(a+"="+escape(b));if(c){var h=new Date;var i=h.getTime()+c*36e5;h.setTime(i);g.push("expires="+h.toGMTString())}if(d){g.push("path="+d)}if(e){g.push("domain="+e)}if(f){g.push(f)}document.cookie=g.join(";")};String.prototype.format=function(){var a=!arguments[0]||typeof arguments[0]=="undefined"?"":arguments[0].toString();var b=/(.*?)({(\d+)(:([0-9a-z]+))?})/ig;var c=this.match(b);if(c){for(var d=0,e=c.length;d<e;d++){c[d]=c[d].replace(b,function(){return RegExp.$1});c[d]=RegExp.$1;switch(typeof arguments[parseInt(RegExp.$3)]){case"undefined":c[d]+=RegExp.$2;break;case"number":c[d]+=isNaN(RegExp.$5)||RegExp.$5==""?arguments[parseInt(RegExp.$3)]:arguments[parseInt(RegExp.$3)].toString(Math.max(Math.min(Math.round(RegExp.$5),36),2));break;default:c[d]+=arguments[parseInt(RegExp.$3)]}}c.push(this.replace(b,""));return c.join("")}return this};Sina.pkg("Core.Math");Core.Math.getUniqueId=function(a,b){return parseInt(Math.random()*1e4).toString()+(new Date).getTime().toString()};Lib.pkg("Login");Lib.Login.info=function(){var a;if(window["sinaSSOController"]&&(a=sinaSSOController.getLoginInfo())){return a}else{return{}}};Lib.Login.LoginPost=Core.Class.create();Lib.Login.LoginPost.prototype={url:"http://i.sso.sina.com.cn/js/ssologin.js",callback:null,initialize:function(a,b,c){window.sinaSSOConfig=new function(){if(c){this.from=c}this.pageCharset="utf-8";this.noActiveTime=14400;this.setDomain=true;this.entry="boke";this.customInit=function(){};this.customLoginCallBack=a;this.customLogoutCallBack=function(a){};this.useIframe=true}},login:function(a,b,c){function e(){if(typeof c=="undefined"){sinaSSOController.login(a,b)}else{sinaSSOController.login(a,b,c)}}var d=this;if(typeof sinaSSOController=="undefined"||!sinaSSOController){trace("no sso");Utils.Io.JsLoad.request(this.url,{onComplete:function(){e()},onException:function(){},timeout:3e4,isRemove:false})}else{trace("has sso");sinaSSOController.init();if(typeof sinaSSOController.setLoginType=="function"){sinaSSOController.setLoginType(2)}if(typeof sinaSSOController.getServerTime=="function"){sinaSSOController.getServerTime(a)}trace("init ok");e()}},parse:function(a){this.callback.call(a)}};Core.System.getScrollPos=function(a){a=a||document;var b=a.documentElement;var c=a.body;return[Math.max(b.scrollTop,c.scrollTop),Math.max(b.scrollLeft,c.scrollLeft),Math.max(b.scrollWidth,c.scrollWidth),Math.max(b.scrollHeight,c.scrollHeight)]};Core.Dom.getStyle=function(a,b){switch(b){case"opacity":var c=100;try{c=a.filters["DXImageTransform.Microsoft.Alpha"].opacity}catch(d){try{c=a.filters("alpha").opacity}catch(d){}}return c/100;case"float":b="styleFloat";default:var e=a.currentStyle?a.currentStyle[b]:null;return a.style[b]||e}};if(!$IE||$IE>8){Core.Dom.getStyle=function(a,b){if(b=="float"){b="cssFloat"}try{var c=document.defaultView.getComputedStyle(a,"")}catch(d){traceError(d)}return a.style[b]||c?c[b]:null}}Core.Dom.getXY=function(a){if((a.parentNode==null||a.offsetParent==null||Core.Dom.getStyle(a,"display")=="none")&&a!=document.body){return false}var b=null;var c=[];var d;var e=a.ownerDocument;d=a.getBoundingClientRect();var f=Core.System.getScrollPos(a.ownerDocument);return[d.left+f[1],d.top+f[0]];b=a.parentNode;while(b.tagName&&!/^body|html$/i.test(b.tagName)){if(Core.Dom.getStyle(b,"display").search(/^inline|table-row.*$/i)){c[0]-=b.scrollLeft;c[1]-=b.scrollTop}b=b.parentNode}return c};if(!$IE){Core.Dom.getXY=function(a){if((a.parentNode==null||a.offsetParent==null||Core.Dom.getStyle(a,"display")=="none")&&a!=document.body){return false}var b=null;var c=[];var d;var e=a.ownerDocument;c=[a.offsetLeft,a.offsetTop];b=a.offsetParent;var f=Core.Dom.getStyle(a,"position")=="absolute";if(b!=a){while(b){c[0]+=b.offsetLeft;c[1]+=b.offsetTop;if($SAFARI&&!f&&Core.Dom.getStyle(b,"position")=="absolute"){f=true}b=b.offsetParent}}if($SAFARI&&f){c[0]-=a.ownerDocument.body.offsetLeft;c[1]-=a.ownerDocument.body.offsetTop}b=a.parentNode;while(b.tagName&&!/^body|html$/i.test(b.tagName)){if(Core.Dom.getStyle(b,"display").search(/^inline|table-row.*$/i)){c[0]-=b.scrollLeft;c[1]-=b.scrollTop}b=b.parentNode}return c}}(function(){var a;var b=parseInt(Math.random()*100);var c=[];var d=-1;var e="";var f="#userPosition {padding: 0;margin: 0;border: 0;position: absolute;z-index: 999;}				#sinaNote {position: absolute;z-index: 999999;width: auto;overflow: hidden;padding: 0;margin: 0;				border: 1px solid #CCCCCC;background: #ffffff;text-align:left;}				#sinaNote li {font-size: 12px;list-style: none;margin: 0 1px;height: 20px;padding: 0 5px;clear: both;				line-height: 20px;cursor: pointer;color: #999999;}				#sinaNote li.note {text-align: left;color: #999999;}";var g=window;var h={overfcolor:"#999",overbgcolor:"#e8f4fc",outfcolor:"#000000",outbgcolor:"",menuStatus:{"sina.com":true,"sina.cn":true,"vip.sina.com":true,"qq.com":true,"163.com":true,"126.com":true,"hotmail.com":true,"yahoo.com.cn":true,"gmail.com":true}};h.createNode=function(){var a=g.document;var b=a.createElement("div");b.innerHTML='<ul id="sinaNote" style="display:none;"></ul>';var c=a.createElement("style");c.setAttribute("type","text/css");try{if($IE){c.styleSheet.cssText=f}else{c.innerHTML=f}}catch(d){trace(d.message)}var e=a.createElement("div");e.appendChild(b);e.appendChild(c);a.body.appendChild(e)};h.arrowKey=function(a){if(a==38){if(d<=0){d=c.length}d--;h.selectLi(d)}if(a==40){if(d>=c.length-1){d=-1}d++;h.selectLi(d)}};h.showList=function(a){e="";var f=Core.Events.getEvent().keyCode;if(f==38||f==40){h.arrowKey(f);return false}if(!$E("sinaNote")){h.createNode()}var i=$E(a).value;var j={};var k=i.indexOf("@");var l="";var m="";if(k>-1){l=i.substr(k+1);m=i.substr(0,k)}c=[];d=0;c[c.length]="sinaNote_MenuItem_Title_"+b;for(var n in this.menuStatus){this.menuStatus[n]=true;if(l!=""&&l!=n.substr(0,l.length)){this.menuStatus[n]=false}else{c[c.length]="sinaNote_MenuItem_"+n+"_"+b}}var o='<li class="note">请选择登录类型</li>';o+='<li id="sinaNote_MenuItem_Title_'+b+'">'+i+"</li>";var p;for(var q in this.menuStatus){if(this.menuStatus[q]==true){if(m==""){p=i+"@"+q}else{p=m+"@"+q}o+='<li id="sinaNote_MenuItem_'+q+"_"+b+'" title="'+p+'">'+p+"</li>"}}$E("sinaNote").innerHTML=o;for(var r=0;r<i.length;r++){if(i.charCodeAt(r)<160){$E("sinaNote").style.display="";this.selectList(a)}else{this.hideList()}}var s=$E(a);var t=$E("sinaNote");var u=0;var v=0;var w;if(g!=window){w=Core.Dom.getXY(window.frameElement);u=w[0];v=w[1]}var x=s.offsetWidth;if(x<200){x=200}t.style.width=x-2+"px";var y=Core.Dom.getXY(s);t.style.left=y[0]-($IE?2:-1)+u+"px";t.style.top=y[1]+s.offsetHeight-($IE?2:-1)+v+"px"};h.selectList=function(a){var b=$E("sinaNote").getElementsByTagName("li");for(var c=1;c<b.length;c++){b[1].style.backgroundColor=h.overbgcolor;b[1].style.color=h.outfcolor;b[c].onmousedown=function(){var b=this.innerHTML;if(b.indexOf("非新浪邮箱")>-1){var c=b.split("@");$E(a).value=c[0]}else{$E(a).value=this.innerHTML}if(Core.Events.getEvent()!=null){Core.Events.stopEvent()}};b[c].onmouseover=function(){if(c!=1){b[1].style.backgroundColor=h.outbgcolor;b[1].style.color=h.overfcolor}this.style.backgroundColor=h.overbgcolor;this.style.color=h.outfcolor};b[c].onmouseout=function(){this.style.backgroundColor=h.outbgcolor;this.style.color=h.overfcolor;b[1].style.backgroundColor=h.overbgcolor;b[1].style.color=h.outfcolor}}};h.selectLi=function(a){var d;$E("sinaNote_MenuItem_Title_"+b).style.backgroundColor=h.outbgcolor;$E("sinaNote_MenuItem_Title_"+b).style.color=h.overfcolor;for(var f=0;f<c.length;f++){d=$E(c[f]);d.style.backgroundColor=h.outbgcolor;d.style.color=h.overfcolor}$E(c[a]).style.backgroundColor=h.overbgcolor;$E(c[a]).style.color=h.outfcolor;e=$E(c[a]).innerHTML};h.hideList=function(){if(!$E("sinaNote")){h.createNode()}$E("sinaNote").style.display="none"};h.init=function(a,b,c,d){d=d||window;if(d.document.body==null){setTimeout(Core.Function.bind3(function(){this.init(a,b,c,d)},this),100)}for(var f in b){this[f]=b[f]}Core.Events.addEvent(document,h.hideList,"click");Core.Events.addEvent(a,h.hideList,"blur");Core.Events.addEvent(a,Core.Function.bind3(h.showList,this,[a]),"keyup");Core.Events.addEvent(a,function(b){var d=Core.Events.getEvent().keyCode;var f;if(d==13||d==9){if(e!=""){var g=e;if(g.indexOf("非新浪邮箱")>-1){var h=g.split("@");a.value=h[0]+"@";f=false}else{a.value=e;f=true}}if(f){if(c!=null){setTimeout(function(){c.focus()},0)}}else{if(a){a.focus()}}}},"keydown");if(d){g=d}};Lib.passcardOBJ=h})();Lib.Login.Ui=Core.Class.create();var msnRefreshTimer=0;Lib.Login.Ui.prototype={dialog:null,isInit:false,request:null,callback:null,initialize:function(){},login:function(a,b,c){this.callback=a||null;this.clearDomain=b||false;this.from=c||null;this.initDom();this.initEvent();this.dialog.show();this.dialog.setAreaLocked(true);this.reloadName();this.onShow();this.focus();if(scope.$pageid==="blogMove"){$E("login_move_tip").style.display=""}if($IE6){this.initAD()}Lib.passcardOBJ.init($E("login_name_d"),{overfcolor:"#999",overbgcolor:"#e8f4fc",outfcolor:"#000000",outbgcolor:""},$E("login_pass_d"))},reloadName:function(){var a=Lib.Login.info();var b=a.ln;if(b){$E("login_name_d").value=b}var c=Utils.Cookie.getCookie("ALF");if(c!=""&&$E("login_save")){$E("login_save").checked=true;$E("login_save_tips").style.display="none"}c=Utils.Cookie.getCookie("LiRe");if(c!=""&&$E("login_save")){$E("login_save").checked=true;$E("login_save_tips").style.display="none"}},initDom:function(){var a=this;this.dialog=winDialog.createCustomsDialog({tpl:a.tpl});this.dialog.addEventListener("hidden",function(){this.destroy()});this.dialog.setContent(this.struc);this.dialog.setTitle("登录新浪博客");this.dialog.setMiddle()},initEvent:function(){var a=this.parse.bind2(this);this.request=new Lib.Login.LoginPost(a,this.clearDomain,this.from);Core.Events.addEvent("login_button",this.doLogin.bind2(this));Core.Events.addEvent("login_name_d",function(a){var b=a.keyCode;if(b==13){this.doLogin()}}.bind2(this),"keydown");Core.Events.addEvent("login_pass_d",function(a){var b=a.keyCode;if(b==13){this.doLogin()}}.bind2(this),"keydown");var b=1;Core.Events.addEvent("login_save",function(){if($E("login_save").checked){$E("login_save_tips").style.display=""}else{$E("login_save_tips").style.display="none"}if(b){var a="http://control.blog.sina.com.cn/blog_rebuild/riaapi/padblog/padInfo.php?ck_login=A00001&rnd="+Math.random();Utils.Io.JsLoad.request(a,{onComplete:function(){},onException:function(){}});b=null}})},doLogin:function(){Core.Events.stopEvent();var a=$E("login_name_d").value;var b=$E("login_pass_d").value;a=Core.String.trim(a);b=b;if(a==""){this.error("请输入登录名");return false}if(b==""){this.error("请输入密码");return false}if(typeof sinaSSOController!="undefined"&&typeof sinaSSOController.loginExtraQuery!="undefined"){if(typeof sinaSSOController.loginExtraQuery.door!="undefined"){var c=$E("login_vcode").value;sinaSSOController.loginExtraQuery.door=c||1}}if($E("login_save").checked){v7sendLog("48_01_38_1");this.request.login(a,b,60)}else{v7sendLog("48_01_38_0");this.request.login(a,b)}return false},parse:function(a){if(a.result){Lib.checkAuthor();if($E("login_save").checked){Utils.Cookie.setCookie("LiRe",true,2400,"/",".blog.sina.com.cn")}else{Utils.Cookie.setCookie("LiRe","",2400,"/",".blog.sina.com.cn")}var b=new Date,c=b.getFullYear(),d=b.getMonth(),e=b.getDate();var f=(new Date(c,d,e,24)).getTime();Utils.Cookie.setCookie("onceloggedonblog",f,720,"/",".blog.sina.com.cn");var g=this;function h(){if(this.callback){try{$tray.renderLogin()}catch(a){}this.callback.call()}else{window.location=window.location.toString().replace(/#.*/,"")}}var i=false;Utils.Io.JsLoad.request("http://login.sina.com.cn/bindmail/checkmailuser.php?entry=blog&name="+encodeURIComponent($E("login_name_d").value)+"&utf82gbk=1&callback=scope.$bindEmailAlert",{noreturn:true,timeout:5e3,onException:function(){if(!i){h.call(g)}}});scope.$bindEmailAlert=function(a){i=true;if(a.ret!="y"&&a.errcode!="not_verify"||Utils.Cookie.getCookie("sbr_noTBE")==1){h.call(g)}else{var b=winDialog.createCustomsDialog({content:['<div id="#{entityID} style="width:358px;height:144px" class="CP_layercon2 unilayer">','<div id="#{contentID}" class="CP_prompt">','<img height="50" align="absmiddle" width="50" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" class="SG_icon SG_icon201">','<table class="CP_w_ttl"><tbody><tr><td>经检测您的帐号存在一定的安全隐患！<br>建议绑定邮箱</td></tr></tbody></table>','<p class="CP_w_btns_Mid"><a href="javascript:;" class="SG_aBtn SG_aBtnB" id="#{bindit}" target="_blank"><cite> 绑定 </cite></a>&nbsp;&nbsp;<a href="javascript:;" class="SG_aBtn SG_aBtnB" id="#{nobind}"><cite> 暂不绑定 </cite></a></p>',"</div>",'<div class="unilayerB SG_j_linedot1">','<p class="SG_txtb"><input type="checkbox" id="#{noalertbind}"><label for="#{noalertbind}">一周内不提醒</label></p>',"</div>","</div>"].join(""),shadow:1},"bindEmail");b.setMiddle();b.show();b.nodes["btnClose"].onclick=function(){h.call(g);b.hidden()};b.nodes["nobind"].onclick=function(){setTimeout(function(){h.call(g);b.hidden()},100)};b.nodes["bindit"].href="http://login.sina.com.cn/bindmail/bindmail.php?entry=blog";b.nodes["bindit"].onclick=function(){h.call(g)};b.nodes["noalertbind"].onclick=function(){if(this.checked){Utils.Cookie.setCookie("sbr_noTBE","1",24*7,"/",".blog.sina.com.cn")}else{Utils.Cookie.setCookie("sbr_noTBE","",0,"/",".blog.sina.com.cn")}}}};this.dialog.hidden()}else{if(a.errno==="4049"){sinaSSOController.loginExtraQuery={door:0};$E("login_ckimg").style.display="";$E("login_vcode").value="";$E("checkImg").src="http://login.sina.com.cn/cgi/pin.php?r="+Core.Math.getUniqueId()+"&s=0";Core.Events.addEvent($E("reloadCode"),function(){$E("checkImg").src="http://login.sina.com.cn/cgi/pin.php?r="+Core.Math.getUniqueId()+"&s=0";$E("login_vcode").value="";$E("login_div_error").innerHTML=""});this.error("");return}if(a.errno==="2070"){Core.Events.fireEvent($E("reloadCode"),"click");this.error(a.reason);return}if(a.errno=="4047"){this.error(a.reason);return}else if(a.errno=="4057"){this.error(a.reason);return}else if(a.errno=="4040"){this.error(a.reason);return}this.error("登录名或密码错误");$E("checkImg").src="http://login.sina.com.cn/cgi/pin.php?r="+Core.Math.getUniqueId()+"&s=0";$E("login_vcode").value=""}},friendlyTip:function(a){var b=a;var c=$E("login_name_d");var d=c.value;var e=this;if(!/[\u0391-\uFFE5]+/.test(d)&&!/^\d+$/.test(d)&&!/^@/.test(d)){var f="你的登录名可能是 ";var g='<a href="#" class="underline" onclick="$_RENAME(/@.*/, \'{1}\');return false">{0}{1}</a>';var h=["@sina.com","@sina.cn"];var i="";if(/@sina\.cn$/.test(d)){i=g.format("{0}",h[0])}else if(/@sina\.com$/.test(d)){i=g.format("{0}",h[1])}else{i=g.format("{0}",h[0])+" 或 "+g.format("{0}",h[1])}b=(f+i).format(d.replace(/@.*/,""))}return b},rename:function(){window.$_RENAME=function(a,b){var c=$E("login_name_d");c.value=c.value.replace(a,"")+b;$E("login_pass_d").focus();$E("login_div_error").innerHTML=""};return window.$_RENAME}(),focus:function(){var a=$E("login_name_d");if(a.value==""){a.focus()}else{$E("login_pass_d").focus()}},initAD:function(){$E("login_ad").src="http://blog.sina.com.cn/lm/iframe/71/2008/0731/21.html"},onShow:function(){},error:function(a){$E("login_div_error").innerHTML=a;$E("login_pass_d").value="";this.focus()},tpl:['<table id="#{panel}" class="CP_w">','<thead id="#{titleBar}">',"<tr>",'<th class="tLeft"><span></span></th>','<th class="tMid">','<div class="bLyTop">','<strong id="#{titleName}">提示标题</strong>','<cite><a id="#{btnClose}" href="#" onclick="return false;" class="CP_w_shut" title="关闭">关闭</a></cite>',"</div>","</th>",'<th class="tRight"><span></span></th>',"</tr>","</thead>","<tfoot>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid"><span></span></td>','<td class="tRight"><span></span></td>',"</tr>","</tfoot>","<tbody>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid" id="#{content}">',"</td>",'<td class="tRight"><span></span></td>',"</tr>","</tbody>","</table>"].join(""),struc:'		<div class="CP_layercon2 passLoginItem">			<div>				<div id="login_move_tip" style="display:none;margin-bottom:12px">可以使用新浪微博、邮箱、通行证的帐号进行登录</div>				<div class="boxA">登录名：					<input tabIndex="201" type="text" class="fm1" style="width:215px;" name="login_name" id="login_name_d" tabIndex=1/>  <a style="font-size: 12px;" href="http://login.sina.com.cn/signup/signupmail.php?entry=blog&srcuid='+scope.$uid+'&src=blogicp" target="_blank">立即注册</a>				</div>				<div class="boxA">密　码：					<input tabIndex="202" type="password" class="fm1" style="width:215px;" name="login_pass" maxlength="16" id="login_pass_d" tabIndex=2/>  <a style="font-size: 12px;" href="http://login.sina.com.cn/getpass.html" target="_blank">找回密码</a>				</div>				<div id="login_ckimg" class="boxA" style="display:none"> <p class="p_img">验证码：                  	<input type="text" id="login_vcode" name="login_vcode" class="fm1" size="10" maxlength="5" />                  	<img width="100" align="absmiddle" id="checkImg" src="http://login.sina.com.cn/cgi/pin.php?r='+Core.Math.getUniqueId()+'&s=0" /> <a href="javascript:;" onclick="return false;" style="font-size: 12px;"><span id="reloadCode">换一换</span></a></p> 			    </div>				<div class="ErrTips" id="login_div_error"></div>				<div class="boxB"><p><input tabIndex="203" type="checkbox" value="" id="login_save" checked="checked" /><label for="login_save"> 记住登录状态</label></p><p id="login_save_tips" style="color:#999;display:none;">建议在网吧/公用电脑上取消该选项</p><p style="margin-top: 8px;"><a id="login_button" class="SG_aBtn SG_aBtnB SG_aBtn_sub" href="javascript:;" tabIndex=204><cite>登录<input type="text"/></cite></a> </p></div>			</div>			<div class="connect_msn" id="connect_msn" style="position:relative;">				<span>使用 MSN 帐号登录博客</span>				<a href="#" onclick="Lib.checkAuthor();v7sendLog(\'48_01_36\'); window.open(\'https://login.live.com/oauth20_authorize.srf?client_id=0000000040046F08&redirect_uri=http%3A%2F%2Fcontrol.blog.sina.com.cn%2Fblog_rebuild%2Fmsn%2FmsnLoginCallBack.php&response_type=code&scope=wl.basic%20wl.signin%20wl.offline_access%20wl.share%20wl.emails\',\'neww\',\'left='+(screen.width-440)/2+",top="+(screen.height-400)/2+',height=400,width=440\');msnrefreshWindow();" style="background:transparent url(http://simg.sinajs.cn/blog7style/images/msn_login01.gif) no-repeat left top; width:70px; height:22px; line-height:22px; display:inline-block; text-align:left; text-indent:2em; text-decoration:none; color:white; font-weight:bold; font-size:14px;">登录</a>			</div>			<a href="http://blog.sina.com.cn/s/blog_4b0f52990100miil.html" target="_blank"style="left:308px;position:relative;top:-24px;">如何登录？</a>			<div class="CP_lg_ad SG_j_linedot1">				<iframe id="login_ad" src="http://blog.sina.com.cn/lm/iframe/71/2008/0731/21.html" frameborder="0" scrolling="no" height="25" width="auto"></iframe>			</div>		</div>'};Core.System.winSize=function(a){var b,c;if(a){target=a.document}else{target=document}if(self.innerHeight){if(a){target=a.self}else{target=self}b=target.innerWidth;c=target.innerHeight}else if(target.documentElement&&target.documentElement.clientHeight){b=target.documentElement.clientWidth;c=target.documentElement.clientHeight}else if(target.body){b=target.body.clientWidth;c=target.body.clientHeight}return{width:b,height:c}};Core.System.pageSize=function(a){if(a){target=a.document}else{target=document}var b=target.compatMode=="CSS1Compat"?target.documentElement:target.body;var c,d;if(window.innerHeight&&window.scrollMaxY){c=b.scrollWidth;d=window.innerHeight+window.scrollMaxY}else if(b.scrollHeight>b.offsetHeight){c=b.scrollWidth;d=b.scrollHeight}else{c=b.offsetWidth;d=b.offsetHeight}var e=Core.System.winSize(a);if(d<e.height){pageHeight=e.height}else{pageHeight=d}if(c<e.width){pageWidth=e.width}else{pageWidth=c}return[pageWidth,pageHeight,e.width,e.height]};(function(){function a(a,b){this.node=a;this.config=b;for(var c in this.defaultConfig){this.config[c]=this.defaultConfig[c]}this.initialize();return this}a.prototype={defaultConfig:{preloadPixel:500},initialize:function(){this.viewableHeight=b.getViewableHeight();b.enrol(this)},callback:function(a){if(this.node.length==0){return}this.viewableHeight=a||this.viewableHeight;var b=[];for(var c=0,d=this.node.length;c<d;c++){if(this.node[c]&&this.node[c].dom==null&&Core.Dom.getXY(this.node[c])[1]<this.viewableHeight+this.config.preloadPixel){this.config.callback(this.node[c]);this.node[c]=null}else if(this.node[c]&&this.node[c].dom&&Core.Dom.getXY(this.node[c].dom)[1]<this.viewableHeight+this.config.preloadPixel){this.node[c].callback(this.node[c].dom);this.node[c]=null}else{b.push(this.node[c])}}this.node=b}};var b={_isInit:null,_binder:null,_isWindow:null,_member:[],initialize:function(){var a=window,b=a==window||a==document||!a.tagName||/^(?:body|html)$/i.test(a.tagName);if(b){var c=a.document;a=c.compatMode=="CSS1Compat"&&($IE||$FF||$OPERA)?c.documentElement:c.body}this._container=a;this._binder=b?window:a;this._isWindow=b;this._isInit=true;this.delayResize();this.bindEvent()},getViewableHeight:function(){var a=b._container.scrollTop+Core.System.winSize().height;this.eyeableHeight=a;return a},bindEvent:function(){if(!this._isInit){this.initialize();return}Core.Events.addEvent(this._binder,b.delayLoad,"scroll");if(this._isWindow){Core.Events.addEvent(this._binder,b.delayResize,"resize")}this.binded=true},unbindEvent:function(){Core.Events.removeEvent(b._binder,b.delayLoad,"scroll");if(this._isWindow){Core.Events.removeEvent(b._binder,b.delayResize,"resize")}this.binded=false},delayLoad:function(){if(b.scrollWatch){clearTimeout(b.scrollWatch)}b.scrollWatch=setTimeout(function(){b.callback();clearTimeout(b.scrollWatch);b.scrollWatch=null},100)},delayResize:function(){if(b.resizeWatch){clearTimeout(b.resizeWatch)}b.resizeWatch=setTimeout(function(){b.callback();clearTimeout(b.resizeWatch);b.resizeWatch=null},100)},enrol:function(a){b._member.push(a)},callback:function(){b.getViewableHeight();if(b._member.length>0){for(var a=0,c=b._member.length;a<c;a++){b._member[a].callback(b.eyeableHeight)}}if(b.eyeableHeight==Core.System.pageSize()[1]){b.unbindEvent()}}};Lib.LazyLoad=function(c,d){if(b.binded!=true){b.bindEvent(c,d)}new a(c,d)}})();var Layer=function(a){this.entity=null;this.ifm=null;var b=this;var c={width:0,height:0,x:0,y:0,isFixed:false,uniqueID:"",entityID:"",contentID:"",template:a,templateString:"",nodes:{}};this.getProperty=function(){return c};(function(){var c=b.getProperty();c.uniqueID="_"+b.getUniqueID();c.entityID=c.uniqueID+"_entity";c.contentID=c.uniqueID+"_content";b.setTemplate(c.template);c.width=parseInt(b.entity.style.width);if($IE6){b.addIframe()}document.body.appendChild(b.entity);b.hidden()})();this._ie6Fixed=function(){b.entity.style.left=document.documentElement.scrollLeft+b.getProperty().x+"px";b.entity.style.top=document.documentElement.scrollTop+b.getProperty().y+"px";if(b.ifm){b.ifm.style.left=document.documentElement.scrollLeft+b.getProperty().x+"px";b.ifm.style.top=document.documentElement.scrollTop+b.getProperty().y+"px"}}};Layer.prototype={setTemplate:function(a){var b=this.getProperty();if(this.entity){this.entity.parentNode.removeChild(this.entity);this.entity=null}if(typeof a=="object"){b.nodes=a;if(this.entity){this.entity.parentNode.removeChild(this.entity);this.entity=null}this.entity=b.nodes.entity;document.body.appendChild(this.entity);if(!b.nodes.entity||!b.nodes.content){throw new Error("[layer.js] missing entity or content in layer nodes")}else{this.entity.style.position="absolute";this.entity.style.zIndex="1024";this.entity.style.left=b.x+"px";this.entity.style.top=b.y+"px"}return}var c=/[^\{\}]+(?=\})/g;b.template=a;b.templateString=b.template.match(c);this.entity=$C("div");var d=$C("div");var e=new Ui.Template(b.template);d.innerHTML=e.evaluate(this.getNodes("i"));document.body.appendChild(d);if(!$E(b.entityID)||!$E(b.contentID)){throw new Error("[layer.js] there missing #{entityID} or #{contentID} in layer template")}else{this.entity=$E(b.entityID);this.entity.style.position="absolute";this.entity.style.zIndex="1024";this.entity.style.left=b.x+"px";this.entity.style.top=b.y+"px";document.body.replaceChild(this.entity,d);d=null}b.nodes=this.getNodes()},setSize:function(a){var b=this.getProperty();Core.System.parseParam(b,a);if(a.width){b.nodes.content.style.width=b.width+"px"}if(a.height){b.nodes.content.style.height=b.height+"px"}this.updateIfmSize()},setPosition:function(a){var b=this.getProperty();Core.System.parseParam(b,a);this.entity.style.left=b.x+"px";this.entity.style.top=b.y+"px";if($IE6&&b.isFixed){this.entity.style.left=b.x+document.documentElement.scrollLeft+"px";this.entity.style.top=b.y+document.documentElement.scrollTop+"px"}if(this.ifm){this.ifm.style.left=this.entity.style.left;this.ifm.style.top=this.entity.style.top}},getWidth:function(){var a=this.entity.style.display;var b=this.entity.style.visibility;this.entity.style.visibility="hidden";this.entity.style.display="";w=this.entity.offsetWidth;this.entity.style.display=a;this.entity.style.visibility=b;return w},getHeight:function(){var a=this.entity.style.display;var b=this.entity.style.visibility;this.entity.style.visibility="hidden";this.entity.style.display="";h=this.entity.offsetHeight;this.entity.style.display=a;this.entity.style.visibility=b;return h},getX:function(){return parseInt(this.entity.style.left)},getY:function(){return parseInt(this.entity.style.top)},updateIfmSize:function(){if(this.ifm){var a=this;a.ifm.style.width=a.entity.offsetWidth+"px";a.ifm.style.height=a.entity.offsetHeight+"px"}},setFixed:function(a){var b=this.getProperty();b.isFixed=a;var c=this;if($IE6){c.entity.style.position="absolute";if(b.isFixed){c._ie6Fixed();Core.Events.addEvent(window,c._ie6Fixed,"scroll")}else{Core.Events.removeEvent(window,c._ie6Fixed,"scroll")}return}if(b.isFixed&&$FF2){c.updateFixed();return}this.entity.style.position=b.isFixed?"fixed":"absolute"},updateFixed:function(){var a=this.getProperty();if(a.isFixed&&$FF2){var b=this;var c=a.x,d=a.y;b.entity.style.position="absolute";b.setPosition({x:a.x+document.documentElement.scrollLeft,y:a.y+document.documentElement.scrollTop});b.entity.style.position="fixed";b.setPosition({x:c,y:d})}},show:function(){this.entity.style.display="";if(this.ifm){this.ifm.style.display="";this.updateIfmSize()}},hidden:function(){this.entity.style.display="none";if(this.ifm){this.ifm.style.display="none"}},addIframe:function(){this.ifm=$C("iframe");this.ifm.style.position="absolute";this.ifm.style.zIndex="1024";this.ifm.style.left=this.entity.style.left;this.ifm.style.top=this.entity.style.top;document.body.appendChild(this.ifm);Core.Dom.setStyle(this.ifm,"opacity",0)},getNodes:function(a){var b=this.getProperty();var c=a||"o";var d;var e={};var f=b.templateString;if(f){for(d=0;d<f.length;d++){var g=f[d];switch(c){case"o":e[g]=$E(b.uniqueID+"_"+g);break;case"i":e[g]=b.uniqueID+"_"+g;break}}}return"entity"in e?e:b.nodes},getUniqueID:function(){return parseInt(Math.random()*1e4).toString()+(new Date).getTime().toString()},setContent:function(a){var b=this.getProperty();if(a){b.nodes.content.innerHTML=a}}};(function(){function c(a){try{var b=a.constructor.toString().toLowerCase();return b.slice(b.indexOf("function")+9,b.indexOf("()"))}finally{b=null}}function d(a,b){var c,d,e=[];d=b.length;for(c=0;c<d;c++){e[e.length]=parseFloat(Core.Dom.getStyle(a,b[c]))}return e}function e(a){return c(a)!="array"?[a]:a}function f(a,b){try{var d=c(a);var e=[],f=[],h,i,j;if(d!="array"){j=g(a);j[1]=b=="opacity"?"":j[1];e=[j[0]];f=[j[1]]}else{i=a.length;for(h=0;h<i;h++){j=g(a[h]);j[1]=b[h]=="opacity"?"":j[1];e[e.length]=j[0];f[f.length]=j[1]}}return[e,f]}finally{d=e=f=h=i=j=null}}function g(a){try{var b=/(-?\d.?\d*)([a-z%]*)/i.exec(a);return[b[1],b[2]?b[2]:"px"]}finally{b=null}}function j(a){try{var c=b(a);var d;if(h[c]!=true){d=new k;i[c]={node:a,func:d};h[c]=true;return d}else{return i[c].func}}finally{c=d=null}}function k(){this._timer=null}function l(a,b,c,d,e,f){var g=j(a);g.start.apply(g,arguments)}var a={simple:function(a,b,c,d){return c*a/d+b},backEaseIn:function(a,b,c,d){var e=1.70158;return c*(a/=d)*a*((e+1)*a-e)+b},backEaseOut:function(a,b,c,d,e,f){var g=1.70158;return c*((a=a/d-1)*a*((g+1)*a+g)+1)+b},backEaseInOut:function(a,b,c,d,e,f){var g=1.70158;if((a/=d/2)<1){return c/2*a*a*(((g*=1.525)+1)*a-g)+b}return c/2*((a-=2)*a*(((g*=1.525)+1)*a+g)+2)+b},bounceEaseOut:function(a,b,c,d){if((a/=d)<1/2.75){return c*7.5625*a*a+b}else if(a<2/2.75){return c*(7.5625*(a-=1.5/2.75)*a+.75)+b}else if(a<2.5/2.75){return c*(7.5625*(a-=2.25/2.75)*a+.9375)+b}else{return c*(7.5625*(a-=2.625/2.75)*a+.984375)+b}},bounceEaseIn:function(b,c,d,e){return d-a.bounceEaseOut(e-b,0,d,e)+c},bounceEaseInOut:function(b,c,d,e){if(b<e/2){return a.bounceEaseIn(b*2,0,d,e)*.5+c}else{return a.bounceEaseOut(b*2-e,0,d,e)*.5+d*.5+c}},strongEaseInOut:function(a,b,c,d){return c*(a/=d)*a*a*a*a+b},regularEaseIn:function(a,b,c,d){return c*(a/=d)*a+b},regularEaseOut:function(a,b,c,d){return-c*(a/=d)*(a-2)+b},regularEaseInOut:function(a,b,c,d){if((a/=d/2)<1){return c/2*a*a+b}return-c/2*(--a*(a-2)-1)+b},strongEaseIn:function(a,b,c,d){return c*(a/=d)*a*a*a*a+b},strongEaseOut:function(a,b,c,d){return c*((a=a/d-1)*a*a*a*a+1)+b},strongEaseInOut:function(a,b,c,d){if((a/=d/2)<1){return c/2*a*a*a*a*a+b}return c/2*((a-=2)*a*a*a*a+2)+b},elasticEaseIn:function(a,b,c,d,e,f){if(a==0){return b}if((a/=d)==1){return b+c}if(!f){f=d*.3}if(!e||e<Math.abs(c)){e=c;var g=f/4}else{var g=f/(2*Math.PI)*Math.asin(c/e)}return-(e*Math.pow(2,10*(a-=1))*Math.sin((a*d-g)*2*Math.PI/f))+b},elasticEaseOut:function(a,b,c,d,e,f){if(a==0){return b}if((a/=d)==1){return b+c}if(!f){f=d*.3}if(!e||e<Math.abs(c)){e=c;var g=f/4}else{var g=f/(2*Math.PI)*Math.asin(c/e)}return e*Math.pow(2,-10*a)*Math.sin((a*d-g)*2*Math.PI/f)+c+b},elasticEaseInOut:function(a,b,c,d,e,f){if(a==0){return b}if((a/=d/2)==2){return b+c}if(!f){var f=d*.3*1.5}if(!e||e<Math.abs(c)){var e=c;var g=f/4}else{var g=f/(2*Math.PI)*Math.asin(c/e)}if(a<1){return-.5*e*Math.pow(2,10*(a-=1))*Math.sin((a*d-g)*2*Math.PI/f)+b}return e*Math.pow(2,-10*(a-=1))*Math.sin((a*d-g)*2*Math.PI/f)*.5+c+b}};var b=function(a){return a.uniqueID};if(!$IE){b=function(a){try{var b;if(a.getAttribute("uniqueID")==null){b="moz__id"+parseInt(Math.random()*100)+"_"+(new Date).getTime();a.setAttribute("uniqueID",b);return b}return a.getAttribute("uniqueID")}finally{b=null}}}var h={};var i={};k.prototype.start=function(b,c,g,h,i,j){this.reset();j=j||{};if(j.before){this._func.before=j.before}if(j.end){this._func.end=j.end}if(j.tween){this._func.tween=j.tween}var k=e(c);var l=d(b,k);var m=f(g,k);this._node=b;this._property=k;this._endingvalue=m[0];this._suffixvalue=m[1];this._startvalue=l;this._end=false;this._fps=0;if(h!=null){this._seconds=h}if(a[i]!=null){this._animation=a[i]}this._starttime=(new Date).getTime();this._func.before();this._timer=setInterval(Core.Function.bind3(this.play,this),10)};k.prototype.play=function(){var a=((new Date).getTime()-this._starttime)/1e3;var b,c,d=this._property.length;if(a>this._seconds){a=this._seconds}for(b=0;b<d;b++){c=this._animation(a,this._startvalue[b],this._endingvalue[b]-this._startvalue[b],this._seconds);Core.Dom.setStyle(this._node,this._property[b],c+this._suffixvalue[b])}this._fps++;this._func.tween();if(a==this._seconds){this.stop()}};k.prototype.stop=function(){clearInterval(this._timer);this._end=true;this._func.end()};k.prototype.reset=function(){clearInterval(this._timer);this._end=false;this._node=null;this._property=[];this._startvalue=[];this._endingvalue=[];this._suffixvalue=[];this._fps=0;this._seconds=.5;this._animation=a.simple;this._func={end:function(){},tween:function(){},before:function(){}}};l.stop=function(a){j(a).stop()};l.isTween=function(a){return!j(a)._end};Ui.tween=l})();var DialogDisplaySet={alpha1:{show:function(a,b,c){var d=0,e=0,f=parseInt(a.style.top)-b;a.style.top=f;Core.Dom.setStyle(a,"opacity",d);a.style.display="";var g=window.setInterval(function(){if(d<=1){Core.Dom.setStyle(a,"opacity",d)}if(e<=f+b){a.style.top=f+e+"px"}e+=1.5;d+=.05;if(d>.9&&parseInt(a.style.top)>=f+b){window.clearInterval(g);if(c){c()}}},10)},hidden:function(a,b,c){var d=1;var e=parseInt(a.style.top);var f=e-b;var g=e;var h=window.setInterval(function(){if(d>=0){Core.Dom.setStyle(a,"opacity",d)}if(g>=f){a.style.top=g+"px"}g-=1.5;d-=.05;if(d<=0&&g<f){window.clearInterval(h);if(c){c()}}},10)}},alpha:{show:function(a,b,c){Core.Dom.setStyle(a,"opacity",.3);a.style.display="";a.style.top=parseInt(a.style.top)-b+"px";var d=parseInt(a.style.top)+b;Ui.tween(a,["top","opacity"],[d,.9],.4,"simple",{end:c})},hidden:function(a,b,c){var d=parseInt(a.style.top)-b;Ui.tween(a,["top","opacity"],[d,0],.2,"simple",{end:c})}},fallDown:{show:function(a,b,c,d){a.style.display="";a.style.top=b+"px";Ui.tween(a,"top",c,.6,"bounceEaseOut",{end:d})},hidden:function(a,b,c,d){a.style.display="";a.style.top=b+"px";Ui.tween(a,"top",c,.6,"strongEaseIn",{end:d})}}};Core.Events.fixEvent=function(a){if(typeof a=="undefined")a=window.event;if(!a.target){a.target=a.srcElement;a.pageX=a.x;a.pageY=a.y}if(typeof a.layerX=="undefined")a.layerX=a.offsetX;if(typeof a.layerY=="undefined")a.layerY=a.offsetY;return a};var Drag3=function(a,b,c){var d=this;this.beDragObj=a;this.movedObjs=b||this.beDragObj;this.dragMode=c||"normal";this.canDrag=true;this.isLock=false;this.lockArea={left:0,right:0,top:0,bottom:0};this.dragSet={normal:function(){d.normalDrag()},border:function(){d.borderDrag()},opacity:function(){d.opacityDrag()}};this.dragObjsFunc=function(){d.onDrag();d.dragObjs()};(function(){d.beDragObj.style.MozUserSelect="none";Core.Events.addEvent(d.beDragObj,function(){return false},"selectstart");Core.Events.addEvent(d.beDragObj,function(){return false},"drag");for(var b=0;b<d.movedObjs.length;b++){if(d.movedObjs[b]!=d.beDragObj){d.movedObjs[b].style.position="absolute";if(!d.movedObjs[b].style.left){d.movedObjs[b].style.left=d.movedObjs[b].offsetLeft+"px"}if(!d.movedObjs[b].style.top){d.movedObjs[b].style.top=d.movedObjs[b].offsetTop+"px"}}}Core.Events.addEvent(d.beDragObj,d.dragSet[d.dragMode],"mousedown");if($IE){Core.Events.addEvent(d.beDragObj,function(){Core.Events.removeEvent(d.beDragObj,d.dragObjsFunc,"mousemove");d.beDragObj.releaseCapture();d.onDragEnd()},"mouseup")}else{Core.Events.addEvent(document,function(){Core.Events.removeEvent(document,d.dragObjsFunc,"mousemove");d.onDragEnd()},"mouseup")}})()};Drag3.prototype={capture:function(){this.canDrag=true},release:function(){this.canDrag=false},onDragStart:function(){},onDrag:function(){},onDragEnd:function(){},dragObjs:function(){e=Core.Events.getEvent();for(var a=0;a<this.movedObjs.length;a++){if(this.isLock){if(e.clientX-this.movedObjs[a].deltaX<this.lockArea.left){this.movedObjs[a].style.left=this.lockArea.left+"px"}else{if(e.clientX-this.movedObjs[a].deltaX>this.lockArea.right-this.movedObjs[a].offsetWidth){this.movedObjs[a].style.left=this.lockArea.right-this.movedObjs[a].offsetWidth+"px"}else{this.movedObjs[a].style.left=e.clientX-this.movedObjs[a].deltaX+"px"}}if(e.clientY-this.movedObjs[a].deltaY<this.lockArea.top){this.movedObjs[a].style.top=this.lockArea.top+"px"}else{if(e.clientY-this.movedObjs[a].deltaY>this.lockArea.bottom-this.movedObjs[a].offsetHeight){this.movedObjs[a].style.top=this.lockArea.bottom-this.movedObjs[a].offsetHeight+"px"}else{this.movedObjs[a].style.top=e.clientY-this.movedObjs[a].deltaY+"px"}}}else{this.movedObjs[a].style.left=e.clientX-this.movedObjs[a].deltaX+"px";this.movedObjs[a].style.top=e.clientY-this.movedObjs[a].deltaY+"px"}}},normalDrag:function(){var a=this;e=Core.Events.getEvent();for(var b=0;b<a.movedObjs.length;b++){a.movedObjs[b].deltaX=e.clientX-parseInt(a.movedObjs[b].style.left);a.movedObjs[b].deltaY=e.clientY-parseInt(a.movedObjs[b].style.top)}if(a.canDrag){if($IE){a.beDragObj.setCapture();Core.Events.addEvent(a.beDragObj,a.dragObjsFunc,"mousemove")}else{Core.Events.addEvent(document,a.dragObjsFunc,"mousemove")}}a.onDragStart()},borderDrag:function(a,b){},opacityDrag:function(a,b){}};Ui.Drag3=Drag3;var Dialog=function(a){var b=this;b.entity=null;b.ifm=null;var c={id:"",x:0,y:0,width:0,height:0,isFixed:false,layer:new Layer(a),template:a,canDrag:false,dragEntity:null,name:"",uniqueID:"",isShow:false,nodes:{},focusNode:null,displayMode:"normal",_modeDisplayRuning:false,enabled:true};this.getProperty=function(){return c};(function(){var c=b.getProperty();var d;c.uniqueID=c.layer.getProperty().uniqueID;c.id=c.uniqueID+"_dialog";c.nodes=b.getNodes();b.entity=c.layer.entity;b.ifm=c.layer.ifm;c.width=parseInt(b.entity.style.width);if(c.nodes.titleBar){c.dragEntity=new Ui.Drag3(c.nodes.titleBar,b.ifm?[b.ifm,b.entity]:[b.entity]);c.nodes.titleBar.style.cursor="move";Core.Events.addEvent(c.nodes.titleBar,function(){return false},"selectstart");c.dragEntity.onDrag=function(){b.onDrag()}}Core.Events.addEvent(window,function(){if(c.isShow&&c.isFixed){var a=Core.System.winSize();var d=a.width/2-b.getWidth()/2;var e=a.height/2-b.getHeight()/2;d=d<0?0:d;e=e<0?0:e;b.setPosition({x:d,y:e})}},"resize")})()};Dialog.prototype={setPosition:function(a){var b=this.getProperty();Core.System.parseParam(b,a);this.getProperty().layer.setPosition(a)},setSize:function(a){var b=this.getProperty();Core.System.parseParam(b,a);b.layer.setSize(a)},setFixed:function(a){var b=this.getProperty();b.isFixed=a;this.getProperty().layer.setFixed(b.isFixed)},setContent:function(a){var b=this.getProperty();this.getProperty().layer.setContent(a)},setTemplate:function(a){var b=this.getProperty();b.template=a;b.layer.setTemplate(b.template)},setDrag:function(a){var b=this.getProperty();b.canDrag=a;if(b.canDrag){b.dragEntity.capture()}else{b.dragEntity.release()}},getWidth:function(){return this.getProperty().layer.getWidth()},getHeight:function(){return this.getProperty().layer.getHeight()},getX:function(){return this.getProperty().layer.getX()},getY:function(){return this.getProperty().layer.getY()},show:function(a){var b=this.getProperty();var c=this;b.isShow=true;if(this.ifm){this.ifm.style.display=""}this.onShow();if(b.displayMode=="normal"||a=="normal"){this.entity.style.display=""}else{b._modeDisplayRuning=true;b.enabled=false;this._showWithMode(function(){b._modeDisplayRuning=false;b.enabled=true;if(c.onDisplaied){c.onDisplaied()}})}},close:function(a){var b=this;var c=this.getProperty();if(c.displayMode=="normal"||a=="normal"){c.isShow=false;c.layer.hidden();this.destroy();this.onClose();if(b.onDisplayFinished){b.onDisplayFinished()}}else if(!c._modeDisplayRuning){c._modeDisplayRuning=true;c.enabled=false;this._hiddenWithMode(function(){c.isShow=false;c.layer.hidden();c._modeDisplayRuning=false;c.enabled=true;b.destroy();b.onClose();if(b.onDisplayFinished){b.onDisplayFinished()}})}},hidden:function(a){var b=this;var c=this.getProperty();if(c.displayMode=="normal"||a=="normal"){c.isShow=false;c.layer.hidden();this.onHidden();if(b.onDisplayFinished){b.onDisplayFinished()}}else if(!c._modeDisplayRuning){c._modeDisplayRuning=true;c.enabled=false;this._hiddenWithMode(function(){c.isShow=false;c.layer.hidden();b.onHidden();c._modeDisplayRuning=false;c.enabled=true;if(b.onDisplayFinished){b.onDisplayFinished()}})}},_showWithMode:function(a){var b=this.getProperty();var c=Core.System.winSize();var d=this;switch(b.displayMode){case"alpha":DialogDisplaySet["alpha"].show(this.entity,20,a);break}},_hiddenWithMode:function(a){var b=this.getProperty();var c=this;var d=Core.System.winSize();switch(b.displayMode){case"alpha":DialogDisplaySet["alpha"].hidden(this.entity,20,a);break}},destroy:function(){try{if(this.getProperty().nodes.iframe){this.getProperty().nodes.iframe.src=""}}catch(a){}this.entity&&this.entity.parentNode.removeChild(this.entity);this.entity=null;if(this.ifm){this.ifm.parentNode.removeChild(this.ifm);this.ifm=null}},onShow:function(){},onClose:function(){},onHidden:function(){},onDrag:function(){},onDisplaied:function(){},onDisplayFinished:function(){},setAreaLocked:function(a){var b=this.getProperty();b.dragEntity.isLock=a;var c=this;if(a){c._updateLockArea();Core.Events.addEvent(window,function(){c._updateLockArea()},"resize")}},_updateLockArea:function(){var a=this.getProperty();var b=Core.System.winSize();if(a.isFixed){if($IE6){a.dragEntity.lockArea={left:document.documentElement.scrollLeft,right:document.documentElement.scrollLeft+b.width,top:document.documentElement.scrollTop,bottom:document.documentElement.scrollTop+b.height};Core.Events.addEvent(window,function(){a.dragEntity.lockArea={left:document.documentElement.scrollLeft,right:document.documentElement.scrollLeft+b.width,top:document.documentElement.scrollTop,bottom:document.documentElement.scrollTop+b.height}},"scroll");Core.Events.addEvent(window,function(){a.dragEntity.lockArea={left:document.documentElement.scrollLeft,right:document.documentElement.scrollLeft+b.width,top:document.documentElement.scrollTop,bottom:document.documentElement.scrollTop+b.height}},"resize")}else{a.dragEntity.lockArea={left:0,right:b.width,top:0,bottom:b.height}}}else{a.dragEntity.lockArea={left:0,right:document.documentElement.scrollWidth,top:0,bottom:document.documentElement.scrollHeight}}},updateFixed:function(){this.getProperty().layer.updateFixed()},getNodes:function(a){return this.getProperty().layer.getNodes(a)},setFocus:function(){var a=this.getProperty();if(a.focusNode&&a.focusNode.style.display!="none"){try{a.focusNode.focus()}catch(b){}}else if(this.entity.style.display!="none"){this.entity.focus()}},getUniqueID:function(){return this.getProperty().layer.getUniqueID()}};Core.String.byteLength=function(a){if(typeof a=="undefined"){return 0}var b=a.match(/[^\x00-\x80]/g);return a.length+(!b?0:b.length)};Lib.register("util.LS",function(a){var b=function(a,b){if(a.localStorage){return a.localStorage}else if(a.sessionStorage){return a.sessionStorage}else if(a.globalStorage){return a.globalStorage}return function(){var a={},b="data-userdata",c=document,d=c.body,e=function(a,c,e,f){d.load(b);e=d.getAttribute(b)||"";f=RegExp("\\b"+a+"\\b,?","i");var g=f.test(e)?1:0;e=c?e.replace(f,""):g?e:e===""?a:e.split(",").concat(a).join(",");d.setAttribute(b,e);d.save(b)};d.addBehavior("#default#userData");a.getItem=function(a){d.load(a);return d.getAttribute(a)};a.setItem=function(a,b){d.setAttribute(a,b);d.save(a);e(a)};a.removeItem=function(a){d.removeAttribute(a);d.save(a);e(a,1)};a.clear=function(){d.load(b);var a=d.getAttribute(b).split(","),c=a.length;if(a[0]==="")return;for(var e=0;e<c;e++){d.removeAttribute(a[e]);d.save(a[e])}d.setAttribute(b,"");d.save(b)};return a}()}(window);return b});$SYSMSG.extend({A00001:"系统繁忙，请稍候再试。",A00007:"未登录。",A00004:"系统繁忙，请稍候再试。",A00112:"博客名称超长。",A00113:"您已开通博客，请点击<a href='http://control.blog.sina.com.cn/blogprofile/index.php'>个人中心</a>进入。",A00116:"不能包含 sina 等有特殊含义的字符。",A11003:"此账户已完成博客快速设置，点击确定，直接进入博客。",A44001:"博客个性地址不能为空。",A44002:"地址格式不对。",A44003:"抱歉，此地址已被占用。",A44005:"抱歉，请按照正确格式填写博客地址。"});(function(){function c(){var a=$nick;var b=Core.String.byteLength(a);while(b>18){a=a.substring(0,a.length-1);b=Core.String.byteLength(a)}return a+"的博客"}function d(a,b,c,d){a.onfocus=function(){a.className="ipt focus";h(c,"");d.style.display=""};a.onblur=function(){a.className="ipt";i(a,b,d);h(c,"none")};a.onkeyup=function(){i(a,b,d)}}function e(b){if(e.requestComplete===false){return}if(b.nameErrorEle.innerHTML){f(b.nameErrorEle.parentNode);setTimeout(function(){f(b.nameErrorEle.parentNode)},442);return}e.requestComplete=false;var c=b.from==="floatingLayer"?"openBlogOkBtn_t":"openBlogOkBtn";$E(c).className="loading";var d={loginName:g(),blogName:b.openName};(new Interface(a,"jsload")).request({GET:{uid:$UID,loginname:d.loginName,blogname:d.blogName,version:7,src:"layer",isprivate:b.isprivate},onSuccess:function(a){e.requestComplete=true;$E(c).className="btn";b.okCallback(a,d);d=null},onError:function(a){var d=$E("blogNameError"),f=$E("blogNameIcon"),g=$E("blogNameError_t"),h=$E("blogNameIcon_t");switch(a.code){case"A11008":if(d&&f){j(d,"输入内容有误，请修改",f)}if(g&&h){j(g,"输入内容有误，请修改",h)}break;case"A11010":if(d&&f){j(d,"输入内容有误，请修改",f)}if(g&&h){j(g,"输入内容有误，请修改",h)}break;default:j(b.errorEle,"系统繁忙，请稍后再试。");break}e.requestComplete=true;$E(c).className="btn"}})}function f(a){for(var b=1;b<=55;b++){(function(b){setTimeout(function(){a.style.backgroundColor="rgb(255, "+ +(200+b)+", "+(200+b)+")"},b*8)})(b)}}function g(){var a=decodeURIComponent(Utils.Cookie.getCookie("SUP"));a=a.split("&name=")[1];a=decodeURIComponent(a.split("&")[0]);return a}function h(a,b){for(var c=0;a[c];c++){a[c].style.display=b}}function i(a,b,c){var d=a.value;if(/^(?:\s|[　])+|(?:\s|[　])+$/.test(d)){a.value=Core.String.trim(d);d=a.value}if(d){var e=Core.String.byteLength(d);if(e>24){j(b,"博客名称超长",c)}else{k(b,c)}}else{j(b,"博客名称不能为空",c)}}function j(a,b,c){a.innerHTML=b;a.style.display="block";if(a.id.indexOf("ErrTips")>=0){a.style.visibility="visible"}if(c){c.className="SG_icon SG_icon48 tips"}}function k(a,b){a.innerHTML="";a.style.display="none";if(b){b.className="SG_icon SG_icon49 tips"}}if(scope.blogOpener){scope.addBlogOpenerEvent=function(){};return}var a="http://control.blog.sina.com.cn/riaapi/reg/open_blog.php";var b=function(){this._hasInit=false};b.prototype={getCon:function(){return['<div class="CP_layercon8">'+'<div class="nowOpenBlog">'+"<strong>您的博客尚未开通,仅一步操作就能开通您的个人博客</strong>"+'<div class="boxA">'+"<label>博客名称：</label>"+'<input id="blogNameInput_t" type="text" class="ipt" />'+'<img style="display:none" id="blogNameIcon_t" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" class="SG_icon SG_icon49 tips">'+'<p id="blogNameError_t" class="tip">名称不能为空</p>'+"</div>"+'<div  class="boxA"> '+"<p>隐私设置："+'<input type="radio" name="isPrivate_t" checked id="openAll1_t" class="rd" /><label for="openAll1_t">对所有人开放</label>'+'<input type="radio" name="isPrivate_t" id="openMe1_t" class="rd" /><label for="openMe1_t">仅对自己开放，私密博客</label>'+"</p>"+"</div>"+'<div id="ErrTips_t" class="ErrTips">系统繁忙，请稍后再试</div>'+'<div class="boxB">'+'<p><a id="openBlogOkBtn_t" class="btn" href="javascript:void(0)">完成开通</a><a id="openBlogCancel" href="javascript:void(0)">取消</a></p>'+"</div>"+"</div>"+"</div>"].join("")},_initDialog:function(){Lib.checkAuthor();this.key=g();this._dialog=winDialog.createCustomsDialog({content:this.getCon()},"openblog");this.bindEvent();d($E("blogNameInput_t"),$E("blogNameError_t"),[],$E("blogNameIcon_t"))},showDialog:function(a,b,c){b=b||false;if(!this._hasInit){this._initDialog();this._hasInit=true}var d=this;scope.whenOpenBlogCallback=a;if(!scope.hasOpenBlog){trace("这是一位后登陆的用户");var e=0;var f=setInterval(function(){trace("呀，怎么还没有出结果啊--"+e);if(scope.hasOpenBlog){clearInterval(f);if(scope.hasOpenBlog=="open"){trace("并且他开通的博客");if(scope.whenOpenBlogCallback){scope.whenOpenBlogCallback()}}else{trace("他们没有开通博客");d._showDialog(b)}}e++;if(e==10){Lib.checkAuthor();trace("等不及了，自己发吧。。。");clearInterval(f);(new Interface("http://control.blog.sina.com.cn/riaapi/profile/unread.php","jsload")).request({GET:{uid:$UID,product:"blog"},onSuccess:function(a){scope.hasOpenBlog=a.isbloguser==1?"open":"no";trace("~~~~~~~~~~~~~~~~~~~"+scope.hasOpenBlog);if(scope.hasOpenBlog=="open"){trace("并且他开通的博客");if(scope.whenOpenBlogCallback){scope.whenOpenBlogCallback()}}else{if(!$E("openblogcss")){Utils.Io.loadCss({id:"openblogcss",url:$_GLOBAL.cssBasicURL+"module/layer/re_nowopen.css"})}trace("他们没有开通博客");d._showDialog(b)}}})}},10)}else{trace("这是已登陆的用户");if(scope.hasOpenBlog=="open"){trace("并且他开通的博客");if(scope.whenOpenBlogCallback){scope.whenOpenBlogCallback()}}else{if(!$E("openblogcss")){Utils.Io.loadCss({id:"openblogcss",url:$_GLOBAL.cssBasicURL+"module/layer/re_nowopen.css"})}trace("他们没有开通博客");this._showDialog(b)}}if(c){$E("openBlogCancel").style.display="none";this._dialog.getNodes().btnClose.style.display="none"}},_showDialog:function(a){$E("blogNameInput_t").value=c();k($E("blogNameError_t"),$E("blogNameIcon_t"));$E("ErrTips_t").style.visibility="hidden";$E("blogNameIcon_t").style.display="none";this._dialog.show();this._dialog.setAreaLocked(true);this._dialog.setMiddle()},bindEvent:function(){var a=this;Core.Events.addEvent($E("openBlogCancel"),function(){a.closeDialog();return false});Core.Events.addEvent($E("openBlogOkBtn_t"),function(){e({nameErrorEle:$E("blogNameError_t"),nameOkIcon:$E("blogNameIcon_t"),openName:$E("blogNameInput_t").value||c(),isprivate:$E("openAll1_t").checked?0:1,errorEle:$E("ErrTips_t"),from:"floatingLayer",okCallback:function(b,c){if(scope.whenOpenBlogCallback){scope.whenOpenBlogCallback(b,c)}if($E("openedBlogTray")&&$E("openedBlogTray").style.display=="none"){$E("outOfOpenBlogTray").style.display="none";$E("noOpenedBlogTray").style.display="none";$E("openedBlogTray").style.display=""}if($E("noOpendBlogSearchTip")&&$E("noOpendBlogSearchTip").style.display=="block"){$E("noOpendBlogSearchTip").style.display="none";$E("opendBlogSearchTip").style.display="block"}scope.hasOpenBlog="open";a.closeDialog();scope.whenOpenBlogCallback=function(){}}});return false})},closeDialog:function(){var a=this;this._dialog.hidden()}};scope.openBlogGetShotName=c;scope.openBlogNameEvent=d;scope.openBlogWhenOpenBlog=e;scope.blogOpener=new b;scope.addBlogOpenerEvent=function(a){Core.Events.addEvent(a,function(a){scope.blogOpener.showDialog(function(a,b){Lib.LocalDB.clearCache(1,"uid_"+$UID+"unread");Lib.util.LS.removeItem("uid"+$UID);if(scope.$pageid=="fakeIndex"){window.location.href="http://i.blog.sina.com.cn/blogprofile/index.php?atten=1";return}if($E("openedBlogTray")){$E("openedBlogTray").style.display="";$E("noOpenedBlogTray").style.display="none";$E("outOfOpenBlogTray").style.display="none";if(b){$E("loginBarAppMenuLabel").innerHTML=b.loginNick}}else{var c=window;c.$tray&&c.$tray.renderLogin()}var d=function(){if(scope.___importV){scope.___importV();scope.___openBlogFlag=1}};var e={subText:!scope.___importV?['<div class="CP_w_cnt SG_txtb">欢迎您在新浪博客安家！除了写博客，看博客外，您还可以进入个人中心完善您的个人资料，更有很多有趣的应用等着您哦。</div>','<ul class="CP_w_part CP_w_aLine">','<li><a href="http://control.blog.sina.com.cn/blogprofile/index.php" onclick="winDialog.getDialog(\'unregister\').hidden();" target="_blank">到博客个人中心&gt;&gt;</a></li>',"</ul>"].join(""):"",icon:"03",funcOk:d,funcClose:d,width:300};winDialog.alert("开通博客成功",e,"unregister");var f=$E("commentNick");if(f){var g=f.firstChild;while(g){f.removeChild(g);g=f.firstChild}f.innerHTML=b.loginNick+":"}},true)},"click")}})();(function(){var a=function(a,b,c){Lib.checkAuthor();var d=new Interface("http://control.blog.sina.com.cn/riaapi/profile/attention_add.php","ijax");d.request({POST:{uid:a||$UID,aid:b||scope.$uid},onSuccess:function(){},onError:function(a){var b="";switch(a.code){case"A11007":b=$SYSMSG["A11007"].replace("#{linkNewBlog}","http://login.sina.com.cn/hd/reg_sec.php?entry=blog");winDialog.alert(b,{funcOk:function(){window.open("http://login.sina.com.cn/hd/reg_sec.php?entry=blog","_blank","")}});break;case"A33003":b=$SYSMSG.A33003.replace("#{UID}",$UID);winDialog.alert(b);break;case"A33004":var d={subText:['<div class="CP_w_cnt SG_txtb">以后对方的动态（发博文，图片，投票等），都可以在<span style="color:red">个人中心</span>查看啦！</div>','<ul class="CP_w_part CP_w_aLine">','<li><a href="http://control.blog.sina.com.cn/blogprofile/index.php?type=3&from=attention" onclick="winDialog.getDialog(\'attention\').hidden();" target="_blank">到个人中心查看关注动态&gt;&gt;</a></li>',"</ul>"].join(""),icon:"03",width:300};try{var e=$E("module_901_attention");e.className="SG_aBtn SG_aBtn_dis";e.innerHTML="<cite onclick=\"Lib.Component.isAttentioned('"+$UID+"', '"+scope.$uid+"');\">已关注</cite>"}catch(f){}b=$SYSMSG["A33004"];d["subText"]=d["subText"].replace(/#{UID}/g,$UID);winDialog.alert(b,d,"attention");break;default:showError(a.code)}c(a.code)},onFail:function(){showError($SYSMSG.A00001)}})};Lib.Component.Attention=function(b,c,d){Lib.checkAuthor();var e=this;d=d||function(){};if(!$isLogin){var f=new Lib.Login.Ui;f.login(function(){scope.blogOpener.showDialog(function(){Core.Function.bind3(a,null,[b,c,d])()})},false,"referer:"+location.hostname+location.pathname+",func:0004")}else{scope.blogOpener.showDialog(function(){a(b,c,d)})}};Lib.Component.deleteAttention=function(a,b){winDialog.getDialog("attention").close();winDialog.confirm("是否要取消关注？",{funcOk:function(){(new Interface("http://control.blog.sina.com.cn/riaapi/profile/attention_del.php","jsload")).request({GET:{uid:$UID,aid:scope.$uid},onSuccess:function(){var a=$E("module_901_attention");a.className="SG_aBtn";a.innerHTML="<cite onclick=\"Lib.Component.Attention('"+$UID+"', '"+scope.$uid+"');\">加关注</cite>"},onError:function(){winDialog.alert("取消失败！请重试。")},onFail:function(){winDialog.alert("取消失败！请重试。")}})},funcCancel:function(){Lib.Component.isAttentioned()},textOk:"是",textCancel:"否"})};Lib.Component.isAttentioned=function(){winDialog.alert("已关注此人！",{subText:['<ul class="CP_w_part CP_w_aLine">','<li><a href="http://control.blog.sina.com.cn/blogprofile/index.php?type=3&from=attention2" onclick="winDialog.getDialog(\'attention\').close();" target="_blank">到个人中心查看关注动态&gt;&gt;</a></li>',"</ul>"].join(""),icon:"03"},"attention")}})();$SetPV=function(a){a=window.parseInt(a);Lib.checkAuthor();if($isAdmin){$E("comp_901_pv").innerHTML='<strong><a title="您的访问统计" href="http://i.blog.sina.com.cn/blogprofile/profilevisitanaly.php" target="_blank">'+Core.String.formatNumber(a)+"</a></strong>"}else{$E("comp_901_pv").innerHTML="<strong>"+Core.String.formatNumber(a)+"</strong>"}var b=0;var c=[0,50,100,150,200,300,500,800,1500,3e3,5e3,1e4,15e3,25e3,4e4,7e4,1e5,15e4,2e5,5e5,1e6,2e6,5e6,1e7,2e7,5e7,1e8,15e7,2e8,25e7,3e8,35e7,4e8,45e7,5e8,55e7];if(a>=5e7){b=Math.floor(a/5e7)+24}else{b=-1;c=c.join(",").replace(/(\d+)/g,function(c,d){if(window.parseInt(d)<=a){b++}})}if(scope.$pageid==="article"||scope.$pageid==="articleM"||scope.$pageid==="articletj"){scope.$rank=b}b=b.toString().replace(/(\d)/g,function(a,b){return'<img src="http://simg.sinajs.cn/blog7style/images/common/number/'+b+'.gif"/>'});$E("comp_901_grade").innerHTML=b};Sina.pkg("Utils.Form");Core.String.leftB=function(a,b){var c=a.replace(/\*/g," ").replace(/[^\x00-\xff]/g,"**");a=a.slice(0,c.slice(0,b).replace(/\*\*/g," ").replace(/\*/g,"").length);if(Core.String.byteLength(a)>b)a=a.slice(0,a.length-1);return a};Utils.Form.limitMaxLen=function(a,b){var c;var d=function(){c=a.value;var d=Core.String.byteLength(c);if(d>b){a.value=Core.String.leftB(c,b)}};Core.Events.addEvent(a,Core.Function.bind3(d,a),"keyup");Core.Events.addEvent(a,Core.Function.bind3(d,a),"blur");Core.Events.addEvent(a,Core.Function.bind3(d,a),"focus")};Lib.invite_tpl=['<table id="#{entity}" class="CP_w">','<thead id="#{titleBar}">',"<tr>",'<th class="tLeft"><span></span></th>','<th class="tMid">','<div class="bLyTop">','<strong id="#{titleName}">提示标题</strong>','<cite><a id="#{btnClose}" href="javascript:void(0)" class="CP_w_shut" title="关闭">关闭</a></cite>',"</div>","</th>",'<th class="tRight"><span></span></th>',"</tr>","</thead>","<tfoot>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid"><span></span></td>','<td class="tRight"><span></span></td>',"</tr>","</tfoot>","<tbody>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid" id="#{content}">',"</td>",'<td class="tRight"><span></span></td>',"</tr>","</tbody>","</table>"].join("");$SYSMSG.extend({A00001:"系统繁忙，请稍候再试。",A00007:"请先登录。",A20101:"内容超长。",A20102:"请输入正确的登录名或密码。",A20103:"请输入正确的验证码。",A20104:"请把对方在黑名单中解除，再加为好友。",A20105:"你的好友数量达到上限，不能添加新好友。",A20106:"博主已设置为拒绝接受好友邀请，请不要打扰哦。",A20107:"不能加自己为好友。",A20108:"你们已经是好友。",A20109:"不能包含sina等特殊含义字符。",A23002:"您已被对方加入黑名单。",A20121:"参数格式不正确。",A20000:"参数格式不正确。",A20001:"内容超长。",A20002:"请输入正确的登录名或密码。",A20003:"请输入正确的验证码。",A20004:"不能包含sina等特殊含义字符。",A20005:"纸条内容不能为空。",A20006:"不能自己给自己发纸条",A20007:"请把对方在黑名单中解除，再发送纸条。",A20020:"给#{nick}的纸条发送失败！",A20008:"对不起，您短时间发表的纸条过多，请多休息会，注意身体！感谢您对新浪博客的支持和关注!",A20999:"对不起，您短时间发送的好友请求过多，请多休息会，注意身体！感谢您对新浪博客的支持和关注!",A20009:"博主已设置为拒绝接收所有纸条，请不要打扰哦。",A20013:"您已经发送多条相似内容了哦，请先休息一下吧~",A20014:"已经有很多博主发过相似评论了，换个内容会更精彩~",A20015:"发生错误，请稍作休息~",A30006:"该博主只接收来自好友的纸条，您还不是Ta的好友哦。",A10006:"对不起，您已被博主列入黑名单，无法发送小纸条。"});Lib.register("blogv.getVHTML",function(){return function(a,b){var c,d;if(isNaN(a)){a=-1}else{a=parseInt(a,10)}if(0==a){c="新浪个人认证";d=" SG_icon146"}else if(0<a&&8>a){c="新浪机构认证";d=" SG_icon147"}var e;if(!1!==b){b=!0}if(c){e='<img class="SG_icon '+d+'" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" title="'+c+'" alt="'+c+'" align="absmiddle" />'}else{e=""}if(e&&b){e='<a target="_blank" href="http://blog.sina.com.cn/v/verify">'+e+"</a>"}return e}});Lib.Invite_Base=Core.Class.create();Lib.Invite_Base.prototype={html:['<div class="CP_layercon2 addFriendItem">','<div class="toWho">#{head_image}<span>#{nickname}</span></div>','<div class="formTowho">','<div class="row1" style="display:#{login};">登录名：','<input id="invite_loginname" type="text" class="fm1" style="width:80px;"/>&nbsp;&nbsp;&nbsp;','密码：<input id="invite_password" type="password" class="fm1" style="width:73px;" maxlength="16"/>','&nbsp;&nbsp;<a target="_blank" href="http://login.sina.com.cn/getpass.html">找回密码</a><em class="SG_txtc">','|</em><a target="_blank" href="http://login.sina.com.cn/signup/signupmail.php?entry=blog&srcuid='+scope.$uid+'&src=blogicp">注册</a>','<input id="saveOnline_invite" type="checkbox" checked value="" style="display:inline-block;margin-top:3px;"/><label for="saveOnline_invite" style="margin-top:10px; display:inline-block;">记住登录状态</label>','<span id="saveCaution_invite" style="color:#999; margin-left:10px; display:none;">建议在网吧/公用电脑上取消该选项</span>','</div><p id="invite_user_error" class="ErrTips" style="display:none;">请输入正确的登录名或密码</p>','<div class="row2"><textarea id="invite_content"></textarea></div>','<div class="row1"><span id="invite_limit" class="SG_floatR SG_txtc">您还可以输入#{content_length}个汉字</span>','验证码：<input type="text" id="invite_checkcode" maxlength="4"',' style="width:60px" class="fm1" name="input"/>&nbsp;','<img height="16" width="51" id="invite_checkimage" src="#{checkImage}" align="absmiddle" />&nbsp;','<a id="invite_checklink" href="#" onclick="return false;">换一下</a>','<p id="invite_code_error" class="ErrTips" style="display:none;"></p></div>','<div class="btn">','<a id="invite_submit" class="SG_aBtn SG_aBtnB" href="#" onclick="return false;"><cite>',"#{dialogTitle}</cite></a>&nbsp;&nbsp;",'<a id="invite_cancel" class="SG_aBtn SG_aBtnB" href="#" onclick="return false;"><cite>取消</cite></a>',"</div>","</div>","</div>"].join(""),dialogName:"invite",initialize:function(a,b){this.uid=a;this.onlineTime=b||15;Lib.checkAuthor();if(!this.isAllowSend()){return}var c={head_image:this.headImage!=null?this.headImage:'<img src="'+("http://portrait"+(this.uid%8+1)+".sinaimg.cn/"+this.uid+"/blog/50")+'" align="absmiddle" alt="'+scope.owenerNickName+'" title="'+scope.owenerNickName+'" />',nickname:this.title(),login:$isLogin?"none":"",checkImage:"http://interface.blog.sina.com.cn/riaapi/checkwd_image.php?"+Math.random(),content_length:this.contentLength/2,dialogTitle:this.dialogTitle};var d=(new Ui.Template(this.html)).evaluate(c);if(this.dialog==null){window.$inviteDialog=this.dialog=winDialog.createCustomsDialog({content:"",title:this.dialogTitle,tpl:Lib.invite_tpl});this.dialog.addEventListener("hidden",function(){this.destroy()})}else{}this.dialog.setContent(d);this.dialog.setMiddle();this.dialog.show();this.dialog.setAreaLocked(true);Utils.Form.limitMaxLen($E("invite_content"),this.contentLength);Core.Events.addEvent("invite_submit",Core.Function.bind2(this.checkData,this));Core.Events.addEvent("invite_cancel",Core.Function.bind2(this.closeDailog,this));var e=function(){$E("invite_checkimage").src="http://interface.blog.sina.com.cn/riaapi/checkwd_image.php?"+Math.random()};Core.Events.addEvent("invite_checkimage",e);Core.Events.addEvent("invite_checklink",e);Core.Events.addEvent("invite_content",Core.Function.bind2(function(){clearInterval(this.check);this.check=setInterval(Core.Function.bind2(function(){var a=Core.String.byteLength($E("invite_content").value);var b=Math.max(0,Math.floor((this.contentLength-a)/2));$E("invite_limit").innerHTML="您还可以输入"+b+"个汉字"},this),500)},this),"focus");Core.Events.addEvent("invite_content",Core.Function.bind2(function(){clearInterval(this.check);this.check=null},this),"blur");this.initSaveCaution();this.reloadName()},isAllowSend:function(){return true},initSaveCaution:function(){function d(){if(a.checked){b.style.display="inline-block"}else{b.style.display="none"}if(c){var d="http://control.blog.sina.com.cn/blog_rebuild/riaapi/padblog/padInfo.php?ck_login=A00002&rnd="+Math.random();Utils.Io.JsLoad.request(d,{onComplete:function(){},onException:function(){}});c=null}}var a=$E("saveOnline_invite");var b=$E("saveCaution_invite");if(!$isLogin){a[$IE?"onclick":"onchange"]=d}var c=1},reloadName:function(){var a=Lib.Login.info();var b=a.ln;if(b){$E("invite_loginname").value=b}},checkData:function(){if(!$isLogin){this.username=Core.String.trim($E("invite_loginname").value);this.password=Core.String.trim($E("invite_password").value);if(this.username==""||this.password==""){$E("invite_user_error").style.display="";return}else{$E("invite_user_error").style.display="none"}}this.checkcode=Core.String.trim($E("invite_checkcode").value);if(this.checkcode==""||this.checkcode.length<4){$E("invite_code_error").innerHTML="请输入正确的验证码";$E("invite_code_error").style.display="";return}else{$E("invite_code_error").style.display="none"}if(!$isLogin){if($E("saveOnline_invite").checked){v7sendLog("48_01_39_1")}else{v7sendLog("48_01_39_0")}this.login()}else{var a=this;scope.blogOpener.showDialog(function(){a.postContent()})}},login:function(){this.request=new Lib.Login.LoginPost(Core.Function.bind2(function(a){if(a.result){if(this.postContent){Lib.checkAuthor();$tray.renderLogin();var b=this;scope.blogOpener.showDialog(function(){b.postContent()})}}else{trace("登陆失败 ："+a.reason);$E("invite_user_error").style.display=""}},this),false,"referer:"+location.hostname+location.pathname+",func:000"+(/messagesend/.test(this.Interface.url.url)?"2":"3"));this.request.login(this.username,this.password,$E("saveOnline_invite").checked?this.onlineTime:null)},resultHTML:new Ui.Template(['<div class="CP_layercon1">','<div class="CP_prompt">','<img class="SG_icon #{icon}" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif"',' width="50" height="50" align="absmiddle" />','<table class="CP_w_ttl"><tr><td>#{content}</td></tr></table>','<p class="CP_w_btns_Mid"><a class="SG_aBtn SG_aBtnB" href="#" ','onclick="window.$inviteDialog && window.$inviteDialog.hidden();return false;"><cite> 确定 </cite></a></p>',"</div>","</div>"].join("")),postContent:function(){$tray.renderLogin();var a=this.Interface;var b={tuid:this.uid,fuid:$UID,authcode:Core.String.trim($E("invite_checkcode").value),content:$E("invite_content").value,varname:"addFriendRequest",version:7,rnd:(new Date).valueOf()};a.request({GET:b,onSuccess:Core.Function.bind2(function(){v7sendLog("45_01_13_"+scope.$uid);var a={icon:"SG_icon203",content:this.successMSG()};this.dialog.setContent(this.resultHTML.evaluate(a));if(this.afterSubmit!=null){this.afterSubmit()}},this),onError:Core.Function.bind2(function(a){if(a.code=="A20109"||a.code=="A20004"){$E("invite_user_error").innerHTML=$SYSMSG[a.code];$E("invite_user_error").style.display=""}else if(a.code=="A20003"||a.code=="A20103"){$E("invite_code_error").innerHTML=$SYSMSG[a.code];$E("invite_code_error").style.display="";$E("invite_checkimage").src="http://interface.blog.sina.com.cn/riaapi/checkwd_image.php?"+Math.random();$E("invite_checkcode").value=""}else if(a.code=="A11007"){var b=$SYSMSG["A11007"].replace("#{linkNewBlog}","http://blog.sina.com.cn/u/"+$UID);winDialog.alert(b)}else{var c={icon:"SG_icon202",content:$SYSMSG[a.code].replace(/#{nick}/,scope.owenerNickName)};this.dialog.setContent(this.resultHTML.evaluate(c))}if(this.afterSubmit!=null){this.afterSubmit()}},this),onFail:Core.Function.bind2(function(){var a={icon:"SG_icon202",content:$SYSMSG.A00001};this.dialog.setContent(this.resultHTML.evaluate(a))},this)})},closeDailog:function(){this.dialog.hidden()}};Lib.Invite=Core.Class.define(Lib.Invite_Base.prototype.initialize,Lib.Invite_Base,{dialogTitle:"加好友",contentLength:200,title:function(){var a=isNaN(scope.owenerWType)?-1:parseInt(scope.owenerWType);var b=Lib.blogv.getVHTML(a);return'加"'+scope.owenerNickName+b+'"为好友'},successMSG:function(){return["邀请发送成功，请等待对方确认。",'<div class="CP_w_cnt SG_txtb" style="font-size:12px;font-weight:normal;">以后对方的动态（发博文，图片，投票等），都可以在<span style="color: red;">个人中心</span>查看啦！</div>','<ul class="CP_w_part CP_w_aLine">','<li><a style="font-weight:normal;font-size:12px;" href="http://control.blog.sina.com.cn/blogprofile/index.php?type=3&from=addfiend" target="_blank">到个人中心查看其他好友动态&gt;&gt;</a></li>',"</ul>"].join("")},Interface:new Interface("http://control.blog.sina.com.cn/riaapi/profile/invitesend.php","jsload"),isAllowSend:function(){if(!scope||!scope.$private)return true;var a=scope.$private.invitationset||0;if(0===a){return true}else{winDialog.alert($SYSMSG["A20106"]);return false}}});Lib.invite=function(a){new Lib.Invite(a)};Lib.invite3=function(a,b){scope.owenerNickName=b;new Lib.Invite(a)};Lib.Scrip=Core.Class.define(Lib.Invite_Base.prototype.initialize,Lib.Invite_Base,{dialogTitle:"发纸条",headImage:"",contentLength:300,title:function(){return"发纸条给："+scope.owenerNickName},successMSG:function(){return"给"+scope.owenerNickName+"的纸条发送成功！"},Interface:new Interface("http://control.blog.sina.com.cn/riaapi/profile/messagesend.php","jsload"),afterSubmit:function(){},isAllowSend:function(){if(!scope||!scope.$private)return true;var a=scope.$private.pageset||0;if(1===a){this._showMsg("A20009");return false}if($isLogin){var b=-1!=$E("comp901_btn_invite").innerHTML.indexOf("已是好友");if(2===a&&!b){this._showMsg("A30006");return false}}return true},_showMsg:function(a){winDialog.alert($SYSMSG[a])}});Lib.scrip=function(a){new Lib.Scrip(a)};if(typeof SinaEx==="undefined"){SinaEx={}}SinaEx.findNode=function(a,b,c){for(var d=a[c];d;d=d[b]){if(d.nodeType==1){return d}}return null};SinaEx.prev=function(a){return SinaEx.findNode(a,"previousSibling","previousSibling")};SinaEx.next=function(a){return SinaEx.findNode(a,"nextSibling","nextSibling")};SinaEx.firstChild=function(a){return SinaEx.findNode(a,"nextSibling","firstChild")};SinaEx.parent=function(a,b){b=b.toLowerCase();while(a){if(a.nodeName.toLowerCase()===b){return a}a=a.parentNode}return null};SinaEx.createNode=function(a){var b=document.createElement("div");b.innerHTML=a;return b.firstChild};SinaEx.addClass=function(a,b){var c=a.className;if((" "+c+" ").indexOf(" "+b+" ")===-1){a.className=b+" "+c}};SinaEx.removeClass=function(a,b){var c=(" "+a.className+" ").replace(" "+b+" "," ");a.className=c.replace(/^\s+/,"").replace(/\s+$/,"")};if(document.documentElement.contains){SinaEx.contains=function(a,b){return a.contains?a.contains(b):true}}else if(document.documentElement.compareDocumentPosition){SinaEx.contains=function(a,b){return a===b||!!(a.compareDocumentPosition(b)&16)}}else{SinaEx.contains=function(a,b){while(b){if(a===b){return true}b=b.parentNode}return false}}$registComp(901,{baseHTML:[""+'<div class="info">'+'<div class="info_img" id="comp_901_head">'+'<img src="http://portrait'+(scope.$uid*1%8+1)+".sinaimg.cn/"+scope.$uid+'/blog/180" id="comp_901_head_image" width="180" height="180" alt="" />'+"</div>"+'<div class="info_txt">'+'<div class="info_nm">'+'<img id="comp_901_online_icon" style="display:none;" class="SG_icon SG_icon1" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" align="absmiddle" /><span class="SG_txtb"><strong id="comp_901_nickname">&nbsp;</strong></span>'+'<span class="info_into"><a class="SG_linka" href="http://space.sina.com.cn/u/1406758883"><img class="SG_icon SG_icon41" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" title="空间" align="absmiddle" />进入我的空间</a></span>'+'<div class="clearit"></div>'+"</div>"+'<div class="info_btn1">'+'<a href="http://you.video.sina.com.cn/'+scope.$uhost+'" class="SG_aBtn SG_aBtn_ico" target="_blank">'+"<cite>"+'<img class="SG_icon SG_icon16" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" align="absmiddle" />播客'+"</cite>"+'</a><a href="http://weibo.com/'+scope.$uid+'?source=blog" class="SG_aBtn SG_aBtn_ico">'+"<cite>"+'<img class="SG_icon SG_icon51" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" align="absmiddle" />微博'+"</cite>"+"</a>"+'<div class="clearit"></div>'+"</div>"+'<div class="SG_j_linedot"></div>'+'<div class="info_list">'+'<ul class="info_list1">'+"<li>"+'<span class="SG_txtc">博客等级：</span><span id="comp_901_grade">读取中…</span>'+"</li>"+"<li>"+'<span class="SG_txtc">博客积分：</span><span id="comp_901_score">读取中…</span>'+"</li>"+"</ul>"+'<ul class="info_list2">'+"<li>"+'<span class="SG_txtc">博客访问：</span><span id="comp_901_pv">读取中…</span>'+"</li>"+"<li>"+'<span class="SG_txtc">关注人气：</span><span id="comp_901_attention">读取中…</span>'+"</li>"+"</ul>"+"</div>"+'<div class="clearit"></div>'+"</div>"+'<div class="clearit"></div>'+"</div>"].join(""),load:function(){Lib.checkAuthor();if($E("comp_901_head")==null){this.setContent(this.baseHTML)}if($isAdmin==false&&$isLogin){this.loadIsFriend()}else if($isAdmin==false&&!$isLogin){this.isFriend=false;this.loadOnline()}else{this.isOnline=true}if(scope.$pageid!="fakeIndex"){Lib.Uic.getNickName([scope.$uid],function(a){var b=Core.String.trim;var c=$E("ownernick");var d=b(c.textContent||c.innerText);var e=b(c.innerHTML);if(Core.String.byteLength(a[scope.$uid])>20){var f=a[scope.$uid].replace(/(.{10})/g,"$1<br/>")}else{var f=a[scope.$uid]}if(!d&&d!=e){c.innerHTML=f+"&nbsp;"+e}else if(d&&d!=e){try{var g=c.getElementsByTagName("a");var h=g&&g[0].innerHTML;c.innerHTML=f+'&nbsp;<a href="http://blog.sina.com.cn/v/verify" target="_blank">'+h+"</a>"}catch(i){}}else{c.innerHTML=f}})}if($E("comp_901_nickname")){this.loadNickname()}else{this.renderHead();var a=$E("ownernick");var b=Core.String.trim;var c=Core.String.byteLength;var d,e;if(a){d=b(a.textContent||a.innerText).replace(/(\r|\n)/g,"");var f=c(d);scope.owenerNickName=d}}this.loadOtherInfo();if(scope.$pageid=="pageSetM"&&this.setManage&&scope.$private.ad==0&&scope.$private.adver==0&&scope.$private.p4p==0){this.setManage()}},fixNick:function(a){var b=Core.String.byteLength;var c=Core.String.leftB;var d=Core.String.trim;var e=b(a);var f;a=d(a);if(22<e){f=c(a,20);a=f+"<br>"+a.replace(f,"")}return a},showOnlineInfo:function(){if(!$isAdmin&&this.isOnline){Core.Dom.setStyle($E("comp_901_online_icon"),"display","");$E("comp_901_online_icon").alt="在线";$E("comp_901_online_icon").title="在线"}},showNickName:function(a){var b=a[scope.$uid]||"";b=Core.String.encodeHTML(b);var c=$E("comp_901_nickname");c.innerHTML=b;scope.owenerNickName=c.textContent||c.innerText;this.renderHead(b)},renderHead:function(a){if(!$isAdmin){if(a){$E("comp_901_head_image").title=a}}else{$E("comp_901_head").innerHTML='<a href="http://control.blog.sina.com.cn/blogprofile/nick.php"'+' title="点击上传头像" target="_blank"><img id="comp_901_head_image" width="180" height="180" alt="点击上传头像" src="http://portrait'+(scope.$uid*1%8+1)+".sinaimg.cn/"+scope.$uid+'/blog/180" /></a>'}},loadOtherInfo:function(){this.loadPv();this.loadAttention();if(scope.$pageid=="index"||scope.$pageid=="indexM"||scope.$pageid=="pageSetM"){this.loadAdManage()}this.load5YearsIcon();this.load7YearsIcon()},loadNewIcon:function(){var a=$C("a");a.href="http://move.blog.sina.com.cn/";a.target="_blank";a.position="absolute";var b=$C("img");b.src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif";b.className="fiveyearsIcon";if($IE6){b.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='http://simg.sinajs.cn/blog7style/images/special/move/move_hz.png',sizingMethod='image')"}else{b.style.backgroundImage="url(http://simg.sinajs.cn/blog7style/images/special/move/move_hz.png)"}b.alt="邀请MSN好友获得朋友徽章";b.title="邀请MSN好友获得朋友徽章";b.style.border="none";a.appendChild(b);$E("comp_901_head").appendChild(a);a.onclick=function(){Utils.Io.JsLoad.request("http://control.blog.sina.com.cn/blog_rebuild/msn/api/msnGuideCount.php?type=hitMedal")};a=null},loadPv:function(){var a=document.referrer=="0"?"":encodeURIComponent(document.referrer);if(scope.totalPv&&!isNaN(scope.totalPv)){$SetPV(scope.totalPv)}else{var b="";if(scope.$articleid){b="http://hits.blog.sina.com.cn/hits?act=4&aid="+scope.$articleid+"&ref="+a}else{var c="00000000"+(scope.$uid*1).toString(16);c=c.substr(c.length-8,8);b="http://hits.blog.sina.com.cn/hits?act=3&uid="+c+"&ref="+a}Utils.Io.JsLoad.request(b,{onComplete:function(a){if(a&&typeof a.pv!="undefined"){scope.totalPv=a.pv;$SetPV(a.pv)}},onException:function(){$SetPV(0)}})}},loadScore:function(){setTimeout(function(){Utils.Io.JsLoad.request("http://blogcnfv5.sinajs.cn/blogscr?uid="+scope.$uid+"&varname=blogScore&.js",{onComplete:function(){if(typeof blogScore!="undefined"||$E("comp_901_score")==null){var a=blogScore.coefficient.a;var b=blogScore.coefficient.b;var c=blogScore.coefficient.c;var d=blogScore.coefficient.d;var e=blogScore.x;var f=blogScore.y;var g=blogScore.z;var h=blogScore.w;var i=e*a+f*b+g*c+h*d;$E("comp_901_score").innerHTML="<strong>"+Core.String.formatNumber(i)+"</strong>"}},noreturn:true})},1)},loadAttention:function(){var a=this;var b=new Interface("http://blogtj.sinajs.cn/api/get_attention_num.php","jsload");var c={uid:scope.$uid,suid:$isLogin?$UID:"0",attention:"suid",userpointuid:scope.$uid,s:"1"};if(this.mashAddFriend){var d=scope.$uid;var e=$UID;if(d&&e){c.friendattuid=d;c.friendattsuid=e}else{this.mashAddFriend=false}}b.request({GET:c,onSuccess:Core.Function.bind2(function(a){Lib.checkAuthor();if($E("comp_901_attention")){var b=Core.String.formatNumber(a.num[scope.$uid]);$E("comp_901_attention").innerHTML="<strong>"+(b<0?0:b)+"</strong>"}if(a.is_attention&&a.is_attention[scope.$uid]==1){this.isAttentioned=true;if($E("module_901_attention")){$E("module_901_attention").innerHTML="已关注"}}if(typeof a.userpoint!="undefined"){if($E("comp_901_score")){$E("comp_901_score").innerHTML="<strong>"+a.userpoint+"</strong>"}}if(this.mashAddFriend){var c=[{uid:scope.$uid,status:a.friendattr}];this.friendSuccessCallback(c)}if(a.svr_time){scope.$svr_time=a.svr_time}},this),onError:function(){if($E("comp_901_attention")){$E("comp_901_attention").innerHTML="<strong>0</strong>"}if(a.mashAddFriend){a.friendErrorCallback()}},onFail:function(){if($E("comp_901_attention")){$E("comp_901_attention").innerHTML="<strong>0</strong>"}if(a.mashAddFriend){a.friendErrorCallback()}}})},loadWorldCupIcon:function(){if(scope.$isWorldcupUser==1){var a=$C("a");a.href="http://blog.2010.sina.com.cn/yunying/2010worldcup/";a.target="_blanks";var b=$C("img");b.id="comp_901_wcIcon";b.src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif";b.className="worldcup_icon worldcup_icon_l";b.alt="记录激动时刻，赢取超级大奖！快一起参加吧！";b.title="记录激动时刻，赢取超级大奖！快一起参加吧！";a.appendChild(b);$E("comp_901_head").appendChild(a)}},load7YearsIcon:function(){var a=$E("comp_901_head");var b={medal0:"http://simg.sinajs.cn/blog7style/images/activity/blog7year/icon_wmm.png",medal1:"http://simg.sinajs.cn/blog7style/images/activity/blog7year/icon_xx.png",medal2:"http://simg.sinajs.cn/blog7style/images/activity/blog7year/icon_xr.png",medal3:"http://simg.sinajs.cn/blog7style/images/activity/blog7year/icon_xf.png",medal4:"http://simg.sinajs.cn/blog7style/images/activity/blog7year/icon_jy.png",medal5:"http://simg.sinajs.cn/blog7style/images/activity/blog7year/icon_fy.png?v20120917",medal6:"http://simg.sinajs.cn/blog7style/images/activity/blog7year/icon_zs.png",medal7:"http://simg.sinajs.cn/blog7style/images/activity/blog7year/icon_yl.png"};var c=scope.$private.medal7;c=7<c?7:c;if(c){var d=$C("a");d.setAttribute("target","_blank");d.setAttribute("href","http://control.blog.sina.com.cn/blog_7years/index.php");var e=$C("img");e.src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif";e.className="sevenyearsIcon";if($IE6){e.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+b["medal"+c]+"',sizingMethod='image')"}else{e.style.backgroundImage="url("+b["medal"+c]+")"}e.style.border="none";d.appendChild(e);$E("comp_901_head").appendChild(d)}else if(!scope.$private.medal&&$UID==scope.$uid){var d=$C("a");d.setAttribute("target","_blank");d.setAttribute("href","http://control.blog.sina.com.cn/blog_7years/index.php");var e=$C("img");e.src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif";e.className="sevenyearsIcon";if($IE6){e.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+b["medal0"]+"',sizingMethod='image')"}else{e.style.backgroundImage="url("+b["medal0"]+")"}e.style.border="none";d.appendChild(e);$E("comp_901_head").appendChild(d)}},load5YearsIcon:function(){if(scope.$private.medal7){return}trace("【活动】显示用户勋章。");try{var a=["纪念勋章","一","二","三","四","五"];var b=scope.$private.medal;if(b>0||b===0){var c=$C("a");c.setAttribute("target","_blank");c.setAttribute("href","http://control.blog.sina.com.cn/blog_7years/index.php");var d=$C("img");d.src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif";d.className="fiveyearsIcon";if($IE6){d.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='http://simg.sinajs.cn/blog7style/images/special/fiveyears/at/"+b+"y.png',sizingMethod='image')"}else{d.style.backgroundImage="url(http://simg.sinajs.cn/blog7style/images/special/fiveyears/at/"+b+"y.png)"}d.alt=b>0?a[b]+"周年勋章":a[0];d.title=b>0?a[b]+"周年勋章":a[0];d.style.border="none";c.appendChild(d);$E("comp_901_head").appendChild(c);if($UID==scope.$uid){var e=$C("span");var f="updateIcon_1";var g="updateIcon_2";e.className=f;c.appendChild(e);var h=0;setInterval(function(){if(h%2==1){e.className=f;i=0}else{e.className=g}h++},500)}trace("【活动】显示用户勋章完成。")}else{trace("【活动】用户还没有获得勋章。")}}catch(j){trace("【活动】显示用户勋章发生异常。")}},loadPhotoCount:function(){},loadVideoCount:function(){},loadAdManage:function(){if($isAdmin&&scope.$private!=null&&scope.$private.ad!=null&&scope.$private.ad!=0&&$E("comp_901_adlink")==null){Debug.info("添加广告共享计划管理链接");var a=['<div class="info_locate2"><div class="SG_j_linedot"/></div>'+'<div id="comp_901_adlink" class="info_AD"><a href="http://share.sass.sina.com.cn/widget_ad/widget_ad_index.php"'+' target="_blank">管理广告共享计划</a></div>'].join("");var b=Core.Dom.getElementsByClass(this.getContent(),"div","info_txt");if(b){b=b[0].lastChild;Core.Dom.insertHTML(b,a,"BeforeBegin")}}},showVisitButton:function(){if($isAdmin){return}if($E("info_locate_id")){var a=$E("comp901_btn_invite");if(a){a.href="javascript:void(0)";if(this.isFriend==false){a.innerHTML="<cite>加好友</cite>";a.onclick=function(){if(!$isLogin){v7sendLog("48_01_28")}Lib.invite(scope.$uid);return false}}else{a.innerHTML="<cite>已是好友</cite>"}}a=$E("comp901_btn_sendpaper");if(a){a.href="javascript:void(0)";a.onclick=function(){if(!$isLogin){v7sendLog("48_01_27")}Lib.scrip(scope.$uid);return false}}a=$E("comp901_btn_msninfo");if(a){a.onclick=function(){if(!$isLogin){v7sendLog("48_01_29")}};a.href="http://blog.sina.com.cn/s/profile_"+scope.$uid+".html#write"}a=$E("comp901_btn_follow");if(a){if(this.isAttentioned){a.innerHTML="<cite>已关注</cite>";a.onclick=function(){Lib.Component.isAttentioned();return false}}else{a.innerHTML="<cite>加关注</cite>";a.onclick=function(){if(!$isLogin){v7sendLog("48_01_30")}Lib.Component.Attention();this.innerHTML="<cite>已关注</cite>";return false}}}return}else{var b;var c="";if(this.isFriend==false){c="Lib.invite("+scope.$uid+');return false;" class="SG_aBtn"><cite>加好友'}else{c+="><cite>已是好友"}var d=['<div id="info_locate_id" class="info_locate"><div class="SG_j_linedot"></div>','<div class="info_btn2">','<p><a href="#" onclick="'+c,"</cite></a>",'<a href="#" onclick="Lib.scrip('+scope.$uid+');return false;" class="SG_aBtn">',"<cite>发纸条</cite></a></p>",'<p><a href="http://blog.sina.com.cn/s/profile_'+scope.$uid+'.html#write" class="SG_aBtn" target="_blank">',"<cite>写留言</cite></a>",'<a id="module_901_attention" href="#" onclick="return false;" class="SG_aBtn'+(this.isAttentioned?" SG_aBtn_dis":"")+'">','<cite onclick="Lib.Component.'+(this.isAttentioned?" isAttentioned":"Attention")+'();">'+(this.isAttentioned?"已":"加")+"关注</cite></a></p>",'<div class="clearit"></div>',"</div></div>"].join("");if(this.size==210){b=Core.Dom.getElementsByClass(this.getContent(),"div","info_btn1");if(b){b=b[0];Core.Dom.insertHTML(b,d,"AfterEnd")}}else{b=Core.Dom.getElementsByClass(this.getContent(),"div","info_txt");if(b){b=b[0];Core.Dom.insertHTML(b,d,"BeforeEnd")}}}}},901);$registComp(903,{load:function(){if($E("atcPicList")){this.loadPicture_new()}else{this.loadArticle()}},loadArticle:function(){var a=typeof $tag_code!="undefined"?$tag_code:"";Utils.Io.Ijax.request("http://tag.blog.sina.com.cn/tag/tag_walist_v7.php",{GET:{blog_id:scope.$articleid,tag:encodeURI($tag),tag_code:a},onComplete:function(a){this.loadPicture('<div class="atcTitList relaList">'+a+"</div>")}.bind2(this),onException:function(){}})},loadPicture:function(a){var b="http://blog.sina.com.cn/lm/iframe/article/sort_"+this.articleCate[scope.$sort_id]+"_"+Math.ceil(Math.random()*3)+"_v7.html";Utils.Io.Ajax.request(b,{onComplete:function(b){var c=/<ul>\s+<\/ul>/i.test(b);this.getContent().innerHTML=a.replace(/<!-- relative_pic_blog-->/,c?"":b)}.bind2(this),onException:function(){}})},loadPicture_new:function(a){var b="http://blog.sina.com.cn/lm/iframe/article/sort_"+this.articleCate[scope.$sort_id]+"_"+Math.ceil(Math.random()*3)+"_v7.html";Utils.Io.Ajax.request(b,{onComplete:function(a){var b=$E("atcPicList");b.innerHTML=a}.bind2(this),onException:function(){}})},articleCate:{105:"105",102:"117",104:"104",149:"149",113:"113",153:"117",111:"117",152:"122",122:"122",131:"131",127:"108",134:"149",145:"108",108:"108",130:"130",116:"116",129:"129",136:"129",125:"125",141:"108",118:"118",117:"117"}},"dymanic");$registComp(904,{load:function(){if(Core.Dom.byClz(this.getContent(),"div","wdtLoading").length>0){var a="http://blog.sina.com.cn/main/top_new/article_sort/"+scope.$sort_id+"_day.v7.html";Utils.Io.Ajax.request(a,{onComplete:function(a){a='<div class="atcTitList relaList">'+a+"</div>";this.setContent(a)}.bind2(this),onException:function(){this.showError()}.bind2(this)})}else{}}},"dymanic");Core.String.shorten=function(a,b,c){if(Core.String.byteLength(a)<=b){return a}if(c!=""){c=c||"..."}else{c=""}return Core.String.leftB(a,b)+c};$registComp(909,{load:function(){if($E("tj_id")){this.showTJList($E("tj_id"))}},showTJList:function(a){Utils.Io.JsLoad.request("http://blogtj.sinajs.cn/api/tj/get_tj_article_info.php",{GET:{uid:scope.$uid},onComplete:function(b){var c='<li><p><span class="SG_dot"></span><a href="#{href}" target="_blank">#{content}</a></p>'+'<div class="w_list SG_txtc"><a href="#{srcHref}" target="_blank">#{src}</a></div></li>';var d="";var e=b.data;var f=b.data.length>5?5:b.data.length;if(f===0){a.innerHTML='<li class="no_text">暂无被推荐博文</li>';return}for(var g=0;g<f;g++){var h={};h.href="http://blog.sina.com.cn/s/blog_"+e[g].blog_id+".html?tj=1";h.content=Core.String.byteLength(e[g].blog_title)>26?Core.String.shorten(e[g].blog_title,26,"…"):e[g].blog_title;h.content=Core.String.encodeHTML(h.content);h.srcHref=e[g].tj_chanel_id_url;h.src=e[g].tj_chanel_id_str;var i=(new Ui.Template(c)).evaluate(h);d+=i}a.innerHTML=d}.bind2(this),onException:function(){this.showError()}.bind2(this)})}},"dymanic");Core.String.toInt=function(a,b){return parseInt(a,b)};Core.String.a2u=function(a){return a.replace(/\\u[\da-fA-F]{4}/gi,function(a){a=Core.String.toInt(a.substr(2),16);return String.fromCharCode(a)})};Lib.register("util.cutNickName",function(){return function(a,b,c){var d=Core.String.byteLength;var e=Core.String.leftB;c=c||6;if(0<=b&&8>b){return d(a)>c?e(a,c-2)+"…":e(a,c)}else{return d(a)>c+2?e(a,c)+"…":e(a,c+2)}}});$registComp("12",{Interface:new Interface("http://footprint.cws.api.sina.com.cn/list.php","jsload"),PromoteUserBlogInterface:new Interface("http://control.blog.sina.com.cn/riaapi/profile/AdTaskTools.php","jsload"),isDisabled:function(){var a=$_GLOBAL.disableVisitor;if(a&&a.indexOf("|"+this.requestParam.uid+"|")>-1){this.showDisabled();return true}return false},_getMessage:function(a){if(!a){a={}}var b=Lib.blogv.getVHTML;var c=Lib.util.cutNickName;this.Interface.request({GET:this.requestParam,onSuccess:Core.Function.bind2(function(d){Core.Array.foreach(d.record,Core.Function.bind2(function(e){e.vString=this.formatTime(e.vtime,d.stime);var f=Core.String.a2u(e.name);if(isNaN(e.wtype)){e.wtype=-1}e.wtype=parseInt(e.wtype,10);e.shortName=c(f,e.wtype);if(a[e.uid]){e.isPromote=true}e.userV=b(e.wtype);e.shortName=Core.String.encodeHTML(e.shortName)},this));this.cacheData=d.record;this.total=d.total;this["render_"+this.size](this.cacheData);a=null},this),onError:Core.Function.bind2(function(a){this.showError($SYSMSG[a.code])},this),onFail:Core.Function.bind2(function(){this.showError($SYSMSG.A80101)},this)})},load:function(){if(this.requestParam==null){this.show("请提供访客组件的接口参数")}else{Lib.checkAuthor();if(!$isLogin){this.requestParam.varname="requestId_visitor_list"}if(scope.unreadMsg&&scope.unreadMsg.foot==0){this.requestParam.add=1}if(this.isDisabled()){return}var a=this;a._getMessage({1259295385:true})}},formatTime:function(a,b){var c="";var d=new Date(b*1e3);var e=new Date(a*1e3);if(d.getFullYear()==e.getFullYear()&&d.getMonth()==e.getMonth()&&d.getDate()==e.getDate()){var f=Math.max(0,b-a);Debug.warning("diffTime : "+f);if(f<60*60){c=Math.ceil(f/60)+"分钟前"}else{var g=new Date(a*1e3);c=("今天0"+g.getHours()+":0"+g.getMinutes()).replace(/(\d{3,3})/g,function(a,b){return b.substr(1)})}}else{var h=new Date(a*1e3);c=h.getMonth()+1+"月"+h.getDate()+"日"}return c},reload:function(a,b,c){var d=a==null||a&&(a==210||a==510||a==730);if(!d){Debug.error("请检查传入的组件尺寸是否正确。"+a);return}this.size=a||this.size;this.getContent().innerHTML='<div class="wdtLoading"><img src="http://simg.sinajs.cn/blog7style/'+'images/common/loading.gif" />加载中…</div>';if(c==true||this.cacheData==null){this.load()}else{this["render_"+this.size]()}}},"dynamic");Lib.deleteVisitByUid=function(a,b,c,d){Lib.checkAuthor();if(!$isLogin){var e=new Lib.Login.Ui;e.login(Core.Function.bind3(Lib.deleteWallByMsgid,null,arguments));return}Debug.log("删除访客："+a);var f="";if($isAdmin){f=$SYSMSG.A80203}else if($isLogin){f=$SYSMSG.A80201}else{return true}winDialog.confirm(f,{funcOk:function(){var e=new Interface("http://footprint.cws.api.sina.com.cn/del.php","jsload");var f={pid:b,uid:scope.$uid,deleteuid:a};if(d!=null){f.subid=d}if($E("comp_12_deleteToBlack")&&$E("comp_12_deleteToBlack").checked==true){f.inblack=1}e.request({GET:f,onSuccess:function(){if(c){c(null,null,true)}else{Debug.log("Reload page");window.location.reload()}}})},subText:$isAdmin?$SYSMSG.A80204:$SYSMSG.A80202,textOk:"是",textCancel:"否",icon:"04"})};$SYSMSG.extend({B80001:"暂无访客",B80002:"暂无留言",B80003:"暂无博客评论",B80004:"暂无好友",B80005:"暂无图片专辑",B80006:"暂无视频",B80007:"暂无归档博文",B80101:"你确定删除此评论吗？<br/>删除后不可恢复",B80102:"你确定删除此留言吗？<br/>删除后不可恢复",B80103:['<ul class="CP_w_part SG_txtb">'+'<li><input type="checkbox" id="comp_2_deleteToBlack" class="CP_w_fm1" />'+'<label for="comp_2_deleteToBlack" >将此人加入黑名单</label></li>'+"</ul>"].join(""),A00101:'<div class="SG_nodata">留言板非公开</div>',B36023:"对不起，黑名单已达到上限"});scope.getPromoteURL=function(a){var b="http://blog.sina.com.cn/u/"+a.uid;var c="http://sina.allyes.com/main/adfclick?db=sina&bid=204720,290418,295665&cid=0,0,0&sid=288937&advid=358&camid=37389&show=ignore";if(a.isPromote){b=c+($UID?"&kv={0}|99999&url={1}".format($UID,b):"&url={0}".format(b))}if(a.uid==1259295385){var d="http://blog.sina.com.cn/u/"+a.uid;b="http://sina.allyes.com/main/adfclick?db=sina&bid=204720,256856,261931&cid=0,0,0&sid=253209&advid=358&camid=37389&show=ignore&url="+d}return b};$registComp(12,{requestParam:{uid:scope.$uid,pagesize:"18",pid:1},html:['<div class="ptCell">','<p class="pt_img"><a id="linkVisited_#{uid}" href="#{uhref}" target="_blank" ',"onmouseover=\"if(this.parentNode.lastChild.className=='del'){this.parentNode.lastChild.style.display='';}\" ","onmouseout=\"if(this.parentNode.lastChild.className=='del'){this.parentNode.lastChild.style.display='none';}\" ><img",' src="#{icon}" width="50" height="50" alt="#{name}" title="#{name}" /></a>',"#{update}#{manage}</p>",'<p class="pt_nm"><a href="#{uhref}"" target="_blank" title="#{name}">#{shortName}</a>#{userV}</p>','<p class="pt_tm SG_txtc">#{vString}</p>',"</div>"].join(""),render_210:function(a){a=a||this.cacheData;a=a.slice(0,12);this.parseToHTML(a)},render_510:function(a){a=a||this.cacheData;a=a.slice(0,12);this.parseToHTML(a)},render_730:function(a){a=a||this.cacheData;this.parseToHTML(a)},parseToHTML:function(a){if(a.length==0){this.showEmpty()}else{Lib.checkAuthor();Core.Array.foreach(a,Core.Function.bind2(function(a){a.manage=$isAdmin||$isLogin&&a.uid==$UID?'<span class="del" style="display: none;" onmouseover="this.style.display = \'\';"'+" onmouseout=\"this.style.display = 'none';\""+'><img class="SG_icon SG_icon6" src="http://simg.sinajs.cn/blog7style'+'/images/common/sg_trans.gif" width="15" height="15" title="删除访问记录" '+"onclick=\"Lib.deleteVisitByUid('"+a.uid+"', 1, Core.Function.bind2(Lib.Component.instances["+this.compId+"].reload, Lib.Component.instances["+this.compId+"])"+(scope.$articleid==null?"":",'"+scope.$articleid+"'")+');return false;" align="absmiddle" /></span>':"";a.update=a.utime==1?'<span class="new"><img class="SG_icon SG_icon7" src="http://simg.sinajs.cn/blog7style'+'/images/common/sg_trans.gif" width="15" height="15" title="有内容更新，赶快去看一下" align="absmiddle" /></span>':"";a.uhref=scope.getPromoteURL(a)},this));var b=new Ui.Template(this.html);var c='<div class="ptList visitorList">'+b.evaluateMulti(a)+"</div>";if((scope.$pageid=="indexM"||scope.$pageid=="pageSetM")&&$isAdmin==true&&(this.size<730&&this.total>12||this.size==730&&this.total>18)){c+='<div class="moreLink SG_j_linedot1"><span class="SG_more"><a href="http://control.blog.sina.com.cn/blogprofile/visitor.php?showtype=1" target="_blank">更多</a>&gt;&gt;</span></div>'}else{c+='<div class="moreLink" style="padding-top:0;"></div>'}this.show(c);var d="1062753310";var e=$E("linkVisited_"+d);e&&(e.href="http://sina.allyes.com/main/adfclick?db=sina&bid=204720,256856,261931&cid=0,0,0&sid=253209&advid=358&camid=37389&show=ignore&url=http://blog.sina.com.cn/u/"+d)}if(scope.$pageid=="pageSetM"&&this.setManage){this.setManage()}},showEmpty:function(){this.setContent('<div class="SG_nodata">'+$SYSMSG.B80001+"</div>")},showDisabled:function(){var a="尊敬的用户您好，为了给大家提供更好的服务，近期访客组件进行升级维护，维护过程中将影响部分用户无法正常浏览，给您带来不便敬请谅解！感谢您对新浪博客一直以来的支持！";this.setContent('<div class="SG_nodata" style="padding-left:1.5em; padding-right:1.5em; text-indent:2em; text-align:left">'+a+"</div>")},setManage:function(){if($isAdmin&&this.getManage()){this.getManage().innerHTML='<span class="move"><a href="#" '+'onclick="funcMoveUpDown.up('+this.compId+');return false;">↑</a><a href="#" '+'onclick="funcMoveUpDown.down('+this.compId+');return false;">↓</a></span>'+'<a href="#" onclick="hiddenComponents(\''+this.compId+'\');return false;" class="CP_a_fuc">[<cite>隐藏</cite>]</a>'}}},12);$registComp(47,{requestParam:{uid:scope.$uid,pagesize:"12",pid:1,subid:scope.$articleid}},12);$registComp(102,{load:function(){trace("comp_1023");this.loadArticle()},loadArticle:function(){Utils.Io.JsLoad.request("http://control.blog.sina.com.cn/riaapi/photoblog/get_hotblog_list.php",{GET:{uid:scope.$uid,version:7},onComplete:function(a){trace("---------------code:"+a.code);var b=['<div class="photoBlog">'];var c=a;var d=c.data;for(var e=0,f=d.length;e<f;e++){var g=d[e].tj?d[e].tj:"";b.push('<div class="photoBlog_cell"><div class="photoBlog_view"><table><tr><td><a href="');b.push(d[e].blogurl);b.push('" target="_blank"><img class="borderc" src="');b.push(d[e].picurl);b.push('" alt="');b.push(d[e].title);b.push('" title="');b.push(d[e].title);b.push('"/></a></td></tr></table></div><p class="photoBlog_nm">');b.push(g);b.push('<a href="');b.push(d[e].blogurl);b.push('" target="_blank">');b.push(d[e].title);b.push("</a></p><p>阅读(");b.push(d[e].hitsnum);b.push(") 评论(");b.push(d[e].commentnum);b.push(")</p></div>")}b.push("</div>");this.getContent().innerHTML=b.join("")}.bind2(this),onException:function(){trace("connect error")}})},tpl:""+'<div class="photoBlog_cell">'+'<div class="photoBlog_view">'+"<table>"+"<tr>"+"<td>"+'<a href="{0}" target="_blank"><img class="borderc" src="{5}" alt="{7}" title="{7}"/></a>'+"</td>"+"</tr>"+"</table>"+"</div>"+'<p class="photoBlog_nm">{6}<a href="{0}" target="_blank">{1}</a> <span class="count">({2}张)</span></p>'+"<p>阅读({3}) 评论({4})</p>"+"</div>"},"dymanic");var DialogManager={dialogs:[],activeDialog:{},backShadow:null,create:function(a,b){var c=this;var d=new Dialog(a);this.dialogs.push(d);this.activeDialog=d;d.name=b||d.getUniqueID();d.entity.style.zIndex=1024;d.onDrag=function(){if($IE6){if(this.getProperty().isFixed){this.setPosition({x:parseInt(this.entity.style.left)-document.documentElement.scrollLeft,y:parseInt(this.entity.style.top)-document.documentElement.scrollTop})}}else{if(this.getProperty().isFixed){this.setPosition({x:parseInt(this.entity.style.left),y:parseInt(this.entity.style.top)})}}};d.onClose=function(){c.removeDialog(this.name);c.updateActiveDialog();c.updateShadow();if(c.activeDialog){c.activeDialog.setFocus()}};d.onHidden=function(){this.isHidden=true;if(this==c.activeDialog){c.activeDialog=null}c.updateActiveDialog();c.updateShadow();if(c.activeDialog){c.activeDialog.setFocus()}};d.onShow=function(){if(this.isHidden){this.isHidden=false;var a,b=c.dialogs.length;for(a=0;a<b;a++){if(c.dialogs[a]==this){document.body.appendChild(c.dialogs[a].entity);c.dialogs.push(c.dialogs[a]);c.dialogs.splice(a,1)}}c.activeDialog=this;c.backShadow.show();c.updateShadow()}};if(this.backShadow.isShow){this.updateShadow()}else{this.backShadow.show()}d.hidden();return d},getDialog:function(a){var b=0,c=this.dialogs.length;for(b=0;b<c;b++){if(this.dialogs[b].name==a){return this.dialogs[b]}}},removeDialog:function(a){var b=0,c=this.dialogs.length;for(b=c-1;b>=0;b--){if(this.dialogs[b].name==a){this.dialogs.splice(b,1);this.activeDialog=this.dialogs[this.dialogs.length-1];break}}},updateActiveDialog:function(){var a,b=this.dialogs.length;for(a=b-1;a>=0;a--){if(!this.dialogs[a].isHidden){this.activeDialog=this.dialogs[a];break}}},updateShadow:function(){if(this.activeDialog&&!this.activeDialog.isHidden){this.backShadow.insertBefore(this.activeDialog.entity);this.activeDialog.updateFixed()}else{this.backShadow.hidden()}},close:function(a){if(!a){if(this.activeDialog){this.activeDialog.close()}return}var b,c=this.dialogs.length;for(b=c-1;b>=0;b--){if(this.dialogs[b].name==a){this.dialogs[b].close();break}}}};var BackShadow=function(a){this.entity=null;this.isShow=false;this._ie6Fixed=function(){if(b.entity){b.entity.style.top=document.documentElement.scrollTop+"px";b.entity.style.left=document.documentElement.scrollLeft+"px";if(b.ifm){b.ifm.style.top=b.entity.style.top;b.ifm.style.left=b.entity.style.left}b.updateSize()}};var b=this;(function(){b.entity=$C("div");b.entity.style.position="absolute";b.entity.style.width=b.getAreaWidth()+"px";b.entity.style.height=b.getAreaHeight()+"px";b.entity.style.left="0px";b.entity.style.top="0px";b.entity.style.zIndex=1024;b.entity.style.backgroundColor="black";document.body.appendChild(b.entity);b._setOpacity(b.entity,isNaN(a)?.5:a);if($IE6){b.entity.style.top=document.documentElement.scrollTop+"px";b.addIframe()}Core.Events.addEvent(window,function(){if(b.entity){if($IE6&&b.isShow){document.documentElement.scrollLeft=0;b._ie6Fixed()}setTimeout(function(){b.updateSize()},1)}},"resize");b.setFixed(true);b.hidden()})()};BackShadow.prototype={show:function(){this.entity.style.display="";if(this.ifm){this.ifm.style.display=""}this.isShow=true;this.onShow()},hidden:function(){this.entity.style.display="none";if(this.ifm){this.ifm.style.display="none"}this.isShow=false;this.onHidden()},close:function(){this.hidden();this.destroy()},destroy:function(){Core.Events.removeEvent(window,this._ie6Fixed,"scroll");this.entity.parentNode.removeChild(this.entity);this.entity=null;if(this.ifm){this.ifm.parentNode.removeChild(this.ifm);this.ifm=null}},addIframe:function(){this.ifm=$C("iframe");this._setOpacity(this.ifm,0);this.ifm.style.position="absolute";this.ifm.style.zIndex=this.entity.style.zIndex;this.ifm.style.left=this.entity.style.left;this.ifm.style.top=this.entity.style.top;this.ifm.style.width=this.entity.style.width;this.ifm.style.height=this.entity.style.height;document.body.insertBefore(this.ifm,this.entity)},insertBefore:function(a){document.body.insertBefore(this.entity,a);if(this.ifm){document.body.insertBefore(this.ifm,this.entity)}},updateSize:function(){this.entity.style.width=this.getAreaWidth()+"px";this.entity.style.height=this.getAreaHeight()+"px";if(this.ifm){this.ifm.style.width=this.getAreaWidth()+"px";this.ifm.style.height=this.getAreaHeight()+"px"}},getAreaHeight:function(){return document.documentElement.clientHeight},getAreaWidth:function(){return document.documentElement.clientWidth},setFixed:function(a){if($IE6){var b=this;if(a){b._ie6Fixed();Core.Events.addEvent(window,b._ie6Fixed,"scroll")}else{Core.Events.removeEvent(window,b._ie6Fixed,"scroll")}}else{this.entity.style.position=a?"fixed":"absolute"}},_setOpacity:function(a,b){if($IE&&$IE<=9){a.style.filter="alpha(opacity="+b*100+")"}else{a.style.opacity=b}},onShow:function(){},onHidden:function(){}};CustomsDialog.prototype={isSetMiddle:false,setContent:function(a){var b=a;this.templateString=b.match(this.nodesPattern);var c=new Ui.Template(b);this.nodes.content.innerHTML=c.evaluate(this.getContentNodes("i"));this.updateNodes()},setTitle:function(a){if(this.nodes.titleName){this.nodes.titleName.innerHTML=a}},setHelp:function(a){if(this.nodes.btnHelp){if(a){this.nodes.btnHelp.href=a}else{this.nodes.btnHelp.innerHTML=""}}},setClose:function(a){var b=this;if(b.nodes.btnClose){a=a||"hidden";switch(a){case"hidden":Core.Events.addEvent(b.nodes.btnClose,b._hiddenDialog,"click");break;case"close":Core.Events.addEvent(b.nodes.btnClose,b._closeDialog,"click");break}}},setPosition:function(a,b){this._dialog.setPosition({x:a,y:b})},setMiddle:function(){var a=Core.System.winSize();var b,c;var d=this._dialog.entity.style.display;this._dialog.setPosition({x:-1e4});this._dialog.entity.style.display="";var e=this.nodes.titleBar?this.nodes.titleBar.offsetHeight:0;var f=a.height-this.nodes.content.offsetHeight-e;var g=(Math.sqrt(5)-1)/2;var h=1;var i=f*g/(g+h);b=a.width/2-this.nodes.content.offsetWidth/2;b=b<0?0:b;c=i<0?0:i;if(!this._dialog.getProperty().isFixed){b=b+Math.max(document.documentElement.scrollLeft,document.body.scrollLeft);c=c+Math.max(document.documentElement.scrollTop,document.body.scrollTop)}this._dialog.entity.style.display=d;this._dialog.setPosition({x:b,y:c});this.isSetMiddle=true},setSize:function(a,b){this._dialog.setSize({width:a,height:b})},setFixed:function(a){this._dialog.setFixed(a)},setAreaLocked:function(a){this._dialog.setAreaLocked(a)},setFocusNode:function(a){this._dialog.getProperty().focusNode=a},setDisplayMode:function(a){this._dialog.getProperty().displayMode=a||"normal"},getWidth:function(){return this._dialog.getProperty().width},getHeight:function(){return this._dialog.getProperty().height},getX:function(){return this._dialog.getProperty().x},getY:function(){return this._dialog.getProperty().y},show:function(){if(this.isSetMiddle){this.setMiddle()}this._dialog.show();this.onShow()},hidden:function(){this._dialog.hidden();this.onHidden()},close:function(){var a=this;a._dialog.close();a.onClose();if(a.nodes.btnClose){Core.Events.removeEvent(a.nodes.btnClose,a._hiddenDialog,"click");Core.Events.removeEvent(a.nodes.btnClose,a._CloseDialog,"click")}},updateNodes:function(){this.nodes=this._dialog.getNodes();var a=this.getContentNodes();for(k in a){this.nodes[k]=a[k]}},getContentNodes:function(a){var b=a||"o";var c;var d={};var e=this.templateString;if(e){for(c=0;c<e.length;c++){var f=e[c];switch(b){case"o":d[f]=$E(this.nodes.content.id+"_"+f);break;case"i":d[f]=this.nodes.content.id+"_"+f;break}}}return d},setOnDisplaied:function(a){this._dialog.onDisplaied=a},setOnDisplayFinished:function(a){this._dialog.onDisplayFinished=a},onDrag:function(){},onShow:function(){},onHidden:function(){},onClose:function(){}};var LayerTemplate={alert:'<table id="#{entity}"  class="gModLy">'+'<thead id="#{titleBar}">'+"<tr>"+'<td class="tbgleft"><div></div></td>'+'<td class="tdmain"><div class="gModLyHeader"><div class="gFl"><div class="gML_tit"><strong id="#{titleName}"></strong></div></div>'+'<div class="gFr"><ul><li><a href="javascript:;" id="#{btnClose}" class="iconClose"></a></li><li><a href="#" class="help" >帮助</a></li></ul></div></div></td>'+'<td class="tbgright"><div></div></td>'+"</tr>"+"</thead>"+"<tfoot>"+"<tr>"+'<td class="tbgleft"><div></div></td>'+'<td class="tdmain"></td>'+'<td class="tbgright"><div></div></td>'+"</tr>"+"</tfoot>"+"<tbody>"+"<tr>"+'<td class="tbgleft"><div></div></td>'+'<td class="tdmain" id="layer_2">'+'<div id="#{content}" class="gModLyCont">'+"<!-- 内容区域 -->"+'<div class="gDialogDoc">'+'<div class="diaBd">'+'<div class="gDiaC1"><img id="#{icon}" width="50" height="50" class="" src="http://simg.sinajs.cn/tiezi/images/icon/icon.gif" alt=""/></div>'+'<div class="gDiaC2">'+'<h5 id="#{text}"></h5>'+'<div id="#{subText}"></div>'+"<p/>"+"</div>"+"</div>"+'<div class="btnRow"><a class="gBtnb gBtnbClr" id="#{linkOk}" href="javascript:;"><cite id="#{btnOk}"><em id="#{ok}"></em></cite></a></div>'+"</div>"+"<!-- 内容区域 -->"+"</div>"+"</td>"+'<td class="tbgright"><div></div></td>'+"</tr>"+"</tbody>"+"</table>",confirm:'<table id="#{entity}"  class="gModLy">'+'<thead id="#{titleBar}">'+"<tr>"+'<td class="tbgleft"><div></div></td>'+'<td class="tdmain"><div class="gModLyHeader"><div class="gFl"><div class="gML_tit"><strong id="#{titleName}"></strong></div></div>'+'<div class="gFr"><ul><li><a href="javascript:;" id="#{btnClose}" class="iconClose"></a></li><li><a href="#" class="help" >帮助</a></li></ul></div></div></td>'+'<td class="tbgright"><div></div></td>'+"</tr>"+"</thead>"+"<tfoot>"+"<tr>"+'<td class="tbgleft"><div></div></td>'+'<td class="tdmain"></td>'+'<td class="tbgright"><div></div></td>'+"</tr>"+"</tfoot>"+"<tbody>"+"<tr>"+'<td class="tbgleft"><div></div></td>'+'<td class="tdmain" id="layer_2">'+'<div id="#{content}" class="gModLyCont">'+"<!-- 内容开始 -->"+'<div class="gDialogDoc">'+'<div class="diaBd">'+'<div class="gDiaC1"><img id="#{icon}" width="50" height="50" class="" src="http://simg.sinajs.cn/tiezi/images/icon/icon.gif" alt=""/></div>'+'<div class="gDiaC2">'+'<h5 id="#{text}"></h5>'+'<div id="#{subText}"></div>'+"<p/>"+"</div>"+"</div>"+'<div class="btnRow">'+'<a class="gBtnb gBtnbClr" id="#{linkOk}" href="javascript:;"><cite id="#{btnOk}"><em id="#{ok}"></em></cite></a>'+'<a class="gBtnb gBtnbClr" id="#{linkCancel}" href="javascript:;"><cite id="#{btnCancel}"><em id="#{cancel}"></em></cite></a>'+"</div>"+"</div>"+"<!-- 内容结束 -->"+"</div>"+"</td>"+'<td class="tbgright"><div></div></td>'+"</tr>"+"</tbody>"+"</table>",iframe:'<table id="#{entity}"  class="gModLy">'+'<thead id="#{titleBar}">'+"<tr>"+'<td class="tbgleft"><div></div></td>'+'<td class="tdmain"><div class="gModLyHeader"><div class="gFl"><div class="gML_tit"><strong id="#{titleName}"></strong></div></div>'+'<div class="gFr"><ul><li><a href="javascript:;" id="#{btnClose}" class="iconClose"></a></li><li><a href="#" class="help" >帮助</a></li></ul></div></div></td>'+'<td class="tbgright"><div></div></td>'+"</tr>"+"</thead>"+"<tfoot>"+"<tr>"+'<td class="tbgleft"><div></div></td>'+'<td class="tdmain"></td>'+'<td class="tbgright"><div></div></td>'+"</tr>"+"</tfoot>"+"<tbody>"+"<tr>"+'<td class="tbgleft"><div></div></td>'+'<td class="tdmain" id="layer_2">'+'<div id="#{content}" class="gModLyCont">'+'<div id="#{loadState}">Loading...</div>'+'<iframe style="width:100%;height:500px;" id="#{iframe}" src="#{iframeURL}"></iframe>'+"</div>"+"</td>"+'<td class="tbgright"><div></div></td>'+"</tr>"+"</tbody>"+"</table>",customs:'<table id="#{entity}"  class="gModLy">'+'<thead id="#{titleBar}">'+"<tr>"+'<td class="tbgleft"><div></div></td>'+'<td class="tdmain"><div class="gModLyHeader"><div class="gFl"><div class="gML_tit"><strong id="#{titleName}"></strong></div></div>'+'<div class="gFr"><ul><li><a href="javascript:;" id="#{btnClose}" class="iconClose"></a></li><li><a href="#" class="help" >帮助</a></li></ul></div></div></td>'+'<td class="tbgright"><div></div></td>'+"</tr>"+"</thead>"+"<tfoot>"+"<tr>"+'<td class="tbgleft"><div></div></td>'+'<td class="tdmain"></td>'+'<td class="tbgright"><div></div></td>'+"</tr>"+"</tfoot>"+"<tbody>"+"<tr>"+'<td class="tbgleft"><div></div></td>'+'<td class="tdmain" id="layer_2">'+'<div id="#{content}" class="gModLyCont">'+"<!-- 内容区域 -->"+"<!-- 内容区域 -->"+"</div>"+"</td>"+'<td class="tbgright"><div></div></td>'+"</tr>"+"</tbody>"+"</table>"};(function(){var a=function(a,b){this.template=b||{};DialogManager.backShadow=a};a.prototype={iconSet:{"01":{"class":"SG_icon SG_icon201",alt:"警告"},"02":{"class":"SG_icon SG_icon202",alt:"失败"},"03":{"class":"SG_icon SG_icon203",alt:"成功"},"04":{"class":"SG_icon SG_icon204",alt:"询问"},"06":{"class":"SG_icon SG_icon148",alt:"警告"}},alert:function(a,b,c){b=b||{};var d=DialogManager.create(b.template||this.template.alert||LayerTemplate.alert,c);var e=Core.System.winSize();var f=d.getNodes();d.onDisplaied=b["funcDisplaied"];d.onDisplayFinished=b["funcDisplayFinished"];d.setSize({width:b["width"],height:b["height"]});d.setFixed(true);this._setDialogMiddle(d);d.show();d.setAreaLocked(true);f.linkOk.focus();f.text.innerHTML=a;if(f.titleName){f.titleName.innerHTML=b["title"]||"提示"}if(f.icon){f.icon.className=b["icon"]?this.iconSet[b["icon"]]["class"]:this.iconSet["01"]["class"];f.icon.alt=b["icon"]?this.iconSet[b["icon"]]["alt"]:this.iconSet["01"]["alt"]}f.ok.innerHTML=b["textOk"]||"确定";if(f.subText){f.subText.innerHTML=b["subText"]||""}d.getProperty().focusNode=f.linkOk;Core.Events.addEvent(f.btnOk,function(){if(b["funcOk"]&&d.getProperty().enabled){b["funcOk"]();Core.Events.stopEvent()}d.close();return false},"click");Core.Events.addEvent(f.linkOk,function(){var a=Core.Events.getEvent();if(a.keyCode=="13"){if(b["funcOk"]&&d.getProperty().enabled){b["funcOk"]()}d.close()}},"keydown");Core.Events.addEvent(f.btnClose,function(){if(b["funcClose"]&&d.getProperty().enabled){b["funcClose"]()}d.close()},"click");Core.Events.addEvent(f.btnClose,function(){var a=Core.Events.getEvent();a.cancelBubble=true},"mousedown")},newAlert:function(a,b,c){b.template=this.template.newAlert;this.alert(a,b,c)},confirm:function(a,b,c){b=b||{};var d=DialogManager.create(b.template||this.template.confirm||LayerTemplate.confirm,c);var e=Core.System.winSize();var f=d.getNodes();d.onDisplaied=b["funcDisplaied"];d.onDisplayFinished=b["funcDisplayFinished"];d.setSize({width:b["width"],height:b["height"]});d.setFixed(true);this._setDialogMiddle(d);d.show();d.setAreaLocked(true);if(b["defaultButton"]==0){f.linkCancel.focus();d.getProperty().focusNode=f.linkCancel}else{f.linkOk.focus();d.getProperty().focusNode=f.linkOk}f.text.innerHTML=a;if(f.titleName){f.titleName.innerHTML=b["title"]||"提示"}if(f.icon){f.icon.className=b["icon"]?this.iconSet[b["icon"]]["class"]:this.iconSet["04"]["class"];f.icon.alt=b["icon"]?this.iconSet[b["icon"]]["alt"]:this.iconSet["04"]["alt"]}f.ok.innerHTML=b["textOk"]||"确定";f.cancel.innerHTML=b["textCancel"]||"取消";if(f.subText){f.subText.innerHTML=b["subText"]||""}Core.Events.addEvent(f.btnOk,function(){if(b["funcOk"]&&d.getProperty().enabled){b["funcOk"]();Core.Events.stopEvent()}d.close();return false},"click");Core.Events.addEvent(f.linkOk,function(){var a=Core.Events.getEvent();if(a.keyCode=="13"){if(b["funcOk"]&&d.getProperty().enabled){b["funcOk"]()}d.close()}},"keydown");Core.Events.addEvent(f.btnCancel,function(){if(b["funcCancel"]&&d.getProperty().enabled){b["funcCancel"]();Core.Events.stopEvent()}d.close();return false},"click");Core.Events.addEvent(f.linkCancel,function(){var a=Core.Events.getEvent();if(a.keyCode=="13"){if(b["funcCancel"]&&d.getProperty().enabled){b["funcCancel"]()}d.close()}},"keydown");Core.Events.addEvent(f.btnClose,function(){if(b["funcClose"]&&d.getProperty().enabled){b["funcClose"]();Core.Events.stopEvent()}d.close();return false},"click");Core.Events.addEvent(f.btnClose,function(){var a=Core.Events.getEvent();a.cancelBubble=true},"mousedown")},newConform:function(a,b,c){b.template=this.template.newConfirm;this.confirm(a,b,c)},showIframe:function(a,b){a=a||{};var c=DialogManager.create(this.template.iframe||LayerTemplate.iframe,b);var d=Core.System.winSize();var e=c.getNodes();c.setSize({width:a["width"]||320,height:a["height"]||150});var f=d.width/2-c.getProperty().width/2<0?0:d.width/2-c.getProperty().width/2;var g=d.height/2-c.getProperty().height/2<0?0:d.height/2-c.getProperty().height/2;if(a["fixed"]){c.setPosition({x:f,y:g})}else{c.setPosition({x:f+document.documentElement.scrollLeft,y:g+document.documentElement.scrollTop})}if(!$IE6){c.getProperty().displayMode="alpha"}c.setFixed(!!a.fixed);c.show();c.setAreaLocked(true);e.titleName.innerHTML=a["title"]||"";e.iframe.src=a["url"]||"about:blank";Core.Events.addEvent(e.iframe,function(){e.iframe.style.display="";e.loadState.style.display="none"},"load");Core.Events.addEvent(e.btnClose,function(){c.close()},"click");Core.Events.addEvent(e.btnClose,function(){var a=Core.Events.getEvent();a.cancelBubble=true},"mousedown")},createCustomsDialog:function(a,b){a=a||{};var c=new CustomsDialog(a.tpl||this.template.customs||LayerTemplate.customs,b);a.content&&c.setContent(a.content);c.setTitle(a.title||"提示");c.setHelp(a.help||"");c.setClose("hidden");c.setOnDisplaied(a["funcDisplaied"]);c.setOnDisplayFinished(a["funcDisplayFinished"]);return c},getDialog:function(a){return DialogManager.getDialog(a)},close:function(a){DialogManager.close(a)},_setDialogMiddle:function(a){var b=Core.System.winSize();var c=a.getNodes();var d,e;var f=a.entity.style.display;a.setPosition({x:-1e4});a.entity.style.display="";var g=c.titleBar?c.titleBar.offsetHeight:0;var h=b.height-c.content.offsetHeight-g;var i=(Math.sqrt(5)-1)/2;var j=1;var k=h*i/(i+j);d=b.width/2-c.content.offsetWidth/2;d=d<0?0:d;e=k<0?0:k;if(!a.getProperty().isFixed){d=d+document.documentElement.scrollLeft;e=e+document.documentElement.scrollTop}a.entity.style.display=f;a.setPosition({x:d,y:e})}};Sina.Ui.WindowDialog=a})();Core.String.expand=function(a){var b=a.replace(/([\u00ff-\ufffe])/gi,"￿$1");return b};Core.String.collapse=function(a){return a.replace(/\uffff/gi,"")};scope.searchFilm=function(a){var b=$E("loginBarSearchForm");var c=b.action;var d=$E("loginBarSearchT");var e=$E("loginBarSearchS");var f=$E("loginBarSearchTS");var g=$E("loginBarSearchType");var h=$E("loginBarSearchSType");var i=$E("loginBarSearchInput");var j={url:c,loginBarSearchT:d.value,loginBarSearchS:e.value,loginBarSearchS:e.value,loginBarSearchType:g.value,loginBarSearchSType:h.value,loginBarSearchInput:i.value};i.value="影评 "+a;d.value="blog";h.value="tag";b.action="http://uni.sina.com.cn/c.php";b.submit();b.action=j["url"];d.value=j["loginBarSearchT"];e.value=j["loginBarSearchS"];e.value=j["loginBarSearchS"];g.value=j["loginBarSearchType"];h.value=j["loginBarSearchSType"];i.value=j["loginBarSearchInput"]};$registComp(122,{getLatestComm:new Interface("http://control.blog.sina.com.cn/riaapi/film/get_latest_filmcomment.php","jsload"),load:function(){this.getLatestComm.request({onSuccess:Core.Function.bind2(function(a){trace("---------ok----------");this.cacheData=a;this.toHTML(this.cacheData)},this),onError:Core.Function.bind2(function(a){trace("---------error----------");this.showError(a.code)},this),onFail:Core.Function.bind2(function(a){this.showError($SYSMSG.A80101)},this)})},toHTML:function(a){function j(a,b){a=Core.String.expand(a);if(a.length<=b){b=a.length-1}a=a.substr(0,b)+" "+a.substr(b);a=Core.String.collapse(a);return a}function k(a,b){var c=Core.String.expand(a);if(c.length>b){c=c.substr(0,b)}c=Core.String.collapse(c);return c}var b=a;if(a.length==0){this.handleEmpty();return}var c=11,d=12;for(var e=0,f=a.length;e<f;e++){var g=a[e]["filmname"];a[e]["filmname_limit"]=g;for(var h=0,i=a[e]["comment"].length;h<i;h++){a[e]["comment"][h].title_limit=k(a[e]["comment"][h].title,d)}a[e]["num"]=Core.String.formatNumber(a[e]["num"])}var l="";for(var m=0,n=a.length;m<n;m++){var o=a[m].type==2?"movie":"tv";var p="http://data.ent.sina.com.cn/"+o+"/"+a[m]["filmid"]+".html";var g=a[m]["filmname"],q=a[m]["filmname_limit"];var r=a[m]["imgurl"],s=a[m]["num"];l+=['<li class="cur">','<a href="'+p+'" target="_blank" title="'+g+'"><img alt="'+g+'" src="'+r+'"></a>',"<p>共"+'<strong><a href="javascript:void(0);" onclick="scope.searchFilm(\''+g+"')\">"+s+"</a></strong>篇</p>","<ul>"].join("");for(var t=0,u=a[m]["comment"].length;t<u;t++){l+='<li><a title="'+a[m]["comment"][t].title+'" href="'+a[m]["comment"][t].url+'" target="_blank">'+a[m]["comment"][t].title_limit+"</a></li>"}var v=m==n-1?"":'<div class="SG_j_linedot"></div>';l+=["</ul>",v,'<div class="clearit"></div>',"</li>"].join("")}var w=['<div class="hotmovies">',"<ul>",l,"</ul>",'</div><div class="clearit"></div>'].join("");this.setContent(w)},handleEmpty:function(){trace("没有最新影评数据");var a=['<div class="SG_nodata">',"<p>还没有影评。</p>","</div>"].join("");this.setContent(a)}},"dynamic");Lib.Component.renderByList=function(a){Core.Array.foreach(a,function(a){try{if($E("module_"+a)!=null){var b=Lib.Component.instances[a]||new Lib.Component["Comp_"+a](a);if(b.size!=null&&b.load!=null){b.size=Lib.Component.compSize[a];try{b.load()}catch(c){}Debug.log("组件："+a+" 初始化成功")}else{Debug.error("组件："+a+" 初始化失败，组件尺寸信息不存在")}}else{Debug.error("组件："+a+" 初始化失败，页面内缺少组件的HTML节点")}}catch(c){Debug.error(c.message||"组件："+a+" 初始化失败，请确认该组件类是否定义过")}finally{}})};Lib.Component.lazyRenderByList=function(a){var b=[];Core.Array.foreach(a,function(a){try{if($E("module_"+a)!=null){var c=Lib.Component.instances[a]||new Lib.Component["Comp_"+a](a);if(c.size!=null&&c.load!=null){c.size=Lib.Component.compSize[a];try{b.push({dom:$E("module_"+a),callback:Lib.Component.instances[a].load.bind2(Lib.Component.instances[a])})}catch(d){}Debug.log("组件："+a+" 初始化成功")}else{Debug.error("组件："+a+" 初始化失败，组件尺寸信息不存在")}}else{Debug.error("组件："+a+" 初始化失败，页面内缺少组件的HTML节点")}}catch(d){Debug.error(d.message||"组件："+a+" 初始化失败，请确认该组件类是否定义过")}finally{}});Lib.LazyLoad(b,{})};$registJob("articleComp1",function(){var a=[901,102,122];if(Lib.Component.getInitCompSize()==null){Debug.error("无法获得页面内组件的尺寸，请检查页面内输出的组件配置信息是否存在。。。");return}trace("文章页组件渲染列表: "+a.toString());Lib.Component.renderByList(a)});$registJob("articleComp2",function(){var a=[903,904,909,47];if(Lib.Component.getInitCompSize()==null){Debug.error("无法获得页面内组件的尺寸，请检查页面内输出的组件配置信息是否存在。。。");return}trace("文章页组件渲染列表: "+a.toString());Lib.Component.lazyRenderByList(a)});Ui.Pagination={config:{pageNode:null,nodeClassNamePrefix:"CP",curPage:1,maxPage:1,minPage:1,pageTpl:"@page@.html",type:1,showPrevNext:true,viewSize:5,dotIsPage:false,dotRate:5,showGoto:false,countTpl:"",language:"zh-cn",theme:1,showLastPage:true,showTotal:false},_list:{},_resource:{"en-us":["Pages (@data@): ","Go to First Page","Go to Previous Page (@data@)","Go to Page @data@","Go to Next Page (@data@)","Go to Last Page","Current Page in View"],"zh-cn":["共 @data@ 页","跳转至第一页","跳转至前 @data@ 页","跳转至第 @data@ 页","跳转至后 @data@ 页","跳转至最后一页","当前所在页"]},_template:'<li class="#{class}" title="#{title}">#{link}</li>',init:function(a){var b=$E(a.pageNode);if(b==null){trace("分页指定的父容器不存在");return}Ui.Pagination._list[b.id]={};var c=Ui.Pagination._list[b.id];for(var d in this.config){c[d]=a[d]===undefined?this.config[d]:a[d]}if(c.type==2){c.viewSize=4}c.minPage=Math.min(c.minPage,c.maxPage)*1;c.maxPage=Math.max(c.minPage,c.maxPage)*1;c.curPage=c.curPage>c.maxPage?c.minPage:c.curPage;c.curPage=c.curPage*1;if(c.curPage+c.viewSize>=100){c.viewSize=3}this._cache_node=c;return this},show:function(a,b){b=b*1;var c=this._cache_node;if(a!=null){this._cache_node=c=Ui.Pagination._list[a.id];c.curPage=b}var d=[];if(c.viewSize*2+1>=c.maxPage){d[1]=c.minPage;d[2]=c.maxPage}else if(c.curPage<=c.minPage+c.viewSize){d[1]=c.minPage;d[2]=c.minPage+(c.viewSize*2-1);d[3]=c.maxPage}else if(c.curPage>=c.maxPage-c.viewSize){d[0]=c.minPage;d[1]=c.maxPage-(c.viewSize*2-1);d[2]=c.maxPage}else{d[0]=c.minPage;d[1]=c.curPage-(c.viewSize-1);d[2]=c.curPage+(c.viewSize-1);d[3]=c.maxPage}var e=[];if(c.countTpl!=null){e.push(this._createPage("","","","",c.countTpl))}if(c.type!=2&&c.curPage!=c.minPage){if(c.type==3)e.push(this._createPage(c.nodeClassNamePrefix+"_s_pgprev",c.curPage-1,3,c.curPage-1,"上页"));else e.push(this._createPage(c.nodeClassNamePrefix+"_pgprev",c.curPage-1,3,c.curPage-1,"< 上一页"))}if(c.type!=3){if(d[0]!=null){var f=d[0]==c.curPage?this._createPage(c.nodeClassNamePrefix+"_pgon",1,6,"",d[0]):this._createPage("",1,1,d[0],d[0]);e.push(f)}if(c.type==1&&d[0]!=null){e.push(this._createPage(c.nodeClassNamePrefix+"_pgelip","","","","..."))}for(var g=d[1];g<=d[2];g++){if(g==d[1]&&g!=c.minPage&&c.type==2){var h=c.curPage-c.dotRate;h=h<c.minPage?c.minPage:h;e.push(this._createPage(c.nodeClassNamePrefix+"_pgelip",c.viewSize+1,2,c.curPage-c.viewSize-1,"..."))}else if(g==d[2]&&g!=c.maxPage&&c.type==2){var i=c.curPage+c.dotRate;i=i>c.maxPage?c.maxPage:i;e.push(this._createPage(c.nodeClassNamePrefix+"_pgelip",c.viewSize+1,4,c.curPage+c.viewSize+1,"..."))}else{f=g==c.curPage?this._createPage(c.nodeClassNamePrefix+"_pgon",1,6,"",g):this._createPage("",g,3,g,g);e.push(f)}}if(c.type==1&&d[3]!=null){e.push(this._createPage(c.nodeClassNamePrefix+"_pgelip","","","","..."))}if(d[3]!=null&&c.showLastPage){f=d[3]==c.curPage?this._createPage(c.nodeClassNamePrefix+"_pgon",c.curPage-1,3,"",d[3]):this._createPage("",1,5,d[3],d[3]);e.push(f)}}else{e.push(this._createPage(c.nodeClassNamePrefix+"_s_pgnum","","","","<strong>"+c.curPage+"</strong>/"+c.maxPage))}if(c.type!=2&&c.curPage!=c.maxPage){if(c.type==3)e.push(this._createPage(c.nodeClassNamePrefix+"_s_pgnext",c.curPage+1,3,c.curPage+1,"下页"));else e.push(this._createPage(c.nodeClassNamePrefix+"_pgnext",c.curPage+1,3,c.curPage+1,"下一页 >"))}if(c.showTotal==true){e.push(this._createPage(c.nodeClassNamePrefix+"_pgttl","","","","共"+c.maxPage+"页"))}$E(c.pageNode).innerHTML='<ul class="'+c.nodeClassNamePrefix+'_pages">'+e.join("")+"</ul>"},_createPage:function(a,b,c,d,e){if(e==""){return""}var f=b===""||c==""?"":this._getTips(b,c);var g=d!==""?"<a "+this._getUrl(d)+">"+e+"</a>":e;return this._template.replace(/(#\{\w+\})/g,function(b,c){switch(c){case"#{class}":return a;case"#{title}":return f;case"#{link}":return g}})},showPage:function(a,b){this._cache_node=Ui.Pagination._list[a];var c=this._cache_node.pageTpl(b);if(c!=false){Ui.Pagination.show($E(a),b)}},_getUrl:function(a){if(typeof this._cache_node.pageTpl=="string"){return'href="'+this._cache_node.pageTpl.replace(/@page@/,a)+'"'}else{return"href=\"javascript:Ui.Pagination.showPage('"+this._cache_node.pageNode+"',"+a+');"'}},_getTips:function(a,b){return this._resource[this._cache_node.language][b].replace(/@data@/g,a)}};var CommentV2={};Utils.Json={eval:function(str){return eval("("+str+")")},flatten:function(a){var b=Utils.Json;if(a==null)return null;else if(a.constructor.toString()==String)return b.str2json(a);else if(a.constructor.toString()==Array)return b.arr2json(a);else if(a.constructor.toString()==Object)return b.obj2json(a);else if(a.constructor.toString()==Boolean)return b.bool2json(a);else if(a.constructor.toString()==Number)return b.num2json(a);else if(a.constructor.toString()==Date)return b.date2json(a);else return null},arr2json:function(a){var b=Utils.Json;var c=[];var d=a.length;var e;for(var f=0;f<d;++f){e=b.flatten(a[f]);if(e)c.push(e)}return"["+c.join(",")+"]"},obj2json:function(a){var b=Utils.Json;var c=[];var d;for(var e in a){d=b.flatten(a[e]);if(d)c.push(b.flatten(e)+":"+d)}return"{"+c.join(",")+"}"},date2json:function(a){function b(a){return a<10?"0"+a:a}return'"'+a.getFullYear()+"-"+b(a.getMonth()+1)+"-"+b(a.getDate())+"T"+b(a.getHours())+":"+b(a.getMinutes())+":"+b(a.getSeconds())+'"'},num2json:function(a){return a?String(a):"0"},bool2json:function(a){return String(a)},str2json:function(a){var b={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};if(/["\\\x00-\x1f]/.test(a)){return'"'+a.replace(/([\x00-\x1f\\"])/g,function(a,c){var d=b[c];if(d)return d;d=c.charCodeAt();return"\\u00"+Math.floor(d/16).toString(16)+(d%16).toString(16)})+'"'}return'"'+a+'"'}};$SYSMSG.extend({B36001:"操作失败，此博文不存在或被删除。",B36002:"验证码错误，请重新输入。",B36003:"请输入昵称。",B36004:"登录名或密码错误。",B36005:"呢称不能使用此类特殊词汇，请重新输入。",B36006:"昵称必须是8个中文或16个字符以内，且不能为纯数字，请重新输入。",B36007:"呢称不能使用此类特殊词汇，请重新输入。",B36008:"不能3秒内连续发评论，请梢后再试。",B36009:"不能发内容重复的评论。",B36020:"暂无评论。",B36021:"暂无评论。",B36022:"评论内容必须是1000中文或2000字符以内，请重新输入。",B36023:"对不起，黑名单已达到上限",B36024:"对方拒绝了你的评论。",B36031:"操作失败，此评论不存在或被删除。",B36032:"操作失败，此评论不存在或被删除。",B36033:"操作失败，此评论不存在或被删除。",B36041:"请输入回复内容。",B36042:"回复内容必须是1000中文或2000字符以内，请重新输入。",B36043:"操作失败，自己不能回复自己的评论。",B36101:"操作失败，此博文不存在或被删除。",B36102:"评论发布失败，此博文设置不允许评论。",B36103:"操作失败，此评论不存在或被删除。",B36104:"评论已发布，需要审核后才能显示，请稍候…",B36113:"博主已关闭匿名评论，请登录后再评论",B36105:"请输入评论内容。",B36106:"请输入验证码。",B36107:"请输入登录名。",B36108:"请输入密码。",B36109:"读取中，请稍候…",B36110:"读取失败，请刷新。",B36111:"确定要删除此评论吗？删除后不可恢复。",B36112:"确定要删除此回复吗？删除后不可恢复。",B36201:"确定要删除此评论吗？删除后不可恢复。",B36202:"确定要删除此回复吗？删除后不可恢复。",B36203:"请选择要删除的内容。",B36204:"已回复该评论，请勿重复提交。",B36998:"系统维护中，服务暂不可用",B36999:"对不起，您短时间发表的评论过多，请多休息会，注意身体！感谢您对新浪博客的支持和关注！",36999:"对不起，您短时间发表的评论过多，请多休息会，注意身体！感谢您对新浪博客的支持和关注！",A20013:"您已经发送多条相似内容了哦，请先休息一下吧~",A20014:"已经有很多博主发过相似评论了，换个内容会更精彩~",B36205:"请登录后在回复评论",B36206:"对不起，您已被对方列入黑名单，无法发评论。",B36207:"请登录后在删除评论",B36208:"评论内容必须是140中文或280字符以内，请重新输入",B36209:"此条评论已被原博主删除",B36210:"博主已关闭评论功能",B36211:"此博文已被博主设为私密",A00004:"此评论不存在或已被博主删除",A00011:"请登录后再进行评论"});CommentV2.List=function(a){this.containerNode="",this.type="",this.operation="",this.data="",this.page=1,this.total=0,this.url="";this.trim=Core.String.trim;this.jsonUtil=Utils.Json;this.init(a)}.$define({init:function(a){trace("super init");this.__merge(a);this.load(this.page)},__merge:function(a){for(var b in a){this[b]=a[b]}},load:function(a){},render:function(){},bindEvent:function(){var a=this;if(!scope.commentlistIsBind){this.addEvent(this.containerNode,a.delegate.bind2(a),"click");this.onListener()}scope.commentlistIsBind=true},delegate:function(a){trace("CommentV2.CommentList.delegate");a=a||window.event;var b=a.target||a.srcElement;var c,d,e,f,g;c=this.getTarget(b,this.containerNode);if(c){d=this.getType(c);if(d){e=d.split("_")[0];f=d.split("_")[1];g=this.str2obj(this.getData(c));if(e=="comment"){var h=$E("comment_"+g.commentid);this[f]({type:e,operation:f,articleid:scope.$articleid,data:g,containerNode:h,node:c})}else{var h=$E("reply_"+g.replyid);this.replyList[g.commentid][f]({type:e,operation:f,articleid:scope.$articleid,data:g,containerNode:h,node:c})}}}},onListener:function(){Lib.Listener.on({name:"commentlist-commentadd",callBack:this.add,scope:this})},removeEvent:function(){trace("CommentV2.CommentList.removeEvent");this.removeEvent(this.containerNode,this.delegate,"click")},toggle:function(){this.isDisplay()?this.hide():this.show()},show:function(){this.containerNode.style.display=""},hide:function(){this.containerNode.style.display="none"},isDisplay:function(){return this.containerNode?this.containerNode.style.display!=="none":false},error:function(a){this.containerNode.innerHTML='<li class="CP_litem"><div class="CP_cmt_none">'+$SYSMSG[a]+"</div></li>"},paging:function(){},add:function(){},del:function(){},report:function(){},reply:function(){},share:function(){},obj2str:function(a){return encodeURIComponent(this.jsonUtil.flatten(a))},str2obj:function(a){return this.jsonUtil.eval(decodeURIComponent(a))},getTarget:function(a,b){while(a&&a!==b){if(a.tagName.toLowerCase()=="a"){return a}a=a.parentNode}return null},getType:function(a){return a&&a.getAttribute("action-type")},getData:function(a){return a&&a.getAttribute("action-data")}});Core.Dom.getElementsByAttr=function(a,b,c){var d=[];for(var e=0,f=a.childNodes.length;e<f;e++){if(a.childNodes[e].nodeType==1){if(a.childNodes[e].getAttribute(b)==c){d.push(a.childNodes[e])}if(a.childNodes[e].childNodes.length>0){d=d.concat(arguments.callee.call(null,a.childNodes[e],b,c))}}}return d};(function(){var a={},b=document.selection;a.selectionStart=function(a){if(!b){try{return a.selectionStart}catch(c){return 0}}var d=b.createRange(),e,f,g=0;var h=document.body.createTextRange();try{h.moveToElementText(a)}catch(c){}for(g;h.compareEndPoints("StartToStart",d)<0;g++){h.moveStart("character",1)}return g};a.selectionBefore=function(b){return b.value.slice(0,a.selectionStart(b))};a.selectText=function(a,c,d){a.focus();if(!b){a.setSelectionRange(c,d);return}var e=a.createTextRange();e.collapse(1);e.moveStart("character",c);e.moveEnd("character",d-c);e.select()};a.insertText=function(c,d,e,f){c.focus();f=f||0;if(!b){var g=c.value,h=e-f,i=h+d.length;c.value=g.slice(0,h)+d+g.slice(e,g.length);a.selectText(c,i,i);return}var j=b.createRange();j.moveStart("character",-f);j.text=d};a.replaceText=function(c,d){c.focus();var e=c.value;var f=a.getSelectedText(c);var g=f.length;if(f.length==0){a.insertText(c,d,a.getCursorPos(c))}else{var h=a.getCursorPos(c);if(b){var i=b.createRange();i.text=d;a.setCursor(c,h+d.length)}else{var j=h+f.length;c.value=e.slice(0,h)+d+e.slice(h+g,e.length);a.setCursor(c,h+d.length);return}}};a.getCursorPos=function(a){var c=0;if($IE){a.focus();var d=null;d=b.createRange();var e=d.duplicate();e.moveToElementText(a);e.setEndPoint("EndToEnd",d);a.selectionStartIE=e.text.length-d.text.length;a.selectionEndIE=a.selectionStartIE+d.text.length;c=a.selectionStartIE}else if(a.selectionStart||a.selectionStart=="0"){c=a.selectionStart}return c};a.getSelectedText=function(a){var c="";var d=function(a){if(a.selectionStart!=undefined&&a.selectionEnd!=undefined)return a.value.substring(a.selectionStart,a.selectionEnd);else return""};if(window.getSelection){c=d(a)}else{c=b.createRange().text}return c};a.setCursor=function(a,b,c){b=b==null?a.value.length:b;c=c==null?0:c;a.focus();if(a.createTextRange){var d=a.createTextRange();d.move("character",b);d.moveEnd("character",c);d.select()}else{a.setSelectionRange(b,b+c)}};a.unCoverInsertText=function(a,b,c){c=c==null?{}:c;c.rcs=c.rcs==null?a.value.length:c.rcs*1;c.rccl=c.rccl==null?0:c.rccl*1;var d=a.value,e=d.slice(0,c.rcs),f=d.slice(c.rcs+c.rccl,d==""?0:d.length);a.value=e+b+f;this.setCursor(a,c.rcs+(b==null?0:b.length))};CommentV2.TextAreaUtils=a})();window.WEIBOFACEDATA=[{phrase:"[草泥马]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/7a/shenshou_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/7a/shenshou_thumb.gif",value:"[草泥马]",picid:""},{phrase:"[神马]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/60/horse2_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/60/horse2_thumb.gif",value:"[神马]",picid:""},{phrase:"[浮云]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/bc/fuyun_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/bc/fuyun_thumb.gif",value:"[浮云]",picid:""},{phrase:"[给力]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/c9/geili_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/c9/geili_thumb.gif",value:"[给力]",picid:""},{phrase:"[围观]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/f2/wg_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/f2/wg_thumb.gif",value:"[围观]",picid:""},{phrase:"[威武]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/70/vw_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/70/vw_thumb.gif",value:"[威武]",picid:""},{phrase:"[熊猫]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/6e/panda_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/6e/panda_thumb.gif",value:"[熊猫]",picid:""},{phrase:"[兔子]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/81/rabbit_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/81/rabbit_thumb.gif",value:"[兔子]",picid:""},{phrase:"[奥特曼]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/bc/otm_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/bc/otm_thumb.gif",value:"[奥特曼]",picid:""},{phrase:"[囧]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/15/j_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/15/j_thumb.gif",value:"[囧]",picid:""},{phrase:"[互粉]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/89/hufen_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/89/hufen_thumb.gif",value:"[互粉]",picid:""},{phrase:"[礼物]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/c4/liwu_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/c4/liwu_thumb.gif",value:"[礼物]",picid:""},{phrase:"[呵呵]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/ac/smilea_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/ac/smilea_thumb.gif",value:"[呵呵]",picid:""},{phrase:"[嘻嘻]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/0b/tootha_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/0b/tootha_thumb.gif",value:"[嘻嘻]",picid:""},{phrase:"[哈哈]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/6a/laugh.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/6a/laugh.gif",value:"[哈哈]",picid:""},{phrase:"[可爱]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/14/tza_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/14/tza_thumb.gif",value:"[可爱]",picid:""},{phrase:"[可怜]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/af/kl_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/af/kl_thumb.gif",value:"[可怜]",picid:""},{phrase:"[挖鼻屎]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/a0/kbsa_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/a0/kbsa_thumb.gif",value:"[挖鼻屎]",picid:""},{phrase:"[吃惊]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/f4/cj_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/f4/cj_thumb.gif",value:"[吃惊]",picid:""},{phrase:"[害羞]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/6e/shamea_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/6e/shamea_thumb.gif",value:"[害羞]",picid:""},{phrase:"[挤眼]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/c3/zy_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/c3/zy_thumb.gif",value:"[挤眼]",picid:""},{phrase:"[闭嘴]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/29/bz_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/29/bz_thumb.gif",value:"[闭嘴]",picid:""},{phrase:"[鄙视]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/71/bs2_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/71/bs2_thumb.gif",value:"[鄙视]",picid:""},{phrase:"[爱你]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/6d/lovea_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/6d/lovea_thumb.gif",value:"[爱你]",picid:""},{phrase:"[泪]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/9d/sada_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/9d/sada_thumb.gif",value:"[泪]",picid:""},{phrase:"[偷笑]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/19/heia_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/19/heia_thumb.gif",value:"[偷笑]",picid:""},{phrase:"[亲亲]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/8f/qq_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/8f/qq_thumb.gif",value:"[亲亲]",picid:""},{phrase:"[生病]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/b6/sb_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/b6/sb_thumb.gif",value:"[生病]",picid:""},{phrase:"[太开心]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/58/mb_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/58/mb_thumb.gif",value:"[太开心]",picid:""},{phrase:"[懒得理你]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/17/ldln_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/17/ldln_thumb.gif",value:"[懒得理你]",picid:""},{phrase:"[右哼哼]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/98/yhh_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/98/yhh_thumb.gif",value:"[右哼哼]",picid:""},{phrase:"[左哼哼]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/6d/zhh_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/6d/zhh_thumb.gif",value:"[左哼哼]",picid:""},{phrase:"[嘘]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/a6/x_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/a6/x_thumb.gif",value:"[嘘]",picid:""},{phrase:"[衰]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/af/cry.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/af/cry.gif",value:"[衰]",picid:""},{phrase:"[委屈]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/73/wq_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/73/wq_thumb.gif",value:"[委屈]",picid:""},{phrase:"[吐]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/9e/t_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/9e/t_thumb.gif",value:"[吐]",picid:""},{phrase:"[打哈欠]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/f3/k_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/f3/k_thumb.gif",value:"[打哈欠]",picid:""},{phrase:"[抱抱]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/27/bba_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/27/bba_thumb.gif",value:"[抱抱]",picid:""},{phrase:"[怒]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/7c/angrya_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/7c/angrya_thumb.gif",value:"[怒]",picid:""},{phrase:"[疑问]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/5c/yw_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/5c/yw_thumb.gif",value:"[疑问]",picid:""},{phrase:"[馋嘴]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/a5/cza_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/a5/cza_thumb.gif",value:"[馋嘴]",picid:""},{phrase:"[拜拜]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/70/88_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/70/88_thumb.gif",value:"[拜拜]",picid:""},{phrase:"[思考]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/e9/sk_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/e9/sk_thumb.gif",value:"[思考]",picid:""},{phrase:"[汗]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/24/sweata_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/24/sweata_thumb.gif",value:"[汗]",picid:""},{phrase:"[困]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/7f/sleepya_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/7f/sleepya_thumb.gif",value:"[困]",picid:""},{phrase:"[睡觉]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/6b/sleepa_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/6b/sleepa_thumb.gif",value:"[睡觉]",picid:""},{phrase:"[钱]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/90/money_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/90/money_thumb.gif",value:"[钱]",picid:""},{phrase:"[失望]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/0c/sw_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/0c/sw_thumb.gif",value:"[失望]",picid:""},{phrase:"[酷]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/40/cool_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/40/cool_thumb.gif",value:"[酷]",picid:""},{phrase:"[花心]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/8c/hsa_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/8c/hsa_thumb.gif",value:"[花心]",picid:""},{phrase:"[哼]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/49/hatea_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/49/hatea_thumb.gif",value:"[哼]",picid:""},{phrase:"[鼓掌]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/36/gza_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/36/gza_thumb.gif",value:"[鼓掌]",picid:""},{phrase:"[晕]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/d9/dizzya_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/d9/dizzya_thumb.gif",value:"[晕]",picid:""},{phrase:"[悲伤]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/1a/bs_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/1a/bs_thumb.gif",value:"[悲伤]",picid:""},{phrase:"[抓狂]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/62/crazya_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/62/crazya_thumb.gif",value:"[抓狂]",picid:""},{phrase:"[黑线]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/91/h_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/91/h_thumb.gif",value:"[黑线]",picid:""},{phrase:"[阴险]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/6d/yx_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/6d/yx_thumb.gif",value:"[阴险]",picid:""},{phrase:"[怒骂]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/89/nm_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/89/nm_thumb.gif",value:"[怒骂]",picid:""},{phrase:"[心]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/40/hearta_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/40/hearta_thumb.gif",value:"[心]",picid:""},{phrase:"[伤心]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/ea/unheart.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/ea/unheart.gif",value:"[伤心]",picid:""},{phrase:"[猪头]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/58/pig.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/58/pig.gif",value:"[猪头]",picid:""},{phrase:"[ok]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/d6/ok_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/d6/ok_thumb.gif",value:"[ok]",picid:""},{phrase:"[耶]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/d9/ye_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/d9/ye_thumb.gif",value:"[耶]",picid:""},{phrase:"[good]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/d8/good_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/d8/good_thumb.gif",value:"[good]",picid:""},{phrase:"[不要]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/c7/no_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/c7/no_thumb.gif",value:"[不要]",picid:""},{phrase:"[赞]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/d0/z2_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/d0/z2_thumb.gif",value:"[赞]",picid:""},{phrase:"[来]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/40/come_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/40/come_thumb.gif",value:"[来]",picid:""},{phrase:"[弱]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/d8/sad_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/d8/sad_thumb.gif",value:"[弱]",picid:""},{phrase:"[蜡烛]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/91/lazu_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/91/lazu_thumb.gif",value:"[蜡烛]",picid:""},{phrase:"[钟]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/d3/clock_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/d3/clock_thumb.gif",value:"[钟]",picid:""},{phrase:"[话筒]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/1b/m_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/1b/m_thumb.gif",value:"[话筒]",picid:""},{phrase:"[蛋糕]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/6a/cake.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/6a/cake.gif",value:"[蛋糕]",picid:""},{phrase:"[微博益起来]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/95/yiqilai_org.gif",hot:true,common:false,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/95/yiqilai_thumb.gif",value:"[微博益起来]",picid:""},{phrase:"[微公益爱心]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/11/lxhgongyi_org.gif",hot:true,common:false,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/11/lxhgongyi_thumb.gif",value:"[微公益爱心]",picid:""},{phrase:"[笑哈哈]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/32/lxhwahaha_org.gif",hot:true,common:false,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/32/lxhwahaha_thumb.gif",value:"[笑哈哈]",picid:""},{phrase:"[转发]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/02/lxhzhuanfa_org.gif",hot:true,common:false,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/02/lxhzhuanfa_thumb.gif",value:"[转发]",picid:""},{phrase:"[得意地笑]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/d4/lxhdeyidixiao_org.gif",hot:true,common:false,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/d4/lxhdeyidixiao_thumb.gif",value:"[得意地笑]",picid:""},{phrase:"[moc转发]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/cb/moczhuanfa_org.gif",hot:true,common:false,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/cb/moczhuanfa_thumb.gif",value:"[moc转发]",picid:""},{phrase:"[劲能样]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/f4/jingnengyang_org.gif",hot:true,common:false,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/f4/jingnengyang_thumb.gif",value:"[劲能样]",picid:""},{phrase:"[bm可爱]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/95/bmkeai_org.gif",hot:true,common:false,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/95/bmkeai_thumb.gif",value:"[bm可爱]",picid:""},{phrase:"[xkl转圈]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/f4/xklzhuanquan_org.gif",hot:true,common:false,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/f4/xklzhuanquan_thumb.gif",value:"[xkl转圈]",picid:""},{phrase:"[ppb鼓掌]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/7e/ppbguzhang_org.gif",hot:true,common:false,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/7e/ppbguzhang_thumb.gif",value:"[ppb鼓掌]",picid:""},{phrase:"[din推撞]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/dd/dintuizhuang_org.gif",hot:true,common:false,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/dd/dintuizhuang_thumb.gif",value:"[din推撞]",picid:""},{phrase:"[xb压力]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/e0/xbyali_org.gif",hot:true,common:false,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/e0/xbyali_thumb.gif",value:"[xb压力]",picid:""},{phrase:"[放假啦]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/37/lxhfangjiale_org.gif",hot:true,common:false,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/37/lxhfangjiale_thumb.gif",value:"[放假啦]",picid:""},{phrase:"[国旗]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/dc/flag_org.gif",hot:true,common:false,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/dc/flag_thumb.gif",value:"[国旗]",picid:""},{phrase:"[带着微博去旅行]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/f5/weitripballoon_org.gif",hot:true,common:false,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/f5/weitripballoon_thumb.gif",value:"[带着微博去旅行]",picid:""},{phrase:"[玩去啦]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/92/weitrip_org.gif",hot:true,common:false,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/92/weitrip_thumb.gif",value:"[玩去啦]",picid:""},{phrase:"[ali哇]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/de/aliwanew_org.gif",hot:true,common:false,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/de/aliwanew_thumb.gif",value:"[ali哇]",picid:""},{phrase:"[酷库熊顽皮]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/46/kxwanpi_org.gif",hot:true,common:false,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/46/kxwanpi_thumb.gif",value:"[酷库熊顽皮]",picid:""},{phrase:"[BOBO爱你]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/74/boaini_org.gif",hot:true,common:false,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/74/boaini_thumb.gif",value:"[BOBO爱你]",picid:""},{phrase:"[偷乐]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/fa/lxhtouxiao_org.gif",hot:true,common:false,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/fa/lxhtouxiao_thumb.gif",value:"[偷乐]",picid:""},{phrase:"[泪流满面]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/64/lxhtongku_org.gif",hot:true,common:false,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/64/lxhtongku_thumb.gif",value:"[泪流满面]",picid:""},{phrase:"[lt切克闹]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/73/ltqiekenao_org.gif",hot:true,common:false,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/73/ltqiekenao_thumb.gif",value:"[lt切克闹]",picid:""},{phrase:"[江南style]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/67/gangnamstyle_org.gif",hot:true,common:false,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/67/gangnamstyle_thumb.gif",value:"[江南style]",picid:""}];if(document.documentElement.contains){Core.Dom.contains=function(a,b){return a.contains?a.contains(b):true}}else if(document.documentElement.compareDocumentPosition){Core.Dom.contains=function(a,b){return a===b||!!(a.compareDocumentPosition(b)&16)}}else{Core.Dom.contains=function(a,b){while(b){if(a===b){return true}b=b.parentNode}return false}}var Tabs=Core.Class.create();Tabs.prototype={initialize:function(a,b){b=b||{};var c=b.className||"";this.tabsArr=[];this.htmlEle=$C("ul");this.htmlEle.className=c;a.appendChild(this.htmlEle)},add:function(a){this.tabsArr.push(a);this.htmlEle.appendChild(a.element);Core.Events.addEvent(a.element,Core.Function.bind3(this.swapTags,this,[a]))},swapTags:function(a){if(a.isFocus==false){for(var b=0;b<this.tabsArr.length;b++){this.tabsArr[b].setAbort()}a.setFocus()}else{return}}};var Tab=Core.Class.create();Tab.prototype={isShow:true,initialize:function(a,b){this.id=Core.Math.getUniqueId();this.option=b||{};var c=b.isFocus||false;this.className=b.className||"";this.focus=b.onfocus?[b.onfocus]:[];this.abotrts=b.onabort?[b.onabort]:[];this.element=$C("li");if(b.cls){this.element.className=b.cls}c?this.setFocus():this.setAbort();this.element.innerHTML=a},setAbort:function(){if(this.isFocus==false){return}if(this.option.cls){this.element.className=this.option.cls}else{this.element.className=""}this.isFocus=false;this.onabort()},setFocus:function(){this.element.className=this.className;this.isFocus=true;this.onfocus()},onabort:function(){for(var a=0;a<this.abotrts.length;a++){this.abotrts[a]()}},onfocus:function(){for(var a=0;a<this.focus.length;a++){this.focus[a]()}},addOnAbort:function(a){this.abotrts.push(a)},addOnFocus:function(a){this.focus.push(a)},hidden:function(){this.element.style.display="none"},hidden:function(){this.element.style.display="none";this.isShow=false},show:function(){this.element.style.display="block";this.isShow=true}};Lib.register("util.JSON",function(a){var b=function(a,b){if(a.JSON)return a.JSON;var c={parse:function(a){return(new Function("return "+a))()},stringify:function(a){if(a instanceof Object){var b="";if(a.constructor===Array){for(var c=0;c<a.length;b+=this.stringify(a[c])+",",c++);return"["+b.substr(0,b.length-1)+"]"}if(a.toString!==Object.prototype.toString){return'"'+a.toString().replace(/"/g,"\\$&")+'"'}for(var d in a){b+='"'+d.replace(/"/g,"\\$&")+'":'+this.stringify(a[d])+","}return"{"+b.substr(0,b.length-1)+"}"}return typeof a==="string"?'"'+a.replace(/"/g,"\\$&")+'"':String(a)}};return c}(window);return b});CommentV2.FaceDialog=Core.Class.create();CommentV2.FaceDialog.prototype={initialize:function(a,b){this._src=a;this._tarea=b;this._json=Lib.util.JSON;this.dialog=new Dialog(this._tpl);this.dialogNodes=this.dialog.getNodes();var c=this.getSrcPos(a);this.faceDatas={};this.generaFaces=[];this.hotFaces=[];this.dialog.setPosition(c);this.dialog.show();this.initTab();this._bindEvents()},_tpl:['<table class="CP_w" id="#{entity}">',"<thead>","<tr>",'<th class="tLeft"><span></span></th>','<th class="tMid"><div class="bLyTop"><strong>插入表情</strong><cite><a href="#" id="#{close}"class="CP_w_shut" title="关闭">关闭</a></cite></div></th>','<th class="tRight"><span></span></th>',"</tr>","</thead>","<tfoot>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid"><span></span></td>','<td class="tRight"><span></span></td>',"</tr>","</tfoot>","<tbody>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid" id="#{content}">','<div class="faceItemList" id="#{facelistbox}">','<div class="CP_w_tag" id="#{facetabs}" style="display:none"></div>','<div id="#{general}">','<div class="tab_subsort" id="#{generaltabs}" style="display:none"></div>','<div class="details">','<ul class="face_tp face_lt" id="#{hotFace}"></ul>','<ul class="face_tp" id="#{inner}"></ul>','<div class="SG_page" id="#{page}"><ul id="#{pagelist}" class="SG_pages"></ul></div>',"</div>","</div>","</div>","</td>",'<td class="tRight"><span></span></td>',"</tr>","</tbody>","</table>"].join(""),_bindEvents:function(){var a=this;Core.Events.addEvent(this.dialogNodes.close,function(b){var b=Core.Events.getEvent();Core.Events.stopEvent(b);a.dialog.hidden()},"click");Core.Events.addEvent(document.body,function(b){var b=Core.Events.getEvent();var c=b.target||b.srcElement;if(!Core.Dom.contains(a.dialogNodes.entity,c)&&c!=a._src){a.dialog.hidden()}},"click");this.bindDelegateAction()},getSrcPos:function(){var a=this._src;var b=Core.Dom.getXY(a);var c=a.offsetHeight;var d={};d.x=b[0];d.y=b[1]+c+5;return d},show:function(){this.dialog.show()},initTab:function(){this.tab=new Tabs(this.dialogNodes.facetabs,{});highTab=new Tab("<div><em>常用表情</em></div>",{isFocus:true,className:"cur"});highTab.addOnFocus(Core.Function.bind3(this.initGeneralFace,this));this.tab.add(highTab);this.initGeneralFace()},getFaceData:function(a){if(this.faceDatas.face){return}var b=this;if(!window.WEIBOFACEDATA){var c="http://i2.api.weibo.com/2/emotions.json?source=1617465124&type=face&language=cnname&callback=jsonpfacedata";window.jsonpfacedata=function(c){if(c.code==1&&c.data){window.WEIBOFACEDATA=c.data;b.faceDatas.face=b.formartFaceData(c.data);a()}};Utils.Io.JsLoad.request(c,{onComplete:function(a){}.bind2(this),charset:"UTF-8"})}else{this.faceDatas.face=b.formartFaceData(window.WEIBOFACEDATA);a()}},formartFaceData:function(a){var b={};for(var c=0,d=a.length;c<d;c++){var e=a[c];if(!e.category){e.category="默认"}if(e.hot){this.hotFaces.push(e)}else{if(b[e.category]){b[e.category].push(e)}else{b[e.category]=[];this.generaFaces.push(e.category);b[e.category].push(e)}}}return b},initGeneralFace:function(){this.getFaceData(this.initGeneralTab.bind2(this))},initGeneralTab:function(){var a=this.initGeneralTabList();this.initGeneralTabPage(a)},initGeneralTabList:function(){var a=new Tabs(this.dialogNodes.generaltabs,{});a.add=function(a){this.tabsArr.push(a);this.htmlEle.appendChild(a.element);var b=this;Core.Events.addEvent(a.element,function(c){var c=Core.Events.getEvent();Core.Events.stopEvent(c);b.swapTags(a)})}.bind2(a);for(var b=0,c=this.generaFaces.length;b<c;b++){var d=this.generaFaces[b];var e=false;if(b==0){e=true}var f=new Tab('<a href="#">'+d+"</a>",{isFocus:e,className:"cur"});f.addOnFocus(Core.Function.bind3(this.showGeneralFaces,this,[d]));if(b>4){f.hidden()}a.add(f);if(b==0){this.showGeneralFaces(d)}}return a},initGeneralTabPage:function(a){function l(){g=h;h=a.tabsArr.length>=e*f-1?a.tabsArr.slice((e-1)*f,e*f):a.tabsArr.slice((e-1)*f);for(var b=g.length-1;b>=0;--b){var c=g[b];c.hidden()}for(var d=h.length-1;d>=0;--d){var i=h[d];i.show()}}var b='<div class="btn_func" ><a href="#" node-type="generalTabPagePre" class="arrow_preview"></a><a href="#" node-type="generalTabPageNext" class="arrow_next"></a></div>';Core.Dom.insertHTML(this.dialogNodes.generaltabs,b,"BeforeEnd");var c=Core.Dom.getElementsByAttr(this.dialogNodes.generaltabs,"node-type","generalTabPagePre")[0];var d=Core.Dom.getElementsByAttr(this.dialogNodes.generaltabs,"node-type","generalTabPageNext")[0];var e=1;var f=5;var g=[];var h=a.tabsArr.slice(e-1,f);var i=this.generaFaces.length;var j=i%f;var k=j>0?(i-j)/f+1:i/f;Core.Events.addEvent(c,function(a){var a=Core.Events.getEvent();Core.Events.stopEvent(a);if(e<=1){e=1;return}else{e--}l()});Core.Events.addEvent(d,function(a){var a=Core.Events.getEvent();Core.Events.stopEvent(a);if(e>=k){e=k;return}else{e++}l()})},showTheHotFace:function(){if(this.hotFaces){var a=this.hotFaces.slice(0,12);var b=this.setHotFaceList(a)}},memoryFocusTab:function(a){this.dialogNodes.generaltabs.setAttribute("data-focustab",a)},showGeneralFaces:function(a){this.memoryFocusTab(a);if(this.faceDatas.face&&this.faceDatas.face[a]){if(a=="默认"){this.dialogNodes.hotFace.style.display="block"}else{this.dialogNodes.hotFace.style.display="none"}var b=this.faceDatas.face[a];this.setGeneralFaceList(b)}},setHotFaceList:function(a){var b=this.getFaceItemsTpl(a);this.dialogNodes.hotFace.innerHTML=b},setGeneralFaceList:function(a){var b=this.getFaceListPageData(a);this.initFaceListPage(b);this.updateGeneralFaceList(a,b)},updateGeneralFaceList:function(a,b){var a=this.getFaceListData(a,b);var c=this.getFaceItemsTpl(a);this.dialogNodes.inner.innerHTML=c},getFaceItemsTpl:function(a){var b=[];for(var c=0,d=a.length;c<d;c++){var e=a[c];b.push('<li action-type="insert" action-data="'+e.phrase+'"><img src="'+e.icon+'" alt="'+e.phrase+'" title="'+e.phrase+'"></li>')}return b.join("")},getFaceListPageData:function(a){var b={};b.step=72;b.focus=1;b.total=a.length;b.totalpage=b.total>b.step?b.total%b.step>0?(b.total-b.total%b.step)/b.step+1:b.total/b.step:1;this.dialogNodes.page.setAttribute("data-page",this._json.stringify(b));return b},initFaceListPage:function(a){var b=[];if(a.totalpage>1){this.dialogNodes.page.style.display="block";for(var c=1;c<=a.totalpage;c++){if(c==a.focus){b.push('<li class="SG_pgon">'+c+"</li>")}else{b.push('<li><a href="#" action-type="facePageNums">'+c+"</a></li>")}}this.dialogNodes.pagelist.innerHTML=b.join("")}else{this.dialogNodes.page.style.display="none"}},getFaceListData:function(a,b){var c=b.step;var d=b.total;var e=b.totalpage;var f=b.focus;if(f<1){f=1}if(f>e){f=e}var g=c<d?a.slice((f-1)*c,f*c):a;return g},bindDelegateAction:function(){function b(b){var c=Lib.util.getActionData(b,"facePageNums");if(c){Core.Events.stopEvent(b);var d=c.targetEl.innerHTML;var e=a._json.parse(a.dialogNodes.page.getAttribute("data-page"));e.focus=d-0;a.dialogNodes.page.setAttribute("data-page",a._json.stringify(e));a.initFaceListPage(e);var f=a.dialogNodes.generaltabs.getAttribute("data-focustab");var g=a.faceDatas.face[f];a.updateGeneralFaceList(g,e)}}function c(b){var c=Lib.util.getActionData(b,"insert");if(c){var d=c.data;var e=CommentV2.TextAreaUtils.selectionStart(a._tarea);CommentV2.TextAreaUtils.insertText(a._tarea,d,e);a.dialog.hidden()}}function d(a){var b=Lib.util.getActionData(a,"insert");if(b){b.targetEl.className="hover"}}function e(a){var b=Lib.util.getActionData(a,"insert");if(b){b.targetEl.className=""}}Core.Events.addEvent(this.dialogNodes.facelistbox,function(a){c(a);b(a)});var a=this;Core.Events.addEvent(this.dialogNodes.facelistbox,function(a){d(a)},"mouseover");Core.Events.addEvent(this.dialogNodes.facelistbox,function(a){e(a)},"mouseout")}};CommentV2.autoHeightTextArea=function(a){function d(a){var c;if(!a.defaultHeight){a.defaultHeight=parseInt(b(a,"height"),10)||parseInt(a.offsetHeight,10)||20}if($IE){var d=parseInt(b(a,"paddingTop"),10)+parseInt(b(a,"paddingBottom"),10);c=Math.max(a.scrollHeight-d,a.defaultHeight)}else{var d=$MOZ?0:parseInt(b(a,"paddingTop"),10)+parseInt(b(a,"paddingBottom"),10);var e=$E("_____textarea_____");if(!e){e=$C("textarea");e.id="_____textarea_____";document.body.appendChild(e)}if(e.currentTarget!=a){var f=[];f.push("width:"+b(a,"width"));f.push("font-size:"+b(a,"fontSize"));f.push("font-family:"+b(a,"fontFamily"));f.push("line-height:"+b(a,"lineHeight"));f.push("padding-left:"+b(a,"paddingLeft"));f.push("padding-right:"+b(a,"paddingRight"));f.push("padding-top:"+b(a,"paddingTop"));f.push("padding-bottom:"+b(a,"paddingBottom"));f.push("top:-1000px");f.push("height:0px");f.push("position:absolute");f.push("overflow:hidden");f.push("");f=f.join(";");e.style.cssText=f}e.value=a.value;c=Math.max(e.scrollHeight-d,a.defaultHeight);e.currentTarget=a}return c}function e(a){var c;var d=[];d.push("width:"+b(a,"width"));d.push("font-size:"+b(a,"fontSize"));d.push("font-family:"+b(a,"fontFamily"));d.push("line-height:"+b(a,"lineHeight"));d.push("padding-left:"+b(a,"paddingLeft"));d.push("padding-right:"+b(a,"paddingRight"));d.push("padding-top:"+b(a,"paddingTop"));d.push("padding-bottom:"+b(a,"paddingBottom"));d.push("top:-1000px");d.push("height:0px");d.push("position:absolute");d.push("overflow:hidden");d.push("");d=d.join(";");return d}var b=Core.Dom.getStyle;var c=Core.Events.addEvent;var f=a.textArea,g=a.maxHeight,h=a.inputListener,i=f.style,j;(j=function(){typeof h==="function"&&h();setTimeout(function(){var a=d(f)||0,b;g=g||a;var c=a>g;b=c?g:a;i.overflowY=c?"auto":"hidden";i.height=Math.min(g,a)+"px"},0)})();if(!f.binded){c(f,j,"keyup");c(f,j,"focus");c(f,j,"blur");f.binded=true;f.style.overflow="hidden"}};CommentV2.CommentArea=Core.Class.create();CommentV2.CommentArea.prototype={initialize:function(a){this._container=a.container;this._place=a.place||"BeforeEnd";this._maxtext=(a.maxtext||140)*2;this._sid=a.sid||(new Date).getTime();a.shownum=a.shownum||"yes";this._shownum=a.shownum=="yes"?1:0;a.autolineheight=a.autolineheight||"no";this._autolineheight=a.autolineheight=="no"?0:1;a.alertnotice=a.alertnotice||"yes";this._alertnotice=a.alertnotice=="yes"?1:0;this._maxheight=a.maxheight||100;this._okhandler=a.okhandler||function(){};this._initTareBox();this._initDom();this._bindEvent();this._clock=null},setReplyData:function(a,b){this._plugs=a;this._replaydata=b},setValues:function(a){var b=a.comment;var c=CommentV2.TextAreaUtils.selectionStart(this._tarea);this._tarea.value="";CommentV2.TextAreaUtils.insertText(this._tarea,b,c);CommentV2.TextAreaUtils.setCursor(this._tarea,0);this._checkNum()},getValue:function(){return this._tarea.value},_setTpl:function(a){this.tpl=['<div id="tare'+this._sid+'">','<div class="count" node-type="num">您还能输入'+this._maxtext/2+"字</div>",'<textarea  node-type="textEl"></textarea>','<div class="func"> <a href="#" class="fico" node-type="faceBtn"></a>','<div class="fr">',"<label>",'<input node-type="shareIpt" type="checkbox">',"将评论分享到微博 </label>",'<a href="#" class="SG_aBtn btn_reply" node-type="subtnEl"><cite>回复</cite></a></div>',"</div>","</div>"].join("")},_initTareBox:function(){this._setTpl();Core.Dom.insertHTML(this._container,this.tpl,this._place);this._selfcontainer=$E("tare"+this._sid)},_initDom:function(){var a=this._selfcontainer;if(!a){return}this._tarea=Core.Dom.getElementsByAttr(a,"node-type","textEl")[0];this._num=Core.Dom.getElementsByAttr(a,"node-type","num")[0];this._subtn=Core.Dom.getElementsByAttr(a,"node-type","subtnEl")[0];this._facebtn=Core.Dom.getElementsByAttr(a,"node-type","faceBtn")[0];this._shareitp=Core.Dom.getElementsByAttr(a,"node-type","shareIpt")[0];this._shareitp.checked=Utils.Cookie.getCookie("acp_bb")=="1"?false:true;if(!this._shownum){this._num.style.display="none"}},_bindEvent:function(){var a=this;Core.Events.addEvent(this._shareitp,function(a){if(scope.$PRODUCT_NAME=="blog7"){v7sendLog("32_01_09")}if(scope.$PRODUCT_NAME=="blog7icp"){v7sendLog("32_01_13")}},"click");Core.Events.addEvent(this._tarea,this._checkNum.bind2(this),"keydown");Core.Events.addEvent(this._tarea,function(b){a._checkNum();var b=Core.Events.getEvent();var c=b.target||b.srcElement;a._checkValue()},"keyup");Core.Events.addEvent(this._tarea,this._bindKeyEvent.bind2(this),"keydown");Core.Events.addEvent(this._subtn,function(b){var b=Core.Events.getEvent();if(b.preventDefault){b.preventDefault()}else{b.returnValue=false}a._submitForm()},"click");Core.Events.addEvent(this._facebtn,function(b){if(scope.$PRODUCT_NAME=="blog7"){v7sendLog("32_01_11")}if(scope.$PRODUCT_NAME=="blog7icp"){v7sendLog("32_01_15")}var b=Core.Events.getEvent();if(b.preventDefault){b.preventDefault()}else{b.returnValue=false}a._showFacePanel()},"click");if(this._autolineheight){CommentV2.autoHeightTextArea({textArea:this._tarea,maxHeight:this._maxheight,inputListener:function(){trace("--autoHeightTextArea--")}})}},_checkValue:function(){},_checkNum:function(){var a=this._getUnoccupiedNum();if(this._shownum){var b=a>=0?"还可以输入"+a+"字":'<em class="red">已超出'+ -a+"字</em>";this._num.innerHTML=b}},_jsOverflow:function(){var a=this._getUnoccupiedNum();return a<0?true:false},_getUnoccupiedNum:function(){var a=this._tarea.value;var b=this._getLen(a);var c=this._maxtext;var d=(c-b)%2==0?(c-b)/2:(c-b-1)/2;return d},_getLen:function(a){if(!a){return 0}var b=a.match(/[^\x00-\xff]/g);return a.length+(b?b.length:0)},_bindKeyEvent:function(a){if(a.keyCode==13&&a.ctrlKey){this._submitForm()}},_validate:function(){var a=this;if(Core.String.trim(this._tarea.value)==""){winDialog.alert($SYSMSG["B36041"],{icon:"01",funcOk:function(){a._tarea.focus()}});return false}if(this._jsOverflow()){winDialog.alert($SYSMSG["B36208"],{icon:"01",funcOk:function(){a._tarea.focus()}});return false}return true},_submitForm:function(){if(scope.$PRODUCT_NAME=="blog7"){v7sendLog("32_01_10")}if(scope.$PRODUCT_NAME=="blog7icp"){v7sendLog("32_01_14")}if(!this._validate()){return}if(this._plugs){this._replaydata.reply_content=Core.String.trim(this._tarea.value);this._replaydata.is_t=this._shareitp.checked?1:0;this._setShareWbSign();this._plugs.add(this._replaydata,this.successFun.bind2(this),this.errorFun.bind2(this))}},_setShareWbSign:function(){if(this._shareitp){if(this._shareitp.checked){if($E("bb")){$E("bb").checked=true}if(Utils.Cookie.getCookie("acp_bb")=="1"){Utils.Cookie.setCookie("acp_bb","",-1,"/",".blog.sina.com.cn")}}else{if($E("bb")){$E("bb").checked=false}if(Utils.Cookie.getCookie("acp_bb")!="1"){Utils.Cookie.setCookie("acp_bb","1",2400,"/",".blog.sina.com.cn")}}}},successFun:function(a){this._tarea.value="";this._checkNum();var b=this;if(this._alertnotice){winDialog.alert("发布成功",{icon:"03",funcOk:function(){b._plugs.sucOkFun&&b._plugs.sucOkFun()}})}this._okhandler()},errorFun:function(a){if(scope.$PRODUCT_NAME=="blog7"){v7sendLog("32_01_12")}if(scope.$PRODUCT_NAME=="blog7icp"){v7sendLog("32_01_16")}var b=a?$SYSMSG[a.code]:"发布失败，请稍后再试";winDialog.alert(b,{icon:"01",funcOk:function(){_this._plugs.errOkFun&&_this._plugs.errOkFun()}})},_showFacePanel:function(){if(!this.facedialog){this.facedialog=new CommentV2.FaceDialog(this._facebtn,this._tarea)}else{this.facedialog.show()}}};Lib.HtmlTemplate=function(a,b){this.uniqueID=b}.$extends(Ui.Template).$define({getHtmlString:function(){if(!this._htmlStr){this._htmlStr=this.evaluate(this.getNodeIds())}return this._htmlStr},getNodeIds:function(){if(!this._nodes){var a=/\{[^\}]+(?=\})/g,b,c={},d,e,f=this._getUniqueID();this.__templateNodesIDs=this.tmpl.match(a);d=this.__templateNodesIDs;if(d){b=d.length;while(b--){e=d[b].replace("{","");c[e]="_"+f+"_"+e}}this._nodes=c}return this._nodes},getNodeId:function(a){if(!this._nodes){this.getNodeIds()}return this._nodes[a]},getNode:function(a){var b=this.getNodeId(a);return!b?null:$E(b)},_getUniqueID:function(){if(!this.uniqueID){this.uniqueID=parseInt(Math.random()*1e3).toString()+(new Date).getTime().toString()}return this.uniqueID}});CommentV2.Add=function(a){var a=a||{};this.tpl=a.tpl||"";this.url=a.url||"";this.type=a.type||"comment";this.data=a.data||"";this.jsonUtil=Utils.Json;this.leftB=Core.String.leftB;this.loader=new Interface(this.url,"ijax");this.init()}.$define({init:function(){trace("CommentV2.Add.Init");if(!this.tpl){this.tpl=this.getTpl()}Lib.checkAuthor()},post:function(a,b,c){var d=this;if(!$isLogin){(new Lib.Login.Ui).login(function(){scope.blogOpener.showDialog(function(){a.uid=$UID;a.login_name=scope.$loginNick||$nick;d.post(a,b,c)})});return}trace("CommentV2.Add.Post");trace(a);this.loader.request({POST:a,returnType:"json",onSuccess:function(c){trace("reply_add_succ");var e=c.comment_reply_data[0];e.action_data=d.obj2str({articleid:scope.$articleid,commentid:e.stair_cms_id,replyid:e.id,comm_uid:e.comm_uid,uname:e.uname,source_uid:e.source_uid,cms_body:e.cms_body,ulink:e.ria_index_url,source_ulink:e.source_ria_index_url,src_uid:e.src_uid});var f=d.render(e,-1,a.cms_reply_num);d.appendItem(f,e.stair_cms_id);if(b&&typeof b==="function"){b(c)}},onError:function(a){trace("reply_add_error");if(c&&typeof c==="function"){c(a)}},onFail:function(a){trace("reply_add_fail");if(c&&typeof c==="function"){c(a)}}})},render:function(a,b,c){var d=$C("li");d.className="SG_j_linedot1";a.cms_body=decodeURIComponent(a.cms_body);a.vimg=a.vimg?a.vimg:"";a.source_vimg=a.source_vimg?a.source_vimg:"";a.from="";if(a.fromProduct=="weibo"){var e='<img height="15" align="absmiddle" width="15" class="SG_icon SG_icon51" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif">';a.user_from_weibo='来自<a target="_blank" href="'+a.ulink+'">'+e+a.weibo_uname+"</a>的评论"}a.cms_reply_num=a.cms_reply_num?"("+a.cms_reply_num+")":"";a.show_more="none";a.moreInfo="";if(this.type==="comment"){d.id="cmt_"+a.id;if(b===0){d.className=""}if(a.comm_uid==0){a.user_image_place='<img src="'+a.user_image+'">';a.user_nick_place=a.uname}else{a.user_image_place='<a href="'+a.ria_index_url+'" target="_blank"><img src="'+a.user_image+'"></a>';a.user_nick_place='<a href="'+a.ria_index_url+'">'+a.uname+"</a>"}if(a.fromProduct==="blog"){var f=/<img\s(?:src=[\S]*)?\s(?:style=[\S]*)?\s(?:onclick=[\S]*)?\s(?:border=[\S]*)?\stitle=[\]["]([\S]*)[\]["]\s?[/]>/ig;var g=/<img\s\S*\salt=[']([\S]*)[']\s?[/]>/ig;var h=/<img\s(?:height=[\S]*)?\s(?:width=[\S]*)?\s(?:border=[\S]*)?\stitle=[\]["]([\S]*)[\]["]\s(?:onclick=[\S]*)?[\S\s]*[/]>/ig;a.temp_cms_body=a.cms_body.replace(f,"[$1]");a.temp_cms_body=a.temp_cms_body.replace(g,"$1");a.temp_cms_body=a.temp_cms_body.replace(h,"[$1]");var i=this.__getLen(a.temp_cms_body);if(i>280){a.show_more="";a.moreInfo='<div class="SG_revert_Inner SG_txtb" id="body_cmt_full_'+a.id+'" style="display:none;">'+a.cms_body+'<a href="javascript:void(0);" class="btn_artsq" style="display:"";" action-type="comment_more" action-data="'+a.action_data+'"></a>'+"</div>";a.cms_body=this.leftB(a.temp_cms_body,280)}}}else if(this.type==="reply"){d.id="reply_"+a.id;if(c>=1&&b===c-1){d.className=""}if(c==0&&b==-1){d.className=""}if(a.source_uid==0){a.soure_user_info="&nbsp;"+a.source_uname+"&nbsp;："}else{a.soure_user_info='&nbsp;<a href="'+a.source_ria_index_url+'" target="_blank">'+a.source_uname+"</a>"+a.source_vimg+"："}}if($UID&&(a.comm_uid==$UID||a.src_uid==$UID)){a.show_del=""}else{a.show_del="none"}if(a.fromProduct!="qing"){a.show_report=""}else{a.show_report="none"}var j=new Date;var k=new Date(a.cms_pubdate.replace(/-/g,"/"));a.cms_pubdate=this.dateFormat(j,k);var l=(new Lib.HtmlTemplate(this.tpl)).evaluate(a);d.innerHTML=l;return d},appendItem:function(a,b){var c=$E("comment_"+b+"_replylist");c.insertBefore(a,c.firstChild);c.style.display=""},getTpl:function(){if(this.type==="comment"){return'<div class="SG_revert_Left">'+"#{user_image_place}"+"</div>"+'<div class="SG_revert_Cont">'+'<p><span class="SG_revert_Tit">'+"#{user_nick_place}"+"</span>#{vimg}"+"</p>"+'<div class="SG_revert_Inner SG_txtb" id="body_cmt_#{id}">#{cms_body}'+'<a href="javascript:void(0);" class="btn_artzk" style="display:#{show_more}" action-type="comment_more" action-data="#{action_data}"></a>'+"</div>"+"#{moreInfo}"+'<p class="myReFrom">'+'<em class="SG_txtc">#{cms_pubdate}</em>#{user_from_weibo}'+'<span class="SG_revert_Func">'+'<a href="javascript:void(0);" class="SG_a_fuc" action-type="comment_report" action-data="#{action_data}" style="display:#{show_report}"><cite>举报</cite></a>'+'<a href="javascript:void(0);" class="SG_a_fuc" action-type="comment_del" action-data="#{action_data}" style="display:#{show_del}">删除</a>'+'<a href="javascript:void(0);" class="SG_a_fuc" action-type="comment_share" action-data="#{action_data}" style="display:#{show_share}"><cite>分享</cite></a>'+'<a href="javascript:void(0);" class="SG_a_fucs" action-type="comment_reply" action-data="#{action_data}" style="display:#{show_reply}"><cite>回复#{cms_reply_num}</cite></a>'+"</span>"+"</p>"+'<div class="SG_reply" id="comment_#{id}" style="display:none;">'+"</div>"+"</div>"}else{return'<div class="img"><a href="#{ria_index_url}" target="_blank"><img src="#{user_image}"></a></div>'+'<div class="txt">'+'<p><a href="#{ria_index_url}" target="_blank">#{uname}</a>#{vimg}&nbsp;回复'+"#{soure_user_info}"+"#{cms_body}"+"(#{cms_pubdate})</p>"+"</div>"+'<div class="links">'+'<a href="javascript:void(0);" action-type="reply_report" action-data="#{action_data}" style="display:#{show_report}">举报</a>'+'<a href="javascript:void(0);" action-type="reply_del" action-data="#{action_data}" style="display:#{show_del}">删除</a>'+'<a href="javascript:void(0);" action-type="reply_share" action-data="#{action_data}" style="display:#{show_share}">分享</a>'+'<a href="javascript:void(0);" class="links_s" action-type="reply_reply" action-data="#{action_data}" style="display:#{show_reply}">回复</a>'+"</div>"}},__getLen:function(a){if(!a){return 0}var b=a.match(/[^\x00-\xff]/g);return a.length+(b?b.length:0)},obj2str:function(a){return encodeURIComponent(this.jsonUtil.flatten(a))},str2obj:function(a){return this.jsonUtil.eval(decodeURIComponent(a))},dateFormat:function(a,b){var c="月";var d="日";var e="今天";var f="秒前";var g="分钟前";var h=a.getFullYear();var i=b.getFullYear();var j=a.getMonth()+1;var k=b.getMonth()+1;var l=a.getDate();var m=b.getDate();var n=a.getHours();var o=b.getHours();if(o<10)o="0"+o;o="&nbsp;"+o;var p=b.getMinutes();if(p<10)p="0"+p;var q=a-b;q=q>0?q:0;q=q/1e3;if(h!=i){return i+"-"+k+"-"+m+" "+o+":"+p}else if(j!=k||l!=m){return k+c+m+d+o+":"+p}else if(n!=o&&q>60*60){return e+o+":"+p}else if(q<51){q=q<1?1:q;return Math.floor((q-1)/10)+1+"0"+f}else{return Math.floor(q/60+1)+g}return""}});Core.Dom.opacity=function(a,b){a=typeof a=="string"?$E(a):a;a.style.filter="alpha(opacity="+b+")";a.style.opacity=b/100};Core.Dom.insertAfter=function(a,b){var c=b.parentNode;if(c.lastChild==b){c.appendChild(a)}else{c.insertBefore(a,b.nextSibling)}return a};Core.Dom.wrap=function(a,b){var c=$C(b);Core.Dom.insertAfter(c,a);c.appendChild(a);return c};Ui.Slide=Core.Class.create();Ui.Slide.prototype={node:null,container:null,status:"show",offset:0,onSlideIn:new Function,onSlideOut:new Function,initialize:function(a,b){var b=b||{};this.node=$E(a);this.container=Core.Dom.wrap(this.node,"div");this.container.style.overflow="hidden";this.offset=this.node.offsetHeight;this.opacity=true;this.animation=b.animation||"strongEaseOut";this.duration=b.duration||1;this.container.style.height=this.offset+"px";this.node.style.marginTop="0px"},slideIn:function(a){a=a||{};if(this.opacity){new Ui.tween(this.node,"opacity",1,this.duration,this.animation,{})}new Ui.tween(this.container,"height",this.offset,this.duration,this.animation,a);new Ui.tween(this.node,"marginTop",0,this.duration,this.animation,{tween:function(a){}.bind2(this),end:this.onSlideIn})},slideOut:function(a){a=a||{};if(this.opacity){new Ui.tween(this.node,"opacity",0,this.duration,this.animation,{})}new Ui.tween(this.container,"height",0,this.duration,this.animation,a);new Ui.tween(this.node,"marginTop",-this.offset,this.duration,this.animation,{end:this.onSlideOut})},show:function(){if(this.opacity){}this.container.style.height=this.offset+"px";this.node.style.marginTop=0+"px"},hide:function(){if(this.opacity){}this.container.style.height=0+"px";this.node.style.marginTop=-this.offset+"px"}};CommentV2.Delete=function(a){Lib.checkAuthor()}.$define({deleteComment:function(a,b){trace("CommentV2.CommentDel.deleteComment");var c=this;var d=a.data;var e="",f="",g="确认需要删除此条评论？<br/>删除后不可恢复。";if($UID==d.comm_uid||d.comm_uid==0){e=' style="display:none" '}if(d.fromProduct!=="qing"){f="<div "+e+'><input id="cbAddToBlock_'+d.commentid+'" type="checkbox"/><label for="cbAddToBlock_'+d.commentid+'">将此人加入黑名单</label></div>'}this.del_url=new Interface("http://control.blog.sina.com.cn/admin/comment_new/cms_del_post.php",$IE6?"ijax":"jsload");winDialog.confirm(g,{subText:f,textOk:"删除",funcOk:function(){var a={GET:{article_id:d.articleid,cms_id:d.commentid,cms_uid:d.comm_uid,login_uid:$UID,inblack:$E("cbAddToBlock_"+d.commentid).checked?1:0},onSuccess:function(a){var c=$E("body_cmt_"+d.commentid).parentNode.parentNode;var e=new Ui.Slide(c);e.onSlideOut=function(){Core.Dom.removeNode(c)};e.slideOut();if(b&&typeof b==="function"){b(a)}},onError:function(a){c.showError(a)},onFail:function(a){c.showError(a)}};c.del_url.request(a)}})},deleteReply:function(a,b){trace("CommentV2.CommentDel.deleteReply");var c=this;var d=a.data;var e="",f="",g="确认需要删除此条回复？<br/>删除后不可恢复。";if($UID==d.comm_uid){e=' style="display:none" '}if(d.fromProduct!=="qing"){f="<div "+e+'><input id="cbAddToBlock_'+d.commentid+'" type="checkbox"/><label for="cbAddToBlock_'+d.commentid+'">将此人加入黑名单</label></div>'}this.del_url=new Interface("http://control.blog.sina.com.cn/admin/comment_new/cms_del_usereply_post.php",$IE6?"ijax":"jsload");winDialog.confirm(g,{subText:f,textOk:"删除",funcOk:function(){var a={GET:{article_id:d.articleid,cms_id:d.replyid,cms_uid:d.comm_uid,login_uid:$UID,source_uid:d.source_uid,stair_cmsid:d.commentid,inblack:$E("cbAddToBlock_"+d.commentid).checked?"1":"0"},onSuccess:function(a){var c=$E("reply_"+d.replyid);var e=new Ui.Slide(c);e.onSlideOut=function(){Core.Dom.removeNode(c)};e.slideOut();if(b&&typeof b==="function"){b(a)}},onError:function(a){c.showError(a)},onFail:function(a){c.showError(a)}};c.del_url.request(a)}})},showError:function(a){if(a.code=="B00006"){return}winDialog.alert($SYSMSG[a.code]||"删除失败，请重试",{icon:"02"})}});Core.String.decodeHTML=function(a){var b=document.createElement("div");b.innerHTML=a;return b.innerText==undefined?b.textContent:b.innerText};Utils.Form.Radio={};Utils.Form.Radio.get=function(a){if(!a)return"";var b=a.length;if(b==undefined)if(a.checked)return a.value;else return"";for(var c=0;c<b;c++){if(a[c].checked){return a[c].value}}return""};Utils.Form.Radio.set=function(a,b){if(!a)return;var c=a.length;if(c==undefined){a.checked=a.value==b.toString();return}for(var d=0;d<c;d++){a[d].checked=false;if(a[d].value==b.toString()){a[d].checked=true}}};scope.reportMainTpl=['<div id="#{panel}" class="blog_report">','<div id="#{titleBar}" class="BRpt_topTit">','<a href="#" onclick="return false;" id="#{btnClose}" title=""><img src="http://simg.sinajs.cn/blog7style/images/common/report/icon_clo.gif" /></a>',"</div>",'<div id="#{content}" class="BRpt_mid">',"</div>","</div>"].join("");scope.reportStartTpl=['<div class="BRpt_Mtop">',"<p>新浪博客愿和您一起共同打造健康和谐的网络信息交流平台。并有7×24小时的值班服务，及时有效的处理您的举报。</p>","</div>",'<div class="Brpt_RtConn">','<p id="#{resumeInfo}" class="Brpt_RtInf"></p>','<textarea id="#{resumeContent}" readonly="readonly" class="Brpt_RtTxt"></textarea>','<p class="Brpt_Rhost"><input type="checkbox" id="#{cbBlogHost}" /><label for="#{cbBlogHost}">同时举报博主</label></p>','<div class="clear"></div>','<div class="Brpt_choCla">','<p class="claTit">请选择您举报类别（<span class="cho">必选</span>）：</p>','<p class="cla_conn">','<input id="ero" value="1" type="radio" name="chocla" /><label for="ero">色情</label>','<input id="pol" value="2" type="radio" name="chocla" /><label for="pol">政治</label>','<input id="tor" value="3" type="radio" name="chocla" /><label for="tor">侵权</label>','<input id="adv" value="5" type="radio" name="chocla" /><label for="adv">广告</label>','<input id="oth" value="4" type="radio" name="chocla" /><label for="oth">其他</label>',"</p>","</div>",'<p class="Brpt_othInt">您可以填写更多举例说明：</p>','<textarea id="#{reportReason}" class="Brpt_RtTxt"></textarea>',"</div>",'<div class="Brpt_RCBtn">','<a class="BRpt_btnGy" href="#" onclick="return false;" id="#{btnOk}" title=""><span>确认</span></a>','<a class="BRpt_btn" href="#" onclick="return false;" id="#{btnCancel}" title=""><span>取消</span></a>','<div class="clearit"></div>',"</div>"].join("");scope.reportBadTpl=['<div class="BRpt_Mtop">',"<p>新浪博客愿和您一起共同打造健康和谐的网络信息交流平台。并有7×24小时的值班服务，及时有效的处理您的举报。</p>","</div>",'<div class="Brpt_exclt">','<p class="Brpt_extP1">您已经成功举报了该信息，工作人员会尽快处理。</p>','<p class="Brpt_extP2">再次感谢您对新浪博客的支持！</p>','<div class="Brpt_extBtn"><a class="BRpt_btn" href="#" onclick="return false;" id="#{btnOk}" title=""><span>确认</span></a><div class="clear"></div></div>',"</div>"].join("");scope.reportSuccessTpl=['<div class="BRpt_Mtop">',"<p>新浪博客愿和您一起共同打造健康和谐的网络信息交流平台。并有7×24小时的值班服务，及时有效的处理您的举报。</p>","</div>",'<div class="Brpt_extRst">','<p class="Brpt_eRTit">举报完成！感谢您对我们工作的支持，我们将在24小时内处理。</p>','<div class="Brpt_eRmtd">','<p class="tit">您还可以：</p>','<div class="conn">','<p class="mtd">','<input type="checkbox" id="#{cbCustom}"/>','<label for="#{cbCustom}">我是新浪博客用户，我要接收处理结果</label><span id="#{guestText}">(您还没有登录)</span>',"</p>","</div>",'<div class="conn2">','<p class="mtd"><input type="checkbox" id="#{cbOtherMethod}" /><label for="#{cbOtherMethod}">我要通过其他方式接收处理结果</label></p>','<div id="#{userForm}" style="display:none;">','<p class="perInf"><span>您的姓名：</span><input id="#{userName}" type="text" /></p>','<p class="perInf"><span>您的邮箱：</span><input id="#{userEmail}" type="text" /></p>','<p class="perInf"><span>您的电话：</span><input id="#{userTel}" type="text" /></p>',"</div>","</div>","</div>",'<div class="Brpt_eRBtn"><a class="BRpt_btnGy" href="#" onclick="return false;" id="#{btnOk}" title=""><span>确认</span></a><div class="clear"></div></div>'].join("");scope.reportFinishedTpl=['<div class="BRpt_Mtop">',"<p>新浪博客愿和您一起共同打造健康和谐的网络信息交流平台。并有7×24小时的值班服务，及时有效的处理您的举报。</p>","</div>",'<div class="Brpt_thx">',"<p>再次感谢您对新浪博客举报的大力支持！</p>",'<div class="Brpt_thxBtn"><a class="BRpt_btnGy" href="#" onclick="return false;" id="#{btnCancel}" title=""><span>关闭</span></a></div>',"</div>"].join("");scope.GeneralReport=Core.Class.create();scope.GeneralReport.prototype={type:"",_hashType:{comment:{"class":"2",initFunction:null},blog:{"class":"1",initFunction:null},guestBook:{"class":"3",initFunction:null},friend:{"class":"4",initFunction:null},photoComment:{"class":"5",initFunction:null},paperlist:{"class":"6",initFunction:null}},dataInterface:null,canSubmit:true,bodyID:"",reportUID:"",userNameInfo1:"",userNameInfo2:"",titleInfo:"",nickName:"",contentInfo:"",tUID:"",_isInitDialog:false,_dialog:null,initialize:function(){this.dataInterface=new Interface("http://control.blog.sina.com.cn/admin/advice/impeach_post_content.php?version=7","ijax");this._hashType["comment"]["initFunction"]=this._commentInit;this._hashType["blog"]["initFunction"]=this._blogInit;this._hashType["guestBook"]["initFunction"]=this._guestBookInit;this._hashType["friend"]["initFunction"]=this._friendInit;this._hashType["photoComment"]["initFunction"]=this._photoCommentInit;this._hashType["paperlist"]["initFunction"]=this._paperlistInit},show:function(){!this._isInitDialog&&this._initDialog();this._dialog.setAreaLocked(true);this._dialog.setMiddle();this._dialog.show();this._isInitDialog=true;this._hashType[this.type]["initFunction"].call(this)},hidden:function(){this._dialog.hidden()},clear:function(){var a=this._dialog.nodes;a.resumeInfo.innerHTML="";a.resumeContent.value="";a.cbBlogHost.checked=false;Utils.Form.Radio.set($N("chocla"),"");a.reportReason.value=""},submit:function(){var a=this;this.dataInterface.request({POST:{body_id:a.bodyID,"class":a._hashType[a.type]["class"],type:Utils.Form.Radio.get($N("chocla")),fnickname:a.nickName,fuid:a.reportUID,tuid:a.tUID,reason:a._dialog.nodes["reportReason"].value,is_report:a._dialog.nodes["cbBlogHost"].checked},onSuccess:function(b){a.canSubmit=true;a.onSuccessed(b)},onError:function(b){a.canSubmit=true;a.onError(b)},onFail:function(){a.canSubmit=true}})},_initDialog:function(){this._dialog=winDialog.createCustomsDialog({tpl:scope.reportMainTpl,content:scope.reportStartTpl});var a=this,b=this._dialog.nodes;this._dialog.addEventListener("hidden",function(){a.clear()});Core.Events.addEvent(b.btnOk,function(){if(a.canSubmit){a.canSubmit=false;a.submit()}},"click");Core.Events.addEvent(b.btnCancel,function(){a._dialog.hidden()},"click");Utils.Form.limitMaxLen(b.reportReason,400)},_commentInit:function(){this._dialog.nodes["resumeInfo"].innerHTML="您要举报的是"+this.userNameInfo1+"在博文"+this.titleInfo+"中发表的评论，摘要如下：";this._dialog.nodes["resumeContent"].value=this.contentInfo;this._dialog.nodes["cbBlogHost"].checked=false},_blogInit:function(){this._dialog.nodes["resumeInfo"].innerHTML="您要举报的是"+this.userNameInfo1+"发表的"+this.titleInfo+"，摘要如下：";this._dialog.nodes["resumeContent"].value=this.contentInfo;this._dialog.nodes["cbBlogHost"].checked=false},_guestBookInit:function(){this._dialog.nodes["resumeInfo"].innerHTML="您要举报的是"+this.userNameInfo1+"在"+this.userNameInfo2+"博客的留言，摘要如下：";this._dialog.nodes["resumeContent"].value=this.contentInfo;this._dialog.nodes["cbBlogHost"].checked=false},_friendInit:function(){this._dialog.nodes["resumeInfo"].innerHTML="您要举报的是"+this.userNameInfo1+"给您发的好友申请，摘要如下：";this._dialog.nodes["resumeContent"].value=this.contentInfo;this._dialog.nodes["cbBlogHost"].checked=true},_photoCommentInit:function(){this._dialog.nodes["resumeInfo"].innerHTML="您要举报的是"+this.userNameInfo1+"在图片"+this.titleInfo+"中发表的评论，摘要如下：";this._dialog.nodes["resumeContent"].value=this.contentInfo;this._dialog.nodes["cbBlogHost"].checked=false},_paperlistInit:function(){this._dialog.nodes["resumeInfo"].innerHTML="您要举报的是"+this.userNameInfo1+"给您发送的纸条，摘要如下：";this._dialog.nodes["resumeContent"].value=this.contentInfo;this._dialog.nodes["cbBlogHost"].checked=false},onSuccessed:function(a){},onError:function(a){}};Utils.Form.inputListen=function(a,b,c){a=$E(a);if(typeof b!="undefined"){b=isNaN(b)?null:b*1}if(a==null||b==null||a.nodeType!=1){return false}c=c||{};var d=c.limitRe;var e=c.doubleByte;e=e==null?true:e;var f=function(){try{var b=Core.Events.getEvent();if(b){var c=b.which||b.keyCode;if(c==37||c==39){return false}}}catch(f){}var g=a.max;while(d!=null&&d.test(a.value)){a.value=a.value.replace(d,"")}if(e==true){if(Core.String.byteLength(a.value)>g){var h=a.value.substr(0,g);while(Core.String.byteLength(h)>g){h=h.replace(/.$/,"")}a.value=h;a.maxLength=h.length}else{a.maxLength=g-a.value.replace(/[\x00-\xff]/g,"").length}}else{a.maxLength=g}if(g<a.value){a.value=a.value.substr(0,g)}};var g=function(){if(d!=null&&d.test(a.value)){a.value=a.value.replace(d,"")}};a.max=b;a.maxLength=b;f();if(a.beWatched==null){a.beWatched=true;if(!$IE){Core.Events.addEvent(a,f,"input")}else{Core.Events.addEvent(a,f,"keyup");Core.Events.addEvent(a,f,"keypress");Core.Events.addEvent(a,f,"mouseout")}Core.Events.addEvent(a,g,"blur")}};scope.SuccessedReport=Core.Class.create();scope.SuccessedReport.prototype={loginUI:null,_isInitDialog:false,canSubmit:true,dataInterface:null,dataID:"",bodyID:"",userInfo:{nickName:""},initialize:function(){this.dataInterface=new Interface("http://control.blog.sina.com.cn/admin/advice/impeach_post_userinfo.php?version=7","ijax");this.loginUI=new Lib.Login.Ui},show:function(){!this._isInitDialog&&this._initDialog();this._dialog.setAreaLocked(true);this._dialog.setMiddle();this._dialog.show();this._isInitDialog=true},displayUserInfo:function(a){this._dialog.nodes["userForm"].style.display=a===false?"none":""},login:function(){var a=this;this.loginUI.login(function(){a.submit()})},clear:function(){var a=this._dialog.nodes;a.cbCustom.checked=false;a.cbOtherMethod.checked=false;a.userForm.style.display="none";a.userName.value="";a.userEmail.value="";a.userTel.value=""},hidden:function(){this._dialog.hidden()},submit:function(){var a=this,b=this._dialog.nodes;Lib.checkAuthor();a.canSubmit=false;this.dataInterface.request({POST:{id:a.dataID,body_id:a.bodyID,nickname:typeof $nick=="undefined"?"":$nick,name:b.userName.value,email:b.userEmail.value,phone:b.userTel.value,uid:$UID,is_login:b.cbCustom.checked?"1":"0"},onSuccess:function(b){a.canSubmit=true;a.onSuccessed(b)},onError:function(b){a.canSubmit=true;a.onError(b)},onFail:function(){a.canSubmit=true}})},_initDialog:function(){this._dialog=winDialog.createCustomsDialog({tpl:scope.reportMainTpl,content:scope.reportSuccessTpl});var a=this,b=this._dialog.nodes;this._dialog.addEventListener("hidden",function(){a.clear()});Lib.checkAuthor();b.guestText.style.display=$isLogin?"none":"";Core.Events.addEvent(b.btnOk,function(){if(a.canSubmit){Lib.checkAuthor();if(!$isLogin&&b.cbCustom.checked){a.login()}else{a.submit()}}},"click");Core.Events.addEvent(b.cbOtherMethod,function(){a.displayUserInfo(b.cbOtherMethod.checked)},"click");Utils.Form.inputListen(b.userName,100);Utils.Form.inputListen(b.userEmail,200);Utils.Form.inputListen(b.userTel,100)},onSuccessed:function(a){},onError:function(a){}};$SYSMSG.extend({B04102:"您输入的电子邮件格式错误，请重新输入",B04105:"很抱歉，您输入的内容过多，请删减后重新提交",B04107:"您要举报的内容已经不存在，感谢您的支持",B04108:"举报分类错误",B04109:"您还没有选择举报类别，请选择后继续操作",B04110:"您的昵称为空，请输入后继续操作",B04111:"系统繁忙，请稍后再试",B04112:"您已经举报过该用户，再次感谢您的支持",B04113:"系统繁忙，请稍后再试",B04114:"系统繁忙，请稍后再试",B04115:"系统繁忙，请稍后再试",B04116:"系统繁忙，请稍后再试"});Lib.BlogReport=Core.Class.create();Lib.BlogReport.prototype={generalReport:null,successedReport:null,badReport:null,finishedReport:null,isBRInit:false,isFRInit:false,initialize:function(){this.generalReport=new scope.GeneralReport;this.successedReport=new scope.SuccessedReport},start:function(a,b,c,d,e,f,g,h,i){var j=this,k=this.generalReport;h=Core.String.decodeHTML(h);k.nickName=b;k.type=a;k.reportUID=d;k.userNameInfo1=e;k.userNameInfo2=f;k.titleInfo=g;k.contentInfo=Core.String.byteLength(h)>800?Core.String.shorten(h,800):h;k.bodyID=c;k.tUID=i?i:"";k.onSuccessed=function(a){j.reportSuccess(b,c,a["dataID"]);this.hidden()};k.onError=function(a){if(a["code"]==="B04112"){j.showBad();this.hidden()}else{winDialog.alert($SYSMSG[a["code"]])}};k.show()},showBad:function(){var a=this;if(!this.isBRInit){this.badReport=winDialog.createCustomsDialog({tpl:scope.reportMainTpl,content:scope.reportBadTpl});Core.Events.addEvent(this.badReport.nodes["btnOk"],function(){a.badReport.hidden()},"click")}this.badReport.setAreaLocked(true);this.badReport.setMiddle();this.badReport.show()},reportSuccess:function(a,b,c){var d=this,e=this.successedReport;e.bodyID=b;e.dataID=c;e.userInfo.nickName=a;e.onSuccessed=function(a){d.finished();this.hidden()};e.onError=function(a){winDialog.alert($SYSMSG[a["code"]])};e.show()},finished:function(){var a=this;if(!this.isFRInit){this.finishedReport=winDialog.createCustomsDialog({tpl:scope.reportMainTpl,content:scope.reportFinishedTpl});Core.Events.addEvent(this.finishedReport.nodes["btnCancel"],function(){a.finishedReport.hidden()},"click")}this.finishedReport.setAreaLocked(true);this.finishedReport.setMiddle();this.finishedReport.show()}};CommentV2.Report=function(){this.BR=new Lib.BlogReport;this.getInterface=new Interface("http://control.blog.sina.com.cn/blog_rebuild/riaapi/profile/note/getCms.php","jsload")}.$define({commentReport:function(a){trace("CommentV2.Report.commentReport");var b={cms_id:a.commentid,uid:a.src_uid};this.setReport(a,b)},replyReport:function(a){trace("CommentV2.Report.replyReport");var b={cms_id:a.replyid,uid:a.src_uid};this.setReport(a,b)},setReport:function(a,b){var c=this;var d=scope.$articleid,e=a.commentid,f=d+"_"+e,g=a.uname,h=a.comm_uid,i="",j="",k='<a target="_blank" href="http://blog.sina.com.cn/s/blog_'+d+'.html">'+$E("t_"+d).innerHTML+"</a>";a.ulink=a.ulink?a.ulink:"http://blog.sina.com.cn/u/"+a.comm_uid;if(a.comm_uid!=0){i='<a href="'+a.ulink+'" target="_blank">'+g+"</a>"}else{i="<strong>"+g+"</strong>"}this.getInterface.request({GET:b,onSuccess:function(a){var b=a.cms_body;c.BR.start("comment",g,f,h,i,j,k,b)},onError:function(a){},onFail:function(){}})}});CommentV2.Share=function(){trace("CommentV2.Share");this.shorten=Core.String.shorten;this.getInterface=new Interface("http://control.blog.sina.com.cn/blog_rebuild/riaapi/profile/note/getCms.php","jsload");this.getWeiboNameInterface=new Interface("http://i2.api.weibo.com/2/users/show.json","jsload")}.$define({commentShare:function(a){var b=this;this.data=a||{};this.__commentShare()},replyShare:function(a){var b=this;this.data=a||{};this.type="reply";var c=this.data.replyid;var d=this.data.src_uid;this.__getCmsBody(c,d)},__getCmsBody:function(a,b){var c=this;var d={cms_id:a,uid:b,origin:1};this.getInterface.request({GET:d,onSuccess:c.__getWeiboName.bind2(c),onError:function(a){},onFail:function(){}})},__getWeiboName:function(a){var b=this;this.body=a.cms_body;this.uid=a.uid;this.src_title=a.src_title;window.jsonpweiboname=function(a){if(a.code==1&&a.data){b.name=encodeURIComponent("@"+a.data.name)}else{b.name=encodeURIComponent(" "+b.data.uname)||""}b.__share()};var c={uid:this.uid,source:"1617465124",callback:"jsonpweiboname"};this.getWeiboNameInterface.request({GET:c,onSuccess:function(){},onError:function(){},onFail:function(){}})},__share:function(){var a=this.body;if(this.type==="comment"){if(this.data.fromProduct==="blog"){var b=/\[emoticons=(E___\w*)\]([^[]*)\[\/emoticons\]/gi;var c=/\[magicemoticons=([E|W]___\w*)\&nbsp\;swfname=(\w+\.swf)\]([^[]*)\[\/magicemoticons\]/gi;a=a.replace(b,"[$2]");a=a.replace(c,"[$3]")}else{var d=/<img\s[\S]*\salt=[\]["][^-]*[-]?([\S]*)[\]["]\s?[\][/]>/ig;a=a.replace(d,"[$1]")}}a=encodeURIComponent(this.shorten(a,100));var e=encodeURIComponent(location.href);var f=encodeURIComponent(this.src_title)||encodeURIComponent($E("t_"+scope.$articleid).innerHTML);var g="分享"+this.name+" 对博文【"+f+"】的评论："+a+" 查看原文：";var h=encodeURIComponent(g);var i="http://v.t.sina.com.cn/share/share.php?",j="新浪-博客",k="http://blog.sina.com.cn",l="http://v.t.sina.com.cn/share/share.php?searchPic=false&title="+h+"&url="+encodeURIComponent(document.location)+"&source="+j+"&sourceUrl="+encodeURIComponent(k)+"&content=utf-8&appkey=1617465124";window.open(l,"selectionshare","toolbar=0,status=0,resizable=1,width=440,height=430,left="+(screen.width-440)/2+",top="+(screen.height-430)/2)},__commentShare:function(){var a=$E("t_"+scope.$articleid).innerHTML;a=a.replace(/\&nbsp\;/g," ");var b=this.data.commentid;var c=$E("body_cmt_"+b);var d,e;if(typeof c.innerText==="string"){d=c.innerText}else{d=c.textContent}if(this.data.fromProduct==="blog"){var f=/\[emoticons=(E___\w*)\]([^[]*)\[\/emoticons\]/gi;var g=/\[magicemoticons=([E|W]___\w*)\&nbsp\;swfname=(\w+\.swf)\]([^[]*)\[\/magicemoticons\]/gi;d=d.replace(f,"[$2]");d=d.replace(g,"[$3]");e=" "+this.data.uname}else{var h=/<img\s[\S]*\salt=[\]["][^-]*[-]?([\S]*)[\]["]\s?[\][/]>/ig;d=d.replace(h,"[$1]");e="@"+this.data.uname}d=this.shorten(d,100);a=this.shorten(a,60);var i="分享"+e+" 对博文【"+a+"】的评论："+d+" 查看原文：";var j=encodeURIComponent(i),k="新浪-博客",l="http://blog.sina.com.cn",m="http://v.t.sina.com.cn/share/share.php?searchPic=false&title="+j+"&url="+encodeURIComponent(document.location)+"&source="+k+"&sourceUrl="+encodeURIComponent(l)+"&content=utf-8&appkey=1617465124";window.open(m,"selectionshare","toolbar=0,status=0,resizable=1,width=440,height=430,left="+(screen.width-440)/2+",top="+(screen.height-430)/2)}});CommentV2.ReplyList=function(a){this.type="reply";this.cmtAdd=new CommentV2.Add({type:this.type,url:"http://control.blog.sina.com.cn/admin/comment_new/cms_usereply_post.php?domain=2",tpl:a.replyTpl||""});this.ownerNickName=a.data.ownerNickName||"";this.cmtDel=new CommentV2.Delete;this.cmtReport=new CommentV2.Report;this.cmtShare=new CommentV2.Share;this._openAreas={}}.$extends(CommentV2.List).$define({load:function(a){var b=this;this.initContainerAndTextArea();this.show();if(this.data.cms_reply_num==0){return}this.showLoading();this.page=a;var c={article_id:this.articleid,comment_id:this.data.commentid,page:this.page};this.url="http://control.blog.sina.com.cn/admin/comment_new/cms_usereply_list.php?domain=2";this.loader=new Interface(this.url,"ijax");this.loader.request({POST:c,returnType:"json",onSuccess:b.render.bind2(b),onError:function(a){trace("reply list onerror");this.error(a.code)}.bind2(b),onFail:function(a){trace("reply list onfail");this.error(a.code)}.bind2(b)})},render:function(a){this.renderList(a);this.paging()},initContainerAndTextArea:function(a){if(this.containerIsReady){return}var b='<div class="SG_reply_con borderc">'+'<div class="bd">'+'<div id="comment_'+this.data.commentid+'_textarea">'+"</div>"+'<div class="reply_list">'+'<ul id="comment_'+this.data.commentid+'_replylist" style="display:none;">'+"</ul>"+"</div>"+'<div class="rp2" id="loading_'+this.data.commentid+'" style="display:none"><div class="SG_reply_con"><div class="bd"><div class="loading"><span class="ico_loading"></span><p>正在加载，请稍后...</p></div></div></div></div>'+'<div class="SG_page" style="display:none;">'+'<ul class="SG_pages" id="comment_'+this.data.commentid+'_pages">'+"</ul>"+"</div>"+"</div>"+"</div>";this.containerNode.innerHTML=b;this.renderTextArea();this.containerIsReady=1},renderTextArea:function(){var a=new CommentV2.CommentArea({container:$E("comment_"+this.data.commentid+"_textarea")});var b=this.data;var c=$E("ownernick");var d=c?this.trim(c.innerHTML):"";a.setReplyData(this,{article_id:this.articleid,reply_cmsid:b.commentid,stair_cmsid:b.commentid,src_uname:this.data.ownerNickName||d,blog_title:$E("t_"+this.articleid)?this.trim($E("t_"+this.articleid).innerHTML):"",uid:$UID,source_uid:b.comm_uid,source_uname:b.uname,login_name:scope.$loginNick,is_t:0,source_ulink:b.ulink})},renderList:function(a){Lib.checkAuthor();if(a==""){this.error($isAdmin?"B36021":"B36020")}else{var b=document.createDocumentFragment();var c;this.total=a&&a.cms_usereply_totalnum;this.total=parseInt(this.total,10);this.hideLoading();if(this.total==0){this.show();return}var d=a.comment_reply_data;var e=d.length;var f=a.blog_id;for(var g=0;g<e;g++){var h=d[g];h.action_data=this.obj2str({articleid:f,commentid:h.stair_cms_id,replyid:h.id,comm_uid:h.comm_uid,uname:h.uname,source_uid:h.source_uid,ulink:h.ria_index_url,source_ulink:h.ulink,src_uid:h.src_uid});c=this.cmtAdd.render(h,g,e);b.appendChild(c)}$E("comment_"+this.data.commentid+"_replylist").appendChild(b);$E("comment_"+this.data.commentid+"_replylist").style.display="";location.hash="cmt_"+this.data.commentid}},show:function(){CommentV2.ReplyList.$super.show.call(this);v7sendLog("32_01_01");var a=this.node.innerHTML;a=a.replace(/回复|取消回复/,"取消回复");this.node.innerHTML=a},hide:function(){CommentV2.ReplyList.$super.hide.call(this);v7sendLog("32_01_02");var a=this.node.innerHTML;a=a.replace("取消","");this.node.innerHTML=a},showLoading:function(){$E("comment_"+this.data.commentid+"_replylist").innerHTML="";$E("loading_"+this.data.commentid).style.display=""},hideLoading:function(){$E("loading_"+this.data.commentid).style.display="none"},paging:function(){var a=this;var b=$E("comment_"+this.data.commentid+"_pages");if(b){var c=20,d=0;if(this.total%c==0){d=Math.ceil(this.total/c)}else{d=Math.floor(this.total/c)+1}if(this.total>c){b.parentNode.style.display="block";b.style.display="block";Ui.Pagination.init({pageNode:"comment_"+a.data.commentid+"_pages",nodeClassNamePrefix:"SG",curPage:this.page,maxPage:d,pageTpl:function(b){a.load(b);location.hash=""}}).show()}else{b.parentNode.style.display="none"}}},setSrcComment:function(a,b,c){var d={cms_id:a,uid:b,origin:1};var e=this;var f=new Interface("http://control.blog.sina.com.cn/blog_rebuild/riaapi/profile/note/getCms.php","jsload");f.request({GET:d,onSuccess:function(a){var b=a.cms_body;var d=a.nick_name;var e=a.source_uname;if(b){var f="//@"+d+" 回复 @"+e+" :"+b;c.setValues({comment:f})}}.bind2(this),onError:function(a){if(a&&a.code){winDialog.alert($SYSMSG[a.code],{funcOk:function(){}})}},onFail:function(a){if(a&&a.code){winDialog.alert($SYSMSG[a.code],{funcOk:function(){}})}}})},reply:function(a){var b=this;if(!a.containerNode.isInited){v7sendLog("32_01_05");a.node.innerHTML="<cite>取消回复</cite>";var c='<div class="SG_reply_con">'+'<div class="bd" id="reply_'+a.data.replyid+'_textarea">'+"</div>"+"</div>";var d=document.createElement("div");d.className="SG_reply borderc rp2";d.innerHTML=c;d.id="reply_"+a.data.replyid+"_textcon";a.containerNode.appendChild(d);a.containerNode.isInited=true;var e=$E("reply_"+a.data.replyid+"_textarea");var f=a.data;this._openAreas[a.data.replyid]=new CommentV2.CommentArea({container:e,autolineheight:"yes",sid:(new Date).getTime(),shownum:"no",okhandler:function(){var b=$E("reply_"+a.data.replyid+"_textcon");if(b){b.style.display="none";a.node.innerHTML="<cite>回复</cite>"}}});this._openAreas[a.data.replyid].setReplyData(b,{article_id:a.articleid,reply_cmsid:f.replyid,stair_cmsid:f.commentid,src_uname:this.ownerNickName,blog_title:$E("t_"+a.articleid).innerHTML,uid:$UID,source_uid:f.comm_uid,source_uname:f.uname,login_name:scope.$loginNick,is_t:0,source_ulink:f.source_ulink});this.setSrcComment(f.replyid,f.src_uid,this._openAreas[a.data.replyid])}else{var g=$E("reply_"+a.data.replyid+"_textcon");if(g.style.display=="none"){v7sendLog("32_01_05");g.style.display="";if(this._openAreas[a.data.replyid].getValue()==""){this.setSrcComment(a.data.replyid,a.data.src_uid,this._openAreas[a.data.replyid])}a.node.innerHTML="<cite>取消回复</cite>"}else{g.style.display="none";a.node.innerHTML="<cite>回复</cite>"}}},add:function(a,b,c){trace("CommentV2.ReplyList.add");trace(a);a.cms_reply_num=this.total;this.cmtAdd.post(a,function(){this.total++;var a=this.node.innerHTML;this.node.innerHTML=a.replace(/(\d+)/,this.total);var a=$E("c_"+this.articleid).innerHTML;var c=parseInt(/(\d+)/.exec(a)[0],10);c++;$E("c_"+this.articleid).innerHTML="("+c+")";b()}.bind2(this),c)},share:function(a){trace("CommentV2.ReplyList.share");v7sendLog("32_01_06");this.cmtShare.replyShare(a.data)},del:function(a){trace("CommentV2.ReplyList.del");v7sendLog("32_01_08");this.cmtDel.deleteReply(a,this.delSucc.bind2(this))},delSucc:function(a){this.total=this.total--?this.total:0;var b=this.node.innerHTML;this.node.innerHTML=b.replace(/(\d+)/,this.total);var b=$E("c_"+this.articleid).innerHTML;var c=parseInt(/(\d+)/.exec(b)[0],10);c=c--?c:0;$E("c_"+this.articleid).innerHTML="("+c+")";if(this.total==0){$E("comment_"+this.data.commentid+"_replylist").style.display="none"}},report:function(a){trace("CommentV2.ReplyList.report");v7sendLog("32_01_07");this.cmtReport.replyReport(a.data)}});CommentV2.CommentList=function(a){this.ownerNickName="";this.type="comment";this.defaultAnchor="#comment";this.replyList={};this.addEvent=Core.Events.addEvent;this.removeEvent=Core.Events.removeEvent;this.cmtAdd=new CommentV2.Add({type:this.type,tpl:a.commentTpl||""});this.cmtDel=new CommentV2.Delete;this.cmtReport=new CommentV2.Report;this.cmtShare=new CommentV2.Share;this.bindEvent()}.$extends(CommentV2.List).$define({load:function(a){var b=this;this.page=a;this.url=this.purl+"_"+this.page+".html?comment_v=articlenew";this.loader=new Interface(this.url,"ajax");this.loader.request({GET:{url_random:0},returnType:"json",onSuccess:b.render.bind2(b),onError:function(a){switch(a.code){case"B36020":case"B36021":case"A00001":this.error(a.code);break;default:this.showError(a.code);this.error("B36110");break}}.bind2(this),onFail:function(){this.error("B36110")}.bind2(this)})},render:function(a){Lib.checkAuthor();this.containerNode.innerHTML="";if(a==""){this.error($isAdmin?"B36021":"B36020");return}else{var b=document.createDocumentFragment();var c,d;this.total=a.comment_total_num;if(this.total==0){this.renderNoComment()}for(var e=0,f=a.comment_data.length;e<f;e++){d=a.comment_data[e];d.action_data=this.obj2str({commentid:d.id,articleid:scope.$articleid,fromProduct:d.fromProduct,comm_uid:d.comm_uid,uname:d.uname,ulink:d.ulink,src_uid:d.src_uid,cms_reply_num:d.cms_reply_num});c=this.cmtAdd.render(d,e);b.appendChild(c)}this.containerNode.appendChild(b)}this.anchor();this.paging();this.sendEvents(a)},sendEvents:function(a){Lib.Listener.notify("commentlist-isready",a);scope.$commentlistIsReady=1},renderNoComment:function(){this.containerNode.innerHTML='<li><div class="noCommdate"><span class="SG_txtb">做第一个评论者吧！ '+'<img class="SG_icon SG_icon134" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="18" height="18" title="" align="absmiddle">'+'<a href="#post">抢沙发&gt;&gt;</a></span></div></li>'},add:function(a){var b=a.item,c=a.fun;var d=this.cmtAdd.render(a.item);c(d)},del:function(a){trace("CommentV2.CommentList.del");this.cmtDel.deleteComment(a,this.delSucc.bind2(this))},delSucc:function(a){this.total=a&&a.staircms_total_num;var b=$E("c_"+scope.$articleid).innerHTML;var c=parseInt(/(\d+)/.exec(b)[0],10);c=c--?c:0;$E("c_"+scope.$articleid).innerHTML="("+c+")";if(this.total==0){this.renderNoComment()}else{if(this.containerNode.getElementsByTagName("li").length==0){this.page--;this.load(this.page)}}},reply:function(a){trace("CommentV2.CommentList.reply");var b=this;Lib.Uic.getNickName([scope.$uid],function(c){b.ownerNickName=c[scope.$uid]||"";a.replyTpl=b.replyTpl||"";a.data.ownerNickName=b.ownerNickName;var d=a.data.commentid;if(b.replyList[d]){b.replyList[d].toggle()}else{b.replyList[d]=new CommentV2.ReplyList(a)}})},report:function(a){trace("CommentV2.CommentList.report");this.cmtReport.commentReport(a.data)},share:function(a){trace("CommentV2.CommentList.share");this.cmtShare.commentShare(a.data)},more:function(a){trace("CommentV2.CommentList.more");var b=a.data.commentid;var c=$E("body_cmt_"+b);var d=$E("body_cmt_full_"+b);if(a.node.className=="btn_artzk"){v7sendLog("32_01_03");c&&(c.style.display="none");d&&(d.style.display="")}else if(a.node.className=="btn_artsq"){v7sendLog("32_01_04");c&&(c.style.display="");d&&(d.style.display="none")}},paging:function(){var a=this;var b=$E("commentPaging");if(b){var c=50,d=0;if(this.total%c==0){d=Math.ceil(this.total/c)}else{d=Math.floor(this.total/c)+1}if(this.total>c){b.parentNode.style.display="block";$E("commentPaging").style.display="block";Ui.Pagination.init({pageNode:"commentPaging",nodeClassNamePrefix:"SG",curPage:this.page,maxPage:d,pageTpl:function(b){a.load(b)}}).show();b.onclick=this.sudaClick}else{b.parentNode.style.display="none"}}},sudaClick:function(a){var b=a&&a.target||window.event&&window.event.srcElement;if(b&&b.tagName&&b.tagName.toLowerCase()=="a"){Lib.sendSuda(function(){try{SUDA.log("","blog_blogcomment_page")}catch(a){}})}else{return}},anchor:function(){var a=window.location.href;var b="#comment";var c=new RegExp("("+b+")\\d*");if(a.indexOf(b)!=-1){window.location.href=a.replace(c,"$1"+this.page)}else{if(this.page>1){window.location.href=b+this.page}}},showError:function(a){winDialog.alert($SYSMSG[code],{icon:"02"})}});Sina.pkg("Utils.Flash");if(typeof deconcept=="undefined")var deconcept=new Object;if(typeof deconcept.util=="undefined")deconcept.util=new Object;if(typeof deconcept.SWFObjectUtil=="undefined")deconcept.SWFObjectUtil=new Object;deconcept.SWFObject=function(a,b,c,d,e,f,g,h,i,j){if(!document.getElementById){return}this.DETECT_KEY=j?j:"detectflash";this.skipDetect=deconcept.util.getRequestParameter(this.DETECT_KEY);this.params=new Object;this.variables=new Object;this.attributes=new Array;if(a){this.setAttribute("swf",a)}if(b){this.setAttribute("id",b)}if(c){this.setAttribute("width",c)}if(d){this.setAttribute("height",d)}if(e){this.setAttribute("version",new deconcept.PlayerVersion(e.toString().split(".")))}this.installedVer=deconcept.SWFObjectUtil.getPlayerVersion();if(!window.opera&&document.all&&this.installedVer.major>7){deconcept.SWFObject.doPrepUnload=true}if(f){this.addParam("bgcolor",f)}var k=g?g:"high";this.addParam("quality",k);this.setAttribute("useExpressInstall",false);this.setAttribute("doExpressInstall",false);var l=h?h:window.location;this.setAttribute("xiRedirectUrl",l);this.setAttribute("redirectUrl","");if(i){this.setAttribute("redirectUrl",i)}};deconcept.SWFObject.prototype={useExpressInstall:function(a){this.xiSWFPath=!a?"expressinstall.swf":a;this.setAttribute("useExpressInstall",true)},setAttribute:function(a,b){this.attributes[a]=b},getAttribute:function(a){return this.attributes[a]},addParam:function(a,b){this.params[a]=b},getParams:function(){return this.params},addVariable:function(a,b){this.variables[a]=b},getVariable:function(a){return this.variables[a]},getVariables:function(){return this.variables},getVariablePairs:function(){var a=new Array;var b;var c=this.getVariables();for(b in c){a[a.length]=b+"="+c[b]}return a},getSWFHTML:function(){var a="";if(navigator.plugins&&navigator.mimeTypes&&navigator.mimeTypes.length){if(this.getAttribute("doExpressInstall")){this.addVariable("MMplayerType","PlugIn");this.setAttribute("swf",this.xiSWFPath)}a='<embed pluginspage="http://www.macromedia.com/go/getflashplayer" type="application/x-shockwave-flash" src="'+this.getAttribute("swf")+'" width="'+this.getAttribute("width")+'" height="'+this.getAttribute("height")+'" style="'+this.getAttribute("style")+'"';a+=' id="'+this.getAttribute("id")+'" name="'+this.getAttribute("id")+'" ';var b=this.getParams();for(var c in b){a+=[c]+'="'+b[c]+'" '}var d=this.getVariablePairs().join("&");if(d.length>0){a+="flashvars="+d+'&realfull=1&moz=1"'}a+="/>"}else{if(this.getAttribute("doExpressInstall")){this.addVariable("MMplayerType","ActiveX");this.setAttribute("swf",this.xiSWFPath)}a='<object id="'+this.getAttribute("id")+'" classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" codebase="http://fpdownload.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=9,0,28,0" width="'+this.getAttribute("width")+'" height="'+this.getAttribute("height")+'" style="'+this.getAttribute("style")+'">';a+='<param name="movie" value="'+this.getAttribute("swf")+'" />';var b=this.getParams();for(var c in b){a+='<param name="'+c+'" value="'+b[c]+'" />'}var d=this.getVariablePairs().join("&");if(d.length>0){a+='<param name="flashvars" value="'+d+'" />'}a+="</object>"}return a},write:function(a){if(this.getAttribute("useExpressInstall")){var b=new deconcept.PlayerVersion([6,0,65]);if(this.installedVer.versionIsValid(b)&&!this.installedVer.versionIsValid(this.getAttribute("version"))){this.setAttribute("doExpressInstall",true);this.addVariable("MMredirectURL",escape(this.getAttribute("xiRedirectUrl")));document.title=document.title.slice(0,47)+" - Flash Player Installation";this.addVariable("MMdoctitle",document.title)}}if(this.skipDetect||this.getAttribute("doExpressInstall")||this.installedVer.versionIsValid(this.getAttribute("version"))){}else{if(this.getAttribute("redirectUrl")!=""){document.location.replace(this.getAttribute("redirectUrl"))}}var c=typeof a=="string"?document.getElementById(a):a;var d=document.title;c.innerHTML=this.getSWFHTML();if(d!==document.title){document.title=d}return true}};deconcept.SWFObjectUtil.getPlayerVersion=function(){var a=new deconcept.PlayerVersion([0,0,0]);if(navigator.plugins&&navigator.mimeTypes.length){var b=navigator.plugins["Shockwave Flash"];if(b&&b.description){a=new deconcept.PlayerVersion(b.description.replace(/([a-zA-Z]|\s)+/,"").replace(/(\s+r|\s+b[0-9]+)/,".").split("."))}}else if(navigator.userAgent&&navigator.userAgent.indexOf("Windows CE")>=0){var c=1;var d=3;while(c){try{d++;c=new ActiveXObject("ShockwaveFlash.ShockwaveFlash."+d);a=new deconcept.PlayerVersion([d,0,0])}catch(e){c=null}}}else{try{var c=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7")}catch(e){try{var c=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6");a=new deconcept.PlayerVersion([6,0,21]);c.AllowScriptAccess="always"}catch(e){if(a.major==6){return a}}try{c=new ActiveXObject("ShockwaveFlash.ShockwaveFlash")}catch(e){}}if(c!=null){a=new deconcept.PlayerVersion(c.GetVariable("$version").split(" ")[1].split(","))}}return a};deconcept.PlayerVersion=function(a){this.major=a[0]!=null?parseInt(a[0]):0;this.minor=a[1]!=null?parseInt(a[1]):0;this.rev=a[2]!=null?parseInt(a[2]):0};deconcept.PlayerVersion.prototype.versionIsValid=function(a){if(this.major<a.major)return false;if(this.major>a.major)return true;if(this.minor<a.minor)return false;if(this.minor>a.minor)return true;if(this.rev<a.rev)return false;return true};deconcept.util={getRequestParameter:function(a){var b=document.location.search||document.location.hash;if(a==null){return b}if(b){var c=b.substring(1).split("&");for(var d=0;d<c.length;d++){if(c[d].substring(0,c[d].indexOf("="))==a){return c[d].substring(c[d].indexOf("=")+1)}}}return""}};deconcept.SWFObjectUtil.cleanupSWFs=function(){var a=document.getElementsByTagName("OBJECT");for(var b=a.length-1;b>=0;b--){a[b].style.display="none";for(var c in a[b]){if(typeof a[b][c]=="function"){a[b][c]=function(){}}}}};if(deconcept.SWFObject.doPrepUnload){if(!deconcept.unloadSet){deconcept.SWFObjectUtil.prepUnload=function(){__flash_unloadHandler=function(){};__flash_savedUnloadHandler=function(){};window.attachEvent("onunload",deconcept.SWFObjectUtil.cleanupSWFs)};window.attachEvent("onbeforeunload",deconcept.SWFObjectUtil.prepUnload);deconcept.unloadSet=true}}if(!document.getElementById&&document.all){document.getElementById=function(a){return document.all[a]}}var getQueryParamValue=deconcept.util.getRequestParameter;var FlashObject=deconcept.SWFObject;Utils.Flash.swfObject=deconcept.SWFObject;Core.Dom.getTop=function(a){var b=0;var c=$E(a);if(typeof c.offsetParent!="unknown"){while(c.offsetParent){b+=c.offsetTop;c=c.offsetParent}}else if(c.y){b+=c.y}return b};Core.Dom.getLeft=function(a){var b=0;var c=$E(a);if(typeof c.offsetParent!="unknown"){while(c.offsetParent){b+=c.offsetLeft;c=c.offsetParent}}else if(c.x){b+=c.x}return b};Lib.applyIf=function(a,b,c){if(c){Lib.applyIf(a,c)}if(a&&b&&typeof a==="object"){for(var d in b){if(!a[d]){a[d]=b[d]}}}return a};Lib.apply=function(a,b,c){if(c){Lib.applyIf(a,c)}if(a&&b&&typeof a==="object"){for(var d in b){a[d]=b[d]}}return a};Lib.Panel=Core.Class.create();Lib.Panel.prototype={noIframe:!1,isPostion:!0,appendTo:null,entity:null,backIframe:null,uniqueID:null,isFixed:false,isShow:!1,isHidden:!0,x:0,y:0,template:"",initialize:function(a){Lib.apply(this,a);var b=this;this.uniqueID=this._getUniqueID();this._ie6Fixed=function(){if(b.entity){b.entity.style.left=document.documentElement.scrollLeft+b.x+"px";b.entity.style.top=document.documentElement.scrollTop+b.y+"px"}if(b.backIframe){b.backIframe.style.left=b.entity.style.left;b.backIframe.style.top=b.entity.style.top}}},getNode:function(a){return this.tpl.getNode(a)},setTemplate:function(a){this.template=a;if(this.entity&&this.entity.parentNode){this.entity.parentNode.removeChild(this.entity);this.backIframe&&this.backIframe.parentNode.removeChild(this.backIframe)}this.entity=$C("div");var b=$C("div");var c=new Lib.HtmlTemplate(this.template,this.uniqueID);this.tpl=c;b.innerHTML=c.getHtmlString();b.style.display="none";if(this.appendTo){$E(this.appendTo).appendChild(b)}else{document.body.appendChild(b)}this.entity=$E("_"+this.uniqueID+"_panel");if(this.isPostion){this.entity.style.position="absolute"}this.entity.style.display="none";if(this.appendTo){$E(this.appendTo).replaceChild(this.entity,b)}else{document.body.replaceChild(this.entity,b)}b=null;if(!this.noIframe){this.backIframe=$C("iframe");this.backIframe.style.display="none";this.backIframe.style.border="none";this.backIframe.style.zIndex=this.entity.style.zIndex-1;document.body.appendChild(this.backIframe);this._updateBackIframe()}},setPosition:function(a,b){this.x=a;this.y=b;this.entity.style.left=a+"px";this.entity.style.top=b+"px";if($IE6&&this.isFixed){this.entity.style.left=a+document.documentElement.scrollLeft+"px";this.entity.style.top=b+document.documentElement.scrollTop+"px"}if(this.backIframe){this.backIframe.style.left=this.entity.style.left;this.backIframe.style.top=this.entity.style.top}},setFixed:function(a){this.isFixed=a;if($IE6){var b=this;this.entity.style.position="absolute";if(this.isFixed){b._ie6Fixed();Core.Events.addEvent(window,b._ie6Fixed,"scroll")}else{Core.Events.removeEvent(window,b._ie6Fixed,"scroll")}return}this.entity.style.position=this.isFixed?"fixed":"absolute";if(this.backIframe){this.backIframe.style.position=this.entity.style.position}},show:function(){this.entity.style.display="";this.isHidden=!1;this.isShow=!0;if(this.backIframe){this._updateBackIframe();this.backIframe.style.display=""}},hidden:function(){this.hide()},hide:function(){this.entity.style.display="none";this.isHidden=!0;this.isShow=!1;if(this.backIframe){this.backIframe.style.display="none"}},close:function(){this.hidden();this.destroy()},destroy:function(){Core.Events.removeEvent(window,this._ie6Fixed,"scroll");this.entity.parentNode.removeChild(this.entity);this.entity=null;if(this.backIframe){this.backIframe.parentNode.removeChild(this.backIframe);this.backIframe=null}},showWithDom:function(a,b,c){var d=Core.Dom.getLeft(a)+a.offsetWidth+b;var e=Core.Dom.getTop(a)+a.offsetHeight+c;if($IE6&&this.isFixed){d=d-document.documentElement.scrollLeft;e=e-document.documentElement.scrollTop}this.setPosition(d,e);this.show()},getWidth:function(){var a=this.entity.style.display;var b=this.entity.style.visibility;this.entity.style.visibility="hidden";this.entity.style.display="";w=this.entity.offsetWidth;this.entity.style.display=a;this.entity.style.visibility=b;return w},getHeight:function(){var a=this.entity.style.display;var b=this.entity.style.visibility;this.entity.style.visibility="hidden";this.entity.style.display="";h=this.entity.offsetHeight;this.entity.style.display=a;this.entity.style.visibility=b;return h},getX:function(){return parseInt(this.entity.style.left)},getY:function(){return parseInt(this.entity.style.top)},getNodes:function(a){var b=a||"o";var c=/[^\{\}]+(?=\})/g;var d;var e={};var f=this.template.match(c);if(f){for(d=0;d<f.length;d++){var g=f[d];switch(b){case"o":e[g]=$E("_"+this.uniqueID+"_"+g);break;case"i":e[g]="_"+this.uniqueID+"_"+g;break}}}return e},_updateBackIframe:function(){Core.Dom.setStyle(this.backIframe,"opacity",0);this.backIframe.style.display="";this.backIframe.style.position=this.entity.style.position;this.backIframe.style.width=this.entity.offsetWidth+"px";this.backIframe.style.height=this.entity.offsetHeight+"px";this.backIframe.style.left=this.entity.style.left;this.backIframe.style.top=this.entity.style.top},_getUniqueID:function(){return parseInt(Math.random()*1e3).toString()+(new Date).getTime().toString()}};var showUpTips=function(){winDialog.alert('您可以在<a href="http://get.adobe.com/flashplayer/" target="_blank">此处下载免费的Adobe flash player installer</a>。成功安装程序后，可返回此处查看。',{icon:"01"})};scope.magicCfg={};window.$magicFacePlay=function(a){var b;if(!scope.flashVersion){scope.flashVersion=deconcept.SWFObjectUtil.getPlayerVersion()}b=scope.flashVersion;if(b.major<9){showUpTips();return}Core.Events.stopEvent();var c={alphaNodeId:"alphaNode",containerDiv:"magicFaceCon"};var d=['<div id="magicFaceCon" title="" alt="" style="height:360px; width:360px;">',"</div>"].join("");scope.magicCfg.layer=new Lib.Panel;scope.magicCfg.layer.setTemplate('<div style="position:absolute;z-index:2000;" id="#{panel}" title="" alt="">'+d+"</div>");scope.magicCfg.layer.show();var e="magicFace";var f=function(){scope.magicCfg.shadow=new BackShadow(.4);scope.magicCfg.shadow.entity.setAttribute("title","点击关闭动画");scope.magicCfg.shadow.entity.setAttribute("alt","点击关闭动画");scope.magicCfg.shadow.entity.onclick=g;Core.Events.addEvent(document,h,"keydown");scope.magicCfg.shadow.show();var b=Core.System.winSize();var d=Core.System.getScrollPos(document);var f=b.width/2-360/2+d[1];var i=b.height/2-360/2+d[0];scope.magicCfg.layer.setPosition(f,i);var j=document.createElement("div");j.id="___flashOverlay";j.style.cssText="cursor:pointer;visibility:hidden;background:white;;z-index:3000;position:absolute;width:360px;height:360px;top:"+i+"px;left:"+f+"px";document.body.appendChild(j);if(document.all){j.style.filter="Alpha(Opacity=0)"}else{j.style.opacity=0}j.style.visibility="visible";Core.Events.addEvent(j,function(){window.open("http://blog.sina.com.cn/myshow2010")});j=null;var k=new Utils.Flash.swfObject("http://www.sinaimg.cn/uc/myshow/blog/misc/gif/"+a+"?t="+Core.Math.getUniqueId(),e,360,360,9,"#FFFFFF");k.addParam("quality","high");k.addParam("wmode","transparent");k.addParam("allowScriptAccess","always");k.write(c.containerDiv)};var g=function(){trace("swf remove!!!");var a=$E(c.containerDiv);if(a){a.innerHTML=""}window.clearInterval(i);Core.Events.removeEvent(document,h,"keydown");try{scope.magicCfg.shadow.close();scope.magicCfg.layer.close();Core.Events.stopEvent()}catch(b){}if($E("___flashOverlay")){document.body.removeChild($E("___flashOverlay"))}};var h=function(a){var b=a.keyCode||a.which||a.charCode;if(b===27){g();Core.Events.removeEvent(document,h,"keydown");Core.Events.stopEvent();return false}};f();var i=window.setInterval(function(){trace("……追踪 进度……");var a=$E(e);var b=0;if(a&&a.PercentLoaded()==100){a.onclick=function(){Core.Events.stopEvent()};trace("swf 加载完毕了………………");var c=a.parentNode;var d=Core.System.getScrollPos(document);var f=Core.System.winSize();var h=f.width/2-c.offsetWidth/2+d[1];var j=f.height/2-c.offsetHeight/2+d[0];scope.magicCfg.layer.setPosition(h,j);scope.magicCfg.layer.show();trace("flash size x="+c.offsetWidth+"  y="+c.offsetHeight);window.clearInterval(i);i=window.setInterval(function(){var c=a.CurrentFrame();var d;try{d=a.TotalFrames()}catch(e){d=a.TotalFrames}if(c<0){return}if(c<d&&b<=c){b=c}else{g()}},80)}},100)};$registJob("articleCommentV2",function(){Lib.LazyLoad([$E("article_comment_list")],{callback:function(){if(!scope.$comment_is_load_page_1&&scope.$private.cms!=1&&scope.$isCommentAllow!=1){var a=new CommentV2.CommentList({purl:"http://blog.sina.com.cn/s/comment_"+scope.$articleid,containerNode:$E("article_comment_list")})}}})});if(typeof App=="undefined"){var App={}}$ScriptLoader={callback:{},response:function(a,b){var c=(scope.$uid*1).toString(16);var d=c.length;if(8>d){for(var e=0,f=8-d;e<f;e++){c="0"+c}}var g={};for(var h in b){g[c+"01"+h]=b[h]}this.callback[a].func(g);var i=scope.$pageid;if(i=="article"||i=="articleM"||!i.indexOf("articletj")){var j=scope.useNewInterfaceToGetNum;if(!j){scope.useNewInterfaceToGetNum={};j=scope.useNewInterfaceToGetNum}var k=0;for(var l in b){k=b[l]["d"];break}if(j){var m="digg_m_"+scope.$articleid;var n={};n[m]=k;if(j.onSuccess){j.onSuccess(n)}else{var o=0;var p=setInterval(function(){if(o>300){clearInterval(p);if(j&&j.onException){j.onException(n)}return}if(j&&j.onSuccess){clearInterval(p);j.onSuccess(n)}o++},100)}}}}};App.getArticlesDetailNumber=function(a,b,c){if(b==null||b.length==0){return{}}a=a||scope.$uid;var d=(scope.$uid*1).toString(16);var e=d.length;if(8>e){for(var f=0,g=8-e;f<g;f++){d="0"+d}}var h=[];Core.Array.foreach(b,function(a){h.push(a.replace(d+"01",""))});var i=$C("script");var j=Math.ceil(Math.random()*1e4);while($ScriptLoader.callback[j]!=null){j=Math.ceil(Math.random()*1e4)}var k="aritlces_number_"+j;$ScriptLoader.callback[k]={func:c,uid:a};i.src="http://blogtj.sinajs.cn/api/num.php?uid="+d+"&aids="+h.join(",")+"&requestId="+k;i.charset="utf-8";i.onload=i.onerror=i.onreadystatechange=Core.Function.bind2(function(){if(i&&i.readyState&&i.readyState!="loaded"&&i.readyState!="complete"){return}i.onload=i.onreadystatechange=i.onerror=null;i.src="";i.parentNode.removeChild(i);i=null},this);document.getElementsByTagName("head")[0].appendChild(i)};$registJob("articleNumberV2",function(){Lib.checkAuthor();if(scope.$pn_x_rank=="1"&&!$isAdmin){return false}var a=scope.$uid;var b=scope.$articleid;App.getArticlesDetailNumber(a,[b],function(a){var c=a[b];for(var d in c){if(scope.$pageid==="articletjTech"){if(d==="c"){$E("comment_tj_"+b).innerHTML="评论("+c[d]+")"}}if($E(d+"_"+b)){$E(d+"_"+b).innerHTML="("+c[d]+")"}}})});Core.Events.fireEvent=function(a,b){var c;a=$E(a);if(a.fireEvent){a.fireEvent("on"+b)}else{if($MOBILE){c=document.createEvent("HTMLEvents")}else{c=document.createEvent("MouseEvents")}c.initEvent(b,true,true);a.dispatchEvent(c)}};scope.faceTemplate=['<table id="#{entity}" class="CP_w">','<thead id="#{titleBar}">',"<tr>",'<th class="tLeft"><span></span></th>','<th class="tMid">','<div class="bLyTop">','<strong id="#{titleName}">插入表情</strong>','<cite><a id="#{btnClose}" href="javascript:;" class="CP_w_shut" title="关闭">关闭</a></cite>',"</div>","</th>",'<th class="tRight"><span></span></th>',"</tr>","</thead>","<tfoot>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid"><span></span></td>','<td class="tRight"><span></span></td>',"</tr>","</tfoot>","<tbody>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid" id="#{content}">','<div class="faceItemContent">','<div class="bigface">','<div id="#{faceTab}" class="faceSidebar">',"</div>",'<div id="#{faceContent}" class="faceShowAll">',"</div>","</div>","</div>","</td>",'<td class="tRight"><span></span></td>',"</tr>","</tbody>","</table>"].join("");Lib.Face=Core.Class.create();Lib.Face.prototype={dialog:null,dialogNodes:null,tabs:null,faceConfig:null,template:null,txtContentArea:null,x:0,y:0,isShowed:false,_isInitDialog:false,insertImageFile:"",initialize:function(a,b){var c=this;this.txtContentArea=a;this.template=b;window.$insertFace=function(a,b){c.insertFace(a,b)}},load:function(){var a=this;this.dialog=new Dialog(this.template||scope.faceTemplate);this.dialogNodes=this.dialog.getNodes();this.tabs=new Tabs(this.dialogNodes["faceTab"]);Core.Events.addEvent(this.dialog.entity,function(){Core.Events.stopEvent()},"mousedown");Core.Events.addEvent(document.body,function(){a.hidden()},"mousedown");this.initFaceConfig(function(){if(a.tabs.tabsArr[0]){a.tabs.tabsArr[0].setFocus()}Core.Events.addEvent(a.dialogNodes["btnClose"],function(){a.hidden()},"mousedown");a.onInitialized()});this._isInitDialog=true},initFaceConfig:function(a){var b=this;Utils.Io.JsLoad.request("http://www.sinaimg.cn/uc/myshow/blog/misc/gif/smileConfig.js?varname=smileConfig&"+(new Date).getTime(),{onComplete:function(c){b.faceConfig=c;b.initFaceData();if(a){a()}},charset:"gb2312"})},initFaceData:function(){var a,b=this;for(a in this.faceConfig){this.addTab(a,this.faceConfig[a]["name"],this.faceConfig[a]["data"])}},onInitialized:function(){},textWatchOn:function(){var a=this.txtContentArea;var b=function(){if(a.createTextRange){a.caretPos=document.selection.createRange().duplicate()}};Core.Events.addEvent(a,b,"keyup");Core.Events.addEvent(a,b,"focus");Core.Events.addEvent(a,b,"select");Core.Events.addEvent(a,b,"click")},addTab:function(a,b,c){var d=this;var e=new Tab('<img src="http://www.sinaimg.cn/uc/myshow/blog/misc/gif/'+a+'.gif" height="20" width="20" align="absmiddle"><span><a href="#" onclick="return false;">'+b+"</a></span><em>("+c.length+")</em>",{isFocus:false,className:"cur"});e.addOnAbort(function(){e.content.style.display="none"});e.addOnFocus(function(){if(!e.isShowed){e.isShowed=true;e.content=$C("ul");e.content.innerHTML=d._getTabContent(a,c);d.dialogNodes["faceContent"].appendChild(e.content)}e.content.style.display=""});this.tabs.add(e)},_getTabContent:function(a,b){var c=[],d;var e,f=b.length;for(e=0;e<f;e++){d=b[e]["name"];d=Core.String.byteLength(d)>8?Core.String.leftB(d,6)+"...":d;c.push("<li><a onclick=\"$insertFace('"+b[e]["code"]+"','"+b[e]["name"]+'\');return false;" href="#"><img style="width:50px;height:50px;" title="'+b[e]["name"]+'" src="http://www.sinaimg.cn/uc/myshow/blog/misc/gif/'+b[e]["code"]+'T.gif"/></a><span>'+d+"</span></li>")}return c.join("")},insertFace:function(a,b){this.insertImageFile=a+"T.gif";this.onInsert();if(!this.txtContentArea){return}var c="[emoticons="+a+"]"+b+"[/emoticons]";if($IE){if(this.txtContentArea.createTextRange&&this.txtContentArea.caretPos){var d=this.txtContentArea.caretPos;d.text=d.text.charAt(d.text.length-1)==" "?c+" ":c;this.txtContentArea.focus()}else{this.txtContentArea.value+=c;this.txtContentArea.focus()}}else{if(this.txtContentArea.setSelectionRange){var e=this.txtContentArea.selectionStart;var f=this.txtContentArea.selectionEnd;var g=this.txtContentArea.value.substring(0,e);var h=this.txtContentArea.value.substring(f);this.txtContentArea.value=g+c+h}else{this.txtContentArea.value+=c}}this.hidden();return false},onInsert:function(){},setPosition:function(a,b){this.x=a;this.y=b;this.dialog.setPosition({x:a,y:b})},show:function(){!this._isInitDialog&&this.load();this.dialog.show();this.isShowed=true},hidden:function(){this.isShowed=false;this.dialog.hidden()}};Core.Dom.addHTML=function(a,b){a.insertAdjacentHTML("beforeend",b)};if(!$C("div").insertAdjacentHTML){Core.Dom.addHTML=function(a,b){var c=a.ownerDocument.createRange();c.setStartBefore(a);var d=c.createContextualFragment(b);a.appendChild(d)}}App.smilesTemplate=['<table id="#{entity}" class="CP_w faceItemContent" style="visibility: visible;">','<thead id="#{titleBar}"><tr><th class="tLeft"><span></span></th>','<th class="tMid"><div class="bLyTop"><strong id="#{titleName}">插入表情</strong><cite><a id="#{btnClose}"',' href="#" onclick="return false;" class="CP_w_shut" title="关闭">关闭</a></cite></div></th>','<th class="tRight"><span></span></th></tr></thead>','<tfoot><tr><td class="tLeft"><span></span></td><td class="tMid"><span></span></td>','<td class="tRight"><span></span></td></tr></tfoot>',"<tbody><tr>",'<td class="tLeft"><span></span></td>','<td class="tMid" id="#{content}">','<div class="insertface">','<div class="insertface_top">','<h3>热门动漫表情</h3><div class="insertface_search">','<input id="#{searchText}" type="text" class="SG_input" value="输入关键字、动漫形象"',' style="color:#9b9b9a;" maxlength="20" /><a id="#{searchBtn}" href="#" onclick="return false;" ','hidefocue="true" class="SG_aBtn SG_aBtnB"><cite>查找表情</cite></a></div>','<div class="clearit"></div>',"</div>",'<div class="insertface_hot">','<span class="insertface_keyword">热门关键字：<span id="#{hotKeyword}"></span></span>','<span class="insertface_hotslider"></span>',"</div>",'<div class="bigface">','<div class="faceSidebar">','<div id="#{keyCtrl}" class="facekeyword" style="display:none;">','<p><< <a id="#{keyCtrlBack}" href="#" onclick="return false;">返回全部关键字</a></p>','<p>关键字：<span id="#{keyWord}"></span></p></div>','<h3 id="#{allSort}" class="facetitle" style="font-weight:600;"><a href="#"',' onclick="return false;">全部</a></h3>','<div id="#{sortList}" class="facelist"></div>','<div id="#{sortCtrl}" class="facearrow"></div>',"</div>",'<div class="faceShowAll">','<div id="#{smileEmpty}" class="faceShownone" style="display:none;"><p>找不到和关键字相符的表情。','<br /><br /><a id="#{smileEmptyBack}" href="#" onclick="return false;">&lt;&lt;返回首页</a></p></div>','<ul class="faceShowAll_list" id="#{smileList}"></ul>','<div class="SG_page"><ul class="SG_pages">','<li id="#{smilePagePrev}" class="SG_s_pgprev"></li>','<li id="#{smilePageShow}" class="SG_s_pgnum"></li>','<li id="#{smilePageNext}" class="SG_s_pgnext"></li>','<li class="play" id="#{magicTip}">点击<img align="absmiddle" src="http://simg.sinajs.cn/blog7style/images/common/img_arrow_r.gif">预览动画效果</li>',"</ul></div>","</div>","</div>","</div>",'</td><td class="tRight"><span></span></td>',"</tr></tbody></table>"].join("");App.smilesDialog2=Core.Class.create();App.smilesDialog2.prototype={pageSize:24,defaultConfig:{sortId:"0",htmlTpl:App.smilesTemplate,callback:function(){}},initialize:function(a){this.option=a||{};for(var b in this.defaultConfig){if(this.option[b]==null){this.option[b]=this.defaultConfig[b]}}this.dialog=new Dialog(this.option.htmlTpl);this.dialog.setAreaLocked(true);this.dialogNodes=this.dialog.getNodes();this.getKeyWord();if(scope.smilesData!=null){this.data=scope.smilesData;this.dataSettle();this.eventListen()}else{var c=this;var d=Utils.Io.JsLoad.request([{url:"http://www.sinaimg.cn/uc/myshow/blog/misc/gif/smileConfig8.js?varname=smileConfig"}],{onComplete:function(a){scope.smilesData=a;c.data=a;c.dataSettle();c.eventListen()},onException:function(){}})}return this},dataSettle:function(a,b){a=a||this.data;b=b||9;this.tabsData=[];this.allData=[];for(var c in a){var d=a[c];d.sortId=c;this.tabsData.push(d);for(var e=0,f=d.data.length;e<f;e++){d.data[e].sid=c;d.data[e].sname=d.name}this.allData=this.allData.concat(d.data)}if(this.allDataBack==null){this.allDataBack=this.allData.slice(0)}this.showTab(1,b);if(this.dialogNodes.smileList.childNodes.length==0){this.showAll()}},children:function(a){var b=[];for(var c=0;a[c];c++){if(a[c].nodeType==1){b.push(a[c])}}return b},showTab:function(a,b){a=a||1;b=b||9;this.dialogNodes.sortList.innerHTML="";this.dialogNodes.smileList.innerHTML="";Core.Dom.setStyle(this.dialogNodes.sortList,"height",b==9?"279px":"217px");this.tabs=new Tabs(this.dialogNodes.sortList);this.tabsObject={};var c=this;for(var d=0;d<b;d++){var e=(a-1)*b;if(this.tabsData[e+d]==null){break}var f=this.tabsData[e+d].sortId;var g=this.tabsData[e+d].name;var h=this.tabsData[e+d].data;var i=new Tab('<img src="http://www.sinaimg.cn/uc/myshow/blog/misc/gif/'+f+'.gif" height="20" width="20" align="absmiddle"><div><span><a href="#" onclick="return false;" title="'+g+'">'+g+"</a></span><em>("+h.length+")</em></div>",{isFocus:false,className:"cur"});i.addOnAbort(Core.Function.bind3(function(a){},null,[i]));i.addOnFocus(Core.Function.bind3(function(a,b,d,e){c.showSmile(d,1,c.pageSize);c.currentTab=a;c.dialogNodes.allSort.style.fontWeight=400;if(!c.isFromUp){var f=scope.$pageid;if(f){var g=scope.isFromtheCommonhzh;if(g){v7sendLog($_GLOBAL.faceChooseTable[f][g]+"_16_020_"+e,f,"")}}}c.isFromUp=null},null,[i,e+d,h,f]));this.tabsObject[f]=i;this.tabs.add(i)}var j=Math.ceil(this.tabsData.length/b);if(j>0){this.showTabPage(a||1,j,b)}else{this.dialogNodes.sortCtrl.innerHTML=""}},showSmile:function(a,b,c){var d=this;c=c||this.pageSize;var e=this;var f=a;var g=f.length;var h=Math.ceil(g/c);var i=document.createDocumentFragment();var j;this.dialogNodes.smileList.innerHTML="";this.dialogNodes.magicTip.style.cssText="display:none;";for(var k=0;k<c;k++){var l=f[(b-1)*c+k];if(l==null){break}var m=$C("li");var n=$C("a");n.href="#";n.onclick=function(){return false};n.onmousedown=Core.Function.bind3(function(a,b,c){e.hide();e.option.callback(a,b,c)},null,[l.code,l.name,l.swf||null]);n.innerHTML='<img style="width:50px;height:50px;" src="http://www.sinaimg.cn/uc/myshow/blog/misc/gif/'+l.code+'T.gif" alt="'+l.name+'" title="'+l.name+'" />';m.appendChild(n);n.setAttribute("key",l.code);var o=$C("span");o.title=l.name;o.innerHTML=Core.String.byteLength(l.name)>8?Core.String.leftB(l.name,6)+"…":l.name;m.appendChild(o);if(l.swf){var p=$C("div");p.innerHTML='<a href="#"   onclick="window.$magicFacePlay(\''+l.swf+'\');return false;"><img height="13" title="播放表情" align="absmiddle" width="14" alt="" src="http://simg.sinajs.cn/blog7style/images/common/img_arrow_r.gif"></a>';p.className="arr_r";m.appendChild(p);this.dialogNodes.magicTip.style.cssText="display:block;"}i.appendChild(m);Core.Events.addEvent(n,function(a){return function(){var b=scope.$pageid;if(b){var c=scope.isFromtheCommonhzh;if(c){v7sendLog($_GLOBAL.faceChooseTable[b][c]+"_16_010_"+a.getAttribute("key"),b,"")}}}}(n),"mousedown")}this.dialogNodes.smileList.appendChild(i);if(g>c){if(b==1){this.dialogNodes.smilePagePrev.innerHTML="上一页"}else{this.dialogNodes.smilePagePrev.innerHTML="";j=$C("a");j.href="#";j.onclick=function(){return false};j.onmousedown=function(){e.showSmile(f,b-1,c)};j.innerHTML="上一页";this.dialogNodes.smilePagePrev.appendChild(j)}this.dialogNodes.smilePageShow.innerHTML=b+"/"+h;if(b>=h){this.dialogNodes.smilePageNext.innerHTML="下一页"}else{this.dialogNodes.smilePageNext.innerHTML="";j=$C("a");j.href="#";j.onclick=function(){return false};j.onmouseup=function(){e.showSmile(f,b+1,c)};j.innerHTML="下一页";this.dialogNodes.smilePageNext.appendChild(j)}}else{this.dialogNodes.smilePagePrev.innerHTML="";this.dialogNodes.smilePageShow.innerHTML="";this.dialogNodes.smilePageNext.innerHTML=""}},showTabPage:function(a,b,c){this.dialogNodes.sortCtrl.innerHTML="";this.dialogNodes.smilePagePrev.innerHTML="";this.dialogNodes.smilePageShow.innerHTML="";this.dialogNodes.smilePageNext.innerHTML="";var d=this;var e;if(a==1){if(a!=b){this.dialogNodes.sortCtrl.innerHTML='<a href="#" onclick="return false;" title="向上" class="up_off"></a>';e=$C("a");e.href="#";e.onclick=function(){return false};e.title="向下";e.className="down";e.onmousedown=function(){d.showTab(a+1,c);d.showAll()};this.dialogNodes.sortCtrl.appendChild(e)}else{}}else if(a<b){e=$C("a");e.href="#";e.onclick=function(){return false};e.title="向上";e.className="up";e.onmousedown=function(){d.showTab(a-1,c);d.showAll()};this.dialogNodes.sortCtrl.appendChild(e);e=$C("a");e.href="#";e.onclick=function(){return false};e.title="向下";e.className="down";e.onmousedown=function(){d.showTab(a+1,c);d.showAll()};this.dialogNodes.sortCtrl.appendChild(e)}else{e=$C("a");e.href="#";e.onclick=function(){return false};e.title="向上";e.className="up";e.onmousedown=function(){d.showTab(a-1,c);d.showAll()};this.dialogNodes.sortCtrl.appendChild(e);Core.Dom.addHTML(this.dialogNodes.sortCtrl,'<a href="#" onclick="return false;" title="向下" class="down_off"></a>')}},eventListen:function(){var a=this;var b=a.dialogNodes.searchText;var c=a.dialogNodes.searchBtn;var d=a.dialogNodes.keyCtrlBack;var e=a.dialogNodes.allSort;var f=a.dialogNodes.smileEmptyBack;Core.Events.addEvent(document.body,function(b){var c=Core.Events.getEvent(),d=$IE?c.srcElement:c.target;if(a.dialogNodes.entity!=null&&(Core.Dom.contains(a.dialogNodes.entity,d)==false||b==true)){a.hide()}});Core.Events.addEvent(this.dialogNodes.btnClose,function(){a.hide()});Core.Events.addEvent(b,function(){if(Core.String.trim(b.value)=="输入关键字、动漫形象"){b.value="";b.style.color="#000"}b.select()},"focus");Core.Events.addEvent(b,function(){if(Core.String.trim(b.value)==""){b.value="输入关键字、动漫形象";b.style.color="#9b9b9a"}},"blur");Core.Events.addEvent(b,function(c){var d=Core.Events.getEvent();var e=d.which||d.keyCode;var f=Core.String.trim(b.value);if(e==13&&f!=""){a.searchKey(f)}},"keydown");Utils.Form.limitMaxLen(b,20);Core.Events.addEvent(c,function(){if(b.value=="输入关键字、动漫形象"||b.value==""){}else{a.searchKey(b.value);b.focus()}});var g=function(){a.dataSettle(a.data,9);a.dialogNodes.keyCtrl.style.display="none";a.dialogNodes.smileEmpty.style.display="none";a.dialogNodes.smileList.style.display="";a.dialogNodes.searchText.value="输入关键字、动漫形象";a.dialogNodes.searchText.style.color="#9b9b9a"};Core.Events.addEvent(d,g);Core.Events.addEvent(f,g);Core.Events.addEvent(e,function(){a.showAll()})},showAll:function(){this.showSmile(this.allData,1,this.pageSize);this.dialogNodes.allSort.style.fontWeight=600;if(this.currentTab!=null){this.currentTab.setAbort()}},setSort:function(a,b){this.isFromUp=a;this.option.sortId=a;this.option.callback=b;if(a==0){this.dialogNodes.allSort.style.fontWeight=600;this.dataSettle()}else{this.dataSettle();this.tabs.swapTags(this.tabsObject[a])}},getKeyWord:function(){if(this.keywordData!=null){return}var a=this;var b=Utils.Io.JsLoad.request("http://www.sinaimg.cn/uc/myshow/blog/misc/gif/smileKeywordConfig.js?varname=smileKeywordConfig",{onComplete:function(b){a.keywordData=b;var c=b.E___00000000000||"顶|路过|哭|啦啦|美女";var d=document.createDocumentFragment();c=c.split("|");for(var e=0,f=c.length;e<f;e++){var g=$C("a");g.href="#";g.onclick=function(){return false};g.onmousedown=Core.Function.bind3(function(b){a.searchKey(b)},null,[c[e]]);g.innerHTML=c[e];if(c[e]=="魔法表情"){var h=$C("img");h.style.cssText="height:15px; width:15px;";h.setAttribute("align","absmiddle");h.src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif";h.className="SG_icon SG_icon68 img_m";d.appendChild(h)}d.appendChild(g)}if(a.dialogNodes.hotKeyword.innerHTML==""){a.dialogNodes.hotKeyword.appendChild(d)}var i="";for(var j in b){if(j!="E___00000000000"){i+="∑"+j+"§"+b[j]}}a.keywordStr=i},onException:function(){}})},searchKey:function(a){var b=a.replace(/([\\^$*+?{}.|])/gi,"\\$1");var c=new RegExp("∑([^§]+)§[^∑]*"+b+"[^∑]*","gi");var d=[];this.keywordStr.replace(c,function(a,b){d.push(b)});d=d.join(",");var e={};var f=this.allDataBack;var g=f.length;var h=0;for(var i=0;i<g;i++){if(d.indexOf(f[i].code)!=-1||f[i].sname.indexOf(a)!=-1||f[i].name.indexOf(a)!=-1){if(e[f[i].sid]==null){e[f[i].sid]={name:f[i].sname,data:[]}}e[f[i].sid].data.push(f[i]);h++}}var j=scope.$pageid;if(h==0){this.dialogNodes.smileEmpty.style.display="";this.dialogNodes.smileList.style.display="none";if(j){var k=scope.isFromtheCommonhzh;if(k){v7sendLog($_GLOBAL.faceChooseTable[j][k]+"_16_030_"+encodeURIComponent(a),j,"")}}}else{this.dialogNodes.smileList.style.display="";this.dialogNodes.smileEmpty.style.display="none";if(j){var k=scope.isFromtheCommonhzh;if(k){v7sendLog($_GLOBAL.faceChooseTable[j][k]+"_16_031_"+encodeURIComponent(a),j,"")}}}this.dataSettle(e,7);this.dialogNodes.keyCtrl.style.display="";this.dialogNodes.keyWord.innerHTML=a.split("").join("<wbr/>");Core.Dom.setStyle(this.dialogNodes.sortList,"height","217px")},setPosition:function(a,b){this.x=a;this.y=b;this.dialog.setPosition({x:a,y:b})},show:function(){this.dialogNodes.searchText.value="输入关键字、动漫形象";this.dialogNodes.searchText.style.color="#9b9b9a";this.dialog.show()},hide:function(){this.dialog.hidden();this.dialogNodes.keyCtrl.style.display="none"}};scope.smilesDataV2={302:{name:"小新小浪",contract:"GY00000001",data:[{name:"灌水",code:"E___0173EN00SIG"},{name:"赞",code:"E___0480ZH00SIG"},{name:"美好",code:"E___0305EN00SIG"},{name:"顶",code:"E___0022EN00SIG"},{name:"顶",code:"E___0088EN00SIG"},{name:"顶",code:"E___0472ZH00SIG"},{name:"开心",code:"E___0092EN00SIG"},{name:"路过",code:"E___0177EN00SIG"}]}};App.insertSmilesForm2=Core.Class.create();App.insertSmilesForm2.prototype={defalutConfig:{sortCount:6,clickCallback:function(){},recommCount:8},initialize:function(a){this.option=a||{};if(this.option.sortNode==null){return}for(var b in this.defalutConfig){if(this.option[b]==null){this.option[b]=this.defalutConfig[b]}}if(scope.smilesDataV2==null){this.getSmilesData()}else{this.data=scope.smilesDataV2;this.renderUI()}},getSmilesData:function(){var a=this;var b=Utils.Io.JsLoad.request([{url:"http://www.sinaimg.cn/uc/myshow/blog/misc/gif/smileConfig8.js?varname=smileConfig"}],{onComplete:function(b){scope.smilesData=b;a.data=b;a.renderUI()},onException:function(){}})},renderUI:function(){var a=this;var b=1;var c=[];var d=[];var e;var f=document.createDocumentFragment();var g=$C("div");var h=$C("span");var i=$C("div");e=this.data&&this.data["302"]&&this.data["302"].data;if($E(this.option.recommNode)!=null){f=document.createDocumentFragment();for(var j=0;j<this.option.recommCount;j++){_title=e[j].name;var k=e[j].code;var l=e[j].swf;node=$C("li");(function(b){node.onclick=Core.Function.bind3(function(c,d,e){a.option.clickCallback(c,d,e);v7sendLog("32_01_20");var f=scope.$pageid;if(f){b+="";b=b.length==1?"0"+b:b;v7sendLog($_GLOBAL.faceCountRecommLinkTable[f]+"_"+b+"_010_"+c,f,"")}Core.Events.stopEvent();return false},null,[k,_title,l])})(j+8);node.hideFocus=true;var m='<a href="#"><img src="http://www.sinaimg.cn/uc/myshow/blog/misc/gif/'+k+'T.gif" alt="'+_title+'" title="'+_title+'" height="50" width="50"/></a>';if(l){m=m+'<div class="arr"><a href="#" onclick="window.$magicFacePlay(\''+l+'\');return false;" ><img src="http://simg.sinajs.cn/blog7style/images/common/img_arrow_r.gif" width="14" height="13" title="播放表情" alt="" align="absmiddle" /></a></div>'}node.innerHTML=m;f.appendChild(node)}$E(this.option.recommNode).appendChild(f)}b=c=d=e=f=g=h=_morelink=i=k=key=_title=node=null}};Lib.children=function(a){var b=[];for(var c=0;a[c];c++){if(a[c].nodeType==1){b.push(a[c])}}return b};App.insertSmilesDialog2=function(a,b,c,d){App.insertSmilesDialog2.callback=b;if(scope.smileDialog==null){scope.smileDialog=new App.smilesDialog2}scope.smileDialog.setSort(a,b);var e=Core.Dom.getXY($E(c));var f=e[0]+d[0];var g=e[1]+d[1];scope.smileDialog.setPosition(f,g);scope.smileDialog.show()};App.formInsertSmile2=function(a,b,c,d,e,f,g,h,i){var j=$E(a);i=i||{};var k=function(){if(j.createTextRange){j.caretPos=document.selection.createRange().duplicate()}};if(!scope.commEditor){scope.commEditor=new commEditor}scope.commEditor.append(g,a,h);Core.Events.addEvent(j,k,"keyup");Core.Events.addEvent(j,k,"focus");Core.Events.addEvent(j,k,"select");Core.Events.addEvent(j,k,"click");var l={sortNode:b,clickCallback:function(a,b,c){setTimeout(function(){var d='<img src="http://www.sinaimg.cn/uc/myshow/blog/misc/gif/'+a+'T.gif" alt="'+b+'" title="'+b+'"width="50" height="50" />';if(c){d='<img src="http://www.sinaimg.cn/uc/myshow/blog/misc/gif/'+a+'T.gif" alt="'+b+'" title="'+b+'" swfname="'+c+'"  width="50" height="50" />'}scope.commEditor.insertHTML(g,d)},20);if(d){d()}},recommNode:c,positionNode:e||b,arrPosPix:f||[0,0],sortCount:i.sortCount||6,recommCount:i.recommCount||8};new App.insertSmilesForm2(l)};var commEditor=function(a,b){this.fids=[];this.areas={};this.wins={};this.docs={};this.intervals={};this.actions={}};commEditor.prototype={init:function(a){var b=this.docs[a];try{b.body.designMode="on"}catch(c){}b.open();b.writeln(this.getEditorHTML(""));b.body.contentEditable=true;var d=b.parentWindow;Lib.checkAuthor();b.body.onkeydown=function(a){try{if((a||d.event).keyCode==9){$E("login_"+($isLogin?"check":"name")).focus();return false}}catch(b){}};b.close()},lazyInit:function(a){var b=this;return function(){var c=b.docs[a];if(c.body.getAttribute("inited")){return}trace("执行一次:"+a);b.init(a);b.bindListener(a);c.body.setAttribute("inited","yes")}},append:function(a,b,c){function f(){try{e.docs[a]=d.contentWindow.document;e.areas[a]=$E(b);if($IE){e.docs[a].body.onclick=e.lazyInit(a)}else{e.lazyInit(a)()}}catch(c){setTimeout(f,150)}}c=c||{};if(!c.interval){c.interval={}}if(!c.interval.before){c.interval.before=function(){}}if(!c.interval.after){c.interval.after=function(){}}var d=$E(a);this.wins[a]=d.contentWindow;this.actions[a]=c;var e=this;f()},frameFilter:function(a){var b=false;var c=a.innerHTML;c=c.replace(/<script[\s\S]*<\/script>/ig,"");c=c.replace(/<style[\s\S]*<\/style>/ig,"");c=c.replace(/<!-{2,}[\s\S]*?-{2,}>/g,"");c=c.replace(/<([^>]+).*?>/ig,function(a,b){var c=b.split(" ")[0].toLowerCase();switch(c){case"/p":return"<br>";case"br":return a;case"img":if(a.toLowerCase().indexOf("http://www.sinaimg.cn/uc/myshow/blog")>0||a.toLowerCase().indexOf("http://simg.sinajs.cn/blog7style/images/common")>0){if(a.toLowerCase().indexOf("t.gif")==-1&&a.toLowerCase().indexOf("img_arrow_r.gif")==-1){return""}return a}else{return""};default:return""}});c=c.replace(/\n/g,"");a.innerHTML=c},bindListener:function(a){var b=this.docs[a];var c=this.areas[a];var d=this.wins[a];var e=this.actions[a];var f=this;if($IE){b.onkeydown=function(){var b=d.event;if(b.keyCode==8){var c=f.getFocusElement(a);if(c&&c.tagName.toUpperCase()=="IMG"){c.parentNode.removeChild(c);b.keyCode=0;b.returnValue=false}}}}Core.Events.addEvent(b.body,function(b){return function(d){f.intervals[a]=setInterval(function(){e.interval.before(a,c);f.clearFrameHTML(b);var d=b.getElementsByTagName("img");for(var g=0;d[g];g++){d[g].removeAttribute("style");d[g].removeAttribute("height");d[g].removeAttribute("width")}e.interval.after(a,c)},400)}}(b.body),"focus");Core.Events.addEvent(b.body,function(b){return function(b){clearInterval(f.intervals[a])}}(b.body),"blur");if(e.normal){for(var g in e.normal){Core.Events.addEvent(b.body,e.normal[g],g)}}},clearFrameHTML:function(a){var b=this;var c=["a","input"];var d=false;for(var e=0;c[e];e++){if(a.getElementsByTagName(c[e]).length>0){d=true;break}}if(d){b.frameFilter(a)}else{var f=a.getElementsByTagName("img");for(var e=0;f[e];e++){var g=f[e].src.indexOf("http://www.sinaimg.cn/uc/myshow/blog");var h=f[e].src.toLowerCase().indexOf("t.g");var i=f[e].src.indexOf("http://simg.sinajs.cn/blog7style/images/common/img_arrow_r.gif");if((g==-1||h==-1)&&i==-1){b.frameFilter(a);break}}}},getFocusElement:function(a){if(!$IE){var b=this.win.getSelection();var c=b.getRangeAt(0);var d=c.commonAncestorContainer;if(d.tagName){if(d.tagName.toLowerCase()=="body"){return d}}if(!c.collapsed){if(c.startContainer==c.endContainer||1&&c.startContainer==c.endContainer.parentNode){if(c.startOffset-c.endOffset<2||1){if(c.startContainer.hasChildNodes()){return c.startContainer.childNodes[c.startOffset]}}}return d.parentNode}else{return d.parentNode}}else{var c=this.docs[a].selection.createRange();return c.item?c.item(0):c.parentElement()}},clearHTML:function(a){var b=this.docs[a];b.body.innerHTML="";b.body.setAttribute("contenteditable",false);b.body.setAttribute("contenteditable",true)},insertHTML:function(a,b){if($IE){this.lazyInit(a)()}var c=this.wins[a];var d=this.docs[a];if($IE){try{c.focus();var e=d.selection.createRange();if(d.selection.type.toLowerCase()=="control"){var f=d.body.createTextRange();f.moveToElementText(e.item(0));e=f}e.pasteHTML(b);e.collapse(false);e.select()}catch(g){}}else{if(($CHROME||$SAFARI)&&(encodeURIComponent(d.body.innerHTML)=="%0A"||d.body.innerHTML=="")){d.body.focus()}this.execCommand("insertHTML",b,a);if(!$CHROME&&!$SAFARI){d.body.focus()}}},execCommand:function(a,b,c){var d=this.wins[c];var e=this.docs[c];d.focus();e.execCommand(a,"",b);d.focus()},handleChange:function(a){var b=this.docs[a].body;this.areas[a].value=this.getHandledStr(b)},getHandledStr:function(a){var b=[];if(a.hasChildNodes()){a=a.childNodes;for(var c=0;a[c];c++){b.push(this.handleDom(a[c]))}}else{b.push(this.handleDom(a))}return b.join("").replace(/\u00A0/ig," ")},handleDom:function(a){if(a.nodeType==3){var b=a.nodeValue;if(!Core.String.trim(b)){return""}return this.reEscapeHTML(b)}else if(a.nodeType==1){if(a.hasChildNodes()&&(a.childNodes.length!=1||a.childNodes.length==1&&a.childNodes[0].tagName)){var c=[];if(a.tagName){var d=a.tagName.toUpperCase();if(d=="DIV"||d=="P"){c.push("\n")}}a=a.childNodes;for(var e=0;a[e];e++){c.push(this.handleDom(a[e]))}return c.join("")}else{var d=a.tagName.toUpperCase();if(d=="IMG"){if(a.src.indexOf("http://www.sinaimg.cn/uc/myshow/blog")!=-1){if(a.src.indexOf("T.g")==-1){return""}var f=a.src.split("T.g")[0];f=f.substring(f.lastIndexOf("/")+1,f.length);var g=a.getAttribute("title");var h=a.getAttribute("swfname");if(!h&&f[0]=="W"){h=f+"S.swf"}if(g){if(h){return"[magicemoticons="+f+" swfname="+h+"]"+g+"[/magicemoticons]"}else{return"[emoticons="+f+"]"+g+"[/emoticons]"}}}else{return""}}else if(d=="BR"){return"\n"}else if(d=="DIV"||d=="P"){var b=a.innerHTML||"";return"\n"+this.reEscapeHTML(b)}else if(d=="SCRIPT"||d=="STYLE"){return""}else{b=a.innerHTML||a.value||"";return this.reEscapeHTML(b)}}}return""},reEscapeHTML:function(a){a=a.replace(/\n/g,"");a=a.replace(/&nbsp;/g," ");a=a.replace(/&quot;/g,'"');a=a.replace(/&lt;/g,"<");a=a.replace(/&gt;/g,">");a=a.replace(/&amp;/g,"&");return a},getEditorHTML:function(a){var b="";b+="<html>";b+="<head>";b+='<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />';b+="<style>		p {			*margin:0.2em auto;		}		body {			margin: 0;			scrollbar-face-color: #ffffff;			scrollbar-highlight-color: #ffffff;			scrollbar-shadow-color: #c0c1bb;			scrollbar-3dlight-color: #c0c1bb;			scrollbar-arrow-color: #c9cbb6;			scrollbar-track-color: #f4f5f0;			scrollbar-darkshadow-color: #ffffff;			scrollbar-base-color: #ffffff;			padding: 10px;			word-wrap: break-word;			overflow: scroll;			overflow-x: auto;			height: 90%;			font-size: 14px;		}		body, td, textarea, input, br, div, span{			font-family: '', Verdana,Arial, Helvetica, sans-serif;			line-height:1.5;		}		img{			border: 0;		}		html{			height: 100%;			cursor: text;		}		pre{			white-space:normal;		}		form{margin: 0;}		body table{font-size: 14px;}		.border{ border:1px dashed #cfcfcf;}		</style>		<script>document.domain='sina.com.cn';</script>		";b+="</head>";b+="<body>";b+=a;b+="</body>";b+="</html>";return b}};App.smilesTemplate=['<table id="#{entity}" class="CP_w faceItemContent" style="visibility: visible;">','<thead id="#{titleBar}"><tr><th class="tLeft"><span></span></th>','<th class="tMid"><div class="bLyTop"><strong id="#{titleName}">插入表情</strong><cite><a id="#{btnClose}"',' href="#" onclick="return false;" class="CP_w_shut" title="关闭">关闭</a></cite></div></th>','<th class="tRight"><span></span></th></tr></thead>','<tfoot><tr><td class="tLeft"><span></span></td><td class="tMid"><span></span></td>','<td class="tRight"><span></span></td></tr></tfoot>',"<tbody><tr>",'<td class="tLeft"><span></span></td>','<td class="tMid" id="#{content}">','<div class="insertface">','<div class="insertface_top">','<h3>热门动漫表情</h3><div class="insertface_search">','<input id="#{searchText}" type="text" class="SG_input" value="输入关键字、动漫形象"',' style="color:#9b9b9a;" maxlength="20" /><a id="#{searchBtn}" href="#" onclick="return false;" ','hidefocue="true" class="SG_aBtn SG_aBtnB"><cite>查找表情</cite></a></div>','<div class="clearit"></div>',"</div>",'<div class="insertface_hot">','<span class="insertface_keyword">热门关键字：<span id="#{hotKeyword}"></span></span>','<span class="insertface_hotslider"></span>',"</div>",'<div class="bigface">','<div class="faceSidebar">','<div id="#{keyCtrl}" class="facekeyword" style="display:none;">','<p><< <a id="#{keyCtrlBack}" href="#" onclick="return false;">返回全部关键字</a></p>','<p>关键字：<span id="#{keyWord}"></span></p></div>','<h3 id="#{allSort}" class="facetitle" style="font-weight:600;"><a href="#"',' onclick="return false;">全部</a></h3>','<div id="#{sortList}" class="facelist"></div>','<div id="#{sortCtrl}" class="facearrow"></div>',"</div>",'<div class="faceShowAll">','<div id="#{smileEmpty}" class="faceShownone" style="display:none;"><p>找不到和关键字相符的表情。','<br /><br /><a id="#{smileEmptyBack}" href="#" onclick="return false;">&lt;&lt;返回首页</a></p></div>','<ul class="faceShowAll_list" id="#{smileList}"></ul>','<div class="SG_page"><ul class="SG_pages">','<li id="#{smilePagePrev}" class="SG_s_pgprev"></li>','<li id="#{smilePageShow}" class="SG_s_pgnum"></li>','<li id="#{smilePageNext}" class="SG_s_pgnext"></li>',"</ul></div>","</div>","</div>","</div>",'</td><td class="tRight"><span></span></td>',"</tr></tbody></table>"].join("");App.smilesDialog=Core.Class.create();App.smilesDialog.prototype={pageSize:24,defaultConfig:{sortId:"0",htmlTpl:App.smilesTemplate,callback:function(){}},initialize:function(a){this.option=a||{};for(var b in this.defaultConfig){if(this.option[b]==null){this.option[b]=this.defaultConfig[b]}}this.dialog=new Dialog(this.option.htmlTpl);this.dialogNodes=this.dialog.getNodes();this.getKeyWord();if(scope.smilesData!=null){this.data=scope.smilesData;this.dataSettle();this.eventListen()}else{var c=this;var d=Utils.Io.JsLoad.request([{url:"http://www.sinaimg.cn/uc/myshow/blog/misc/gif/smileConfig.js?varname=smileConfig",charset:"GBK"}],{onComplete:function(a){scope.smilesData=a;c.data=a;c.dataSettle();c.eventListen()},onException:function(){}})}return this},dataSettle:function(a,b){a=a||this.data;b=b||9;this.tabsData=[];this.allData=[];for(var c in a){var d=a[c];d.sortId=c;this.tabsData.push(d);for(var e=0,f=d.data.length;e<f;e++){d.data[e].sid=c;d.data[e].sname=d.name}this.allData=this.allData.concat(d.data)}if(this.allDataBack==null){this.allDataBack=this.allData.slice(0)}this.showTab(1,b);if(this.dialogNodes.smileList.childNodes.length==0){this.showAll()}},children:function(a){var b=[];for(var c=0;a[c];c++){if(a[c].nodeType==1){b.push(a[c])}}return b},showTab:function(a,b){a=a||1;b=b||9;this.dialogNodes.sortList.innerHTML="";this.dialogNodes.smileList.innerHTML="";Core.Dom.setStyle(this.dialogNodes.sortList,"height",b==9?"279px":"217px");this.tabs=new Tabs(this.dialogNodes.sortList);this.tabsObject={};var c=this;for(var d=0;d<b;d++){var e=(a-1)*b;if(this.tabsData[e+d]==null){break}var f=this.tabsData[e+d].sortId;var g=this.tabsData[e+d].name;var h=this.tabsData[e+d].data;var i=new Tab('<img src="http://www.sinaimg.cn/uc/myshow/blog/misc/gif/'+f+'.gif" height="20" width="20" align="absmiddle"><span><a href="#" onclick="return false;">'+g+"</a></span><em>("+h.length+")</em>",{isFocus:false,className:"cur"});i.addOnAbort(Core.Function.bind3(function(a){},null,[i]));i.addOnFocus(Core.Function.bind3(function(a,b,d,e){c.showSmile(d,1,c.pageSize);c.currentTab=a;c.dialogNodes.allSort.style.fontWeight=400;if(!c.isFromUp){var f=scope.$pageid;if(f){var g=scope.isFromtheCommonhzh;if(g){v7sendLog($_GLOBAL.faceChooseTable[f][g]+"_16_020_"+e,f,"")}}}c.isFromUp=null},null,[i,e+d,h,f]));this.tabsObject[f]=i;this.tabs.add(i)}var j=Math.ceil(this.tabsData.length/b);if(j>0){this.showTabPage(a||1,j,b)}else{this.dialogNodes.sortCtrl.innerHTML=""}},showSmile:function(a,b,c){var d=this;c=c||this.pageSize;var e=this;var f=a;var g=f.length;var h=Math.ceil(g/c);var i=document.createDocumentFragment();var j;this.dialogNodes.smileList.innerHTML="";for(var k=0;k<c;k++){var l=f[(b-1)*c+k];if(l==null){break}var m=$C("li");var n=$C("a");n.href="#";n.onclick=function(){return false};n.onmousedown=Core.Function.bind3(function(a,b){e.option.callback(a,b);e.hide()},null,[l.code,l.name]);n.innerHTML='<img style="width:50px;height:50px;" src="http://www.sinaimg.cn/uc/myshow/blog/misc/gif/'+l.code+'T.gif" alt="'+l.name+'" title="'+l.name+'" />';m.appendChild(n);n.setAttribute("key",l.code);var o=$C("span");o.title=l.name;o.innerHTML=Core.String.byteLength(l.name)>8?Core.String.leftB(l.name,6)+"…":l.name;m.appendChild(o);i.appendChild(m);Core.Events.addEvent(n,function(a){return function(){var b=scope.$pageid;if(b){var c=scope.isFromtheCommonhzh;if(c){v7sendLog($_GLOBAL.faceChooseTable[b][c]+"_16_010_"+a.getAttribute("key"),b,"")}}}}(n),"mousedown")}this.dialogNodes.smileList.appendChild(i);if(g>c){if(b==1){this.dialogNodes.smilePagePrev.innerHTML="上一页"}else{this.dialogNodes.smilePagePrev.innerHTML="";j=$C("a");j.href="#";j.onclick=function(){return false};j.onmousedown=function(){e.showSmile(f,b-1,c)};j.innerHTML="上一页";this.dialogNodes.smilePagePrev.appendChild(j)}this.dialogNodes.smilePageShow.innerHTML=b+"/"+h;if(b>=h){this.dialogNodes.smilePageNext.innerHTML="下一页"}else{this.dialogNodes.smilePageNext.innerHTML="";j=$C("a");j.href="#";j.onclick=function(){return false};j.onmouseup=function(){e.showSmile(f,b+1,c)};j.innerHTML="下一页";this.dialogNodes.smilePageNext.appendChild(j)}}else{this.dialogNodes.smilePagePrev.innerHTML="";this.dialogNodes.smilePageShow.innerHTML="";this.dialogNodes.smilePageNext.innerHTML=""}},showTabPage:function(a,b,c){this.dialogNodes.sortCtrl.innerHTML="";this.dialogNodes.smilePagePrev.innerHTML="";this.dialogNodes.smilePageShow.innerHTML="";this.dialogNodes.smilePageNext.innerHTML="";var d=this;var e;if(a==1){if(a!=b){this.dialogNodes.sortCtrl.innerHTML='<a href="#" onclick="return false;" title="向上" class="up_off"></a>';e=$C("a");e.href="#";e.onclick=function(){return false};e.title="向下";e.className="down";e.onmousedown=function(){d.showTab(a+1,c);d.showAll()};this.dialogNodes.sortCtrl.appendChild(e)}else{}}else if(a<b){e=$C("a");e.href="#";e.onclick=function(){return false};e.title="向上";e.className="up";e.onmousedown=function(){d.showTab(a-1,c);d.showAll()};this.dialogNodes.sortCtrl.appendChild(e);e=$C("a");e.href="#";e.onclick=function(){return false};e.title="向下";e.className="down";e.onmousedown=function(){d.showTab(a+1,c);d.showAll()};this.dialogNodes.sortCtrl.appendChild(e)}else{e=$C("a");e.href="#";e.onclick=function(){return false};e.title="向上";e.className="up";e.onmousedown=function(){d.showTab(a-1,c);d.showAll()};this.dialogNodes.sortCtrl.appendChild(e);Core.Dom.addHTML(this.dialogNodes.sortCtrl,'<a href="#" onclick="return false;" title="向下" class="down_off"></a>')}},eventListen:function(){var a=this;var b=a.dialogNodes.searchText;var c=a.dialogNodes.searchBtn;var d=a.dialogNodes.keyCtrlBack;var e=a.dialogNodes.allSort;var f=a.dialogNodes.smileEmptyBack;Core.Events.addEvent(document.body,function(b){var c=Core.Events.getEvent(),d=$IE?c.srcElement:c.target;if(a.dialogNodes.entity!=null&&(Core.Dom.contains(a.dialogNodes.entity,d)==false||b==true)){a.hide()}});Core.Events.addEvent(this.dialogNodes.btnClose,function(){a.hide()});Core.Events.addEvent(b,function(){if(Core.String.trim(b.value)=="输入关键字、动漫形象"){b.value="";b.style.color="#000"}b.select()},"focus");Core.Events.addEvent(b,function(){if(Core.String.trim(b.value)==""){b.value="输入关键字、动漫形象";b.style.color="#9b9b9a"}},"blur");Core.Events.addEvent(b,function(c){var d=Core.Events.getEvent();var e=d.which||d.keyCode;var f=Core.String.trim(b.value);if(e==13&&f!=""){a.searchKey(f)}},"keydown");Utils.Form.limitMaxLen(b,20);Core.Events.addEvent(c,function(){if(b.value=="输入关键字、动漫形象"||b.value==""){}else{a.searchKey(b.value);b.focus()}});var g=function(){a.dataSettle(a.data,9);a.dialogNodes.keyCtrl.style.display="none";a.dialogNodes.smileEmpty.style.display="none";a.dialogNodes.smileList.style.display="";a.dialogNodes.searchText.value="输入关键字、动漫形象";a.dialogNodes.searchText.style.color="#9b9b9a"};Core.Events.addEvent(d,g);Core.Events.addEvent(f,g);Core.Events.addEvent(e,function(){a.showAll()})},showAll:function(){this.showSmile(this.allData,1,this.pageSize);this.dialogNodes.allSort.style.fontWeight=600;if(this.currentTab!=null){this.currentTab.setAbort()}},setSort:function(a,b){this.isFromUp=a;this.option.sortId=a;this.option.callback=b;if(a==0){this.dialogNodes.allSort.style.fontWeight=600;this.dataSettle()}else{this.dataSettle();this.tabs.swapTags(this.tabsObject[a])}},getKeyWord:function(){if(this.keywordData!=null){return}var a=this;var b=Utils.Io.JsLoad.request("http://www.sinaimg.cn/uc/myshow/blog/misc/gif/smileKeywordConfig.js?varname=smileKeywordConfig&rnd="+Math.random(),{onComplete:function(b){a.keywordData=b;var c=b.E___00000000000||"顶|路过|哭|啦啦|美女";var d=document.createDocumentFragment();c=c.split("|");for(var e=0,f=c.length;e<f;e++){var g=$C("a");g.href="#";g.onclick=function(){return false};g.onmousedown=Core.Function.bind3(function(b){a.searchKey(b)},null,[c[e]]);g.innerHTML=c[e];d.appendChild(g)}if(a.dialogNodes.hotKeyword.innerHTML==""){a.dialogNodes.hotKeyword.appendChild(d)}var h="";for(var i in b){if(i!="E___00000000000"){h+="∑"+i+"§"+b[i]}}a.keywordStr=h},onException:function(){}})},searchKey:function(a){var b=a.replace(/([\\^$*+?{}.|])/gi,"\\$1");var c=new RegExp("∑([^§]+)§[^∑]*"+b+"[^∑]*","gi");var d=[];this.keywordStr.replace(c,function(a,b){d.push(b)});d=d.join(",");var e={};var f=this.allDataBack;var g=f.length;var h=0;for(var i=0;i<g;i++){if(d.indexOf(f[i].code)!=-1||f[i].sname.indexOf(a)!=-1||f[i].name.indexOf(a)!=-1){if(e[f[i].sid]==null){e[f[i].sid]={name:f[i].sname,data:[]}}e[f[i].sid].data.push(f[i]);h++}}var j=scope.$pageid;if(h==0){this.dialogNodes.smileEmpty.style.display="";this.dialogNodes.smileList.style.display="none";if(j){var k=scope.isFromtheCommonhzh;if(k){v7sendLog($_GLOBAL.faceChooseTable[j][k]+"_16_030_"+encodeURIComponent(a),j,"")}}}else{this.dialogNodes.smileList.style.display="";this.dialogNodes.smileEmpty.style.display="none";if(j){var k=scope.isFromtheCommonhzh;if(k){v7sendLog($_GLOBAL.faceChooseTable[j][k]+"_16_031_"+encodeURIComponent(a),j,"")}}}this.dataSettle(e,7);this.dialogNodes.keyCtrl.style.display="";this.dialogNodes.keyWord.innerHTML=a.split("").join("<wbr/>");Core.Dom.setStyle(this.dialogNodes.sortList,"height","217px")},setPosition:function(a,b){this.x=a;this.y=b;this.dialog.setPosition({x:a,y:b})},show:function(){this.dialogNodes.searchText.value="输入关键字、动漫形象";this.dialogNodes.searchText.style.color="#9b9b9a";this.dialog.show()},hide:function(){this.dialog.hidden();this.dialogNodes.keyCtrl.style.display="none"}};App.insertSmilesForm=Core.Class.create();App.insertSmilesForm.prototype={defalutConfig:{sortCount:6,clickCallback:function(){},recommCount:8},initialize:function(a){this.option=a||{};if(this.option.sortNode==null){return}for(var b in this.defalutConfig){if(this.option[b]==null){this.option[b]=this.defalutConfig[b]}}if(scope.smilesData==null){this.getSmilesData()}else{this.data=scope.smilesData;this.renderUI()}},getSmilesData:function(){var a=this;var b=Utils.Io.JsLoad.request([{url:"http://www.sinaimg.cn/uc/myshow/blog/misc/gif/smileConfig.js?varname=smileConfig",charset:"GBK"}],{onComplete:function(b){scope.smilesData=b;a.data=b;a.renderUI()},onException:function(){}})},renderUI:function(){var a=this;var b=1;var c=[];var d=[];var e;var f=document.createDocumentFragment();var g=$C("div");var h=$C("span");var i=$C("div");g.className="facestyle";for(var j in this.data){if(b==1){e=this.data[j]||{data:{}};e=e.data}if(b<=this.option.sortCount){var k=this.data[j].name;var l=$C("a");l.href="#";l.setAttribute("key",j);l.onclick=function(){Core.Events.stopEvent();return false};l.onmousedown=Core.Function.bind3(function(b){App.insertSmilesDialog(b,a.option.clickCallback,a.option.positionNode,a.option.arrPosPix)},null,[j]);l.hideFocus=true;l.innerHTML='<img src="http://www.sinaimg.cn/uc/myshow/blog/misc/gif/'+j+'-25.gif" alt="'+k+'" title="'+k+'" />';g.appendChild(l);b++}else{break}}var m=(new Date).getTime();g.id="recomm_"+m;f.appendChild(g);h.className="SG_more";var n=$C("a");n.href="#";n.onclick=function(){Core.Events.stopEvent();return false};n.onmousedown=function(b){return function(){App.insertSmilesDialog(0,a.option.clickCallback,a.option.positionNode,a.option.arrPosPix);var c=scope.$pageid;if(c){var d=b.parentNode.parentNode.id.split("_")[0];if(d){scope.isFromtheCommonhzh=$_GLOBAL.faceCountMoreLinkTable[c][d][1];v7sendLog($_GLOBAL.faceCountMoreLinkTable[c][d][0]+"_07_000_000",c,"")}}}}(n);n.innerHTML="更多>>";h.appendChild(n);f.appendChild(h);i.className="clearit";f.appendChild(i);$E(this.option.sortNode).appendChild(f);if($E(this.option.recommNode)!=null){f=document.createDocumentFragment();for(var o=0;o<this.option.recommCount;o++){k=e[o].name;var p=e[o].code;l=$C("a");l.href="#";(function(b){l.onclick=Core.Function.bind3(function(c,d){a.option.clickCallback(c,d);var e=scope.$pageid;if(e){b+="";b=b.length==1?"0"+b:b;v7sendLog($_GLOBAL.faceCountRecommLinkTable[e]+"_"+b+"_010_"+c,e,"")}Core.Events.stopEvent();return false},null,[p,k])})(o+8);l.hideFocus=true;l.innerHTML='<img src="http://www.sinaimg.cn/uc/myshow/blog/misc/gif/'+p+'T.gif" alt="'+k+'" title="'+k+'" />';f.appendChild(l)}$E(this.option.recommNode).appendChild(f)}var q=Lib.children($E("recomm_"+m).childNodes);for(o=0;q[o];o++){Core.Events.addEvent(q[o],function(a,b){return function(){var c=scope.$pageid;if(c){var d=a.parentNode.parentNode.id.split("_")[0];if(d){scope.isFromtheCommonhzh=$_GLOBAL.faceCountMoreLinkTable[c][d][1];v7sendLog($_GLOBAL.faceCountMoreLinkTable[c][d][0]+"_0"+b+"_020_"+a.getAttribute("key"),c,"")}}}}(q[o],o+1),"mousedown")}b=c=d=e=f=g=h=n=i=p=j=k=l=null}};Lib.children=function(a){var b=[];for(var c=0;a[c];c++){if(a[c].nodeType==1){b.push(a[c])}}return b};App.insertSmilesDialog=function(a,b,c,d){App.insertSmilesDialog.callback=b;if(scope.smileDialog==null){scope.smileDialog=new App.smilesDialog}scope.smileDialog.setSort(a,b);var e=Core.Dom.getXY($E(c));var f=e[0]+d[0];var g=e[1]+d[1];scope.smileDialog.setPosition(f,g);scope.smileDialog.show()};App.formInsertSmile=function(a,b,c,d,e,f){var g=$E(a);var h=function(){if(g.createTextRange){g.caretPos=document.selection.createRange().duplicate()}};Core.Events.addEvent(g,h,"keyup");Core.Events.addEvent(g,h,"focus");Core.Events.addEvent(g,h,"select");Core.Events.addEvent(g,h,"click");new App.insertSmilesForm({sortNode:b,clickCallback:function(a,b){var c="[emoticons="+a+"]"+b+"[/emoticons]";if($IE){if(g.createTextRange&&g.caretPos){var e=g.caretPos;e.text=e.text.charAt(e.text.length-1)==" "?c+" ":c;g.focus()}else{g.value+=c;g.focus()}}else{if(g.setSelectionRange){var f=g.selectionStart;var h=g.selectionEnd;var i=g.value.substring(0,f);var j=g.value.substring(h);g.value=i+c+j}else{g.value+=c}}if(d){d()}},recommNode:c,positionNode:e||b,arrPosPix:f||[0,0]})};Core.Dom.removeParentNode=function(a){a=$E(a);var b=a.parentNode;Core.Dom.insertAfter(a,b);b.parentNode.removeChild(b)};TweenStrategyEx=function(a,b,c,d){this.startValue=a||[];this.endValue=b||[];this.duration=c||0;this.motion=d||Ui.Transition.simple;this.__eventDispatcher=new Core.Events.EventDispatcher(this)}.$define({motion:null,duration:0,startValue:0,endValue:0,_itvID:0,_isTweenning:false,addEventListener:function(a,b){this.__eventDispatcher.addEventListener(a,b);return this},removeEventListener:function(a,b){this.__eventDispatcher.removeEventListener(a,b);return this},start:function(){if(this._isTweenning){return}this._isTweenning=true;var a=this,b,c=this.startValue,d=this.endValue,e=this.duration,f=[],g=(new Date).getTime();this._itvID=window.setInterval(function(){b=((new Date).getTime()-g)/1e3;b>a.duration&&(b=a.duration);for(var h=0;h<c.length;h++){f[h]=a.motion(b,c[h],d[h]-c[h],e)}a.onTween&&a.onTween(f);a.__eventDispatcher.dispatchEvent("tween",f);b==a.duration&&a.stop()},25);return this},stop:function(){window.clearInterval(this._itvID);this._isTweenning=false;this.onEnd&&this.onEnd();this.__eventDispatcher.dispatchEvent("end");return this},onTween:function(a){},onEnd:function(){}});Core.Events.getEventTarget=function(a){a=a||Core.Events.getEvent();Core.Events.fixEvent(a);return a.target};Comment2TSina=Core.Class.create();Comment2TSina.prototype={anonyous:false,data:null,initialize:function(a,b){this.anonyous=a||false;this.data=b||{};scope.$temp_commCtt=this.data.weibo_content;scope.$temp_commId=this.data.blog_id},writeCommTips:function(){if(!$E("bb")){return}var a="";var b=$E("writeComm_tips");if(!b){var c=$C("div");c.className="writeComm_tips_box";c.style.display="none";c.innerHTML='<span class="writeComm_tips" id="writeComm_tips"><strong></strong><cite><a href="javascript:;">关闭</a></cite></span>';var d=Core.Dom.byClz(document,"div","writeComm");if(d){d[0].insertBefore(c,d[0].childNodes[0])}else{return}b=c.firstChild;Core.Events.addEvent(b.lastChild,function(){c.style.display="none"},"click");this.bindTipsEvents(b)}var e=b.parentNode,f=b.firstChild;e.style.display="none";if(this.anonyous||$E("anonymity")&&$E("anonymity").checked||this.data.re_weibo==="no_blog"){f.innerHTML='评论发表成功，<a href="javascript:void(0);">点此还可以同步到微博，分享给我的粉丝。</a>';e.style.display="block"}else if(this.data.re_weibo==="success"){f.innerHTML='评论成功同步到微博，<a href="http://weibo.com/'+this.data.t_sina+'/profile" target="_blank">点此查看</a>';e.style.display="block"}else if(this.data.re_weibo==="no_bind"){f.innerHTML='评论分享失败，您需要先<a href="javascript:void(0);">绑定微博</a>';e.style.display="block"}},bindTipsEvents:function(a){Core.Events.addEvent(a.firstChild,function(b){Core.Events.stopBubble(b);if(Core.Events.getEventTarget(b).tagName.toLowerCase()!="a"){return}var c=a.firstChild.lastChild.innerHTML;if(c==="点此查看"){a.parentNode.style.display="none"}else if(c==="绑定微博"){$E("writeComm_tips").parentNode.style.display="none";this.bindToTSina()}else{if(checkUserProduct.flag==true){this.openStep()}else{this.shareToT()}}}.bind2(this),"click")},openStep:function(){var me=this;Utils.Io.Ijax.request("http://control.blog.sina.com.cn/riaapi/tshow/send_cms_weibo.php",{POST:{uid:$UID,blog_id:scope.$temp_commId,content:scope.$temp_commCtt,isphoto:0},onComplete:function(data){data=eval("("+data+")")||{};if(data.code==="A00006"){var tips=$E("writeComm_tips");tips.parentNode.style.display="block";tips.firstChild.innerHTML='评论成功同步到微博，<a href="http://weibo.com/'+data.data+'/profile" target="_blank">点此查看</a>'}else if(data.code==="B00001"){winDialog.alert("您的博客还未绑定新浪微博，现在绑定？",{icon:"04",funcOk:function(){me.bindToTSina()}})}else if(data.code==="A00004"||data.code==="A11007"){me.shareToT()}else{winDialog.alert("网络繁忙，请稍后再试。",{icon:"01"})}},onException:function(a,b){winDialog.alert("网络繁忙，请稍后再试。",{icon:"01"})}})},bindToTSina:function(){var a=this;var b="http://control.blog.sina.com.cn/t_sina_blog/bind_weibo_form.php?from=js&domain="+document.domain;window.open(b,"mb","toolbar=0,status=0,resizable=1,width=440,height=430,left="+(screen.width-440)/2+",top="+(screen.height-430)/2);window.tOkBack=function(){trace("微博绑定回调ok函数！");winDialog.alert("绑定微博成功",{icon:"03",funcOk:function(){a.openStep()},funcClose:function(){a.openStep()}})};window.tFailBack=function(){trace("微博绑定 fail");winDialog.alert("网络繁忙，请稍后再试。",{icon:"01"})}},shareToT:function(){var a=scope.$temp_commCtt;if(a){var b=encodeURIComponent(a);var c="http://v.t.sina.com.cn/share/share.php?",d="新浪-博客",e="http://blog.sina.com.cn",f="http://v.t.sina.com.cn/share/share.php?searchPic=false&title="+b+"&url="+encodeURIComponent(document.location)+"&source="+d+"&sourceUrl="+encodeURIComponent(e)+"&content=utf-8&appkey=1617465124";window.open(f,"selectionshare","toolbar=0,status=0,resizable=1,width=440,height=430,left="+(screen.width-440)/2+",top="+(screen.height-430)/2)}else{winDialog.alert("分享的内容不能为空",{icon:"01"})}$E("writeComm_tips").parentNode.style.display="none"}};var checkUserProduct={isinit:false,func:null,product:"",flag:true,getReturn:function(a){switch(a){case"blog":var b="0x"+scope.userProducts&1;if(b!=0){this.flag=true}else{this.flag=false}break;case"photo":var b="0x"+scope.userProducts&8;if(b!=0){this.flag=true}else{this.flag=false}break;default:this.flag=true}this.func()},check:function(a,b){this.product=a;this.func=b||function(){};if(scope.userProducts){this.getReturn(a)}else{var c="http://uic.sso.sina.com.cn/uic/Query.php?"+"UID="+$UID+"&Check=null&UserInfoTypes=[4]&ProductType=2";Utils.Io.JsLoad.request(c,{onComplete:function(a){if(typeof a=="object"){scope.userProducts=a.UserInfo[0][1];this.getReturn(this.product);this.isinit=true}else{this.flag=false;this.isinit=true}}.bind2(this),charset:"UTF-8"})}}};CommentV2.formatTime=function(a){var b=new Date;if(a){b.setTime(b)}var c=b.getMonth()+1>=10?b.getMonth()+1:"0"+(b.getMonth()+1);var d=b.getDate()>=10?b.getDate():"0"+b.getDate();var a=(new Date).toTimeString().split(" ")[0];var e=b.getFullYear()+"-"+c+"-"+d+" "+a;return e};CommentV2.Post=Core.Class.create();CommentV2.Post.prototype={articleid:0,totle:0,anonyous:false,onSuccess:new Function,onError:new Function,initialize:function(){},post:function(a){try{this.data=a;this.data.article_id=this.articleid;this.data.uid=$isLogin?$UID:"";this.data.fromtype="commentadd";this.data.anonymity=this.data.anonymity||this.anonyous||false;if(this.data.anonymity){this.data.login_name=this.data.comment_anonyous}Lib.checkAuthor();if($isLogin){this.data.login_name=$nick;this.postComment(this.data)}else{if(this.anonyous){this.postComment(this.data)}else{if($E("login_remember")){if(this.data.login_remember){v7sendLog("48_01_37_1")}else{v7sendLog("48_01_37_0")}}(new Lib.Login.LoginPost(function(a){Lib.checkAuthor();if($isLogin){this.data.login_name=$nick;this.postComment(this.data);this.renderLogin()}else{if(a&&a.errno&&(a.errno==="4049"||a.errno==="2070")){this.loginNeedSafeCode(a);return}else{winDialog.alert(a&&a.reason||"登录名或密码错误！",{icon:"02"})}this.refreshCKIMG();$E("commentloginM").style.display="none";$E("commentlogin").style.display="block";$E("commentNick").style.display="";$E("commentNick").innerHTML="";if($E("anonymity_cont")){$E("anonymity").checked=false;$E("anonymity_cont").style.display="none"}}}.bind2(this),false,"referer:"+location.hostname+location.pathname+",func:0001")).login(a.login_name,a.login_pass,a.login_remember==true?15:0)}}}catch(b){trace(b)}},renderLogin:function(){$tray.renderLogin();$E("commentlogin").style.display="none";var a=this;var b=$E("commentNick");var c=function(){if(checkUserProduct.flag==true){scope.setNickTime=setInterval(function(){var a=Lib.blogv.getVHTML(scope.loginUserWtype);if(typeof scope.$loginNick=="undefined"){Lib.Uic.getNickName([$UID],function(c){for(var d in c){scope.$loginNick=c[d];b.innerHTML=scope.$loginNick+"&nbsp;"+a+":";b.style.display=""}});clearInterval(scope.setNickTime)}else{b.innerHTML=scope.$loginNick+"&nbsp;"+a+":"}},500)}else{a._showOpenBlogInfo()}};if(b.innerHTML==""){if(checkUserProduct.isinit==false){window.checkuserinterval=setInterval(function(){if(checkUserProduct.isinit==false){checkUserProduct.check("blog",c)}else{clearInterval(window.checkuserinterval)}},500)}else{c()}}if($E("anonymity_cont")){$E("anonymity_cont").style.display=""}},_showOpenBlogInfo:function(){for(var a=$E("commentNick").firstChild;a;a=a.nextSibling){$E("commentNick").removeChild(a)}$E("commentNick").style.display="";$E("commentNick").innerHTML='<div id="openblog-li" style="cursor:pointer;"><a href="javascript:void(0);"><span id="openblog-nickname"></span>您还未开通博客，点击一秒开通。</a></div>';scope.addBlogOpenerEvent($E("openblog-li"));if($E("anonymity")){$E("commentloginM").style.display="";$E("anonymity").checked=true;$E("quote_comment_p").style.display="none"}var b=setInterval(function(){if(!scope.nickname){return}$E("openblog-nickname").innerHTML=scope.nickname+"：";clearInterval(b)},500)},postComment:function(a){function c(a){if(!a){var c=(new Date).getTime();a=c-b}Utils.Io.JsLoad.request("http://control.blog.sina.com.cn/admin/article/ria_debug.php",{GET:{type:"addBlogComment",usetime:a},noreturn:true})}v7sendLog("32_01_19");var b=(new Date).getTime();var d={POST:a,onComplete:function(b){if(typeof b=="string"){b=b.replace(/;$/,"")}b=typeof b=="string"&&/\s*{/.test(b)?Core.String.j2o(b):b;if(b!=null&&typeof b.code=="undefined"){trace("接口数据异常："+this.url,"#F00");return}if(b.code=="A00006"){v7sendLog("45_01_12_"+scope.$uid);b=b.data;if(a.is_mobile){if(b.insertid.charAt(0)==="N"){b.insertid=b.insertid.slice(1)}var d=b.t_sina;if(d&&d.charAt(0)==="N"){b.t_sina=d.slice(1)}}c();Lib.checkAuthor();var e=$E("c_"+scope.$articleid).innerHTML;var f=parseInt(/(\d+)/.exec(e)[0],10);f++;$E("c_"+this.articleid).innerHTML="("+f+")";if($isLogin){this.renderLogin()}this.addNewComment(a,b);var g=new Comment2TSina(this.anonyous,b);if($E("bb")&&$E("bb").checked){v7sendLog("32_01_18")}g.writeCommTips();this.onSuccess();if($E("comment_get_vcode")){Lib.AudioCheck.render($E("comment_get_vcode").parentNode,Lib.AudioCheck.soundUrl+"?"+(new Date).getTime())}else{}}else{v7sendLog("32_01_21");c();this.refreshCKIMG();if(b.code=="B36113"){winDialog.alert("博主已关闭匿名评论，请登录后再评论",{funcOk:function(){if($E("anonymity_cont")){$E("anonymity_cont").checked=false;$E("anonymity_cont").style.display="none"}$E("commentlogin").style.display="";$E("commentloginM").style.display="none"}})}else if(b.code=="B36002"){winDialog.alert($SYSMSG["B36002"],{funcOk:function(){$E("login_check").value="";$E("login_check").focus()}})}else{showError(b.code)}if(b.code!=null){Lib.checkAuthor();if($isLogin){return}if($E("anonymity_cont")){$E("anonymity").checked=false;$E("anonymity_cont").style.display="none"}if($E("anonymity").checked==true){$E("commentloginM").style.display="block";$E("anonymity").checked="checked"}else{$E("commentloginM").style.display="none";$E("commentlogin").style.display="block"}$E("commentNick").innerHTML="";$isLogin=false;this.anonyous=true}}}.bind2(this),onException:function(a){v7sendLog("32_01_21");c(-1);trace("post comment error");winDialog.alert($SYSMSG[a.code]||"发评论失败！请重试。",{icon:"02"})}.bind2(this)};Utils.Io.Ijax.request("http://control.blog.sina.com.cn/admin/comment_new/cms_post.php",d);var e=setTimeout(function(){c(-1);clearTimeout(e);e=null},3e4)},refreshCKIMG:function(){if($E("comment_check_img")){$E("comment_check_img").src="http://interface.blog.sina.com.cn/riaapi/checkwd_image.php?"+(new Date).valueOf()}if($E("comment_get_vcode")){Lib.AudioCheck.render($E("comment_get_vcode").parentNode,Lib.AudioCheck.soundUrl+"?"+(new Date).getTime())}},addNewComment:function(a,b){if(isNaN(scope.$comment_page)||"undefined"==typeof scope.$comment_page){scope.$comment_page=1}var c=CommentV2.count(scope.$totle_comment);Lib.checkAuthor();this.getPostTemplet(a,b)},commentTween:function(a){var b=this;var c=$E("article_comment_list");var d;if(scope.$pageid.indexOf("articletj")===-1){c.appendChild(a);d=$E("postCommentIframe")}else{var e=$T(c,"li")[0];if(e){e.className="SG_j_linedot1";c.insertBefore(a,e)}else{c.appendChild(a)}d=$E("postcommentid")}var f=Core.Dom.getXY(a);var g=Core.Dom.getXY(d);new rockIt(a,g,f,0,300,"elasticEaseInOut",{end:function(e){e.clear();Core.Dom.opacity(a,0);if(scope.$pageid.indexOf("articletj")===-1){c.appendChild(a);d=$E("postCommentIframe")}else{c.insertBefore(a,c.firstChild);d=$E("postcommentid")}var f=0;var g=function(){Core.Dom.opacity(a,f);if(f==100){clearInterval(h);f=0}f+=20};var h=setInterval(g,10);var i=b.getScollTop();var j=Core.Dom.getXY(a)[1];if(j>i){return}var k=Math.abs(i);var l=0;var m=100;if(k<=100){l=k==i?1:-1;m=k}else{l=i/100}var n=+(new Date);var o=500;var p=setInterval(function(){var a=window.$transitions["regularEaseOut"];var c=+(new Date);if(c-n<o){var d=c-n}else{var d=o;clearInterval(p)}b.setScollTop(a(d,i,j-i,o))},15)}})},getScollTop:function(){var a=0;var b=0;if(document.body&&(document.body.scrollLeft||document.body.scrollTop)){b=document.body.scrollTop;a=document.body.scrollLeft}else if(document.documentElement&&(document.documentElement.scrollLeft||document.documentElement.scrollTop)){b=document.documentElement.scrollTop;a=document.documentElement.scrollLeft}return b},setScollTop:function(a){if(document.body&&(document.body.scrollLeft||document.body.scrollTop)){document.body.scrollTop=a}else if(document.documentElement&&(document.documentElement.scrollLeft||document.documentElement.scrollTop)){document.documentElement.scrollTop=a}},getPostTemplet:function(a,b){var c=this;var d=b.isworldcup;var e=b;var b=e.insertid||b;var f={};f.id=b;f.user_image=e.user_img;f.src_uid=scope.$uid;if(a.anonymity){f.uname=a.comment_anonyous;f.comm_uid=0}else{f.ulink="http://blog.sina.com.cn/u/"+(a.uid||$UID);f.ria_index_url=f.ulink;var g=Lib.blogv.getVHTML(scope.loginUserWtype);f.uname=scope.nickname||a.login_name;if(g){f.vimg=g}f.comm_uid=$UID}f.cms_body=this.changeToContent(a.comment);f.cms_pubdate=CommentV2.formatTime();f.fromProduct=e.from_product;f.cms_reply_num="0";f.action_data=encodeURIComponent(Utils.Json.flatten({commentid:f.id,articleid:e.blog_id,fromProduct:e.from_product,comm_uid:f.comm_uid,uname:f.uname,ulink:f.ulink,src_uid:scope.$uid,cms_reply_num:f.cms_reply_num}));var h={};h.item=f;h.fun=function(a){c.commentTween(a)};Lib.Listener.notify("commentlist-commentadd",h);var i=this.isNoCotent();var j=scope&&scope.$pageid==="articletj";if(i){i.parentNode.removeChild(i)}},isNoCotent:function(){var a=$E("article_comment_list");var b=a.getElementsByTagName("li");for(var c=0;b[c];c++){var d=b[c].getElementsByTagName("div");for(var e=0;d[e];e++){if(d[e].className.toUpperCase().indexOf("NOCOMMDATE")!=-1){return b[c]}}}return null},changeToContent:function(a){var b=a.replace(/\r\n|\n/gi,"###line-return###");b=Core.String.encodeHTML(b);var c=/\[emoticons=(E___\w*)\]([^[]*)\[\/emoticons\]/gi;var d='<img src="http://www.sinaimg.cn/uc/myshow/blog/misc/gif/$1T.gif" style="margin:1px;'+'cursor:pointer;" onclick="window.open(\'http://blog.sina.com.cn/myshow2010'+'\')" border="0" title="$2" />';b=b.replace(c,d);var e=/\[magicemoticons=([E|W]___\w*)\&nbsp\;swfname=(\w+\.swf)\]([^[]*)\[\/magicemoticons\]/gi;var f=['<img src="http://www.sinaimg.cn/uc/myshow/blog/misc/gif/$1T.gif" style="margin:1px;','cursor:pointer;" onclick="window.$magicFacePlay(\'$2\');return false;"',' border="0" title="$3" width="50" height="50"/>'].join("");b=b.replace(e,f);b=b.replace(/###line-return###/gi,"<br/>");return b},loginNeedSafeCode:function(a){var b=this;var c="http://login.sina.com.cn/cgi/pin.php";var d=['<table id="#{entity}" class="CP_w">','<thead id="#{titleBar}">',"<tr>",'<th class="tLeft"><span></span></th>','<th class="tMid">','<div class="bLyTop">','<strong id="#{titleName}"></strong>','<cite><a title="关闭" class="CP_w_shut"  id="#{btnClose}" href="javascript:;">关闭</a></cite>',"</div>","</th>",'<th class="tRight"><span></span></th>',"</tr>","</thead>","<tfoot>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid"><span></span></td>','<td class="tRight"><span></span></td>',"</tr>","</tfoot>","<tbody>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid">','<div class="" style="width:auto;" id="#{content}">',"</div>","</td>",'<td class="tRight"><span></span></td>',"</tr>","</tbody>","</table>"].join("");var e='<div class="CP_layercon1">'+'<div class="verifyPrompt"><p>为了保护你的账号安全，请输入验证码进行登录</p>'+'<div class="row1"><strong>验证码：</strong>'+'<input type="text" maxlength="5" id="xssSafeCodeDiag_checkword" class="fm1">'+'<img width="100" align="absmiddle" src="http://login.sina.com.cn/cgi/pin.php?r=11681364785467546&amp;s=0" maxlength="5" id="xssSafeCodeDiag_safeimg">'+'<a id="" href="javascript:void(0); return false;" onclick="scope.xssSafeCodeDiag.changeSafeCode();">换一换</a>'+"</div>"+'<p class="CP_w_btns">'+'<a id="" href="javascript:void(0); return false;" class="CP_a_btn2" onclick="scope.xssSafeCodeDiag.ok();"><cite><span>登录</span></cite></a>'+'<span style="display:none" id="xssSafeCodeDiag_ErrTips" class="ErrTips"></span>'+"</p>"+"</div>"+"</div>";if(typeof scope.xssSafeCodeDiag=="undefined"){scope.xssSafeCodeDiag=winDialog.createCustomsDialog({tpl:d,title:"提示",content:e,width:282,height:180,funcDisplayFinished:function(){}},"note");scope.xssSafeCodeDiag.changeSafeCode=function(){$E("xssSafeCodeDiag_checkword").value="";$E("xssSafeCodeDiag_safeimg").src="http://login.sina.com.cn/cgi/pin.php?r="+Core.Math.getUniqueId()+"&s=0"};scope.xssSafeCodeDiag.ok=function(){var a=$E("xssSafeCodeDiag_checkword").value;if(a===""){$E("xssSafeCodeDiag_ErrTips").innerHTML="请输入验证码";$E("xssSafeCodeDiag_ErrTips").style.display="";return}if(typeof sinaSSOController!="undefined"&&typeof sinaSSOController.loginExtraQuery!="undefined"){if(typeof sinaSSOController.loginExtraQuery.door!="undefined"){sinaSSOController.loginExtraQuery.door=a||1}}sinaSSOController.loginExtraQuery.door=a||1;b.post(b.data);scope.xssSafeCodeDiag.hidden()};scope.xssSafeCodeDiag.displayError=function(a){if(a.errno!=="4049"){$E("xssSafeCodeDiag_ErrTips").innerHTML=a.reason;$E("xssSafeCodeDiag_ErrTips").style.display=""}else{$E("xssSafeCodeDiag_ErrTips").style.display="none"}}}scope.xssSafeCodeDiag.show();scope.xssSafeCodeDiag.setMiddle();scope.xssSafeCodeDiag.changeSafeCode();scope.xssSafeCodeDiag.displayError(a)}};CommentV2.commentFaceTemplate=['<table id="#{entity}" class="CP_w">','<thead id="#{titleBar}">',"<tr>",'<th class="tLeft"><span></span></th>','<th class="tMid">','<div class="bLyTop">','<strong id="#{titleName}">插入表情</strong>','<cite><a id="#{btnClose}" href="javascript:;" onclick="return false;" class="CP_w_shut" title="关闭">关闭</a></cite>',"</div>","</th>",'<th class="tRight"><span></span></th>',"</tr>","</thead>","<tfoot>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid"><span></span></td>','<td class="tRight"><span></span></td>',"</tr>","</tfoot>","<tbody>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid" id="#{content}">','<div class="faceItemContent">','<div class="bigface">','<div id="#{faceTab}" class="faceSidebar">',"</div>",'<div id="#{faceContent}" class="faceShowAll">',"</div>","</div>","</div>","</td>",'<td class="tRight"><span></span></td>',"</tr>","</tbody>","</table>"].join("");CommentV2.count=function(a){var b=50;var c=0;if(a%b==0)c=Math.ceil(a/b);else c=Math.floor(a/b)+1;return c};var Comment={};CommentV2.insertSmile=Core.Class.create();CommentV2.insertSmile.prototype={initialize:function(){},show:function(){this.btnShowFaceEditor=$E("article_comment_insertSmile");this.txtComment=$E("commentArea");this.faceEditor=new Lib.Face(this.txtComment);var a=this;a.bindFace()},bindFace:function(){var a=this;Core.Events.addEvent(this.btnShowFaceEditor,function(){if(a.faceEditor.isShowed){a.faceEditor.hidden()}else{if(!a.faceEditor.isLoad){a.faceEditor.load();a.initFace();a.faceEditor.isLoad=true}var b=Core.Dom.getLeft(a.btnShowFaceEditor)-450;var c=Core.Dom.getTop(a.btnShowFaceEditor)+a.btnShowFaceEditor.offsetHeight;a.faceEditor.setPosition(b,c);a.faceEditor.show()}Core.Events.stopEvent()},"mousedown")},initFace:function(){var a=this;Core.Events.addEvent(this.faceEditor.dialogNodes["btnClose"],function(){a.faceEditor.hidden()},"mousedown");Core.Events.addEvent(document.body,function(){a.faceEditor.hidden()},"mousedown");Core.Events.addEvent(this.faceEditor.dialog.entity,function(){Core.Events.stopEvent()},"mousedown")}};$SYSMSG.extend({B119001:"不能转载自己的文章!",B119002:"转帖功能为新版博客专属功能，点击确认立即升级你的博客吧！<br/><span style='font-weight: 100; font-size: 12px;'><a target='_blank' href='http://blog.sina.com.cn/lm/iframe/xhtml/2010/blogspread.html'>了解新版博客详情</a></span>",B119003:"被转载文章不存在!",B119004:"请访问原文进行转载！",B119005:"对不起，博主设置不允许转载该文章",B119006:"对不起，博主设置不允许转载其文章",B119007:"很抱歉，转载失败，请稍后再试",B119008:"已经转载很多啦，看看其他的精彩文章",B119009:"您短时间转载过多，请稍后再试"});App.getArticlesSort=function(a,b){b=b||scope.$uid;var c=$C("script");Lib.checkAuthor();c.src="http://hits.blog.sina.com.cn/acate?varname=x&uid="+b;c.charset="utf-8";c.onload=c.onerror=c.onreadystatechange=Core.Function.bind2(function(){if(c&&c.readyState&&c.readyState!="loaded"&&c.readyState!="complete"){return}App.ArticlesSort=x;if(a!=null){a(App.ArticlesSort)}c.onload=c.onreadystatechange=c.onerror=null;c.src="";c.parentNode.removeChild(c);c=null},this);document.getElementsByTagName("head")[0].appendChild(c)};var cateDialog=Core.Class.create();cateDialog.prototype={uid:"",initialize:function(a){this.action=a||false},show:function(a){this.uid=a||scope.$uid;this.initDialog();this.dialog.show();this.dialog.setFixed(true);this.dialog.setAreaLocked(true);this.dialog.setMiddle()},initDialog:function(){var a=this;var b={width:492,height:0,url:"http://control.blog.sina.com.cn/admin/article/article_class_list.php?"+(this.action?"action=editor":"")};Lib.checkAuthor();this.url="http://control.blog.sina.com.cn/admin/article/article_class_save2.php?uid="+$UID+(this.action?"&action=editor":"");this.id=Core.Math.getUniqueId();this.manage=null;this.manage=new cateMng(this.id,this.itemTpl,this.uid);this.manage.onSuccess=function(b){a.onSuccess(b)};var c=new Ui.Template("<div style='width: #{width}px; height: #{height}px;' id='category_"+this.id+"'></div>");var d={ad:false,drag:true,title:"分类管理",content:c.evaluate(b),shadow:1,width:b.width,height:b.height};var e={};var f=winDialog.createCustomsDialog(d,e);this.dialog=f;$E("category_"+this.id).innerHTML=this.tpl.join("");var g=this;this.dialog.nodes["btnClose"].href="javascript:;";this.dialog.nodes["btnClose"].onclick=function(){if(g.manage.getEdit()){winDialog.confirm("是否保存此更改？",{funcOk:function(){g.manage.saveHandler(g.url)},funcCancel:function(){g.close()},funcClose:function(){g.dialog.show()},textOk:"是",textCancel:"否"})}else{g.close()}};this.initEvent()},initEvent:function(){this.manage.nameEvent();this.manage.createEvent();this.manage.dataProvider();this.manage.saveEvent(this.url)},hidden:function(){this.dialog.hidden()},close:function(){this.dialog.hidden();this.dialog.destroy()},showOld:function(){this.dialog.show()},reset:function(){window.CateDialog.dialog.setCloseEvent(true);window.CateDialog.dialog.hidden();window.CateDialog.dialog=null;window.CateDialog.init=false},setSize:function(a,b){var c=this.dialog.nodes.content.firstChild;this.dialog.setSize(a,b);c.style.width=a+"px";c.style.height=b+"px"},setCloseEvent:function(a){},getDialog:function(){return this.dialog},getId:function(){return this.id},getDataList:function(){return this.manage.list},onSuccess:function(a){},init:false,dialog:null,tpl:['<div id="categoryBody">','<div id="categoryTitle">',"</div>",'<div id="categoryHead">',"<table>","<tr>",'<td><input type="text" maxlength="28" value="最多可输入14个中文字符" id="categoryName"/></td>','<td width="80"><a id="categoryCreate" href="javascript:void(0);" class="SG_aBtn SG_aBtnB SG_aBtn_sub"><cite>创建分类</cite></a></td>','<td><span class="SG_txtc">请用中文、英文或数字。</span></td>',"</tr>","</table>",'<div id="errTips"></div>',"</div>",'<form method="post" id="categoryForm" name="form">','<div id="categoryList">','<ul class="clearfix" id="datalist">&nbsp;</ul>','<div class="SG_j_linedot"></div>',"</div>",'<div id="categoryBottom" style="text-align:center">','<a id="categorySave" href="javascript:void(0);" class="SG_aBtn SG_aBtnB SG_aBtn_sub"><cite>保存设置<input type="button" value="保存设置"/></cite></a>',"</div>","</form>","</div>"],itemTpl:['<li class="{class}">','<span class="htit" style="color:#000000" id="cate_{index}">{cate}</span>','<input type="hidden" value="{cate}" name="typename[]" class="catName"/>','<input type="hidden" value="{id}" name="number[]"/>','<span id="ctrl_{index}" class="control">','<div class="manage">','<a class="CP_a_fuc" id="edit_{index}" href="javascript:;" onclick="javascript:window.CateDialog.manage.editCate(this);">[<cite>编辑</cite>]</a>','<a class="CP_a_fuc" id="del_{index}" index="{index}" href="javascript:;" onclick="javascript:window.CateDialog.manage.delCate(this);">[<cite>删除</cite>]</a>',"</div>",'<div class="arrow">','<a id="up_{index}" class="{up_class}" href="javascript:;" onclick="javascript:window.CateDialog.manage.upHandler(this);"/>','<a id="down_{index}" class="{down_class}" href="javascript:;" onclick="javascript:window.CateDialog.manage.downHandler(this);"/>',"</div>","</span>",'<div id="editctrl_{index}" class="writeinfo" style="display:none">','<input id="new_{index}" type="text" value="" /><a class="SG_aBtn SG_aBtnB SG_aBtn_sub" href="javascript:;"><cite>确定</cite></a><a class="SG_aBtn SG_aBtnB SG_aBtn_sub" href="javascript:;"><cite>取消</cite></a></div>',"<div/>","</li>"]};var cateMng=Core.Class.create();cateMng.prototype={list:null,orilen:0,edit:false,uid:null,initialize:function(a,b,c){this.uid=c||scope.$uid;this.id=a;this.itemTpl=b;Array.prototype.remove=function(a){if(isNaN(a)||a>this.length){return false}this.splice(a,1)}},nameEvent:function(){var a=this;$E("categoryName").onfocus=function(){if(this.value=="最多可输入14个中文字符"){this.value=""}};$E("categoryName").onblur=function(){var b=/[ ><\\\'\;\"`\|\t\r\n|\u3000]/ig;this.value=this.value.replace(b,"");if(Core.String.trim($E("categoryName").value)==""){this.value="最多可输入14个中文字符";this.edit=false}else{this.edit=true}a.showTips("")};$E("categoryName").onkeyup=function(){var a=Core.String.trim(this.value);if(Core.String.byteLength(a)>28){this.value=Core.String.leftB(a,28)}else if(a!=this.value){this.value=a}};a.showTips("")},createEvent:function(){function c(){var c=Core.String.trim($E("categoryName").value);b="";if(c==""||c=="最多可输入14个中文字符"){b="分类名称不能为空"}else if(c.indexOf("&")!=-1||c.indexOf("＆")!=-1){b="分类名称不能包含&符号"}else if(a.list.length>=15){b="抱歉！最多可创建15条分类"}else if(Core.String.byteLength(c)>28){b="最多可输入14个中文字符"}for(var d=0;d<a.list.length;d++){if(a.list[d].name==c){b="您已经添加过此分类";break}}if(b!=""){return false}else{return true}}var a=this;var b="";$E("categoryCreate").onclick=function(){if(c()&&$E("categoryName").edit){var d={id:-1,name:$E("categoryName").value};$E("categoryName").value="最多可输入14个中文字符";$E("categoryName").edit=false;a.list.push(d);a.update()}a.showTips(b)}},saveEvent:function(a){Core.Events.stopEvent();var b=this;$E("categorySave").onclick=function(){b.saveHandler(a)}},saveHandler:function(url){var _this=this;var length=_this.list.length;if(_this.orilen-length>2){winDialog.confirm("您本次删除的博文分类太多，确定删除？",{funcOk:function(){_this.orilen=length;$E("categorySave").onclick()}});return}var cateName=[];var cateId=[];for(var i=0;i<length;i++){var item=_this.list[i];cateName.push(item.name);cateId.push(item.id)}Utils.Io.Ijax.request(url+"&r="+Math.random(),{POST:{typename:cateName.join("|"),number:cateId.join("|")},onComplete:function(res){eval("var result = "+res);try{try{if($E("module_3")){Lib.Component.refresh(3,{width:scope.catedialogwidth||210})}if($E("module_7")){location.reload()}}catch(error){trace(error)}try{window.ArticleCateFuncs.reloadCate(result.msg)}catch(error){}window.CateDialog.close()}catch(e){}var r;eval("r="+res);_this.onSuccess(r.msg)},onException:function(a){}})},editCate:function(a){function g(a,d){var f=a;var g="";if(Core.String.byteLength(f)>28){f=Core.String.leftB(f,28)}if(d==1){for(var h=0;h<b.list.length;h++){if(b.list[h].name==f){g="您已经添加过此分类";break}}}if(g!=""){if(!$E("err_"+c)){Core.Dom.addHTML($E("editctrl_"+c),'<div id="err_'+c+'" class="errTips">'+g+"</div>");e.style.height="60px"}else{$E("err_"+c).value=g}}else{b.list[c].name=f;var i=b.itemTpl.join("");i=i.replace('<li class="{class}">',"");i=i.replace("</li>");var j=b.list[c];i=i.replace(/\{cate\}/ig,j.name);i=i.replace(/\{id\}/ig,j.id);i=i.replace(/\{index\}/ig,c);i=i.replace(/\{up_class\}/,c==0?"up_disabled":"up");i=i.replace(/\{down_class\}/,c==b.list.length-1?"down_disabled":"down");e.innerHTML=i;e.className=c%2==0?"":"cline";e.style.height="30px";if(d==1){b.edit=true}}g=""}var b=this;var c=a.id.split("_")[1];var d=$E("cate_"+c).innerHTML;var e=$E("cate_"+c).parentNode;$E("ctrl_"+c).className="control hide";e.className=c%2==0?"editName":"cline editName";var f='<div id="editctrl_'+c+'" class="writeinfo"><input id="new_'+c+'" type="text" value="'+d+'"><a class="SG_aBtn SG_aBtnB SG_aBtn_sub" href="javascript:;"><cite>确定</cite></a><a class="SG_aBtn SG_aBtnB SG_aBtn_sub" href="javascript:;"><cite>取消</cite></a></div>';e.innerHTML=f;$E("new_"+c).onkeyup=function(){var a=/[ >&<\\\'\,\;\"`\|\t\r\n|\u3000]/ig;var b=Core.String.trim(this.value.replace(a,""));if(b!=this.value){this.value=b}if(b==""){$E("editctrl_"+c).childNodes[1].disabled=true}else{$E("editctrl_"+c).childNodes[1].disabled=false}};$E("new_"+c).onblur=function(){if(Core.String.byteLength(this.value)>=28){this.value=Core.String.leftB(this.value,28)}};$E("editctrl_"+c).childNodes[1].onclick=function(){if($E("new_"+c).value==d){g(d,2)}else{g($E("new_"+c).value,1)}};$E("editctrl_"+c).childNodes[2].onclick=function(){g(d,2)}},delCate:function(a){var b=this;var c=a.id.split("_")[1];winDialog.confirm("确实要删除此分类吗？删除后不可恢复。",{funcOk:function(){b.list.remove(c);b.update()}})},upHandler:function(a){var b=a.id.split("_")[1];if(b>0){var c=this.list[b];this.list[b]=this.list[b-1];this.list[b-1]=c;this.update()}},downHandler:function(a){var b=a.id.split("_")[1];if(b<this.list.length-1){var c=b*1+1;var d=this.list[c];this.list[c]=this.list[b];this.list[b]=d;this.update()}},showTips:function(a){$E("errTips").innerHTML=a},dataProvider:function(){var a=this;App.getArticlesSort(function(b){a.list=b.data;a.orilen=a.list.length;$E("datalist").innerHTML="";for(var c=0;c<a.list.length;c++){var d=a.itemTpl.join("");var e=a.list[c];d=d.replace(/\{cate\}/ig,e.name);d=d.replace(/\{class\}/ig,c%2==0?"":"cline");d=d.replace(/\{id\}/ig,e.id);d=d.replace(/\{index\}/ig,c);d=d.replace(/\{up_class\}/,c==0?"up_disabled":"up");d=d.replace(/\{down_class\}/,c==a.list.length-1?"down_disabled":"down");Core.Dom.addHTML($E("datalist"),d)}},this.uid)},update:function(){$E("datalist").innerHTML="";for(var a=0;a<this.list.length;a++){var b=this.itemTpl.join("");var c=this.list[a];b=b.replace(/\{cate\}/ig,c.name);b=b.replace(/\{class\}/ig,a%2==0?"":"cline");b=b.replace(/\{id\}/ig,c.id);b=b.replace(/\{index\}/ig,a);b=b.replace(/\{up_class\}/,a==0?"up_disabled":"up");b=b.replace(/\{down_class\}/,a==this.list.length-1?"down_disabled":"down");Core.Dom.addHTML($E("datalist"),b)}if(!this.edit){this.edit=true}},getEdit:function(){return this.edit},onSuccess:function(a){}};var QuoteSuccess=Core.Class.create();QuoteSuccess.prototype={interfaceSave:null,_isDialogInit:false,_dialog:null,memoNullText:"说点什么...",articleID:"",_cateList:[],initialize:function(){Lib.checkAuthor();this.interfaceSave=new Interface("http://control.blog.sina.com.cn/riaapi/article/edit_cat.php","ijax");!window.CateDialog&&(window.CateDialog=new cateDialog)},show:function(a){!this._isDialogInit&&this._initDialog();this.articleID=a||"";this._dialog.show();this._dialog.setFixed(true);this._dialog.setMiddle();this._dialog.setAreaLocked(true)},save:function(){var a=this,b=this._dialog.nodes;this.interfaceSave.request({POST:{new_cat:b.selCate.value,blog_id:a.articleID,reship:b.txtMemo.value===a.memoNullText?"":b.txtMemo.value},onSuccess:function(b){a.onSuccess(b);a.close()},onError:function(b){a.onError(b)},onFail:function(){}})},close:function(){this._dialog.hidden();this.clear()},_initDialog:function(){var a=this;this._dialog=winDialog.createCustomsDialog({content:['<div class="CP_layercon6">','<div class="turnBox">','<p class="turnTxt">','<img class="SG_icon SG_icon203" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="50" height="50" align="absmiddle"/>','<span class="txt1">转载成功！</span>你还可以写评论...',"</p>","<ul>",'<li><span class="a">评论：</span><span class="b"><textarea id="#{txtMemo}" style="color:#c8c8c8;" cols="" rows="3" class="SG_textarea">'+this.memoNullText+"</textarea></span></li>","<li>",'<span class="a">分类：</span>','<span class="b"><select id="#{selCate}" name=""><option value="00">默认文章分类</option></select>&nbsp;&nbsp;<a id="#{btnShowCate}" href="#" onclick="return false;">创建分类</a></span>',"</li>","</ul>",'<div class="clearit"></div>','<div class="butt">','<a href="#" id="#{btnSave}" onclick="return false;" class="SG_aBtn SG_aBtnB"><cite>保存</cite></a>&nbsp;&nbsp;<a id="#{btnCancel}" onclick="return false;" href="#" class="SG_aBtn SG_aBtnB "><cite>关闭</cite></a>','<a style="visibility:hidden" target="_blank" href="http://blog.sina.com.cn/admin/advice/advice_list.php" class="link">改进建议</a>',"</div>","</div>",'<div class="clearit"></div>',"</div>"].join("")});Core.Events.addEvent(this._dialog.nodes.btnSave,function(){if(a._dialog.nodes.txtMemo.value===a.memoNullText&&a._dialog.nodes.selCate.selectedIndex===0){a.close()}else{a.verified()&&a.save()}},"click");Core.Events.addEvent(this._dialog.nodes.btnCancel,function(){a.close()},"click");Core.Events.addEvent(this._dialog.nodes.btnShowCate,function(){window.CateDialog.onSuccess=function(b){a._dialog.nodes.selCate.length=1;var c=b||[],d,e=c.length;for(d=0;d<e;d++){a.addCate(c[d].value,c[d].label)}a.addCate("0","私密博文")};Lib.checkAuthor();window.CateDialog.show($UID)},"click");this._dialog.addEventListener("hidden",function(){a.clear();a.onClose()});this._dialog.nodes.txtMemo.onblur=function(){if(this.value.replace(/\s/g,"")===""){this.style.color="#c8c8c8";this.value=a.memoNullText}};this._dialog.nodes.txtMemo.onfocus=function(){if(this.value===a.memoNullText){this.style.color="#000000";this.value=""}};this._initCateList();this._isDialogInit=true},verified:function(){var a=this._dialog.nodes;if(Core.String.byteLength(a.txtMemo.value)>2e3){winDialog.alert("评论内容必须是1000中文或2000字符以内，请重新输入。");return false}return true},_initCateList:function(){var a=this._dialog.nodes,b=this;a.selCate.length=1;Lib.checkAuthor();App.getArticlesSort(function(){var a=x.data,c,d=a.length;for(c=0;c<d;c++){b.addCate(a[c].id,a[c].name)}b.addCate("0","私密博文")},$UID)},_getFaceURL:function(a){var b=parseInt(a)%8+1;return"http://portrait"+b+".sinaimg.cn/"+a+"/blog/50"},addCate:function(a,b){var c=this._dialog.nodes.selCate;var d=$C("option");d.value=a;d.innerHTML=b;c.appendChild(d)},clear:function(){var a=this._dialog.nodes;a.txtMemo.style.color="#c8c8c8";a.txtMemo.value=this.memoNullText},onSuccess:function(a){},onError:function(a){},onClose:function(){}};var Quote=Core.Class.create();Quote.prototype={quoteSuccess:null,saving:false,articleID:"",initialize:function(a){this.quoteSuccess=new QuoteSuccess;this.initInterface();this.bindEvent(a);this.articleID=scope.$articleid},bindEvent:function(a){var b=this;if(a){Core.Events.addEvent($E(a),function(){b.check()})}},initInterface:function(){this._interface=new Interface("http://control.blog.sina.com.cn/admin/article/article_quote.php","ijax")},check:function(a,b,c,d){this.articleID=a||scope.$articleid;d=d||function(){};Lib.checkAuthor();var e=this;if(!$isLogin){v7sendLog("48_01_33");(new Lib.Login.Ui).login(function(){scope.blogOpener.showDialog(function(){e.save.bind2(e)();d()})})}else{var e=this;scope.blogOpener.showDialog(function(){e.save(b,c);d()})}},save:function(a,b){var c=this;if(this.saving){return}this.saving=true;var d={version:7,blog_id:c.articleID,comment:b||"",reship:a||""};this._interface.request({POST:d,onSuccess:function(b){this.numAdd();this.saving=false;var c=b.url.split("/").pop().split("_")[1].split(".")[0];if(!a){this.quoteSuccess.onSuccess=function(){winDialog.alert("博文已成功转载！<br/><span style='font-weight: 100; font-size: 12px;'><a target='_blank' href='"+b.url+"'>查看转载博文>></a></span>",{icon:"03"})};this.quoteSuccess.show(c)}this.onSuccess(c,b.url||"")}.bind2(this),onError:function(a){this.saving=false;if(a.code=="B119007"||a.code=="B119008"){winDialog.alert($SYSMSG[a.code],{icon:"01",funcOk:function(){window.location.href=window.location.href.replace(/#.*$/,"")}},"alert1");Core.Events.addEvent(winDialog.getDialog("alert1").getNodes().btnClose,function(){window.location.href=window.location.href.replace(/#.*$/,"")},"click");this.onError();return}if(a.code=="B119002"){winDialog.alert($SYSMSG[a.code],{icon:"01",funcOk:function(){window.location.href="http://control.blog.sina.com.cn/upgrade/upgrade_show.php?version=7"}})}else{winDialog.alert($SYSMSG[a.code],{icon:"02",funcOk:function(){window.location.href=window.location.href.replace(/#.*$/,"")}},"alert1");Core.Events.addEvent(winDialog.getDialog("alert1").getNodes().btnClose,function(){window.location.href=window.location.href.replace(/#.*$/,"")},"click")}this.onError()}.bind2(this),onFail:function(){this.saving=false}.bind2(this)})},numAdd:function(){var a=$E("quote_sign")||$E("quote_sign_"+this.articleID)||$E("z_"+this.articleID);if(!a){return}var b=a.innerHTML;var c;b.replace(/(\d+)/,function(a,b){c=b});a.innerHTML="("+(parseInt(c)+1)+")"},onSuccess:function(a){},onError:function(){}};var CommentQuote=Core.Class.create();CommentQuote.prototype={_isInitTip:false,_tip:null,quote:null,commentText:"",articleID:"",interfaceSave:null,initialize:function(){this.interfaceSave=new Interface("http://control.blog.sina.com.cn/riaapi/article/edit_cat.php","ijax");this._initQuote()},_initQuote:function(){var a=this;this.quote=new Quote;this.quote.onSuccess=function(b,c){a.hideTip();winDialog.alert("博文已成功转载！<br/><span style='font-weight: 100; font-size: 12px;'><a target='_blank' href='"+c+"'>查看转载博文>></a></span>",{icon:"03"});a.onSuccess()};this.quote.onError=function(){a.hideTip()}},showTip:function(a){var b,c=Core.System.winSize();!this._isInitTip&&this._initTip();b=this._tip;b.getNodes().content.innerHTML=a;b.visibility="hidden";b.show();b.setPosition(c.width/2- +b.entity.offsetWidth/2,c.height/2- +b.entity.offsetHeight/2);b.visibility="";b.setFixed(true)},check:function(a,b){this.articleID=a;this.commentText=b;this.quote.check(a,b,"1")},hideTip:function(){this._tip&&this._tip.hidden()},_initTip:function(){this._tip=new Lib.Panel;this._tip.setTemplate(['<div id="#{panel}" style="z-index:512;border:1px solid #CC9933; background:#FFFFCC; padding:20px;">','<div id="#{content}"></div>',"</div>"].join(""));this._isInitTip=true},onSuccess:function(){}};scope.bindEmailPanel=Core.Class.define(function(){Lib.Panel.prototype.initialize.apply(this,arguments);this.setTemplate(['<div id="#{panel}" style="z-index:512; width:200px" class="tb_layer_Y tb_layer_w5">','<div class="tb_layer_Y_main tip_layer_main">','<div class="tip_ps" style="width:auto;float:right">','<a id="closeBindEmail" title="关闭提示" class="tb_friend_inputDel" href="#" onclick="return false"></a>',"</div>",'<div style="padding:6px">为了您的账号安全，请<a id="linkBindEmail" href="#" target="_blank">绑定邮箱</a></div>',"</div>",'<div class="tb_layer_arrow tip_arrow"></div>',"</div>"].join(""))},Lib.Panel,{initUserInfo:function(a){var b=this.getNodes()}});$registJob("articleCommentPostV2",function(){function b(){var a=$E("commentNick");if(!a)return;for(var b=a.firstChild;b;b=b.nextSibling){a.removeChild(b)}a.innerHTML='<div id="openblog-li" style="cursor:pointer;"><a href="javascript:void(0);"><span id="openblog-nickname"></span>您还未开通博客，点击一秒开通。</a></div>';scope.addBlogOpenerEvent($E("openblog-li"));var c=setInterval(function(){if(!scope.nickname){return}$E("openblog-nickname").innerHTML=scope.nickname+"：";clearInterval(c)},100)}if(!$E("comment_check_img")){return}var a=new CommentQuote;a.onSuccess=function(){$E("cbCommentQuote")&&($E("cbCommentQuote").checked=false)};if(scope.$private.cms!=1&&scope.$isCommentAllow!=1){var c=false;$E("comment_check_img").style.display="none";var d=new CommentV2.Post;var e=function(){$E("commentNick").style.display="";if(checkUserProduct.flag==true){scope.setNickTime=setInterval(function(){var a=Lib.blogv.getVHTML(scope.loginUserWtype);if(typeof scope.$loginNick=="undefined"){Lib.Uic.getNickName([$UID],function(b){for(var c in b){scope.$loginNick=b[c];$E("commentNick").innerHTML=scope.$loginNick+"&nbsp;"+a+":"}});clearInterval(scope.setNickTime)}else{$E("commentNick").innerHTML=scope.$loginNick+"&nbsp;"+a+":"}},500)}else{b()}};if($isLogin){if(checkUserProduct.isinit==false){setTimeout(function(){checkUserProduct.check("blog",e)},10)}else{e()}}else{$E("commentlogin").style.display="block";var f=Utils.Cookie.getCookie("remberloginname");if(f!=""&&f!=""){$E("login_name").value=unescape(unescape(f))}var g=Utils.Cookie.getCookie("ALF");if(g!=""&&$E("login_remember")){$E("login_remember").checked=true}var g=Utils.Cookie.getCookie("LiRe");if(g!=""&&$E("login_remember")){$E("login_remember").checked=true}if($E("anonymity_cont")){$E("anonymity")&&($E("anonymity").checked=false);$E("anonymity_cont").style.display="none"}}if($E("bb")){$E("bb").checked=Utils.Cookie.getCookie("acp_bb")=="1"?false:true}var h=function(){function c(){if(b){var a="http://control.blog.sina.com.cn/blog_rebuild/riaapi/padblog/padInfo.php?ck_login=A00003&rnd="+Math.random();Utils.Io.JsLoad.request(a,{onComplete:function(){},onException:function(){}});b=null}}Lib.checkAuthor();var a=$E("login_remember");if(!a){return}a.checked=true;if(!$isLogin){a["onclick"]=c}var b=1};h();if($E("anonymity")&&$E("anonymity").checked){d.anonyous=true;$E("commentlogin").style.display="none";$E("commentloginM").style.display=""}Core.Events.addEvent($E("comment_anonyous"),function(){if($E("anonymity")&&$E("anonymity").checked&&Core.String.trim($E("comment_anonyous").value)=="新浪网友"){$E("comment_anonyous").value=""}},"focus");Core.Events.addEvent($E("comment_anonyous"),function(){if($E("anonymity")&&$E("anonymity").checked&&Core.String.trim($E("comment_anonyous").value)==""){$E("comment_anonyous").value="新浪网友"}},"blur");var i=new scope.bindEmailPanel;Core.Events.addEvent($E("login_name"),function(){i.hidden()},"focus");Core.Events.addEvent($E("login_name"),function(){var a=$E("login_name").value;if(!a)return;j(a)},"blur");function j(a){Utils.Io.JsLoad.request("http://login.sina.com.cn/bindmail/checkmailuser.php?entry=blog&name="+encodeURIComponent(a)+"&utf82gbk=1&callback=scope.$bindEmailTip",{noreturn:true})}scope.$bindEmailTip=function(a){if(a.ret=="y"||a.errcode=="not_verify"){var b=$E("login_name");i.showWithDom(b,-150,-55);$E("linkBindEmail").href="http://login.sina.com.cn/bindmail/signin.php?entry=blog&utf82gbk=1&username="+encodeURIComponent(b.value)}else{i.hidden()}};Core.Events.addEvent($E("closeBindEmail"),function(){i.hidden()});Core.Events.addEvent("postcommentid",function(){try{i.hidden()}catch(a){}});var k=function(){if($IE8){$E("comment_check_img").src="http://interface.blog.sina.com.cn/riaapi/checkwd_image_ie8.php?"+(new Date).valueOf()}else{$E("comment_check_img").src="http://interface.blog.sina.com.cn/riaapi/checkwd_image.php?"+(new Date).valueOf()}l("img")};function l(a){var b=a||"check";if(b=="img"){$E("comment_check_img").style.display="inline";$E("check_show").style.display="none"}else{$E("comment_check_img").style.display="none";$E("check_show").style.display=""}}d.articleid=scope.$articleid;d.onSuccess=function(){if(scope.commEditor){scope.commEditor.clearHTML("postCommentIframe")}var b=$E("cbCommentQuote");if(b&&b.checked){a.check($r_quote_bligid,$E("commentArea").value)}$E("commentArea").value="";$E("login_check").value="";if(m&&o){o.value=""}l()};d.onError=function(){k()};if($E("anonymity")){Core.Events.addEvent("anonymity",function(){var a=$E("commentNick");v7sendLog("32_01_17");var c=checkUserProduct.flag&&checkUserProduct.isinit||false;c&&$isLogin&&a&&(a.style.display="");if($E("anonymity").checked){d.anonyous=true;$E("commentlogin").style.display="none";$E("commentloginM").style.display="block";$E("cbCommentQuote")&&($E("cbCommentQuote").checked=false);a&&(a.innerHTML="你正以匿名身份发表评论:")}else{var e=Lib.blogv.getVHTML(scope.loginUserWtype);d.anonyous=false;$E("commentlogin").style.display=$isLogin?"none":"block";$E("commentloginM").style.display="none";if(c){a&&(a.innerHTML=(scope.$loginNick||scope.nickname)+"&nbsp;"+e+":")}else{b()}}$E("cbCommentQuote")&&($E("cbCommentQuote").disabled=$E("anonymity").checked);$E("quote_comment_p")&&($E("quote_comment_p").style.display=$E("anonymity").checked?"none":"")})}if($E("bb")){Core.Events.addEvent($E("bb"),function(){v7sendLog("32_01_18")})}if(!$E("postCommentIframe")){Core.Events.addEvent("commentArea",function(){if(c){return}$E("check_show").style.display="none";k();c=true},"focus")}Core.Events.addEvent("login_check",function(){if(c){return}$E("check_show").style.display="none";k();c=true},"focus");Core.Events.addEvent("check_show",function(){if(c){return}$E("check_show").style.display="none";k();c=true},"click");Core.Events.addEvent("comment_check_img",function(){k()},"mousedown");var m=/Mobile/i.test(navigator.userAgent),n=$E("mobileComment"),o=$E("mbCommentTa");if(m&&n){$E("commonComment").style.display="none";$E("faceWrap").style.display="none";n.style.display="";var p=$E("anonymity_cont");p&&(p.style.cssFloat="left")}var q=function(){if(Core.Events.getEvent()){var a=Core.Events.getEvent();if(a.type=="keydown"&&a.keyCode!=13){return}else if(a.type=="keydown"&&a.keyCode==13){if(scope.commEditor){scope.commEditor.handleChange("postCommentIframe")}}Core.Events.stopEvent()}if(!$isLogin&&$E("anonymity")&&$E("anonymity").checked==false){if(Core.String.trim($E("login_name").value)==""){showError($SYSMSG.B36107);return}else if(Core.String.trim($E("login_pass").value)==""){showError($SYSMSG.B36108);return}}if(m&&o){$E("commentArea").value=o.value}if($E("anonymity")&&$E("anonymity").checked==true&&Core.String.trim($E("comment_anonyous").value)==""){showError($SYSMSG.B36003)}else{if(Core.String.trim($E("commentArea").value)==""){showError($SYSMSG.B36105)}else if(Core.String.trim($E("login_check").value)==""){winDialog.alert($SYSMSG.B36106,{funcOk:function(){$E("login_check").value="";$E("login_check").focus()}})}else{var b={comment:$E("commentArea").value,login_name:$E("login_name").value,login_pass:$E("login_pass").value,check:$E("login_check").value,comment_anonyous:$E("comment_anonyous").value,anonymity:$E("anonymity")&&$E("anonymity").checked,is_mobile:+m,is_t:0};if($E("login_remember")){b.login_remember=$E("login_remember").checked;if(b.login_remember){Utils.Cookie.setCookie("LiRe",true,2400,"/",".blog.sina.com.cn")}else{Utils.Cookie.setCookie("LiRe","",2400,"/",".blog.sina.com.cn")}}if($E("bb")){if((!d.anonyous||!$E("anonymity"))&&$E("bb").checked){b.is_t=1;if(Utils.Cookie.getCookie("acp_bb")=="1"){Utils.Cookie.setCookie("acp_bb","",-1,"/",".blog.sina.com.cn")}}else{b.is_t=0;if(Utils.Cookie.getCookie("acp_bb")!="1"){Utils.Cookie.setCookie("acp_bb","1",2400,"/",".blog.sina.com.cn")}}}d.post(b);c=false}}};Core.Events.addEvent($E("commentArea"),function(){var a=Core.Events.getEvent();if(a.ctrlKey&&a.keyCode===13){q()}},"keydown");Core.Events.addEvent("postcommentid",function(){if(scope.commEditor){scope.commEditor.handleChange("postCommentIframe")}q()});Core.Events.addEvent($E("postcommentid").parentNode,function(){if(scope.commEditor){scope.commEditor.handleChange("postCommentIframe")}q()},"keydown");Core.Events.addEvent($E("login_check"),q,"keydown");if($E("smilesSortShow")==null){$E("commentArea").style.width="680px";var r=new CommentV2.insertSmile;r.show()}else{var s=[-325,40+($IE?-2:0)],t;if(scope.$pageid.indexOf("articletj")!==-1){t={sortCount:4,recommCount:6}}if($E("postCommentIframe")){var u={normal:{focus:function(){if(c){return}$E("check_show").style.display="none";k();c=true}}};App.formInsertSmile2("commentArea","smilesSortShow","smilesRecommended",null,"smilesSortShow",s,"postCommentIframe",u,t)}else{App.formInsertSmile("commentArea","smilesSortShow","smilesRecommended",null,"smilesSortShow",s,null,null,t)}}}});Core.Dom.getChildrenByClass=function(a,b){var c=[];var d=a.childNodes||a.children;var b=" "+b+" ";var e=d.length;for(var f=0;f<e;++f){var g=d[f];var h=" "+g.className+" ";if(h.indexOf(b)!=-1){c[c.length]=g}}return c};Lib.pkg("util");Lib.util.hoverJq=function(a){var b={elm:document.body,mouseenter:function(a,b,c){},mouseleave:function(a,b,c){},delay:0};a=Lib.apply(b,a);var c=$IE?"mouseenter":"mouseover",d=$IE?"mouseleave":"mouseout";if(!("length"in a.elm)){a.elm=[a.elm]}else{try{a.elm=Array.prototype.slice.call(a.elm,0)}catch(e){var f=[];for(var g=0,h=a.elm.length;g<h;g++){f.push(a.elm[g])}a.elm=f}}Core.Array.foreach(a.elm,function(b,e){Core.Events.removeEvent(b,c);Core.Events.removeEvent(b,d);Core.Events.addEvent(b,function(a,b,c){return function(d){d=d||window.event;if($IE){b.apply(a,[d,a,c])}else{i(d,"mouseenter",a,c)}}}(b,a[c],e),c);Core.Events.addEvent(b,function(a,b,c){return function(d){if($IE){b.apply(a,[d,a,c])}else{i(d,"mouseleave",a,c)}}}(b,a[d],e),d)});var i=function(b,c,d,e){var f=b.relatedTarget;try{if(f&&f!==document&&!f.parentNode){return}while(f&&f!==d){f=f.parentNode}if(f!==d){a[c].apply(d,[b,d,e])}}catch(g){}return false}};Lib.register("tray.tpl.loginMemu",function(){var a=['<div class="ntopbar_menu" id="#{panel}">','<div id="#{openBlog}" style="display:none;">','<span class="link" id="#{userMenu}"><a id="#{userNick}" onclick="v7sendLog(\'40_01_21\');return false;" href="###">读取中...</a><a href="javascript:;" class="link_arrow" title=""></a></span>','<span id="#{msnHolder}" class="ico_msn" style="display:none"><a id="#{msnLink}" href="http://control.blog.sina.com.cn/blogprofile/msnbind.php?c=" target="_blank"><img height="18" width="18" align="absmiddle" class="SG_icon SG_icon136" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif"></a></span>','<span class="line_s"></span>','<span class="link"><a onclick="v7sendLog(\'40_01_27\')" href="http://i.blog.sina.com.cn/blogprofile/index.php?com=1">个人中心</a></span>','<span class="line_s"></span>','<em id="#{newFeed}" class="mtip" style="left:341px;display:none;cursor:pointer;"></em>','<span class="link" id="#{blogMenu}"><a target="_blank" onclick="v7sendLog(\'40_01_24\')" href="http://control.blog.sina.com.cn/admin/article/article_add.php">发博文</a><a id="#{addArticle}" onclick="v7sendLog(\'40_01_25\');return false;" href="###" class="link_arrow"></a></span>','<span class="line_s"></span>','<span class="link"><a onclick="v7sendLog(\'40_01_28\')" target="_blank" href="http://wanwan.sina.com.cn/bloggame/">游戏</a></span>','<span class="line_s"></span>','<span class="link" id="#{trayMsg}" msg-panel-show-state="0"><a onclick="v7sendLog(\'40_01_30\');return false;" href="###">消息</a><a href="javascript:return false;" class="link_arrow" title=""></a></span>','<em id="#{newTips}" onclick="v7sendLog(\'40_01_29\')" class="mtip" style="left:341px;display:none;cursor:pointer;"></em>',"</div>",'<div id="#{noOpenBlog}" style="display:none;">','<span class="link"><a id="#{ssoNick}" onclick="v7sendLog(\'40_01_40\');return false;" href="###">读取中...</a></span>','<span class="line_s"></span>','<span class="link"><a id="#{ssoLoginOut}" onclick="v7sendLog(\'40_01_41\');return false;" href="###">退出</a></span>','<div class="ntopbar_login" style="float:left;"><a id="#{openBlogBtn}" onclick="v7sendLog(\'40_01_42\')" class="login" href="###"><span>立即拥有一个新博客</span></a></div>',"</div>","</div>"].join("");return a});Lib.register("tray.tpl.loginOutMemu",function(){var a=scope.$uid||"";var b="http://login.sina.com.cn/signup/signupmail.php?entry=blog&srcuid="+a+"&src=";if(scope.$channel==2){b+="baby"}else{b+="blogicp"}var c=['<div id="#{panel}" class="ntopbar_login">','<a class="login" onclick="v7sendLog(\'40_01_38\');return false;" href="###" action-type="tray-login-btn"><span>登录</span></a>','<a class="register" onclick="v7sendLog(\'40_01_39\')" target="_blank" href="',b,'">注册</a></div>'].join("");return c});Lib.register("tray.tpl.userMenu",function(){var a=['<div id="#{panel}" class="mUserMenu">',"<ul>","<li>",'<span class="tb_ps_nm"><a id="#{linkBlog}" onclick="v7sendLog(\'40_01_22\')" href="###"><img class="SG_icon SG_icon15" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" title="博客" align="absmiddle">博客</a></span>','<span class="rlink"><a target="_blank" onclick="v7sendLog(\'40_01_22\')" id="#{linkPostBlog}" href="http://control.blog.sina.com.cn/admin/article/article_add.php">发博文</a></span>',"</li>",'<li> <span class="tb_ps_nm"><a id="#{linkPhoto}" onclick="v7sendLog(\'40_01_22\')" href="###"><img class="SG_icon SG_icon18" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" title="相册" align="absmiddle">相册</a></span> <span class="rlink"><a target="_blank" id="#{linkPostPhoto}" onclick="v7sendLog(\'40_01_22\')" href="http://photo.blog.sina.com.cn/upload/upload.php">发图片</a></span> </li>','<li> <span class="tb_ps_nm"><a target="_blank" id="#{linkVBlog}" onclick="v7sendLog(\'40_01_22\')" href="###"><img class="SG_icon SG_icon16" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" title="播客" align="absmiddle">播客</a></span> <span class="rlink"><a target="_blank" id="#{linkUpload}" onclick="v7sendLog(\'40_01_22\')" href="http://vupload.you.video.sina.com.cn/u.php?m=1">发视频</a>&nbsp;&nbsp;<a id="#{linkRecord}" onclick="v7sendLog(\'40_01_22\')" href="http://vupload.you.video.sina.com.cn/r.php" target="_blank">录视频</a></span> </li>','<li> <span class="tb_ps_nm"><a id="#{miniblog}" onclick="v7sendLog(\'40_01_22\')" href="###" target="_blank"><img class="SG_icon SG_icon110" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="17" title="微博" align="absmiddle">微博</a></span> </li>','<li> <span class="tb_ps_nm"><a id="#{qingblog}" onclick="v7sendLog && v7sendLog(\'79_01_02\',scope.$pageid,\'qingLink\');" onclick="v7sendLog(\'40_01_22\')" href="###" target="_blank"><img class="SG_icon SG_icon205" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" title="Qing" align="absmiddle">Qing</a></span> </li>','<li style="display:none;" id="#{mail}"> <span class="tb_ps_nm"><a id="#{bindEmail}" target="_blank" href="http://mail.sina.com.cn/?s=2" onclick="v7sendLog(\'40_01_22\')"><img class="SG_icon SG_icon212" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="13" title="邮件" align="absmiddle">邮件</a></span> </li>','<li> <span class="tb_ps_nm"><a id="#{mySpace}" onclick="v7sendLog(\'40_01_22\')" href="###"><img class="SG_icon SG_icon41" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" title="关于我" align="absmiddle">关于我</a></span> </li>',"</ul>",'<div class="links">','<p><a target="_blank" id="#{linkChangeFace}" onclick="v7sendLog(\'40_01_22\')" href="###">修改头像昵称&gt;&gt;</a></p>','<p><a target="_blank" id="#{linkChangePassword}" onclick="v7sendLog(\'40_01_22\')" href="###">修改登录密码&gt;&gt;</a></p>','<p><a target="_blank" id="#{linkAccountSetup}" onclick="v7sendLog(\'40_01_22\')" href="###">帐号安全设置&gt;&gt;</a></p>','<p><a id="#{loginOut}" onclick="v7sendLog(\'40_01_23\');return false;" href="#">退出&gt;&gt;</a></p>',"</div>","</div>"].join("");return a});Lib.register("tray.loginOut",function(a){var b=a.Listener;return function(a,c){var d=encodeURIComponent(window.location.href);(new Interface("http://control.blog.sina.com.cn/blog_rebuild/msn/api/msnLoginOut.php","jsload")).request({onSuccess:function(e){b.notify("global-login-out",e);a&&a(e);if(c){window.location.href="http://login.sina.com.cn/cgi/login/logout.php?r="+d}},onError:function(a){b.notify("global-login-out",a);if(c){window.location.href="http://login.sina.com.cn/cgi/login/logout.php?r="+d}},onFail:function(a){b.notify("global-login-out",a);if(c){window.location.href="http://login.sina.com.cn/cgi/login/logout.php?r="+d}}})}});Lib.register("tray.UserMenuPanel",function(a){var b=Core.Class.define(function(){a.Panel.prototype.initialize.apply(this,arguments);this.setTemplate(a.tray.tpl.userMenu)},a.Panel,{initUserInfo:function(a){var b=this.getNodes();b["linkBlog"].href="http://blog.sina.com.cn/u/"+a;b["linkPhoto"].href="http://photo.blog.sina.com.cn/u/"+a;b["linkVBlog"].href="http://you.video.sina.com.cn/m/"+a;b["miniblog"].href="http://control.blog.sina.com.cn/t_sina_blog/tb.php?uname="+a;b["qingblog"].href="http://qing.weibo.com/fancy.html";b["mySpace"].href="http://blog.sina.com.cn/s/profile_"+a+".html";b["linkChangeFace"].href="http://control.blog.sina.com.cn/blogprofile/nick.php";b["linkChangePassword"].href="http://login.sina.com.cn/member/security/password.php";b["linkAccountSetup"].href="http://login.sina.com.cn/member/security.php";this.initLoginOut(b["loginOut"])},initLoginOut:function(b){b.onclick=function(){return false};Core.Events.addEvent(b,function(){a.tray.loginOut(null,!0)})}});return b});Lib.register("tray.tpl.blogMenu",function(){var a=['<div id="#{panel}" class="wrtBlog_sub">','<div class="wrtBlog_sub3">','<p><a target="_blank" onclick="v7sendLog(\'40_01_26\')" href="http://control.blog.sina.com.cn/admin/article/article_add.php?tag365">写365</a></p>','<p><a target="_blank" onclick="v7sendLog(\'40_01_26\')" href="http://control.blog.sina.com.cn/admin/article/changWeiBo.php">长微博</a></p>','<p><a target="_blank" onclick="v7sendLog(\'40_01_26\')" href="http://control.blog.sina.com.cn/weiyulu/weiyulu.php">微语录</a></p>','<p><a target="_blank" onclick="v7sendLog(\'40_01_26\')" href="http://control.blog.sina.com.cn/admin/article/daily.php">九宫格</a></p>','<p><a target="_blank" onclick="v7sendLog(\'40_01_26\')" href="http://photo.blog.sina.com.cn/upload/upload.php">发照片</a></p>','<p><a target="_blank" onclick="v7sendLog(\'40_01_26\')" href="http://vupload.you.video.sina.com.cn/u.php?m=1">发视频</a></p>',"</div>","</div>"].join("");return a});Lib.register("tray.BlogMenuPanel",function(a){var b=Core.Class.define(function(){a.Panel.prototype.initialize.apply(this,arguments);this.setTemplate(a.tray.tpl.blogMenu)},a.Panel,{});return b});Lib.register("tray.tpl.searchForm",function(){var a=['<div class="ntopbar_input" id="#{panel}">','<form id="#{searchForm}" method="get" target="_blank" action="http://search.sina.com.cn">','<input id="#{queryTxt}" class="ntopbar_txt" type="text" name="q" autocomplete="off"/>','<input id="#{submit}" type="submit" onclick="v7sendLog(\'40_01_44\')" class="ntopbar_searchBtn" value=""/>','<input type="hidden" name="ie" value="utf-8"/>','<input type="hidden" name="e" value="utf-8"/>','<input id="#{range}" type="hidden" name="range" value="article"/>','<input id="#{t}" type="hidden" name="t" value=""/>','<input id="#{s}" type="hidden" name="s" value="sup"/>','<input id="#{by}" type="hidden" name="by" value="all"/>','<input id="#{type}" type="hidden" name="type" value=""/>','<input id="#{stype}" type="hidden" name="stype" value="1"/>','<input id="#{c}" type="hidden" name="c" value="blog"/>',"</form>","</div>"].join("");return a});Core.Dom.addClass=function(a,b){var c=Core.String.trim;b=c(b);if(!b){return a}a=$E(a);var d=c(a.className||"");var e=" "+d+" ";if(!d){a.className=c(b);return a}var f=b.split(" ");var g,h=[];for(var i=0;i<f.length;i++){g=f[i];if(g&&-1===e.indexOf(" "+g+" ")){h.push(g)}}a.className=d+" "+h.join(" ");return a};Core.Dom.removeClass=function(a,b){a=$E(a);a.className=a.className.replace(new RegExp("\\s*\\b"+b+"\\b"),"")};Lib.util.getActionData=function(a,b,c,d){if(!b){throw"[Lib.util.getActionData] param actionType is undefined!"}a=a||window.event;var e=Core.Events.getEventTarget,f,g,h,i,j,k,c=c||"action-type",d=d||"action-data";f=e(a);g=a.currentTarget||document.documentElement||document.body;while(f&&f!=g){h=f.getAttribute(c)||"";i=h.split(",");for(var l=0,m=i.length;l<m;l++){j=i[l];if(b===j){k=f.getAttribute(d);return{actionType:b,targetEl:f,data:k}}}f=f.parentNode}return null};Lib.register("tray.tpl.cateSearch",function(){var a=['<div id="#{panel}" class="mCatSearch">',"<ul>",'<li action-type="tray-search" onclick="v7sendLog(\'40_01_43\')" action-data="article" class="current">含“<span id="#{article}"></span>”的博文</li>','<li action-type="tray-search" onclick="v7sendLog(\'40_01_43\')" action-data="bloger">含“<span id="#{bloger}"></span>”的博主</li>','<li action-type="tray-search" onclick="v7sendLog(\'40_01_43\')" action-data="music">含“<span id="#{music}"></span>”的音乐</li>','<li action-type="tray-search" onclick="v7sendLog(\'40_01_43\')" action-data="video">含“<span id="#{video}"></span>”的视频</li>',"</ul>","</div>"].join("");return a});Lib.register("tray.CateSearchPanel",function(a){var b=Core.Events.addEvent;var c=Core.String.leftB;var d=Core.String.byteLength;var e=Core.Class.define(function(){a.Panel.prototype.initialize.apply(this,arguments);this.setTemplate(a.tray.tpl.cateSearch);this.initEvt()},a.Panel,{initEvt:function(){var c=this.getNodes();var d=$T(c["panel"],"li");a.util.hoverJq({elm:d,mouseenter:function(a,b,c){Core.Dom.addClass(b,"current")},mouseleave:function(a,b,c){Core.Dom.removeClass(b,"current")},delay:50});b(c["panel"],function(b){b=b||window.event;var c=a.util.getActionData(b,"tray-search");if(c){a.Listener.notify("tray-categroy-search",c.data)}})},updateSearch:function(a){if(5<d(a)){a=c(a,4)+"..."}var b=a.replace(/(<|>)/g,function(a){if("<"===a){return"&lt;"}else{return"&gt;"}});var e=this.getNodes();e["article"].innerHTML=b;e["bloger"].innerHTML=b;e["music"].innerHTML=b;e["video"].innerHTML=b}});return e});Lib.register("tray.SearchFormPanel",function(a){var b=Core.Events.addEvent;var c=Core.String.trim;var d=Core.Class.define(function(b){a.Panel.prototype.initialize.apply(this,arguments);this.setTemplate(a.tray.tpl.searchForm);this.initEvt();this.catePanel=new a.tray.CateSearchPanel;this.catePanel.entity.style.zIndex=512;a.Listener.on({name:"tray-categroy-search",callBack:this.search,scope:this})},a.Panel,{initEvt:function(){var a=this;var c=this.getNode("queryTxt");b(c,function(b){b=b||window.event;var c=b.target||b.srcElement;var d=c.offsetWidth;a.showCateSearch(c,d,c.value)},"input");b(c,function(b){console.log(b);b=b||window.event;if("value"!==b.propertyName){return}var c=b.target||b.srcElement;var d=c.offsetWidth;a.showCateSearch(c,d,c.value)},"propertychange");b(c,function(b){b=b||window.event;var c=b.target||b.srcElement;var d=c.offsetWidth;a.showCateSearch(c,d,c.value)},"focus");b(this.getNode("searchForm"),function(b){b=b||window.event;var c=b.target||b.srcElement;if(!a.checkValidate(c)){Core.Events.stopEvent(b)}else{setTimeout(function(){a.hideCateSearch();a.resetForm()},100)}},"submit");b(window,function(){if(a.catePanel.isShow){var b=c.offsetWidth;a.catePanel.showWithDom(c,-b,4)}},"resize")},checkValidate:function(a){if("q"in a&&!c(a["q"].value))return false;else if("k"in a&&!c(a["k"].value))return false;else return true},setForm:function(b,c){var d={queryTxt:"q",ie:"utf-8",range:"",t:"",s:"",by:"",type:"",stype:"",e:"utf-8",c:""};var e=this.getNode("searchForm");e.action=b;a.apply(d,c);var f=this.getNode("queryTxt");f.name=d["queryTxt"];delete d["queryTxt"];var g,h;for(var i in d){g=d[i];if(typeof g==="string"&&(h=this.getNode(i))){h.value=g}}},resetForm:function(){this.setForm("http://search.sina.com.cn",{queryTxt:"q",range:"article",s:"sup",by:"all",stype:"1",c:"blog"})},search:function(a){var b=this.getNode("searchForm");var c="http://search.sina.com.cn";var d="http://video.sina.com.cn/search/index.php";var e="http://music.sina.com.cn/yueku/search/s.php";switch(a){case"video":this.setForm(d,{queryTxt:"k",s:"sup",type:"boke",stype:"1"});break;case"bloger":this.setForm(c,{queryTxt:"q",range:"author",s:"sup",by:"all",stype:"1",c:"blog"});break;case"music":this.setForm(e,{queryTxt:"k",t:"song"});break;default:this.setForm(c,{queryTxt:"q",range:"article",s:"sup",by:"all",stype:"1",c:"blog"})}if($IE){this.getNode("submit").click()}else{Core.Events.fireEvent(this.getNode("submit"),"click")}},showCateSearch:function(a,b,c){var d=this.catePanel;if(c&&d.isHidden){d.showWithDom(a,-b,4)}else if(!c){this.hideCateSearch()}d.updateSearch(c)},hideCateSearch:function(){var a=this.catePanel;a.hide();a.updateSearch("")}});return d});Lib.register("tray.loadUserInfo",function(a){var b=a.util.LS;var c=a.util.JSON;var d=function(d,e){var f="http://interface.blog.sina.com.cn/riaapi/profile/getNickName.php";Utils.Io.JsLoad.request(f,{GET:{uid:d},onComplete:function(f){if(f&&"A00006"===f.code){var g=f.data.nickname;var h={time:(new Date).getTime()/1e3};a.apply(h,f.data);b.setItem("uid"+d,c.stringify(h));e(h)}},onException:function(){},timeout:1e4})};return function(a,e,f){var g=b.getItem("uid"+a);if(!f&&g){g=c.parse(g);var h=(new Date).getTime()/1e3;var i=h-g.time;if(i<4*60&&g.nickname){e(g);return}}d(a,e)}});Lib.register("tray.MsgLoader",function(a){var b=function(a){var b=$C("div");a.write(b);document.body.appendChild(b)};var c="",d;if(window.$Maxthon||window.$360||window.$TT){c="?t="+Core.Math.getUniqueId()}var e=function(e){a.apply(this,e);if(!d){try{var f=new Utils.Flash.swfObject($_GLOBAL.flashBasicURL+"blogMessageReminding.swf"+c,"__msgTipsPlayer","1px","1px","9","#00ff00");f.addParam("quality","high");f.addParam("wmode","transparent");f.addParam("allowScriptAccess","always");f.addParam("freeTime",27*1e3);if("complete"===document.readyState){b(f);d=$E("__msgTipsPlayer")}else{_addEvt(window,function(){b(f);d=$E("__msgTipsPlayer")},"load")}}catch(g){}}}.$define({time:30,url:"http://comet.blog.sina.com.cn/notice",getFlaDom:function(){return d},play:function(){if($_GLOBAL.msgPlaySound&&d&&d.PlaySound){try{d.PlaySound()}catch(a){}}},load:function(b,c){var d=this;var e=scope.$articleid||"";if(!b){return}Utils.Io.JsLoad.request(this.url,{GET:{uid:b||"",blogid:e},onComplete:function(c){if(c&&"A00006"==c.code){var d,f;if(b&&(d=c.data[b])){var g={};g.sum=0;for(var h in d){g[h]=d[h];g.sum+=d[h]}g.blogrecomment=g.blogrecomment?g.blogrecomment:0;a.Listener.notify("tray-newmsg-loaded",g)}if(e&&(f=c.data[e])){a.Listener.notify("article-msg-loaded",f)}}},onException:function(){},timeout:1e4})}});return e});Lib.register("tray.tpl.notice",function(){var a=['<div id="#{panel}" class="horn">','<div id="#{tj}" class="horn_con" style="display:none;">推荐：<a id="#{noticeAd1}" target="_blank" href="#"></a><a id="#{noticeAd2}" target="_blank" href="#"></a></div>','<div id="#{announce}" class="horn_con" style="display:none;"><p id="#{announceCon}">公告：<em>请您及时更换请请请您正在使用的模版将于2周后被下线，请您及时更换</em></p></div>','<a class="close" title="关闭" id="#{close}" style="float:none;">×</a>',"</div>"].join("");return a});Lib.register("tray.BlogNotice",function(a){var b=Core.Events.addEvent,c=Utils.Cookie.setCookie,d=scope.$pageid;var e=Core.Class.define(function(){a.Panel.prototype.initialize.apply(this,arguments);this.setTemplate(a.tray.tpl.notice);this.initEvt()},a.Panel,{initEvt:function(){var d=this;b(this.getNode("close"),function(b){b=b||window.event;c("closeNotice_fzp",$UID,24,"/",".blog.sina.com.cn");a.Listener.notify("tray-announce-close",{});d.destroy()})},update:function(a){var b=this.getNode("tj"),c=this.getNode("announce");var e="";var f=["SLOT_58","SLOT_59","SLOT_98","SLOT_99","SLOT_100","SLOT_101","SLOT_102"];var g="http://interface.blog.sina.com.cn/riaapi/pageslot/pageslot.php";var h={id:f};if(typeof scope!="undefined"){h.blogeruid=scope.$uid}if($UID){h.loginuid=$UID}if($isLogin&&a.announce.result&&(d==="indexM"||d==="articleM"||d==="articlelistM")){c.innerHTML=a.announce.announce_con;c.style.display=""}else{var i=this.getNode("noticeAd1");var j=this.getNode("noticeAd2");var k=function(a){var c=0;var d=a[f[0]].res;var e=a[f[1]].res;if(d||e){if(d){c=0;if(d.length>1){c=Math.floor((d.length+1)*Math.random())}i.innerHTML=d[c].words;i.href=d[c].a_href;i.title=d[c].a_title;i.setAttribute("suda-uatrack",d[c].a_c_suda.replace("suda-uatrack=","").replace('"',"").replace('"',""));if(typeof SUDA!=="undefined"){SUDA.uaTrack(d[c].a_v_suda_key,d[c].a_v_suda_value)}}if(e){c=0;if(e.length>1){c=Math.floor((e.length+1)*Math.random())}j.innerHTML=e[c].words;j.href=e[c].a_href;j.title=e[c].a_title;j.setAttribute("suda-uatrack",e[c].a_c_suda.replace("suda-uatrack=","").replace('"',"").replace('"',""));if(typeof SUDA!=="undefined"){SUDA.uaTrack(e[c].a_v_suda_key,e[c].a_v_suda_value)}}b.style.display=""}};if(scope.__subscribeSlot==="waitting"){scope.__subscribeSlotFunc=k}else if(typeof scope.__subscribeSlot==="object"){k(scope.__subscribeSlot)}else{scope.__subscribeSlot="waitting";Utils.Io.JsLoad.request(g,{GET:h,onComplete:function(a){k(a);scope.__subscribeSlot=a;if("function"==typeof scope.__subscribeSlotFunc){scope.__subscribeSlotFunc(a)}},onException:function(){}})}}},setTemplate:function(a){this.template=a;var b=new Lib.HtmlTemplate(this.template,this.uniqueID);this.tpl=b;Core.Dom.insertHTML($E(this.appendTo),b.getHtmlString(),"afterbegin");this.entity=$E("_"+this.uniqueID+"_panel");this.entity.style.display="none";tempEntity=null}});return e});Lib.register("tray.unReadMsgPanel",function(a){var b=Core.Class.define(function(b){a.Panel.prototype.initialize();if(scope.$pageid=="editor"){return}this._lockstate=0;this._scrolling=0;this._srcPot=b;var c=['<div class="cor"></div>','<div class="bd">','<a href="#" id="j-unread-msg-close" class="close" title="关闭">×</a>','<ul id="j-unre-list">',"</ul>","</div>"].join("");this.setTemplate('<div class="messageTips" id="#{panel}" style="left:850px; top:10px;">'+c+"</div>");this.entity.style.zIndex=500;this._bindEvent()},a.Panel,{show:function(){if(this.isShow){return}v7sendLog("40_02_01");this.entity.style.display="";this._srcPot&&this._srcPot.setAttribute("unread-show-state",1);this.isHidden=!1;this.isShow=!0;if(this.backIframe){this._updateBackIframe();this.backIframe.style.display=""}a.Listener.notify("tray-unread-panel-show",{})},hide:function(){a.Panel.prototype.hide.call(this);this._srcPot&&this._srcPot.setAttribute("unread-show-state",0);a.Listener.notify("tray-unread-panel-hide",{})},_updatePanelIframe:function(){if(this.backIframe){this._updateBackIframe()}},_updateCont:function(a){var b=[];if(a.comment+a.message+a.notice+a.gbook==0){this.hide();return}if(a.comment>0){b.push("<li>"+a.comment+'条新评论，<a onclick="v7sendLog(\'40_02_02\')" href="http://i.blog.sina.com.cn/blogprofile/profilecommlist.php?type=1">查看评论</a></li>')}if(a.message>0){b.push("<li>"+a.message+'条新纸条，<a onclick="v7sendLog(\'40_02_03\')" href="http://control.blog.sina.com.cn/blogprofile/profilepaperlist.php?type=1">查看纸条</a></li>')}if(a.gbook>0){b.push("<li>"+a.gbook+'条新留言，<a onclick="v7sendLog(\'40_02_04\')" href="http://i.blog.sina.com.cn/blogprofile/wall.php">查看留言</a></li>')}if(a.notice>0){var c={notice:"http://control.blog.sina.com.cn/blog_rebuild/profile/controllers/notelist.php?action=profilesysnote",like:"http://i.blog.sina.com.cn/profilelist/profilelikelist.php",notice_favourite:"http://i.blog.sina.com.cn/blog_rebuild/profile/controllers/notelist.php?action=profilenotice",notice_quote:"http://i.blog.sina.com.cn/blog_rebuild/profile/controllers/notelist.php?action=profilenotice",invite:"http://control.blog.sina.com.cn/blogprofile/profileinvitelist.php",unreadnotices:"http://i.blog.sina.com.cn/blog_rebuild/profile/controllers/notelist.php?action=profilenotice"};var d=c.notice;for(var e in a.notices){if(a.notices[e]>0){d=c[e];break}}b.push("<li>"+a.notice+'条新通知，<a onclick="v7sendLog(\'40_02_05\')" href="'+d+'">查看通知</a></li>')}$E("j-unre-list").innerHTML=b.join("");this.show();this._setThePos()},_setThePos:function(){var a=Core.Dom.getXY(this._srcPot);var b=this._srcPot.className=="link"?-2:0;var c=$IE7||$IE6?this.entity.offsetWidth:this.entity.clientWidth;if(a[0]){var d=a[0]+this._srcPot.clientWidth-c+b;var e=0;if(this._srcPot.getAttribute("adshow")==1&&this._scrolling==0){e=a[1]}var f=this._srcPot.clientHeight+e+10;this.setPosition(d,f)}},_bindEvent:function(){var a=this;Lib.Listener.on({name:"tray-newmsg-loaded",callBack:function(b){if(a._lockstate){return}a._eventHandle(b);a._setThePos()}});Lib.Listener.on({name:"tray-scrolling-fix",callBack:function(b){a._scrolling=1;if(a._lockstate){return}a.setFixed(1);a._setThePos()}});Lib.Listener.on({name:"tray-scrolling-nofix",callBack:function(b){a._scrolling=0;if(a._lockstate){return}a.setFixed(0);a._setThePos()}});Lib.Listener.on({name:"topad680-show-end",callBack:function(b){a._srcPot.setAttribute("adshow",1);if(a.isShow){a._setThePos()}}});Core.Events.addEvent($E("j-unread-msg-close"),function(b){var c=b||window.event;if(c.preventDefault){c.preventDefault()}else{c.returnValue=false}a.hide();a._lockstate=1},"click");Core.Events.addEvent(window,function(){if(a.isShow){a._setThePos()}},"resize")},_eventHandle:function(a){var b={};b.comment=a.blogcomment-0+(a.photocomment-0)+a.blogrecomment;b.notice=a.notice+a.like+a.notice_favourite+a.notice_quote+a.invite+a.unreadnotices;b.notices={notice:a.notice,like:a.like,notice_favourite:a.notice_favourite,notice_quote:a.notice_quote,invite:a.invite,unreadnotices:a.unreadnotices};b.message=a.message;b.gbook=a.gbook;this._updateCont(b)}});return b});Lib.register("tray.msgSummaryPanel",function(a){var b=a.util.JSON;var c=['<li><a onclick="v7sendLog(\'40_02_12\')" href="http://i.blog.sina.com.cn/blogprofile/profilecommlist.php?type=1"><span class="icoms_comment"></span>查看评论</a></li>','<li><a onclick="v7sendLog(\'40_02_13\')" href="http://control.blog.sina.com.cn/blogprofile/profilepaperlist.php?type=1"><span class="icoms_tips"></span>查看纸条</a></li>','<li><a onclick="v7sendLog(\'40_02_14\')" href="http://i.blog.sina.com.cn/blogprofile/wall.php"><span class="icoms_message"></span>查看留言</a></li>','<li><a onclick="v7sendLog(\'40_02_15\')" href="http://i.blog.sina.com.cn/blog_rebuild/profile/controllers/notelist.php?action=profilenotice"><span class="icoms_notice"></span>查看通知</a></li>'];var d=Core.Class.define(function(b){a.Panel.prototype.initialize();this._srcPot=b;this._lock=1;this._scrolling=0;this._requirestate=1;this._nums={};var d=['<div class="bd">','<ul id="j-summary-list">',c.join(""),"</ul>","</div>"].join("");this.setTemplate('<div class="messageBox" id="#{panel}">'+d+"</div>");this.entity.style.zIndex=500;this._bindEvent();this._initNums()},a.Panel,{show:function(){var a=this;if(this._checkNumChange()){this._updateCont()}else{this._showAction()}},_showAction:function(){if(this.isHidden){this._srcPot&&this._srcPot.setAttribute("msg-panel-show-state",1);this.entity.style.display="";this.isHidden=!1;this.isShow=!0;if(this.backIframe){this._updateBackIframe();this.backIframe.style.display=""}this._setThePos()}else{this._setThePos()}},_checkNumChange:function(){var a=this._srcPot.getAttribute("msg-count");var b=this._srcPot.getAttribute("old-msg-count");if(a==b){return false}else{return true}},hide:function(){a.Panel.prototype.hide.call(this);this._srcPot&&this._srcPot.setAttribute("msg-panel-show-state",0);a.Listener.notify("tray-msg-panel-hide",{})},_initNums:function(){var a=b.parse(this._srcPot.getAttribute("msg-count"));this._formatData(a)},_setThePos:function(){if($IE6||$IE7||$IE8){this.entity.style.width="auto"}var a=Core.Dom.getXY(this._srcPot);var b=this._srcPot.className=="link"?-2:0;var c=$IE7||$IE6?this.entity.offsetWidth:this.entity.clientWidth;var d=a[0]+this._srcPot.clientWidth-c+b;var e=0;if(this._srcPot.getAttribute("adshow")==1&&this._scrolling==0){if($IE6||$IE7||$IE8){e=a[1]-2}else{e=a[1]}}var f=this._srcPot.clientHeight+e+1;if($IE6||$IE7||$IE8){this.entity.style.width=this.entity.clientWidth+1+"px";this.entity.style.width=this.entity.clientWidth-1+"px"}this.setPosition(d,f)},_updatePanelIframe:function(){if(this.backIframe){this._updateBackIframe()}},_updateCont:function(a){var b=[];var c=this;this._lock=0;if(this._requirestate){this._getDate({},function(a){b.push(c._getComment(a));b.push(c._getMessage(a));b.push(c._getGbook(a));b.push(c._getNotice(a));$E("j-summary-list").innerHTML=b.join("");c._srcPot.setAttribute("old-msg-count",c._srcPot.getAttribute("msg-count"));if($IE6){$E("j-summary-list").style.width="270px"}c._showAction()},function(a){});this._requirestate=0}},_getDate:function(a,b,c){b=b||function(){};c=c||function(){};var d=this;Lib.checkAuthor();var e=new Interface("http://control.blog.sina.com.cn/blog_rebuild/riaapi/profile/note/notelist.php","jsload");e.request({GET:{uid:$UID},onSuccess:function(a){b(a)}.bind2(this),onError:function(a){c({num:0})}.bind2(this),onFail:function(){c({num:0})}.bind2(this)})},_getUserPicUrl:function(a,b){var b=b||50;var c=parseInt(a)%8+1;return"http://portrait"+c+".sinaimg.cn/"+a+"/blog/"+b},getLen:function(a){if(!a){return 0}var b=a.match(/[^\x00-\xff]/g);return a.length+(b?b.length:0)},strTruncate:function(a,b,c){a=a||"";if(typeof c=="undefined"){c="..."}return this.getLen(a)>b?this.truncete(a,b)+c:a},truncete:function(a,b){var c=a.replace(/\*/g," ").replace(/[^\x00-\xff]/g,"**");a=a.slice(0,c.slice(0,b).replace(/\*\*/g," ").replace(/\*/g,"").length);this.getLen(a)>b&&b>0&&(a=a.slice(0,a.length-1));return a},getVipIcon:function(a){if(!a){return""}var b={1:{icon:"SG_icon146",info:"新浪个人认证"},2:{icon:"SG_icon147",info:"新浪机构认证"}};var a=a||1;var c='<img class="SG_icon '+b[a].icon+'" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="13" title="'+b[a].info+'" alt="'+b[a].info+'" align="absmiddle" />';return c},_setNameforIE6:function(a){if($IE6){return this.strTruncate(a,4)}else{return a}},_getComment:function(a){var b="";if(this._nums._comment>0){var d=a.msg.cms;if(d.length>0){var e={1:"评论了你的博文",2:"评论了你的图片",6:"回复了你的评论"};var f={1:"http://i.blog.sina.com.cn/blogprofile/profilecommlist.php?type=1",2:"http://i.blog.sina.com.cn/blogprofile/profilecommlist.php?type=2",6:"http://i.blog.sina.com.cn/blogprofile/profilereplylist.php"};var g=[];for(var h=0,i=d.length;h<i;h++){var j=d[h];var k=j.nick_name||j.name;k=this._setNameforIE6(k);var l=this._getUserPicUrl(j.uid,30);var m=j.msg_type;g.push(m);var n=j.user_type||0;var o=j.time;b+='<li><a onclick="v7sendLog(\'40_02_06\')" href="'+f[m]+'"><img src="'+l+'"><em class="nl">'+k+"</em>"+this.getVipIcon(n)+'<em class="tm">'+o+"</em>"+e[m]+"</a></li>"}g.sort();if(this._nums._comment>3){b+='<li class="lcount"><a onclick="v7sendLog(\'40_02_07\')" href="'+f[g[0]]+'">总共'+this._nums._comment+"条新评论</a></li>"}else{}}else{b=c[0]}}else{b=c[0]}return b},_getMessage:function(a){var b="";if(this._nums._message>0){var d=a.msg.note[0];var e=d.name||d.nick_name;e=this._setNameforIE6(e);var f=this._nums._message>1?"等"+this._nums._message+"人":"";var g=d.user_type||0;b+='<li class="bgc"><a onclick="v7sendLog(\'40_02_08\')" href="http://control.blog.sina.com.cn/blogprofile/profilepaperlist.php?type=1"><span class="icoms_tips"></span><em class="nl">'+e+"</em>"+this.getVipIcon(g)+f+'发来纸条<em class="nr">查看纸条</em></a></li>'}else{b=c[1]}return b},_getGbook:function(a){var b="";if(this._nums._gbook>0){var d=a.msg.note[1];var e=d.name||d.nick_name;if(e){e=this._setNameforIE6(e);var f=this._nums._gbook>1?"等"+this._nums._gbook+"人":"给你";var g=d.user_type||0;b+='<li class="bgc"><a onclick="v7sendLog(\'40_02_09\')" href="http://i.blog.sina.com.cn/blogprofile/wall.php"><span class="icoms_message"></span><em class="nl">'+e+"</em>"+this.getVipIcon(g)+f+'留言<em class="nr">查看留言</em></a></li>'}}else{b=c[2]}return b},_getNotice:function(a){var b="";var d="http://i.blog.sina.com.cn/blog_rebuild/profile/controllers/notelist.php?action=profilenotice";var e="http://control.blog.sina.com.cn/blog_rebuild/profile/controllers/notelist.php?action=profilesysnote";var f={3:"http://control.blog.sina.com.cn/blogprofile/profileinvitelist.php",7:d,8:d,9:d,23:d,13:"http://i.blog.sina.com.cn/profilelist/profilelikelist.php",100:e,101:e,102:e,103:e,104:e,105:e,106:e,107:e,108:e,109:e,110:e,111:e,112:e};if(this._nums._notice>0){var g=a.msg.note[2];var h=g.msg_type;b+='<li class="bgc last"><a onclick="v7sendLog(\'40_02_10\')" href="'+f[h]+'"><span class="icoms_notice"></span>'+this._nums._notice+'条新通知<em class="nr">查看通知</em></a></li>'}else{b=c[3]}return b},_bindEvent:function(){var a=this;Lib.Listener.on({name:"tray-newmsg-loaded",callBack:function(b){a._requirestate=1;a._eventHandle(b)}});Lib.Listener.on({name:"tray-scrolling-nofix",callBack:function(b){a._scrolling=0;if(a._lockstate){return}a.setFixed(0);a._setThePos()}});Lib.Listener.on({name:"tray-scrolling-fix",callBack:function(b){a._scrolling=1;if(a._lockstate){return}a.setFixed(1);a._setThePos()}});Lib.Listener.on({name:"topad680-show-end",callBack:function(b){if(a.isShow){a._setThePos()}}})},_eventHandle:function(a){this._formatData(a);if(this.isShow){this._updateCont()}},_formatData:function(a){var b={};b._comment=a.blogcomment-0+(a.photocomment-0)+a.blogrecomment;b._notice=a.notice+a.like+a.notice_favourite+a.notice_quote+a.invite+a.unreadnotices;b._message=a.message;b._gbook=a.gbook;this._cacheNums(a,b)},_cacheNums:function(a,b){for(var c in a){this._nums[c]=a[c]}for(var d in b){this._nums[d]=b[d]}}});return d});Lib.register("TrayPanel",function(a){var b=Core.Events.addEvent;var c=Core.Events.removeEvent;var d=Utils.Cookie.getCookie;var e=Core.Dom.contains;var f=a.util.JSON;var g=Core.Dom.getChildrenByClass;var h="login_bar_logo_link_350";var i="______noticeTrayHolder";var j=0;var k=null;var l=!1;var m=0;var n=function(a,b,c){if(typeof c!=="string"){return a.getAttribute(b)}else{a.setAttribute(b,c)}};var o=Core.Class.define(function(){var b=g(document.body,"nsinatopbar")[0];var c=this.$main=g(b,"ntopbar_main")[0];a.Panel.prototype.initialize.call(this,{appendTo:c,isPostion:!1,noIframe:!0});a.Listener.on({name:"tray-data-loaded",callBack:this.showPublishWare,scope:this},{name:"tray-newmsg-loaded",callBack:this.showNewMsgTips,scope:this},{name:"global-login-out",callBack:function(){clearInterval(this._msgTimer)},scope:this},{name:"tray-announce-loaed",callBack:function(a){var b=arguments;var c=this;if(this.notice){this.notice.update(a);return}setTimeout(function(){b.callee.call(c,a)},200)},scope:this},{name:"tray-unread-panel-hide",callBack:function(){var a=this.getNode("trayMsg");var b=f.parse(a.getAttribute("msg-count"));this.showNewMsgTips(b,1)},scope:this},{name:"tray-unread-panel-show",callBack:function(){var a=this.getNode("newTips");a.style.display="none"},scope:this},{name:"tray-msg-panel-hide",callBack:function(){var a=this.getNode("trayMsg");var b=f.parse(a.getAttribute("msg-count"));this.showNewMsgTips(b,1)},scope:this},{name:"tray-announce-close",callBack:function(a){this.setTrayPosition()},scope:this},{name:"topad680-show-start",callBack:function(a){this._hideActiveSub()},scope:this});if(j){j++}},a.Panel,{subPanels:[],hoverTimeout:"",hoverTime:400,load:function(b){if(!j){var c=$E(h);if(c&&$_GLOBAL&&$_GLOBAL.platformTrayLogo){if(!$IE6&&$_GLOBAL.platformTrayLogo.imgForOtherBrs){c.children[0].src=$_GLOBAL.platformTrayLogo.imgForOtherBrs}else if($_GLOBAL.platformTrayLogo.imgForIE6){c.children[0].src=$_GLOBAL.platformTrayLogo.imgForIE6}}this.initSearch()}switch(b){case"login":if(/ipad/i.test(navigator.userAgent)){v7sendLog("48_01_02")}var d=new Date;var e=this;a.tray.loadUserInfo($UID,function(b){scope.unreadMsg=b;scope.nickname=b["full_nickname"];scope.loginUserWtype=b["login_wtype"];if(!e._isRenderUser){e.renderRight(a.tray.tpl.loginMemu);e._isRenderUser=!0}var c,d,f;if(b.isbloguser){var g=e.getNode("noOpenBlog");g.style.display="none";e.initUserMenu();e.initBlogMenu(b);e.initNewMsgEvt();e.initMsg();e.initMsgLoder();e.initHideSub();e.initunReadMsgPanel();c=e.getNode("userNick");d=e.getNode("openBlog")}else{c=e.getNode("ssoNick");c.href="http://control.blog.sina.com.cn/myblog/htmlsource/blog_notopen.php?uid="+$UID+"&version=7";e.initOpenBlog();e.initLogout();d=e.getNode("noOpenBlog")}c.innerHTML="";var h=document.createTextNode(b.nickname);c.appendChild(h);d.style.display="block";var i=Utils.Cookie.getCookie("loginFromMsn");if(i&&c){f=e.getNode("msnHolder");f.style.display="block";var j=e.getNode("msnLink");j.href+=$UID}if(f){Core.Dom.insertAfter(f,c.parentNode)}e.initNotice()});break;case"logout":if(!this.trayLogin){this.trayLogin=new a.Login.Ui;this.renderRight(a.tray.tpl.loginOutMemu)}this.initLogin();this.initNotice();break;case"oncelogedon":break}j++},initMsgLoder:function(){if(!this.msgLoader){this.msgLoader=new a.tray.MsgLoader;this.msgLoader.load($UID);var b=this;this._msgTimer=setInterval(function(){b.msgLoader.load($UID)},30*1e3)}},initLogin:function(){var c=this;var d=n(this._el,"login");if(!d){n(this._el,"login","1");b(this._el,function(b){var d=a.util.getActionData(b,"tray-login-btn");if(!d){return}if(typeof sinaSSOController!="undefined")sinaSSOController.loginExtraQuery={};c.trayLogin.login(function(){Lib.checkAuthor();var a=$UID==scope.$uid?"02":"01";v7sendLog("87_01_"+a+"_"+$UID,scope.$pageid);setTimeout(function(){window.location=window.location.toString().replace(/#.*/,"")},100)},false,"referer:"+location.hostname+location.pathname+",func:0007")},"click")}},initLogout:function(){var c=this.getNode("ssoLoginOut");var d=n(c,"loginout");if(!d){n(this._el,"login","1");b(c,function(){a.tray.loginOut(null,!0)})}c=null},initHideSub:function(){var a=this;b(document.body,function(b){if(!a._activeTab){return}var c=b.target||b.srcElement;var d=a.subPanels;var f;for(var g=d.length-1;g>=0;g--){f=d[g];if(f.tab===c||e(f.tab,c)){return}if(f.panel.entity===c||e(f.panel.entity,c)){return}}a._hideActiveSub()},"click");b(window,function(){var b=a._activeTab;if(!b){return}var c=b.tab;var d=b.panel;var e=b.left;var f=b.top;var g=Core.Dom.getLeft(c)+c.offsetWidth+e;var h=Core.Dom.getTop(c)+c.offsetHeight+f;if($IE6&&this.isFixed){g=g-document.documentElement.scrollLeft;h=h-document.documentElement.scrollTop}d.setPosition(g,h)},"resize")},_hideActiveSub:function(){var a=this;if(a._activeTab){var b=a._activeTab.tab;var c=a._activeTab.panel;a._activeTab=null;c.hidden();b.className=b.className.replace(/(?:[ ]*)\bcurrent\b/g,"")}},initUserMenu:function(){var b=this.getNode("userMenu");var c=n(b,"init");if(!c){n(b,"init","1");var d=this;var e;var f=d.getNode("userMenu");var g=d._findSub("userMenu");var h=0;Lib.util.hoverJq({elm:b,mouseenter:function(c,e,j){clearTimeout(d.hoverTimeout);if(!h){h=1;var k;if(!g){k=new a.tray.UserMenuPanel;d.addSubPanel("userMenu",k,b,f)}else{k=g.panel}var l=k.getNode("panel");k.initUserInfo($UID);Lib.util.hoverJq({elm:l,mouseenter:function(a,b,c){clearTimeout(d.hoverTimeout);d._showPanel("userMenu",-160,0)},mouseleave:function(a,b,c){d.hoverTimeout=setTimeout(function(){d._hideActiveSub()},d.hoverTime)}});i(function(a){if(a){k.getNode("mail").style.display=""}})}d._showPanel("userMenu",-160,0)},mouseleave:function(a,b,c){d.hoverTimeout=setTimeout(function(){d._hideActiveSub()},d.hoverTime)}});var i=function(a){if(typeof e==="boolean"){a(e)}else{Utils.Io.JsLoad.request("http://service.mail.sina.com.cn/mailproxy/mail.php",{onComplete:function(){var b=sinamailinfo.email;if(b!=""){e=!0}else{e=!1}a(e)},onException:function(){}})}}}},initBlogMenu:function(b){var c=this.getNode("addArticle");var d=n(c,"init");if(!d){n(c,"init","1");var e=this;var f=e.getNode("blogMenu");var g=0;Lib.util.hoverJq({elm:f,mouseenter:function(d,h,i){clearTimeout(e.hoverTimeout);if(!g){g=1;var j=e._findSub("blogMenu");var k;if(!j){k=new a.tray.BlogMenuPanel;e.addSubPanel("blogMenu",k,c,f);if(b["tbh_status"]===1){k.getNode("tbh_status").style.display=""}}var l=k.getNode("panel");Lib.util.hoverJq({elm:l,mouseenter:function(a,b,c){clearTimeout(e.hoverTimeout);e._showPanel("blogMenu",-74,0)},mouseleave:function(a,b,c){e.hoverTimeout=setTimeout(function(){e._hideActiveSub()},e.hoverTime)}})}e._showPanel("blogMenu",-74,0)},mouseleave:function(a,b,c){e.hoverTimeout=setTimeout(function(){e._hideActiveSub()},e.hoverTime)}})}},initNotice:function(){var e=scope.$PRODUCT_NAME;var f=scope.$pageid;if("blog7"!==e){this.noNotice=!0;return}if(-1===f.indexOf("article")&&-1===f.indexOf("index")){this.noNotice=!0;return}var g=d("closeNotice_fzp");var i=$E("sinablogHead");Lib.checkAuthor();if(g&&g===$UID||!i){this.noNotice=!0;return}if(!this.notice){var j=new a.tray.BlogNotice({appendTo:$E(h).parentNode,isPostion:!1,noIframe:!0});this.notice=j;var k=this;var l=i.offsetHeight+30;var m;var n=function(){var a=document;var b=a.body.scrollTop+a.documentElement.scrollTop;if(b>l){k.hideActive();k.setTrayFixed();if(!m){m=1;v7sendLog("48_01_11")}}else{setTimeout(function(){k.setTrayPosition();j.hide()})}};b(window,n,"scroll");a.Listener.on({name:"tray-announce-close",callBack:function(){c(window,n,"scroll")}})}},initNewMsgEvt:function(){var a=this.tpl;var c=this.getNode("newTips");var d=n(c,"init");if(!d){n(c,"init","1");var e=this;b(c,function(a){a=a||window.event;var b=a.target||a.srcElement;Core.Events.stopEvent(a);b.style.display="none";b.innerHTML="";var c=e.getNode("trayMsg");Core.Events.fireEvent(c,"click")},"click");c=null}},initMsg:function(){var a=this.getNode("trayMsg");var b=n(a,"init");if(!b){n(a,"init","1");var c=this;var d=0;Lib.util.hoverJq({elm:a,mouseenter:function(a,b,e){clearTimeout(c.hoverTimeout);if(!d){d=1;var f=window.event||a;if(f.preventDefault){f.preventDefault()}else{f.returnValue=false}var g=c.getNode("trayMsg");var h=c._findSub("msgPanel");var i;if(!h){i=new Lib.tray.msgSummaryPanel(g);c.addSubPanel("msgPanel",i,g,g)}var j=i.getNode("panel");Lib.util.hoverJq({elm:j,mouseenter:function(a,b,d){clearTimeout(c.hoverTimeout);c._showPanel("msgPanel",-260,0)},mouseleave:function(a,b,d){c.hoverTimeout=setTimeout(function(){c._hideActiveSub()},c.hoverTime)}})}c._showPanel("msgPanel",-260,0)},mouseleave:function(a,b,d){c.hoverTimeout=setTimeout(function(){c._hideActiveSub()},c.hoverTime)}})}},initunReadMsgPanel:function(){var b=this.getNode("trayMsg");var c=n(b,"init-unre");if(!c){n(b,"init-unre","1");new a.tray.unReadMsgPanel(b)}},initSearch:function(){if(!j){var c=new a.tray.SearchFormPanel({isPostion:!1,appendTo:"traySearchBar",noIframe:!0});c.show();b(document.body,function(a){a=a||window.event;var b=a.target||a.srcElement;var d=c.getNode("queryTxt");if(d!==b&&c.entity!==b&&!e(b,c.entity)){c.catePanel.hide()}},"click")}},initOpenBlog:function(){var a=$E("openblogcss");if(!a){Utils.Io.loadCss({id:"openblogcss",url:$_GLOBAL.cssBasicURL+"module/layer/re_nowopen.css"});var b=this.getNode("openBlogBtn");scope.addBlogOpenerEvent(b)}},notifyMsgPanel:function(a){var b=a.getAttribute("msg-count");if(b){try{b=f.parse(b)}catch(c){b={}}}else{b=-1}},renderRight:function(a){this.setTemplate(a);this._el=this.entity;var b=g(this.$main,"ntopbar_loading")[0];b.style.display="none";this.show()},addSubPanel:function(a,b,c,d){var e=this;this.subPanels.push({name:a,tab:d,bind:c,panel:b})},_showPanel:function(a,b,c){var d=this._findSub(a);if(!d){return}var e=d.panel;var f=d.tab;e.entity.style.zIndex=512;if("msgPanel"===a){var g=this.getNode("newTips");this.notifyMsgPanel(f);g.style.display="none"}var h,i,j;i=this._activeTab;if(i){j=i["tab"];if(j===f){return}i["panel"].hide();j.className=j.className.replace(/(?:[ ]*)\bcurrent\b/g,"")}var k=f.className;if(!/\bcurrent\b/.test(k)){f.className+=" current"}this._activeTab={name:a,tab:f,panel:e,left:b,top:c};var l=e.entity;if(this.isFixed&&(!$IE||$IE>6)){l.style.position="fixed"}else{l.style.position="absolute"}e.showWithDom(f,b,c)},_findSub:function(a){var b;for(var c=this.subPanels.length-1;c>=0;c--){b=this.subPanels[c];if(a===b.name){return b}}return null},showNewMsgTips:function(a,c){var d=a.sum-a.feed;var e=this.getNode("newTips");var g=this.getNode("trayMsg");if(d){if(g.getAttribute("unread-show-state")==0&&g.getAttribute("msg-panel-show-state")==0){e.style.display="block"}if(scope.$pageid=="editor"){e.style.display="block"}var h=this.entity.offsetWidth;e.style.left=h-e.offsetWidth-10+"px";if(d<10){e.innerHTML=d}else{e.innerHTML="•••"}if(!m){v7sendLog("40_01_49_"+$UID);m=1}g.setAttribute("msg-count",f.stringify(a));this.startTitleTips(d)}else{g.setAttribute("msg-count",f.stringify(a));this.stopTitleTips()}var i=a.feed;if(i){var j=this.getNode("newFeed");j.style.display="block";if(!c){v7sendLog("40_02_11"+"_"+$UID)}var h=this.entity.offsetWidth;j.style.left=h-j.offsetWidth-197+"px";i=i<10?i:"•••";j.innerHTML=i;if(!j.addEvt){j.addEvt=1;b(j,function(){location.href="http://i.blog.sina.com.cn/blogprofile/index.php?com=1";j.style.display="none";j.innerHTML=""})}}},stopTitleTips:function(){if(scope.$pageid=="editor"){return}var a=document.title.replace(/\(\d+\+*\)/,"");document.title=a},startTitleTips:function(a){if(scope.$pageid=="editor"){return}var b;if(a){a=a>=1e5?"99999+":a;if(/\(\d+\+*\)/.test(document.title)){b=document.title.replace(/\(\d+\+*\)/,"("+a+")")}else{b="("+a+")"+document.title}}document.title=b},hideActive:function(){var a,b;if(a=this._activeTab){a["panel"].hide();b=a["tab"];b.className=b.className.replace(/(?:[ ]*)\bcurrent\b/g,"");this._activeTab=null}},setTrayFixed:function(){var c=$E(h);this.notice.show();var d=this;setTimeout(function(){$E("traySearchBar").parentNode.style.display="none";c.style.display="none";var e=c.parentNode.parentNode;if(!$IE||$IE>6){a.Listener.notify("tray-scrolling-fix",{});e.style.position="fixed";e.style.top="0px"}else if($IE===6){if(!d.__isFixie6){b(window,function(a){if(!d.isFixed){return}var b=document.documentElement.scrollTop;setTimeout(function(){var c=document.documentElement.scrollTop;if(b===c){e.style.display="block";d._ie6fix(a)}else if(d.isFixed){e.style.display="none"}},50)},"scroll");d.__isFixie6=!0}}e.style.width="100%";if(!$E(i)){var f=e.offsetHeight;var g=$C("div");g.style.height=f+"px";g.id=i;Core.Dom.insertAfter(g,e)}d.isFixed=!0})},_ie6fix:function(b){if(this.isFixed){var c=$E(h);var d=c.parentNode.parentNode;d.style.position="absolute";d.style.top=document.documentElement.scrollTop+"px";var e=this.getNode("trayMsg");if(e){e.style.display="none";e.style.display=""}a.Listener.notify("tray-scrolling-fix",{})}},setTrayPosition:function(){if($IE6){var b=this.getNode("trayMsg");if(b){b.style.display="none";b.style.display=""}}a.Listener.notify("tray-scrolling-nofix",{});var c=$E(h);var d=c.parentNode.parentNode;if($E(i)){d.parentNode.removeChild($E(i))}d.style.position="";var e=$E("traySearchBar");e.style.position="";e.style.top="";this.notice.hide();d.style.display="block";c.style.display="block";$E("traySearchBar").parentNode.style.display="block";this.isFixed=!1}});return function(){if(!k){k=new o}return k}});Core.System.htmlFilter=function(a){var b={"&":"&#038;","<":"&#060;",">":"&#062;"};var c;for(c in b){a=a.replace(new RegExp(c,"g"),b[c])}return a};Utils.Io.loadExternalCSS=function(a,b){if(typeof a!=="string"){return}var c,d,e=document.getElementsByTagName("head")[0];if($FF){d=$C("style");d.type="text/css";d.innerHTML="@import url("+a+")";e.appendChild(d);(function(){try{d.sheet.cssRules;typeof b==="function"&&b()}catch(a){setTimeout(arguments.callee,50)}})()}else{c=$C("link");c.href=a;c.type="text/css";c.rel="stylesheet";c.media="all";e.appendChild(c);if($SAFARI||$CHROME){(function(){try{c.sheet.cssRules;typeof b==="function"&&b()}catch(a){setTimeout(arguments.callee,50)}})()}else{c.onload=function(){c.onload=null;typeof b==="function"&&b()}}}};Core.Events.click=function(){var a=/mobile/i.test(navigator.userAgent);if($IE&&$IE<9){return function(a){a.click()}}else{return function(b){var c;if(a){c=document.createEvent("HTMLEvents")}else{c=document.createEvent("MouseEvents")}c.initEvent("click",true,true);b.dispatchEvent(c)}}}();Core.Dom.removeClassName=Core.Dom.removeClass;scope.trayPlusTemplayLogout=['<div class="topbar_menu">','<span class="link"><a target="_blank" href="http://blog.sina.com.cn">博客首页</a></span>','<span class="line_s"></span>',"</div>",'<div class="topbar_login"><a id="linkTrayLogin" class="login" href="javascript:;">登录</a><a id="linkReg" target="_blank" class="register" href="">注册</a></div>','<div id="divPopularize" class="topbar_ad"></div>','<div id="loginBarActivity" class="topbar_activity"></div>'].join("");scope.trayPlusTemplayLogin=['<div class="topbar_menu" id="openedBlogTray">','<span id="loginBarOptApp" class="link"><a id="loginBarAppMenuLabel" href="javascript:;">读取中...</a><a href="javascript:;" class="link_arrow" title=""></a></span>','<span class="line_s"></span>','<span style="display:none;" id="loginBarMail" class="link imfor blog_to_mail"><a target="_blank" href="http://mail.sina.com.cn/?s=2">邮件</a><div id="mailpiaohong" style="display:none;" class="imforbox"></div></span>','<span class="line_s" style="display:none;" id="line"></span>','<span id="loginBarCenter" class="link"><a target="_self" href="http://i.blog.sina.com.cn/blogprofile/index.php?com=1">个人中心</a></span>','<span class="line_s"></span>','<span id="loginBarFriend" class="link"><a target="_blank" href="http://control.blog.sina.com.cn/blogprofile/profilefriendlist.php">好友</a></span>','<span class="line_s"></span>','<span id="loginBarInbox" class="link imfor"><img id="imgNewMessage" style="display:none;" class="topbar_msg" src="http://simg.sinajs.cn/blog7style/images/common/topbar/topbar_msg.gif"/><a href="#" onclick="return false;">消息</a><a href="#" onclick="return false;" class="link_arrow" title=""></a><div id="ccnotepiaohong" style="display:none;" class="imforbox"></div></span>','<span class="line_s"></span>','<span class="link" id="logOut"><a href="#">退出</a></span>',"</div>",'<div style="display:none" class="topbar_menu" id="noOpenedBlogTray">','<span class="link" style="cursor:default;"><a id="noOpenBlogName">读取中...</a></span>','<span class="line_s"></span>','<span class="link"><a href="#">退出</a></span>',"</div>",'<div class="topbar_noopen" style="display:none" id="outOfOpenBlogTray">','<a id="openBlogBtnTray" title="立即开通博客" class="nowopen" href="javascript:void(0)" onclick="return false;"></a>',"</div>",'<div id="loginBarActivity" class="topbar_activity"></div>'].join("");scope.trayPlusTemplayOnceLoged=['<div class="topbar_menu" id="openedBlogTray">','<span id="loginBarOptApp" class="link"><a id="loginBarAppMenuLabel" href="javascript:;">读取中...</a></span>','<span class="line_s"></span>','<span id="loginBarMail" class="link imfor blog_to_mail"><a target="_blank" href="http://mail.sina.com.cn/?s=2">邮件</a><div id="mailpiaohong" style="display:none;" class="imforbox"></div></span>','<span class="line_s" id="line"></span>','<span id="loginBarCenter" class="link"><a target="_self" href="http://i.blog.sina.com.cn/blogprofile/index.php?com=1">个人中心</a></span>','<span class="line_s"></span>','<span id="loginBarFriend" class="link"><a target="_blank" href="http://control.blog.sina.com.cn/blogprofile/profilefriendlist.php">好友</a></span>','<span class="line_s"></span>','<span id="loginBarInbox" class="link imfor"><img id="imgNewMessage" style="display:none;" class="topbar_msg" src="http://simg.sinajs.cn/blog7style/images/common/topbar/topbar_msg.gif"/><a href="#" onclick="return false;">消息</a><div id="ccnotepiaohong" style="display:none;" class="imforbox"></div></span>',"</div>",'<div style="display:none" class="topbar_menu" id="noOpenedBlogTray">','<span class="link" style="cursor:default;"><a id="noOpenBlogName">读取中...</a></span>','<span class="line_s"></span>','<span class="link"><a href="#">退出</a></span>',"</div>",'<div class="topbar_noopen" style="display:none" id="outOfOpenBlogTray">','<a id="openBlogBtnTray" title="立即开通博客" class="nowopen" href="javascript:void(0)" onclick="return false;"></a>',"</div>",'<div id="divPopularize" class="topbar_ad"></div>','<div id="loginBarActivity" class="topbar_activity"></div>'].join("");scope.newStatusTipTemplay=['<div class="tb_layer_arrow"></div>','<div class="tb_layer_Y_main tip_ps" style="width:130px;text-align:left;padding:5px 0 2px 5px;color:#000000">','<a onclick="$E(\'newStatusTip\').style.display=\'none\';return false" href="#" class="tb_friend_inputDel" title="关闭" style="margin-top: 5px;"></a>','<a href="http://i.blog.sina.com.cn/blogprofile/index.php?type=3&from=newstatus&com=2"><span id="nstFeed" style="padding:2px 2px;display:none;">你有<span style="color:red">新动态</span>可查看</span></a>','<a href="http://control.blog.sina.com.cn/blogprofile/profileremind.php?com=2"><span id="nstFavorite" style="padding:3px 2px;display:none;">你有博文被<span style="color:red">转载/收藏</span></span></a>','<img id="gbimg" class="SG_icon SG_icon83" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="17" height="15" align="absmiddle" style="display:none"/><a style="display:none" href="http://i.blog.sina.com.cn/blogprofile/index.php?com=g" id="gbmsg">官博<em>新动态</em></a>',"</div>"].join("");scope.onceLogedStatusTipTemplay=['<div class="tb_layer_arrow"></div>','<div class="tb_layer_Y_main tip_ps" style="width:130px;text-align:left;padding:5px 0 2px 5px;color:#000000">','<a onclick="$E(\'newStatusTip\').style.display=\'none\';return false" href="#" class="tb_friend_inputDel" title="关闭" style="margin-top: 5px;"></a>','<a href="javascript:void(0);return false;"><span id="nstUnread" style="padding:3px 2px;display:none;">你有<span style="color:red">未读消息</span>可查看</span></a>','<a href="javascript:void(0);return false;"><span id="nstFeed" style="padding:2px 2px;display:none;">你有<span style="color:red">新动态</span>可查看</span></a>','<a href="javascript:void(0);return false;"><span id="nstUpdate" style="padding:3px 2px;display:none;">你最近浏览的博主<span style="color:red">有更新</span></span></a>','<a href="javascript:void(0);return false;"><span id="nstUnpub" style="padding:2px 2px;display:none;">你有<span style="color:red">尚未发表</span>的博文</span></a>',"</div>"].join("");scope.nicknamePanelTemplate=['<div id="#{panel}" class="tb_layer_Y tb_layer_w2" style="z-index:512;">','<div class="tb_layer_arrow"></div>','<div class="tb_layer_Y_main">','<div class="tb_ps">','<div class="tb_ps_list">',"<ul>","<li>",'<span class="tb_ps_nm"><a id="#{linkBlog}" href="javascript:;"><img class="SG_icon SG_icon15" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" title="博客" align="absmiddle" /><strong>博客</strong></a></span>','<span class="tb_ps_set">[<a target="_blank" id="#{linkPostBlog}" href="http://control.blog.sina.com.cn/admin/article/article_add.php">发博文</a>]</span>',"</li>","<li>",'<span class="tb_ps_nm"><a id="#{linkPhoto}" href="javascript:;"><img class="SG_icon SG_icon18" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" title="相册" align="absmiddle" /><strong>相册</strong></a></span>','<span class="tb_ps_set">[<a target="_blank" id="#{linkPostPhoto}" href="http://photo.blog.sina.com.cn/upload/upload.php">发图片</a>]</span>',"</li>","<li>",'<span class="tb_ps_nm"><a target="_blank" id="#{linkVBlog}" href="javascript:;"><img class="SG_icon SG_icon16" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" title="播客" align="absmiddle" /><strong>播客</strong></a></span>','<span class="tb_ps_set">[<a target="_blank" id="#{linkUpload}" href="http://vupload.you.video.sina.com.cn/u.php?m=1">发视频</a>][<a id="#{linkRecord}" href="http://vupload.you.video.sina.com.cn/r.php" target="_blank">录视频</a>]</span>',"</li>","<li>",'<span class="tb_ps_nm"><a id="#{miniblog}" href="javascript:;" target="_blank"><img class="SG_icon SG_icon51" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" title="微博" align="absmiddle" /><strong>微博</strong></a></span>',"</li>","<li>",'<span class="tb_ps_nm"><a id="#{qingblog}" onclick="v7sendLog && v7sendLog(\'79_01_02\',scope.$pageid,\'qingLink\');" href="javascript:;" target="_blank"><img class="SG_icon SG_icon205" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" title="Qing" align="absmiddle" /><strong>Qing</strong></a></span>',"</li>","<li>",'<span class="tb_ps_nm"><a id="#{mySpace}" href="javascript:;"><img class="SG_icon SG_icon41" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" title="关于我" align="absmiddle" /><strong>关于我</strong></a></span>',"</li>","</ul>",'<div class="clearit"></div>',"</div>",'<div class="tb_ps_manage">','<p><a target="_blank" id="#{linkChangeFace}" href="javascript:;">修改头像昵称</a></p>','<p><a target="_blank" id="#{linkChangePassword}" href="javascript:;">修改登录密码</a></p>','<p><a target="_blank" id="#{linkAccountSetup}" href="javascript:;">账号安全设置</a></p>','<p><a target="_blank" id="#{bindEmail}" href="javascript:;">绑定邮箱</a></p>',"</div>","</div>","</div>","</div>"].join("");scope.NicknamePanel=Core.Class.define(function(){Lib.Panel.prototype.initialize.apply(this,arguments);this.setTemplate(scope.nicknamePanelTemplate)},Lib.Panel,{initUserInfo:function(a){var b=this.getNodes();scope.$bindEmail=function(a){var c=b["bindEmail"];if(a.ret!="y"&&a.errcode!="not_verify"){c.parentNode.removeChild(c)}else{c.href="http://login.sina.com.cn/bindmail/bindmail.php?entry=blog"}};try{var c=/user=([^&]+)&/g.exec(decodeURIComponent(Utils.Cookie.getCookie("SUP")))[1];Utils.Io.JsLoad.request("http://login.sina.com.cn/bindmail/checkmailuser.php?entry=blog&name="+encodeURIComponent(c)+"&utf82bgk=1&callback=scope.$bindEmail",{noreturn:true})}catch(d){}b["linkBlog"].href="http://blog.sina.com.cn/u/"+a;b["linkPhoto"].href="http://photo.blog.sina.com.cn/u/"+a;b["linkVBlog"].href="http://you.video.sina.com.cn/m/"+a;b["miniblog"].href="http://control.blog.sina.com.cn/t_sina_blog/tb.php?uname="+a;b["qingblog"].href="http://qing.blog.sina.com.cn/fancy.html";b["mySpace"].href="http://blog.sina.com.cn/s/profile_"+a+".html";b["linkChangeFace"].href="http://control.blog.sina.com.cn/blogprofile/nick.php";b["linkChangePassword"].href="http://login.sina.com.cn/member/security/password.php";b["linkAccountSetup"].href="http://login.sina.com.cn/member/security.php";var e=["linkBlog","linkPhoto","linkVBlog","miniblog","qingblog","mySpace","linkChangeFace","linkChangePassword","linkAccountSetup"];for(var f=0;f<e.length;f++){b[e[f]].onclick=function(){v7sendLog("40_01_02_"+$UID)}}}});var st=['<div id="#{panel}" style="z-index:512;" class="tb_layerBox">',"<ul>",'<li id="#{blog}"><a href="javascript:;" onclick="v7sendLog(\'40_01_19\')">博文</a></li>','<li id="#{bauthor}"><a href="javascript:;" onclick="v7sendLog(\'40_01_19\')">博主</a></li>','<li id="#{song}"><a href="javascript:;" onclick="v7sendLog(\'40_01_19\')">音乐</a></li>','<li id="#{video}"><a href="javascript:;" onclick="v7sendLog(\'40_01_19\')">视频</a></li>','<li id="#{vauthor}"><a href="javascript:;" onclick="v7sendLog(\'40_01_19\')">播主 </a></li>',"</ul>","</div>"];scope.searchPanelTemplate=st.join("");scope.SearchPanel=Core.Class.define(function(){Lib.Panel.prototype.initialize.apply(this,arguments);this.setTemplate(scope.searchPanelTemplate)},Lib.Panel,{config:{blog:{text:"博文",url:"http://search.sina.com.cn/?c=blog",keyName:"q",range:"article",by:"all"},bauthor:{text:"博主",url:"http://search.sina.com.cn/?c=blog",keyName:"q",range:"author",by:"all"},song:{text:"音乐",url:"http://music.sina.com.cn/yueku/search/s.php",keyName:"k",t:"song",s:"",ts:"",type:"",stype:""},video:{text:"视频",url:"http://search.video.sina.com.cn/search.php",keyName:"k",t:"",s:"sup",ts:"",type:"boke",stype:"1"},vauthor:{text:"播主",url:"http://search.video.sina.com.cn/search.php",keyName:"k",t:"",s:"sup",ts:"",type:"boke",stype:"3"}}});Utils.Flash.swfView={swfList:[],Add:function(a,b,c,d,e,f,g,h,i){if(a&&c){this.swfList[this.swfList.length]={sURL:a,sID:b,sPID:c,nWidth:d,nHeight:e,nVersion:f,sBGColor:g,oVar:h,oParam:i};this.Init();return}},Init:function(){var a;var b=this.swfList;for(var c=0,d=b.length;c<d;c++){var e=b[c];a=new Utils.Flash.swfObject(e.sURL,e.sPID,e.nWidth,e.nHeight,e.nVersion,e.sBGColor);if(e.oVar){for(var f in e.oVar){a.addVariable(f,e.oVar[f])}}if(e.oParam){for(var g in e.oParam){a.addParam(g,e.oParam[g])}}a.write(e.sID)}b=[];e=null;a=null}};Utils.Io.loadCss=function(a,b){if(a==null){return false}b=b||window;var c=b.document;a.id=a.id||"";var d;if(a.url){d=c.createElement("link");d.setAttribute("rel","stylesheet");d.setAttribute("type","text/css");d.setAttribute("href",a.url)}else if(a.text){d=c.createElement("style");d.setAttribute("type","text/css");if($IE){d.styleSheet.cssText=a.text}else{d.innerHTML=a.text}}d.setAttribute("id",a.id);c.getElementsByTagName("head")[0].appendChild(d)};var st=['<div id="#{panel}" style="z-index:512;" class="tb_layer_Y tb_layer_w6" style="left:400px; top:700px;">','<div class="tb_layer_arrow"></div>','<div class="tb_layer_Y_main">','<div class="tb_mas" id="#{newInboxList}" style="">','<div class="tb_mas_list">','<ul id="#{changebgli1}"  style="display:none" >','<li  style="display:none" >','<span id="#{ccsysgonggao}" class="tb_friend_nm">[<strong>公告</strong>] <a href="http://control.blog.sina.com.cn/blog_rebuild/profile/controllers/notelist.php?action=profilesysnote">新浪邀你一起共度中秋活动</a></span>','<span class="tb_friend_set"><a href="http://control.blog.sina.com.cn/blog_rebuild/profile/controllers/notelist.php?action=profilesysnote">&gt;&gt;</a></span>',"</li>",'<li style="display:none">','<span id="#{ccsystongzhi}" class="tb_friend_nm">[<strong>通知</strong>] <a href="http://control.blog.sina.com.cn/blog_rebuild/profile/controllers/notelist.php?action=profilesysnote">新浪2010邀你一起共度中秋活动...</a></span>','<span class="tb_friend_set"><a href="http://control.blog.sina.com.cn/blog_rebuild/profile/controllers/notelist.php?action=profilesysnote">&gt;&gt;</a></span>',"</li>","</ul>",'<ul class="bd" id="#{changebgli2}">','<li  id="#{newInboxLoding}" style="cursor:default" ><div style="margin: 0pt; padding: 10px;text-align:center;"><img src="http://simg.sinajs.cn/blog7style/images/common/loading.gif"><div></li>','<li  id="#{nomsgli}" style="cursor:default;" >还没有消息</li>','<li style="float:none;"><span class="mas_more"><a id="#{mas_moremsg}" href="http://i.blog.sina.com.cn/blogprofile/profilelatestnote.php">全部消息</a></span></li>',"</ul>",'<div class="clearit"></div>',"</div>",'<ul class="commentslist" id="commentdata">','<li><a class="conn" href="http://i.blog.sina.com.cn/blogprofile/profilecommlist.php?type=1">评论</a><a class="num" href="http://i.blog.sina.com.cn/blogprofile/profilecommlist.php?type=1" id="#{commentRelapseCount}" ></a></li>','<li><a class="conn" href="http://i.blog.sina.com.cn/blogprofile/wall.php">留言</a><a class="num" href="http://i.blog.sina.com.cn/blogprofile/wall.php" id="#{guestBookCount}">1</a></li>','<li class="lst"><a class="conn" href="http://control.blog.sina.com.cn/blogprofile/profileinvitelist.php">好友邀请</a><a class="num" href="http://control.blog.sina.com.cn/blogprofile/profileinvitelist.php" id="#{inviteCount}" ></a></li>','<li><a class="conn" href="http://control.blog.sina.com.cn/blogprofile/profilepaperlist.php?type=1">纸条</a><a class="num" href="http://control.blog.sina.com.cn/blogprofile/profilepaperlist.php?type=1" id="#{messageCount}" ></a></li>','<li><a class="conn" target="_blank" href="http://mail.sina.com.cn" reject="1">邮箱</a><a class="num" href="http://mail.sina.com.cn" id="#{mailCount}" target="_blank" reject="1"></a></li>','<li><a class="conn" href="http://control.blog.sina.com.cn/blog_rebuild/profile/controllers/notelist.php?action=profilesysnote">系统消息</a><a class="num" href="http://control.blog.sina.com.cn/blog_rebuild/profile/controllers/notelist.php?action=profilesysnote" id="#{sysnoticeCount}" ></a></li>',"</ul>","</div>","</div>","</div>"];scope.newInboxPanelTemplate=st.join("");Lib.LocalDB={_this:null,isFlashReady:false,FlaDom:null,updataFun:null,loadedFun:null,regiFun:[],regiFunArgs:[],scacheReady:function(){var a=Lib.LocalDB;a.isFlashReady=true;if(a.loadedFun){a.loadedFun(a._this)}var b=a.regiFun;var c=a.regiFunArgs;for(var d=0;d<b.length;d++){b[d].apply(null,c[d])}},registerFun:function(a,b){this.regiFun.push(a);var c=b||[];this.regiFunArgs.push(c)},set:function(a,b){if(this.isFlashReady){try{this.FlaDom.setLazyInterface(a,b);return true}catch(c){trace("set函数出错")}}return false},get:function(a,b,c){if(this.isFlashReady){try{return this.FlaDom.getLazyInterface(a,b,c)}catch(d){trace("get函数出错")}}return false},clearCache:function(a,b){if(this.isFlashReady){try{$E("scache").clearCache(a,b)}catch(c){trace("gclearCache函数出错")}}return false},loadFlash:function(a){var b="";if(window.$Maxthon||window.$360||window.$TT){b="?t="+Core.Math.getUniqueId()}if(!this.FlaDom){var c=new Utils.Flash.swfObject($_GLOBAL.flashBasicURL+"scache.swf"+b,"scache","1","1","9","#00ff00");c.addParam("quality","high");c.addParam("wmode","transparent");c.addParam("allowScriptAccess","always");c.write(a);this.FlaDom=$E("scache")}},getServer:function(){try{return this.FlaDom.isServer()}catch(a){trace("判断是否是通信主机发生错误");return false}},login:function(a){try{this.FlaDom.login(a)}catch(b){trace("login函数出错");trace(a)}},sendToClient:function(a){try{if(this.getServer()){this.FlaDom.sendToClient(a)}else{}}catch(b){trace("sendToClient函数出错")}},setClientJsFun:function(a){try{if(this.getServer()){this.FlaDom.setClientJsFun(a)}else{trace("非主机不可以设置接收函数")}}catch(b){trace("setClientJsFun函数出错")}},receive:function(a){this.updataFun(a)}};scope.msnTipsTemplate=['<div id="#{panel}" style="position: absolute; width: 369px; padding-top: 7px; font-size: 12px; z-index:511">',"<div  style=\"top: 0pt; left: 65px; position: absolute; width: 16px; height: 8px; background: url('http://simg.sinajs.cn/blog7style/images/special/move/bg_boxtop_01.png') no-repeat scroll 0pt 0pt transparent; z-index: 100;\"></div>","<div style=\"padding: 5px 6px 9px 14px; border: 1px solid rgb(181, 202, 214); background: url('http://simg.sinajs.cn/blog7style/images/special/move/bg_asiangames.jpg') no-repeat scroll left bottom rgb(255, 255, 255); z-index: 1;\">",'<p id="#{close}" class="close" style="float: right; margin: 0pt; cursor: pointer; width: 8px; height: 8px; font-size: 0pt;background:url(\'http://simg.sinajs.cn/blog7style/images/special/move/btn_close.gif\') no-repeat 0 0;"></p>','<div style="width: 342px; margin: 10px 0pt 0pt; padding: 0pt 0pt 3px;">','<a style="float: left; margin: 0pt 10px 0pt 0pt;" href="#"><img height="91" width="122" style="border: 0pt none;" alt="MSN" src="http://simg.sinajs.cn/blog7style/images/special/move/img_msnphoto.png"></a>','<h3 style="padding: 2px 0pt 5px; color: rgb(0, 0, 0); margin: 0pt; font-size: 12px;">各位拥有MSN帐号的同学注意啦!</h3>','<p style="width: 268px; display: inline; text-indent: 0pt; padding: 0pt; color: rgb(51, 51, 51); line-height: 19px;">新浪博客帐号与MSN帐号已经实现关联。您可以使用MSN帐号来登录博客，绑定后发博文、发图片可同步到Live，第一时间让您的MSN好友知晓。</p>',"</div>",'<p style="clear: both; height: 30px; margin: 12px 10px 4px 0pt; padding: 12px 0pt 0pt; border-top: 1px solid rgb(220, 213, 211); text-align: right;"><a style="float: right; color: rgb(176, 173, 172); margin-top: 10px; text-decoration: none;" href="javascript:void(0);" id="#{noMoreShow}">不再显示</a><a style="float: right; text-decoration: none; margin: 10px 14px 0pt 16px;color:#2d3186;" href="http://blog.sina.com.cn/s/blog_4b0f52990100lt3i.html">帮助</a><a id="#{setNow}"style="float: right;" href="http://control.blog.sina.com.cn/blogprofile/msnbind.php"><img height="32" width="105" style="border: medium none;" alt="立即设置" src="http://simg.sinajs.cn/blog7style/images/special/move/btn_receive01.jpg"></a></p>',"</div>","</div>"].join("");scope.msnTips=Core.Class.define(function(){Lib.Panel.prototype.initialize.apply(this,arguments);this.setTemplate(scope.msnTipsTemplate)},Lib.Panel,{initUserInfo:function(a,b){var c=this.getNodes();this.setFixed($E("loginBarActivity"),-230,-2);var d=this;c["close"].onclick=function(){d.hidden()};c["noMoreShow"].onclick=function(){d.hidden();Utils.Cookie.setCookie("noMoreMsnTips"+$UID,1,24*100,"/",".blog.sina.com.cn")};c["setNow"].onclick=function(){v7sendLog("95_02_01",scope.$pageid,"")}},setFixed:function(a,b,c){var d=this;setTimeout(function(){d.showWithDom(a,b,c);d.fadeIn()},2e3);Core.Events.addEvent(window,function(){var e=Core.Dom.getLeft(a)+a.offsetWidth+b;var f=Core.Dom.getTop(a)+a.offsetHeight+c;if($IE6&&d.isFixed){e=e-document.documentElement.scrollLeft;f=f-document.documentElement.scrollTop}d.setPosition(e,f)},"resize")},fadeIn:function(){var a=this.entity;Core.Dom.opacity(a,0);var b=0;(function c(){Core.Dom.opacity(a,b+=5);if(Core.Dom.getStyle(a,"opacity")<1){setTimeout(c,20)}})()}});scope.NewInboxPanel=Core.Class.define(function(){Lib.Panel.prototype.initialize.apply(this,arguments);this.setTemplate(scope.newInboxPanelTemplate);this.nodes=this.getNodes();var a=this;var b=Lib.LocalDB;if(/Mobile/i.test(navigator.userAgent)){setTimeout(function(){a.requestDataInterface()},100)}else{if(!b.FlaDom){b._this=a;b.loadedFun=a.FlashLoaded;b.loadFlash("trayFlashConnetion")}else{a.FlashLoaded(a)}}Core.Events.addEvent($E("loginBarInbox"),function(b){v7sendLog("40_01_09_"+$UID);var c=b&&b.target||window.event&&window.event.srcElement;if(c&&c.tagName&&c.tagName.toLowerCase()=="a"){v7sendLog("45_01_10_"+$UID)}a._hasOverview=true;$E("ccnotepiaohong").style.display="none";a.requestMsgDate()},"click");this.interfaceMessages=new Interface("http://interface.blog.sina.com.cn/riaapi/profile/unread.php","jsload")},Lib.Panel,{nodes:null,_connectSWF:null,_SWFChannelName:"inboxConnection",interfaceMessges:null,isMessageLoaded:false,isUICServiceLoaded:true,isHaveNewMessage:false,_listData:null,_productIDs:{blog:1,vblog:2,group:4,photo:8,cube:16},_msgIsLoad:false,_newnote:0,_hasOverview:false,interfaceUICServiceURL:"http://uic.sinajs.cn/uic?type=service&uids=#{uids}&varname=service",FlashLoaded:function(a){var b=Lib.LocalDB;var c=a;window.$updateData=function(a){c.updateData(a)};Lib.checkAuthor();b.login($UID);b.setClientJsFun("$updateData");setTimeout(function(){c.requestDataInterface()},100)},requestMsgDate:function(){this.updateView("loading");var a=this;var b=0;if(this._hasOverview){b=this._newnote;this._newnote=0;this._hasOverview=false}var c=new Interface("http://control.blog.sina.com.cn/blog_rebuild/riaapi/profile/note/notetips.php?clearnum="+b,"jsload");c.request({GET:{uid:$UID},onSuccess:function(b){if(typeof b.announcement!="undefined"&&b.announcement){a.nodes["ccsysgonggao"].innerHTML='[<strong>公告</strong>]&nbsp;<a href="http://control.blog.sina.com.cn/blog_rebuild/profile/controllers/notelist.php?action=profilesysnote">'+b.announcement+"</a>";a.nodes["ccsysgonggao"].parentNode.style.display=""}else{a.nodes["ccsysgonggao"].parentNode.style.display="none"}if(typeof b.sysNote!="undefined"&&b.sysNote){a.nodes["ccsystongzhi"].innerHTML='[<strong>通知</strong>]&nbsp;<a href="http://control.blog.sina.com.cn/blog_rebuild/profile/controllers/notelist.php?action=profilesysnote">'+b.sysNote+"</a>";a.nodes["ccsystongzhi"].parentNode.style.display=""}else{a.nodes["ccsystongzhi"].parentNode.style.display="none"}if(typeof b.sysNote=="undefined"&&typeof b.announcement=="undefined"){a.nodes["ccsystongzhi"].parentNode.parentNode.style.display="none"}else{a.nodes["ccsystongzhi"].parentNode.parentNode.style.display=""}a.nodes["nomsgli"].style.display="";if(typeof b.notice!="undefined"&&b.notice){var c=b.notice;while(a.nodes["changebgli2"].childNodes.length>2){a.nodes["changebgli2"].removeChild(a.nodes["changebgli2"].childNodes[a.nodes["changebgli2"].childNodes.length-3])}for(var d=c.length-1;d>=0;d--){var e=$C("li");e.innerHTML=c[d].data;e._href=c[d].url;a.nodes["changebgli2"].insertBefore(e,a.nodes["changebgli2"].firstChild);e.onclick=function(){v7sendLog("45_01_11_"+$UID);window.location.href=this._href};a.nodes["nomsgli"].style.display="none"}}if(parseInt($E("ccnotepiaohong").innerHTML,10)>0){var f=parseInt($E("ccnotepiaohong").innerHTML,10);var g=a.nodes["changebgli2"].childNodes;for(var h=0;h<g.length-2&&h<f;h++){Core.Dom.removeClassName(g[h],"cur");g[h].className+=" cur"}}a.updateView("loaded");a._msgIsLoad=true;a.bindliEvent()},onError:function(a){},onFail:function(){}});var d=new Interface("http://control.blog.sina.com.cn/blog_rebuild/riaapi/profile/note/unreadmail.php","jsload");d.request({onSuccess:function(b){var c=parseInt(b)||0;if(c>99){c="99+"}a.nodes.mailCount.innerHTML=c||""},onError:function(){a.nodes.mailCount.innerHTML=""}})},requestDataInterface:function(){var a=this;Lib.checkAuthor();var b=Lib.LocalDB;var c=null;if(b.isFlashReady&&!this.checkCache){this.clearCache();c=b.get("uid_"+$UID+"unread",60*1e3*4);this.checkCache=true}var d=function(d,e){if(!c&&!e){b.set("uid_"+$UID+"unread",d)}if(d["isBindToMsn"]==0&&Utils.Cookie.getCookie("noMoreMsnTips"+$UID)!=1){}a.isMessageLoaded=true;a.onMessageLoad(d["nickname"]);a._listData=d;scope.unreadMsg=d;scope.nickname=d["full_nickname"];scope.loginUserWtype=d["login_wtype"];if(d.svr_time)scope.$svr_time=d.svr_time;if(d.nfn>=1){v7sendLog("40_01_03_"+$UID);a.initNewStatusTip(d)}else{}a.updateListData(d);if(a.isMessageLoaded){a.updateData({data:a._listData});a.onLoaded()}scope.hasOpenBlog=d.isbloguser==1?"open":"no";scope.bindTrayOpenTime=1;Lib.Listener.notify("tray-data-loaded",d);if(scope.hasOpenBlog=="no"&&scope.bindTrayOpenTime==1){if(!$E("openblogcss")){Utils.Io.loadCss({id:"openblogcss",url:$_GLOBAL.cssBasicURL+"module/layer/re_nowopen.css"})}$E("openedBlogTray").style.display="none";$E("noOpenedBlogTray").style.display="";$E("outOfOpenBlogTray").style.display="";scope.addBlogOpenerEvent($E("openBlogBtnTray"));$E("noOpenBlogName").href="http://blog.sina.com.cn/u/"+$UID;scope.bindTrayOpenTime=2}scope.unreadOkExecuted=true};if(c){d(c,true);trace("-------unread 使用缓存的数据!!!----")}else{trace("-----直接调用unread接口！！！");this.interfaceMessages.request({GET:{uid:$UID,product:"blog"},onSuccess:d,onError:function(a){},onFail:function(){}})}},clearCache:function(){var a={profile_notice:"notice",profile_paperlist:"message",profile_invitelist:"invite",profile_commlist:"blogcomment",profile_replylist:"blogrecomment",profile_guestBookM:"gbook",profile_commtrash:"trashcomment",profile_commphotolist:"photocomment",profile_index:"profile_index",profile_remind:"profile_remind"};var b=Lib.LocalDB;var c=b.get("uid_"+$UID+"unread",60*1e3*4);if(c&&a[scope.$pageid]&&typeof c[a[scope.$pageid]]!=undefined){trace("-----清除缓存");b.clearCache(10,"uid_"+$UID+"unread")}var d=$UID+"_clear_flash";var e=Utils.Cookie.getCookie(d);if(e==1){trace("【活动】根据cookie标记,清除Flash缓存");b.clearCache(10,"uid_"+$UID+"unread");Utils.Cookie.setCookie(d,"",0,"/",".sina.com.cn")}},initMsnTips:function(){Lib.checkAuthor();(new scope.msnTips).initUserInfo($nick,$UID)},initNewStatusTip:function(a){if(scope.$pageid=="profile_index"||scope.$pageid=="pageSetM"||scope.$pageid=="editor"){return}var b=$E("newStatusTip");if(b||!a){return}v7sendLog("45_01_07_"+$UID);b=$C("div");b.id="newStatusTip";b.className="tb_layer_Y tb_layer_w3";b.style.width="138px";b.innerHTML=scope.newStatusTipTemplay;var c=$T($E("loginBarCenter"),"a")[0];var d=Core.Dom.getXY(c);b.style.left=d[0]-(138/2-c.offsetWidth/2)+"px";b.style.top=d[1]+c.offsetHeight+"px";b.style.zIndex="510";if(c.href.indexOf("?")==-1){c.href+="?type=2&from="+scope.$pageid}Core.Dom.opacity(b,0);document.body.appendChild(b);if(a.nfn>=1){$E("nstFeed").style.display="block";$E("nstFeed").onclick=function(){v7sendLog("45_01_09_"+$UID);v7sendLog("40_01_04_"+$UID)}}if(a.official_blog==1){$E("gbimg").style.display="";$E("gbmsg").style.display=""}for(var e=1;e<=500;e++){(function(a){setTimeout(function(){Core.Dom.opacity(b,a*2/10)},a*2)})(e)}if(scope.$pageid=="editor"){c.target="_blank";$E("nstFeed").parentNode.target="_blank";$E("gbmsg").style.target="_blank";Core.Events.addEvent(c,this.closeTip(c),"click")}Core.Events.addEvent(window,function(){var a=$T($E("loginBarCenter"),"a")[0];var c=Core.Dom.getXY(a);b.style.left=c[0]-(138/2-a.offsetWidth/2)+"px";b.style.top=c[1]+a.offsetHeight+"px"},"resize")},closeTip:function(a){return function(){$E("newStatusTip").style.display="none";a.href=a.href.split("?")[0]}},updateData:function(a){var b=Lib.LocalDB;var c=this;Lib.checkAuthor();try{if($UID&&$UID==a.uid||b.getServer()==true){c.isHaveNewMessage=false;c.isMessageLoaded=false;c.updateListData(a.data);if(c._newnote>0){v7sendLog("45_01_08_"+$UID);v7sendLog("40_01_08_"+$UID)}if(a.data.nfn>=1){c.initNewStatusTip()}}}catch(d){}if(b.getServer()==true){Lib.checkAuthor();b.sendToClient({data:a.data,uid:$UID});setTimeout(function(){c.requestUICService();c.requestDataInterface()},6e4*4)}else{setTimeout(function(){if(b.getServer()){b.setClientJsFun("$updateData");c.requestUICService();c.requestDataInterface()}},6e4*4)}},initializeList:function(){this.requestUICService();this.checkCache=false},updateListData:function(a){try{var b=0;b+=parseInt(this._getFormatCountString(a["invite"])||0);if(b>500){b="500+"}this.nodes["inviteCount"].innerHTML=b?b:""}catch(c){}try{var b=0;b+=parseInt(this._getFormatCountString(a["message"])||0);if(b>500){b="500+"}this.nodes["messageCount"].innerHTML=b?b:""}catch(c){}try{var b=0;b+=parseInt(a["unreadnotices"]||0);b+=parseInt(a["notice"]||0);if(b>500){b="500+"}this.nodes["sysnoticeCount"].innerHTML=b?b:""}catch(c){}Lib.checkAuthor();try{var b=0;b+=parseInt(this._getFormatCountString(a["gbook"])||0);b+=parseInt(this._getFormatCountString(a["trashwall"])||0);if(b>500){b="500+"}this.nodes["guestBookCount"].innerHTML=b?b:""}catch(c){}try{var b=0;b+=parseInt(a["blogcomment"]||0);b+=parseInt(a["blogrecomment"]||0);b+=parseInt(a["photocomment"]||0);b+=parseInt(a["trashcomment"]||0);if(b>500){b="500+"}this.nodes["commentRelapseCount"].innerHTML=b?b:""}catch(c){}this._newnote=parseInt(a["newnotes"],10);if(this._newnote>0){$E("ccnotepiaohong").innerHTML=this._newnote>500?"500+":this._newnote;$E("ccnotepiaohong").style.display=""}else{$E("ccnotepiaohong").style.display="none"}var d,e=["notice","invite","message","blogcomment","blogrecomment","photocomment","trashcomment","vblogcomment","gbook"],f=e.length;for(d=0;d<f;d++){if(parseInt(a[e[d]])>0){this.isHaveNewMessage=true}var g;for(g in a){if(g!="version"&&window.parseInt(a[g])>0){if($E("left_"+g)){$E("left_"+g).innerHTML="("+a[g]+")"}}}}},requestUICService:function(){Lib.checkAuthor();if(this.isMessageLoaded){this.updateData({data:this._listData});this.onLoaded()}},_getFormatCountString:function(a){var b="";if(!isNaN(parseInt(a))&&parseInt(a)!=0){if(parseInt(a)>500){b="(<strong>500+</strong>)"}else{b=a}}return b},updateView:function(a){this.nodes["newInboxLoding"].style.display=a=="loaded"?"none":"";if(a=="loading"){this.nodes["nomsgli"].style.display="none"}},onLoaded:function(){},onMessageLoad:function(a){$E("loginBarAppMenuLabel").innerHTML=Core.System.htmlFilter(a);$E("noOpenBlogName").innerHTML=Core.System.htmlFilter(a)},bindliEvent:function(){function e(a){var b=a&&a.target||window.event&&window.event.srcElement;if(b&&b.tagName&&(b.tagName.toLowerCase()=="a"||b.tagName.toLowerCase()=="li")&&!b.getAttribute("reject")){v7sendLog("40_01_10_"+$UID);v7sendLog("45_01_11_"+$UID)}}var a=this.nodes["changebgli1"].getElementsByTagName("li");var b=this.nodes["changebgli2"].getElementsByTagName("li");for(var c=0;c<a.length;c++){a[c].style.cursor="pointer";a[c].onmouseover=function(){this._className=this.className;this.className="on"};a[c].onmouseout=function(){this.className=this._className}}for(var c=0;c<b.length-1;c++){if(b[c]==this.nodes["nomsgli"]){continue}b[c].style.cursor="pointer";b[c].onmouseover=function(){this._className=this.className;this.className="on"};b[c].onmouseout=function(){this.className=this._className}}var d=$E("commentdata");if(d){Core.Events.addEvent(d,function(a){e(a)})}Core.Events.addEvent(this.nodes["changebgli1"],function(a){e(a)});Core.Events.addEvent(this.nodes["changebgli2"],function(a){e(a)})}});scope.addArticleTemplate=['<div id="#{panel}" class="wrtBlog_sub" style="z-index:512;">','<div class="wrtBlog_sub2">','<p><img width="15" height="16" align="absmiddle" title="写365" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" class="SG_icon SG_icon138"><a onclick="v7sendLog(\'48_01_18\');v7sendLog(\'40_01_14\');" href="http://control.blog.sina.com.cn/admin/article/article_add.php?tag365" target="_blank">写365</a></p>','<div class="SG_j_linedot"></div>','<p><img class="SG_icon SG_icon88" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" title="长微博" align="absmiddle" /><a target="_blank" onclick="v7sendLog(\'40_01_14\')" href="http://control.blog.sina.com.cn/admin/article/changWeiBo.php">长微博</a></p>','<div class="SG_j_linedot"></div>','<p><img class="SG_icon SG_icon87" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" title="微语录" align="absmiddle" /><a target="_blank" onclick="v7sendLog(\'40_01_14\')" href="http://control.blog.sina.com.cn/weiyulu/weiyulu.php">微语录</a></p>','<div class="SG_j_linedot"></div>','<p><img class="SG_icon SG_icon85" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" title="九宫格" align="absmiddle" /><a target="_blank" onclick="v7sendLog(\'40_01_14\')" href="http://control.blog.sina.com.cn/admin/article/daily.php">九宫格</a></p>','<div class="SG_j_linedot"></div>','<p><img class="SG_icon SG_icon18" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" title="发照片" align="absmiddle" /><a target="_blank" onclick="v7sendLog(\'40_01_14\')" href="http://photo.blog.sina.com.cn/upload/upload.php">发照片</a></p>','<div class="SG_j_linedot"></div>','<p><img class="SG_icon SG_icon16" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" title="发视频" align="absmiddle" /><a target="_blank" onclick="v7sendLog(\'40_01_14\')" href="http://vupload.you.video.sina.com.cn/u.php?m=1">发视频</a></p>','<div id="tray_tbh_ware_linedot" style="display:none;" class="SG_j_linedot"></div>','<p id="tray_tbh_ware_link" style="display:none;"><img class="SG_icon SG_icon150" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" title="发商品" align="absmiddle" /><a target="_blank" onclick="v7sendLog(\'40_01_14\')" href="http://control.blog.sina.com.cn/admin/article/article_add.php?tbh=1">发商品</a></p>',"</div>","</div>"].join("");scope.addArticlePanel=Core.Class.define(function(){Lib.Panel.prototype.initialize.apply(this,arguments);this.setTemplate(scope.addArticleTemplate);this.hidden()},Lib.Panel,{});Core.Events.stopBubble=function(a){var b=a?a:Core.Events.getEvent();if(b!=null){b.cancelBubble=true}};if(!$IE||$IE>8){Core.Events.stopBubble=function(a){var b=a?a:Core.Events.getEvent();if(b!=null){b.stopPropagation()}}}Lib.PlatformTrayPlus=Core.Class.create();Lib.PlatformTrayPlus.prototype={tray:null,subPanels:[],trayLogin:null,initialize:function(){},load:function(a){var b=$E("login_bar_logo_link_350");if(b&&$_GLOBAL&&$_GLOBAL.platformTrayLogo){if(!$IE6&&$_GLOBAL.platformTrayLogo.imgForOtherBrs){b.children[0].src=$_GLOBAL.platformTrayLogo.imgForOtherBrs}else if($_GLOBAL.platformTrayLogo.imgForIE6){b.children[0].src=$_GLOBAL.platformTrayLogo.imgForIE6}}switch(a){case"login":if($E("loginBarOptApp")==null||!$isAdmin){this.render(scope.trayPlusTemplayLogin);trace("++++js渲染 登陆后++++++")}this.initStatic();if(/ipad/i.test(navigator.userAgent)){v7sendLog("48_01_02")}this.setNodesMouseHoverStyle(["loginBarOptApp","loginBarMail","loginBarCenter","loginBarFriend","loginBarInbox"]);this.initNicknamePanel();this.initNewInboxPanel();this.initActivityPanel();var c=this;Utils.Io.JsLoad.request("http://service.mail.sina.com.cn/mailproxy/mail.php",{onComplete:function(){var a=sinamailinfo.email;if(a!=""){c.initMailRemind()}},onException:function(){}});this.initMsnLogout();if(scope&&scope.$private&&scope.$private.msnfeed){var d=this;setTimeout(function(){d.displayUserGuideTips()},1e3)}break;case"logout":this.trayLogin=new Lib.Login.Ui;if($E("phprender")===null){this.render(scope.trayPlusTemplayLogout);trace("-----------js渲染---------")}else{trace("-----------php渲染---------")}this.initLogin();this.initPopularize();break;case"oncelogedon":this.trayLogin=new Lib.Login.Ui;this.render(scope.trayPlusTemplayOnceLoged);this.setNodesMouseHoverStyle(["loginBarOptApp","loginBarMail","loginBarCenter","loginBarFriend","loginBarInbox"]);var e=Lib.Login.info();var f=e&&e.uid;$E("loginBarAppMenuLabel").innerHTML=e&&e.nick;this.initPopularize();this.initOnceLogedEvent(["loginBarOptApp","loginBarMail","loginBarCenter","loginBarFriend","loginBarInbox"],f);this.initOnceLogedTips(f);this.initStatic();break}this.initAddArticlePanel();this.initSearchPanel();this.initFilmSearch()},displayUserGuideTips:function(){function b(){var b=$E("loginBarCenter");if(b){var c=Core.Dom.getXY(b),d=c[0]+b.offsetWidth/2-a.tipsUserGuide.offsetWidth/2+"px",e=c[1]+b.offsetHeight+10+"px"}a.tipsUserGuide.style.left=d;a.tipsUserGuide.style.top=e}if(!window.scope||scope.$pageid==="profile_index"){Utils.Cookie.setCookie($UID+"alreadyVisitProfileIndex","true","86400","/",".sina.com.cn");return}var a=this},initStatic:function(){if(!this._commetTimer){var a=function(){var a=scope.$uid;var b=scope.$articleid||"";Utils.Io.JsLoad.request("http://comet.blog.sina.com.cn/notice",{GET:{uid:a||"",blogid:b},onComplete:function(a){}})};this._commetTimer=setInterval(a,30*1e3);setTimeout(function(){a()},15)}},initFilmSearch:function(){var a=$E("loginBarSearchInput");a&&(a.value="");var b=$E("loginBarSearchSType");b&&(b.value="title")},render:function(a){$E("trayContainer").innerHTML=a},initLogin:function(){var a=this;var b=Core.Dom.getElementsByClass($E("trayContainer"),"span","link")[0];b.onclick=function(){v7sendLog("40_01_15")};Core.Events.addEvent($E("linkTrayLogin"),function(){v7sendLog("40_01_16");if(typeof sinaSSOController!="undefined")sinaSSOController.loginExtraQuery={};a.trayLogin.login(function(){Lib.checkAuthor();var a=$UID==scope.$uid?"02":"01";v7sendLog("87_01_"+a+"_"+$UID,scope.$pageid);setTimeout(function(){window.location=window.location.toString().replace(/#.*/,"")},100)},false,"referer:"+location.hostname+location.pathname+",func:0007")},"click");$E("linkReg").href="http://login.sina.com.cn/signup/signupmail.php?entry=blog&srcuid="+scope.$uid+"&src=blogicp";$E("linkReg").onclick=function(){v7sendLog("40_01_17")};if(scope.$channel){if(scope.$channel==2){$E("linkReg").href="http://login.sina.com.cn/signup/signupmail.php?entry=blog&srcuid="+scope.$uid+"&src=baby"}}},initPopularize:function(){var a=$E("divPopularize");if(a){this.hideActiLink(a);this._loadPopularizeData(a)}},_loadPopularizeData:function(a){Utils.Io.JsLoad.request("http://blog.sina.com.cn/lm/iframe/283/2012/0705/1.js",{charset:"utf-8",onComplete:function(b){var c=$_GLOBAL.popularizeConfig;if(!c||a.innerHTML){return}var d=c.length;var e=Utils.Cookie;var f=parseInt(e.getCookie("blogPopularizeIndex")||0);if(d<=f){f=0}e.setCookie("blogPopularizeIndex",1+f,24,"/",".blog.sina.com.cn");a.innerHTML=c[f];if($E("err_i8t9c")){var g=a.innerText||a.textContent||"";if(g.length>10){a.children[0].innerHTML=g.substr(0,9)+"..."}}}})},setNodesMouseHoverStyle:function(a){var b,c=a.length;for(b=0;b<c;b++){Core.Events.addEvent($E(a[b]),function(b){return function(){Core.Dom.removeClassName($E(a[b]),"current");$E(a[b]).className+=" current"}}(b),"mouseover");Core.Events.addEvent($E(a[b]),function(b){return function(){Core.Dom.removeClassName($E(a[b]),"current")}}(b),"mouseout")}$E("loginBarCenter").onclick=function(){v7sendLog("40_01_05_"+$UID)};$E("loginBarFriend").onclick=function(){v7sendLog("40_01_06_"+$UID)};$E("logOut").onclick=function(){v7sendLog("40_01_11_"+$UID)}},initNicknamePanel:function(){function d(a){function f(){var c=setInterval(function(){var d=$E("loginBarAppMenuLabel").innerHTML;if(d!=="读取中..."){var e=a.offsetLeft+"px";b.style.left=e;trace("刷新msn icon mask");clearInterval(c)}},300)}var b=$C("a");var c=a.parentNode;var d=c.parentNode;var e=$C("img");d.style.position="relative";c.style.position="relative";e.id="msnLoginIcon";e.className="SG_icon SG_icon136";e.src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif";e.style.width="18px";e.style.height="18px";e.align="absmiddle";b.appendChild(e);b.href="http://control.blog.sina.com.cn/blogprofile/msnbind.php?c="+ +(new Date);b.target="_blank";b.style.cssText="display:block; width:18px; height:18px; position:absolute; z-index:1024;";b.style.paddingTop="4px";b.title="MSN账号登录";d.insertBefore(b,d.childNodes[0]);Core.Events.addEvent(window,f,"resize");trace("创建msn icon mask");f();scope.$msnRelocation=f}var a=new scope.NicknamePanel;Lib.checkAuthor();a.initUserInfo($UID);this.addSubPanel(a,$E("loginBarOptApp"),-98,-9);var b=this;if(Utils.Cookie.getCookie("loginFromMsn")&&!$E("msnLoginIcon")){var c=$C("img");c.src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif";c.style.cssFloat=c.style.styleFloat="left";c.width="18";c.height="0";c.style.padding="9px 0";c.align="absmiddle";Core.Dom.insertAfter(c,$E("loginBarAppMenuLabel"));trace("创建msn icon");d(c)}else{trace("不渲染msn icon")}},initAddArticlePanel:function(){var a=new scope.addArticlePanel;this.addSubPanel(a,$E("arrowAddArticle"),-81,0);$E("arrowAddArticle").onclick=function(){v7sendLog("40_01_13_"+($UID?$UID:""))};$E("arrowAddArticle").parentNode.children[0].onclick=function(){v7sendLog("40_01_12_"+($UID?$UID:""))}},showPublishWare:function(a){if(a["tbh_status"]&&parseInt(a["tbh_status"],10)){$E("tray_tbh_ware_linedot").style.display="";var b=$E("tray_tbh_ware_link");b.style.display="";try{var c=$T(b,"a")[0];if(scope&&"editor"==scope.$pageid){c.href="javascript:;";c.target="";c.onclick=function(){var a=$E("shortcut_content");var b=$T(a,"img");for(var c=0;c<b.length;c++){if(-1!=b[c].src.indexOf("element_shop")){Core.Events.click(b[c])}}}}c=null;b=null}catch(d){}}Lib.Listener.off({name:"tray-data-loaded",callBack:this.showPublishWare,scope:this})},initSearchPanel:function(){function e(c){var d=$E("loginBarSearchForm");d.action=a.config[c]["url"];$E("loginBarSearchMenuLabel").innerHTML=b[c].getElementsByTagName("a")[0].innerHTML;var e=$E("loginBarSearchC"),f=$E("loginBarSearchT"),g=$E("loginBarSearchType"),h=$E("loginBarSearchS"),i=$E("loginBarSearchTS"),j=$E("loginBarSearchInput");switch(c){case"all":case"blog":case"bauthor":if(!e){e=$C("input");e.type="hidden";e.name="c";e.id="loginBarSearchC";d.appendChild(e)}e.value="blog";f.value=a.config[c]["range"];f.name="range";g.value=a.config[c]["by"];g.name="by";j.name=a.config[c]["keyName"];break;case"song":case"video":case"vauthor":e&&(e.value="");f.value=a.config[c]["t"];f.name="t";h.value=a.config[c]["s"];i.value=a.config[c]["ts"];g.value=a.config[c]["type"];g.name="type";$E("loginBarSearchSType").value=a.config[c]["stype"];j.name=a.config[c]["keyName"];break}}var a=new scope.SearchPanel;this.addSubPanel(a,$E("searchSelect"),-54,-4);Utils.Form.limitMaxLen($E("loginBarSearchInput"),50);var b=a.getNodes();var c;for(c in a.config){(function(a){Core.Events.addEvent(b[a],function(){e(a)},"click")})(c)}e("blog");$E("searchSelect").onclick=function(){v7sendLog("40_01_18")};var d=Core.Dom.getElementsByClass($E("loginBarSearchForm"),"input","topbar_searchBtn")[0];d.onclick=function(){v7sendLog("40_01_20")};Core.Events.addEvent($E("loginBarSearchInput"),function(a){var b=a.keyCode||a.charCode;if(b==15){v7sendLog("40_01_20")}},"keyup")},hideActiLink:function(a){var b=scope.$pageid;if("pageSetM"!==b&&"editor"!==b){a.style.display="none";a.setAttribute("shouldShow","1")}setTimeout(function(){if(typeof BLOG_AD_TIPS=="undefined"||!BLOG_AD_TIPS){a.style.display="";return}},3e3)},initActivityPanel:function(){if($_GLOBAL){var a=$E("loginBarActivity");if(a){this.hideActiLink(a);this._loadPopularizeData(a)}}if($_GLOBAL.activityBlackList&&$_GLOBAL.activityBlackList[scope.$pageid]){trace("【活动】当前页面在黑名单");return}},initMsnLogout:function(){function h(){(new Interface("http://control.blog.sina.com.cn/blog_rebuild/msn/api/msnLoginOut.php","jsload")).request({onSuccess:function(a){window.location.href="http://login.sina.com.cn/cgi/login/logout.php?r="+g},onError:function(a){window.location.href="http://login.sina.com.cn/cgi/login/logout.php?r="+g},onFail:function(a){window.location.href="http://login.sina.com.cn/cgi/login/logout.php?r="+g}})}var a=$E("openedBlogTray");var b=a.getElementsByTagName("a");var c=b[b.length-1];c.href="#";c.onclick=function(){return false};var d=$E("noOpenedBlogTray");var e=d.getElementsByTagName("a");var f=e[e.length-1];f.href="#";f.onclick=function(){return false};var g=encodeURIComponent(window.location.href);if(a)Core.Events.addEvent(c,h);if(d)Core.Events.addEvent(f,h)},addSubPanel:function(a,b,c,d){function f(){Core.Events.stopEvent();var f,g=e.subPanels.length;for(f=0;f<g;f++){e.subPanels[f].hidden()}a.showWithDom(b,c,d)}var e=this;this.subPanels.push(a);Core.Events.addEvent(b,function(){if(b===$E("loginBarOptApp")){v7sendLog("40_01_01_"+$UID)}f()},"click");Core.Events.addEvent(document.body,function(){a.hidden()},"click");Core.Events.addEvent(a.entity,function(){Core.Events.stopEvent()},"mousedown");Core.Events.addEvent(window,function(){var e=Core.Dom.getLeft(b)+b.offsetWidth+c;var f=Core.Dom.getTop(b)+b.offsetHeight+d;if($IE6&&this.isFixed){e=e-document.documentElement.scrollLeft;f=f-document.documentElement.scrollTop}a.setPosition(e,f)},"resize")},initNewInboxPanel:function(){var a=new scope.NewInboxPanel;this.addSubPanel(a,$E("loginBarInbox"),-137,-9);try{if(!$E("ccnotepiaohong")){var b=$C("div");b.className="imforbox";b.style.display="none";b.id="ccnotepiaohong";$E("loginBarInbox").appendChild(b)}$E("loginBarInbox").className="link imfor"}catch(c){}a.onMessageLoad=function(a){$E("loginBarAppMenuLabel").innerHTML=a;$E("noOpenBlogName").innerHTML=Core.System.htmlFilter(a)}},initMailRemind:function(){function a(){var a=new Interface("http://interface.blog.sina.com.cn/riaapi/profile/unreadmail.php","jsload");a.request({onSuccess:function(a){var b=parseInt(a,10);if(b>99){b="99+"}if(b!==0&&$E("mailpiaohong")){var c=$E("mailpiaohong");c.style.display="";c.innerHTML=b}else{$E("mailpiaohong").style.display="none"}},onError:function(){$E("mailpiaohong").style.display="none"}})}if($E("loginBarMail")&&$E("line")){$E("loginBarMail").style.display="";$E("line").style.display=""}a();var b=setInterval(a,5*60*1e3);Core.Events.addEvent($E("loginBarMail"),function(){v7sendLog("40_01_07_"+$UID);var a=$E("mailpiaohong");var b=!a.style.display;if(b){a.style.display="none"}},"click");Core.Events.addEvent($E("mailpiaohong"),function(){var a=$E("mailpiaohong");a.style.display="none";window.open("http://mail.sina.com.cn/?s=2")},"click")},initOnceLogedEvent:function(a,b){var c,d=a.length;var e=this;for(c=0;c<d;c++){$E(a[c]).onclick=function(){switch(this.id){case"loginBarOptApp":v7sendLog("44_01_07_"+b);break;case"loginBarMail":v7sendLog("44_01_08_"+b);break;case"loginBarCenter":v7sendLog("44_01_09_"+b);break;case"loginBarFriend":v7sendLog("44_01_10_"+b);break;case"loginBarInbox":v7sendLog("44_01_11_"+b);break}if(typeof sinaSSOController!="undefined")sinaSSOController.loginExtraQuery={};e.trayLogin.login(function(){setTimeout(function(){window.location=window.location.toString().replace(/#.*/,"")},100)},false);return false}}},initOnceLogedTips:function(a){var b=this;var c="http://interface.blog.sina.com.cn/riaapi/profile/unread.php";Utils.Io.JsLoad.request(c,{GET:{uid:a,product:"blog"},onComplete:function(c){if(scope.$pageid=="profile_index"||scope.$pageid=="pageSetM"||scope.$pageid=="editor"){return}var d=$E("newStatusTip");if(!d){d=$C("div");d.id="newStatusTip";d.className="tb_layer_Y tb_layer_w3";d.style.width="138px";d.innerHTML=scope.onceLogedStatusTipTemplay;var e=$T($E("loginBarCenter"),"a")[0];var f=Core.Dom.getXY(e);d.style.left=f[0]-(138/2-e.offsetWidth/2)+"px";d.style.top=f[1]+e.offsetHeight+"px";d.style.zIndex="510";d.style.display="none";document.body.appendChild(d)}if(c.data.unreadnotes>=1){v7sendLog("44_01_12_"+a);d.style.display="block";$E("nstUnread").style.display="block";$E("nstUnread").onclick=function(){v7sendLog("44_01_13_"+a);if(typeof sinaSSOController!="undefined")sinaSSOController.loginExtraQuery={};b.trayLogin.login(function(){setTimeout(function(){window.location="http://i.blog.sina.com.cn/blogprofile/profilelatestnote.php"},100)},false);return false}}else if(c.data.nfn>=1){v7sendLog("44_01_14_"+a);d.style.display="block";$E("nstFeed").style.display="block";$E("nstFeed").onclick=function(){v7sendLog("44_01_15_"+a);if(typeof sinaSSOController!="undefined")sinaSSOController.loginExtraQuery={};b.trayLogin.login(function(){setTimeout(function(){window.location="http://i.blog.sina.com.cn/blogprofile/index.php?type=3&from=newstatus&com=2"},100)},false);return false}}Core.Events.addEvent(window,function(){var a=$T($E("loginBarCenter"),"a")[0];var b=Core.Dom.getXY(a);d.style.left=b[0]-(138/2-a.offsetWidth/2)+"px";d.style.top=b[1]+a.offsetHeight+"px"},"resize")},onException:function(a){}})}};$registJob("tray",function(){Lib.Listener.add("tray-data-loaded");Lib.checkAuthor();var a;var b=$E("login_bar_logo_link_350");var c="ntopbar_main"===b.parentNode.className;if(c){a=Lib.TrayPanel()}else{a=new Lib.PlatformTrayPlus}var d=Lib.Login.info();var e=d.uid;window.$onceLog=false;var f=unescape(Utils.Cookie.getCookie("onceloggedonblog"));if(f&&e){time=f;var g=(new Date).getTime();if(time&&g>time){$onceLog=true}}if($isLogin){a.load("login")}else if(!c&&$onceLog){a.load("oncelogedon")}else{a.load("logout")}window.$tray={};window.$tray.renderLogin=function(){Lib.checkAuthor();if($isLogin){a.load("login")}};window.$tray.renderLogout=function(){a.load("logout")}});$registJob("login",function(){var a=new Lib.Login.Ui;Core.Events.addEvent("loginbtn",function(){a.login(function(){alert("做一些，登陆之后，做的事情，呵呵！")})})});Lib.insertMoban=function(){if(scope.tpl&&scope.tpl!=""&&(scope.tpl.split("_")[0]=="13"||$_GLOBAL.flashtemplate[scope.tpl])){Lib.insertMobanFunc(scope.tpl)}};Lib.insertMobanFunc=function(a){var b=$E("headflash");if(b){b.innerHTML="";b.style.display="";var c="http://simg.sinajs.cn/blog7newtpl/css/"+a.split("_")[0]+"/"+a+"/top.swf";var d=950,e=266;if($_GLOBAL.flashtemplate[a].width){d=$_GLOBAL.flashtemplate[a].width}if($_GLOBAL.flashtemplate[a].height){e=$_GLOBAL.flashtemplate[a].height}trace("flash height="+e);var f=Utils.Flash.swfView.Add(c,"headflash","headflash_f",d,e,"9.0.0.0","#000",{},{allowScriptAccess:"false",wmode:"transparent",allowFullScreen:"false"})}};Lib.tplFuncArr={};Lib.tplFuncCount=0;Lib.getTplNum=function(a){Lib.tplFuncArr[Lib.tplFuncCount++]=a||function(){};if($isAdmin&&scope.tpl&&scope.tpl!=""){for(var b in Lib.tplFuncArr){Lib.tplFuncArr[b]();Lib.tplFuncArr[b]=null;delete Lib.tplFuncArr[b]}return}else{if($IE){var c=document.styleSheets;var d=/\S*(blog7tpl([^t]*))\S*/gi;var e=/\S*(blog7newtpl\/css([^t]*))\S*/gim;for(var f=0;f<c.length;f++){if(c[f].id=="uid_link_css"){var g=d.exec(c[f].cssText);var h=e.exec(c[f].cssText);if(g!=null||h!=null){if(g!=null){scope.tpl=g[2].split("/")[2]}else if(h!=null){scope.tpl=h[2].split("/")[2]}}break}}for(var b in Lib.tplFuncArr){Lib.tplFuncArr[b]();Lib.tplFuncArr[b]=null;delete Lib.tplFuncArr[b]}}else if(!$IE&&scope.$PRODUCT_NAME=="blog7"){for(var b in Lib.tplFuncArr){Lib.tplFuncArr[b]();Lib.tplFuncArr[b]=null;delete Lib.tplFuncArr[b]}return;Utils.Io.Ajax.request("http://blog.sina.com.cn/s/"+scope.$uid+".css?",{onComplete:function(a){a=a.replace("\n","");var b=/\S*(blog7tpl([^t]*))\S*/gim;var c=/\S*(blog7newtpl\/css([^t]*))\S*/gim;var d=b.exec(a);var e=c.exec(a);if(d!=null||e!=null){if(d!=null){scope.tpl=d[2].split("/")[2]}else if(e!=null){scope.tpl=e[2].split("/")[2]}}for(var f in Lib.tplFuncArr){Lib.tplFuncArr[f]();Lib.tplFuncArr[f]=null;delete Lib.tplFuncArr[f]}}.bind2(this),returnType:"txt"})}else if(!$IE&&scope.$PRODUCT_NANM!="blog7"){Utils.Io.JsLoad.request("http://blog.sina.com.cn/s/"+scope.$uid+".js",{GET:{tm:(new Date).getTime()},onComplete:function(){for(var a in Lib.tplFuncArr){Lib.tplFuncArr[a]();Lib.tplFuncArr[a]=null;delete Lib.tplFuncArr[a]}}.bind2(this)})}}};$registJob("getTplNum",function(){});(function(){var getImgStaticPath=function(pid,type){if(!pid){return""}var type=type||"orignal";try{var num=eval("0X"+pid.substring(pid.length-2))%16+1;return"http://s"+num+".sinaimg.cn/"+type+"/"+pid}catch(e){trace("图片URL计算出错！PID:"+pid);return""}};window.getImgStaticPath=getImgStaticPath})();Utils.insertTemplate=function(a,b,c){var d=[],e={},f=/#{(\w+)}/g,g="_"+(new Date).getTime().toString().slice(-5)+Math.floor(Math.random()*1e5);b=b.replace(f,function(a,b){d.push(b);return b+g});Core.Dom.insertHTML(a,b,c);for(var h=d.length,i;h--;){i=d[h];e[i]=$E(i+g)}return e};$registJob("articleShare",function(){if(!$E("t_"+scope.$articleid)){trace("应该是私密博文");return}var a="javascript:void((function(s,d,e,r,l,p,t,z,c,w){var%20f='http://v.t.sina.com.cn/share/share.php?',u=z||d.location,p=['url=',e(u),'&title=',e(t||d.title),'&source=',e(r),'&sourceUrl=',e(l),'&content=',c||'gb2312','&pic=',e(p||''),'&ralateUid=',w].join('');function%20a(){if(!window.open([f,p].join(''),'mb',['toolbar=0,status=0,resizable=1,width=440,height=430,left=',(s.width-440)/2,',top=',(s.height-430)/2].join('')))u.href=[f,p].join('');};if(/Firefox/.test(navigator.userAgent))setTimeout(a,0);else%20a();})(screen,document,encodeURIComponent,'新浪-博客','http://blog.sina.com.cn','"+(scope.$album_pic?getImgStaticPath(scope.$album_pic,"bmiddle"):"")+"','分享"+scope.owenerNickName+"的博文："+$E("t_"+scope.$articleid).innerHTML.replace(/'/g,"\\'")+" 推荐给@头条博客"+"','http://blog.sina.com.cn/s/blog_"+scope.$articleid+".html','utf-8','1231759973'));";a=Core.String.decodeHTML(a);if($E("shareminiblogfromblogatarticlepage")){Lib.Uic.getNickName([scope.$uid],function(b){var c=b[scope.$uid]||"";c=Core.String.encodeHTML(c);scope.owenerNickName=c;$E("shareminiblogfromblogatarticlepage").href=a})}if($_GLOBAL.diggerOpenFlag){var b=$E("sharewb"),c=$E("shareqing"),d=$E("sharemail");if(b){b.href=a;Core.Events.addEvent(b,function(){v7sendLog("80_01_04")})}if(!c&&b){c=$C("a");c.href="javascript:;";c.innerHTML='<img width="18" height="18" align="absmiddle" title="分享到新浪Qing" alt="" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" class="SG_icon SG_icon205" />';b.parentNode.appendChild(c)}if(c){c.onclick=function(){var a=$E("t_"+scope.$articleid).innerHTML,b=[],c=$T($E("sina_keyword_ad_area2"),"img");if(a.length>120){a=a.substr(0,120)+"…"}for(var d=0,e=Math.min(20,c.length);d<e;d++){b.push(c[d].src||c[d].real_src)}var f=$_GLOBAL.qingURL+"blog/controllers/share.php?searchPics=0&content="+encodeURIComponent("分享"+scope.owenerNickName+"的博文《"+a+"》，查看原文：")+"&url="+encodeURIComponent(location.href)+"&ralateNick="+encodeURIComponent("新浪博客")+"&pics="+encodeURIComponent(b.join(","));window.open(f,"shareQing","toolbar=0,status=0,resizable=1,width=600,height=520,left="+(screen.width-600)/2+",top="+(screen.height-520)/2);v7sendLog("80_01_01");return false}}if(!d&&c){var e='<a href="javascript:;" id="sharemail"><img width="16" height="16" align="absmiddle" title="分享到新浪邮箱" alt="" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" class="SG_icon SG_icon211"></a>';Utils.insertTemplate(c,e,"AfterEnd");d=$E("sharemail")}if(d){if(!scope.$rank||!scope.totalPv){var f=setInterval(g,300);function g(){var a=scope.$rank;var b=scope.totalPv;if(a&&b){clearInterval(f)}}}d.onclick=function(){if($isLogin){var a="http://mail.sina.com.cn/share/mail.php?"+"aid="+encodeURIComponent(scope.$articleid)+"&bl="+encodeURIComponent(scope.$rank)+"&ba="+encodeURIComponent(scope.totalPv);window.open(a,"shareMail","toolbar=0,status=0,scrollbars=1,resizable=1,width=970,height=630,left="+(screen.width-970)/2+",top="+(screen.height-630)/2);return false}else{var b=new Lib.Login.Ui;b.login(function(){var a="http://mail.sina.com.cn/share/mail.php?"+"aid="+encodeURIComponent(scope.$articleid)+"&bl="+encodeURIComponent(scope.$rank)+"&ba="+encodeURIComponent(scope.totalPv);window.open(a,"shareMail","toolbar=0,status=0,scrollbars=1,resizable=1,width=970,height=630,left="+(screen.width-970)/2+",top="+(screen.height-630)/2);return false})}}}if($E("sharexn")){$E("sharexn").href="javascript:u='http://share.xiaonei.com/share/buttonshare.do?link='+location.href+'&title='+encodeURIComponent(document.title);window.open(u,'xiaonei','toolbar=0,resizable=1,scrollbars=yes,status=1,width=626,height=436');void(0)";Core.Events.addEvent($E("sharexn"),function(){v7sendLog("80_01_07")})}if($E("sharedb")){$E("sharedb").href="http://www.douban.com/recommend/?url="+window.location.href+"&title="+encodeURIComponent(document.title)+";window.open(u,'douban','toolbar=0,resizable=1,scrollbars=yes,status=1,width=450,height=330');void(0)";Core.Events.addEvent($E("sharedb"),function(){v7sendLog("80_01_08")})}if($E("sharekx")){$E("sharekx").href="javascript:d=document;t=d.selection?(d.selection.type!='None'?d.selection.createRange().text:''):(d.getSelection?d.getSelection():'');void(kaixin=window.open('http://www.kaixin001.com/~repaste/repaste.php?&rurl='+escape(d.location.href)+'&rtitle='+escape('"+document.title+"')+'&rcontent='+escape('"+document.title+"'),'kaixin'));kaixin.focus();";Core.Events.addEvent($E("sharekx"),function(){v7sendLog("80_01_06")})}var h=$E("sharemsn");if(h){var i=[];i.push("url="+encodeURIComponent("http://blog.sina.com.cn/s/blog_"+scope.$articleid+".html"));var j=$E("t_"+scope.$articleid);if($IE){j=j.innerText}else{j=j.textContent}i.push("title="+encodeURIComponent(j));var k=scope.$album_pic?getImgStaticPath(scope.$album_pic,"bmiddle"):"http://portrait"+(parseInt(scope.$uid)%8+1)+".sinaimg.cn/"+scope.$uid+"/blog/180";i.push("screenshot="+encodeURIComponent(k));var l=$E("sina_keyword_ad_area2");if(l){if($IE){l=l.innerText}else{l=l.textContent}l=l.replace(/\n/ig,"");l=l.replace(/^\s\s*/,"");var m=/\s/;var n=l.length;while(m.test(l.charAt(--n)));i.push("description="+encodeURIComponent(l.substring(0,101)))}h.href="http://profile.live.com/badge/?"+i.join("&");h.target="_blank";Core.Events.addEvent(h,function(){v7sendLog("80_01_05")})}}if($E("moreshares")){Core.Events.addEvent($E("moreshares"),function(){if($E("sharelayer")){if($E("sharelayer").style.display=="none"){var b=Core.Events.fixEvent(Core.Events.getEvent());var c=Core.Dom.getXY($E("moreshares"));$E("sharelayer").style.left=c[0]-45+"px";$E("sharelayer").style.top=c[1]+15+"px";$E("sharelayer").style.display=""}else{}}else{var d='<div id="sharelayer" style="z-index:100;width:120px;" class="tb_layer_Y tb_layer_w2">'+'<div class="tb_layer_arrow"></div>'+'<div class="tb_layer_Y_main" >'+'<div class="tb_ps_share" style="width:96px;">'+'<span class="share"><a id="sharewb" href="#" title="分享到新浪微博"><img height="16" align="absmiddle" width="16" title="微博" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" class="SG_icon SG_icon51"></a></span>'+'<span class="share"><a id="sharexn" href="#" title="分享到人人"><img height="16" align="absmiddle" width="16" title="人人" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" class="SG_icon SG_icon113"></a></span>'+'<span class="share"><a id="sharedb" target="_blank" href="#" title="分享到豆瓣"><img height="16" align="absmiddle" width="16" title="豆瓣" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" class="SG_icon SG_icon116"></a></span>'+'<span class="share"><a id="sharekx" href="#" title="分享到开心001"><img height="16" align="absmiddle" width="16" title="开心001" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" class="SG_icon SG_icon117"></a></span>'+'<div class="clearit"></div>'+"</div>"+"</div>"+"</div>";Core.Dom.insertHTML(document.body,d,"beforeend");var b=Core.Events.fixEvent(Core.Events.getEvent());var c=Core.Dom.getXY($E("moreshares"));$E("sharelayer").style.left=c[0]-45+"px";$E("sharelayer").style.top=c[1]+15+"px";$E("sharewb").href=a;$E("sharexn").href="javascript:u='http://share.xiaonei.com/share/buttonshare.do?link='+location.href+'&title='+encodeURIComponent(document.title);window.open(u,'xiaonei','toolbar=0,resizable=1,scrollbars=yes,status=1,width=626,height=436');void(0)";$E("sharedb").href="http://www.douban.com/recommend/?url="+window.location.href+"&title="+encodeURIComponent(document.title)+";window.open(u,'douban','toolbar=0,resizable=1,scrollbars=yes,status=1,width=450,height=330');void(0)";$E("sharekx").href="javascript:d=document;t=d.selection?(d.selection.type!='None'?d.selection.createRange().text:''):(d.getSelection?d.getSelection():'');void(kaixin=window.open('http://www.kaixin001.com/~repaste/repaste.php?&rurl='+escape(d.location.href)+'&rtitle='+escape('"+document.title+"')+'&rcontent='+escape('"+document.title+"'),'kaixin'));kaixin.focus();";Core.Events.addEvent($E("sharelayer"),function(){var a=Core.Events.fixEvent(Core.Events.getEvent());var b=Core.Dom.getXY($E("sharelayer"));var c=Core.System.getScrollPos(document);var d=b[0];var e=b[1];var f=c[1]+a.clientX;var g=c[0]+a.clientY;if(f>=d+116||f<=d||g>=e+42||g<=e){$E("sharelayer").style.display="none"}},"mouseout")}},"mouseover")}var o=function(){var a=['<div class="layer_weimi">','<a href="javascript:;" class="close" id="weimiShareClose"></a>','<div class="title">微米分享</div>','<ol class="list">','<li class="step code"><img id="weimiQRCode" alt="二维码" /></li>','<li class="step step1">','<div class="pic"><img src="http://simg.sinajs.cn/blog7style/images/common/weimilayer/1.jpg" alt="步骤一" /></div>','<div class="desc"><span class="num">1</span><span class="txt">微米扫描左侧二维码</span></div>',"</li>",'<li class="step step2">','<div class="pic"><img src="http://simg.sinajs.cn/blog7style/images/common/weimilayer/2.jpg" alt="步骤二" /></div>','<div class="desc"><span class="num">2</span><span class="txt">点击右上角的分享按钮</span></div>',"</li>",'<li class="step step3">','<div class="pic"><img src="http://simg.sinajs.cn/blog7style/images/common/weimilayer/3.jpg" alt="步骤三" /></div>','<div class="desc"><span class="num">3</span><span class="txt">选择分享给朋友</span></div>',"</li>","</ol>","</div>"].join("");var b={},c={};var d,e,f,g="http://comet.blog.sina.com.cn/qr?"+location.href.replace(/[#?](.*)/,"");c.init=function(){f=$E("shareweimi");if(!f){b.createShareNode()}Core.Events.addEvent(f,b.showLayer,"click");Core.Events.addEvent(window,b.resizeLayer,"resize")};b.createShareNode=function(a){var b=$E("shareqing").parentNode,c=$E("shareqing"),d;d=$C("a");d.id="shareweimi";d.innerHTML='<img width="51" height="16" align="absmiddle" title="分享到微米" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" class="SG_icon SG_icon213">';b.insertBefore(d,c);f=$E("shareweimi")};b.createShareLayer=function(){var c=$C("div");c.id="weimiShareLayer";c.innerHTML=a;document.body.appendChild(c);$E("weimiQRCode").src=g;d=$E("weimiShareLayer");e=$E("weimiShareClose");Core.Events.addEvent(e,b.hideLayer,"click")};b.showLayer=function(){d=$E("weimiShareLayer");if(!d){b.createShareLayer()}b.setPos();d.style.display="";return false};b.hideLayer=function(){d&&(d.style.display="none");return false};b.resizeLayer=function(){if(!d){return}if(d.style.display=="none"){return}b.setPos()};b.setPos=function(){var a=document.documentElement.clientHeight||document.body.clientHeight;var b=document.documentElement.clientWidth||document.body.clientWidth;var c=586;d.style.position=$IE6?"absolute":"fixed";d.style.left=Math.abs(b-c)/2+"px";d.style.zIndex="1025";if($IE6){d.style.top=document.documentElement.scrollTop+50+"px"}else{d.style.top=50+"px"}};return c};var p=o();p.init();var q=function(){var a={},b={},c;b.init=function(){c=$E("shareweibo");if(c){Core.Events.addEvent(c,a.clickHandle,"click")}};a.clickHandle=function(){var a=$E("t_"+scope.$articleid).innerHTML,b=$E("sina_keyword_ad_area2"),c;if(a.length>60){a=a.substr(0,60)+"..."}if(typeof b.innerText==="string"){c=b.innerText}else{c=b.textContent}c=c.replace(/\s+/g,"");if(c.length>60){c=c.substr(0,60)+"..."}var d="http://service.weibo.com/share/share.php?appkey=&title="+encodeURIComponent("分享自"+scope.owenerNickName+" 《"+a+"》 -    ")+encodeURIComponent(c)+encodeURIComponent(" (来自 @头条博客) - ")+"&url="+encodeURIComponent(window.location.href)+"&source=blog&retcode=0&ralateUid=";window.open(d,"","toolbar=0,status=0,resizable=1,scrollbars=1,width=634,height=634,left="+(screen.width-634)/2+",top="+(screen.height-634)/2);return false};return b};var r=q();r.init()});$registJob("recordVisitor",function(){Lib.checkAuthor();if($isLogin&&!$isAdmin){(function(){if(scope.unreadMsg){if(!scope.unreadMsg.foot){scope.unreadMsg.foot=0}if(!(scope.unreadMsg.foot*1)){var a={pid:1,uid:scope.$uid};if(typeof scope.$articleid!="undefined"){a.subid=scope.$articleid}Utils.Io.JsLoad.request("http://footprint.cws.api.sina.com.cn/add.php",{GET:a})}}else{setTimeout(arguments.callee,200)}})()}});Utils.text2Copy=function(a){var b=function(){var a=navigator.mimeTypes&&navigator.mimeTypes["application/x-shockwave-flash"]?navigator.mimeTypes["application/x-shockwave-flash"].enabledPlugin:0;if(a){var b=navigator.plugins["Shockwave Flash"].description.split(" ");for(var c=0;c<b.length;++c){if(isNaN(parseInt(b[c],10))){continue}var d=b[c]}return d>=10}else if($IE){try{new ActiveXObject("ShockwaveFlash.ShockwaveFlash.10");return true}catch(e){return false}}};if(window.clipboardData&&$IE6){window.clipboardData.clearData();return window.clipboardData.setData("Text",a)}else{if(b()){if($IE){try{window.clipboardData.clearData();return window.clipboardData.setData("Text",a)}catch(c){return false}}try{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");var d=Components.classes["@mozilla.org/widget/clipboard;1"].createInstance(Components.interfaces.nsIClipboard);if(!d){return}var e=Components.classes["@mozilla.org/widget/transferable;1"].createInstance(Components.interfaces.nsITransferable);if(!e){return}e.addDataFlavor("text/unicode");var f={};var g={};f=Components.classes["@mozilla.org/supports-string;1"].createInstance(Components.interfaces.nsISupportsString);var h=a;f.data=h;e.setTransferData("text/unicode",f,h.length*2);var i=Components.interfaces.nsIClipboard;if(!d){return false}d.setData(e,null,i.kGlobalClipboard);return true}catch(c){return false}}else{var j="flashcopier";if(!$E(j)){var k=$C("div");k.id=j;document.body.appendChild(k)}a=a.replace(/%/g,escape("%")).replace(/&/g,escape("&"));var l='<embed src="http://simg.sinajs.cn/blog7common/clipboard.swf" FlashVars="clipboard='+a+'" width="0" height="0" type="application/x-shockwave-flash"></embed>';$E(j).innerHTML=l;return true}}};Lib.subscribe=Core.Class.create();Lib.subscribe.prototype={initialize:function(){this.createDlg()},createDlg:function(){var a="http://blog.sina.com.cn/rss/"+scope.$uid+".xml";var b=['<div id="rssDy"></div>'];b.push('<div class="clearit"></div></div><table><tr><th scope="row">订阅地址：</th><td><input type="text" id="subscribeText" class="SG_input" value="" /><a class="SG_aBtn SG_aBtnB" href="javascript:;" onclick="return false;"><cite id="subscribeCopy">复制</cite></a></td></tr><tr><th scope="row"></th><td>如果还没有RSS阅读器，请<strong><a href="http://down.tech.sina.com.cn/content/3034.html" target="_blank">立即下载</a></strong>。 </td></tr></table>');b=b.join("");var c=['<table id="#{entity}" class="CP_w">','<thead id="#{titleBar}">',"<tr>",'<th class="tLeft"><span></span></th>','<th class="tMid">','<div class="bLyTop">','<strong id="#{titleName}"></strong>','<cite style="width:100px;"><a href="http://www.sina.com.cn/ddt/rsshelp.html" target="_blank">什么是RSS?</a><a title="关闭" class="CP_w_shut" id="#{btnClose}" href="javascript:;">关闭</a></cite>',"</div>","</th>",'<th class="tRight"><span></span></th>',"</tr>","</thead>","<tfoot>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid"><span></span></td>','<td class="tRight"><span></span></td>',"</tr>","</tfoot>","<tbody>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid">','<div class="CP_layercon2 rssLayer" id="#{content}">',"</div>","</td>",'<td class="tRight"><span></span></td>',"</tr>","</tbody>","</table>"].join("");this._dialog=winDialog.createCustomsDialog({tpl:c,title:"RSS订阅",content:b,width:415,height:104},"tips");$E("subscribeText").value=a;this.bindEvent()},bindEvent:function(){var a=this;Core.Events.addEvent($E("subscribeCopy"),function(){var b=Utils.text2Copy($E("subscribeText").value);if(b==true)winDialog.alert("复制成功",{funcOk:function(){a._dialog.hidden()},icon:"03"})})},show:function(){var a=function(){if($_GLOBAL.rssIcons){var a=scope.$uid;if($_GLOBAL.rssMethod){a=scope[$_GLOBAL.rssMethod]}var b="http://blog.sina.com.cn/rss/"+a+".xml";var c=['<div class="rss_title"><strong>在线阅读器直接订阅：</strong></div><div class="rss_list" style="display:inline-block;">'];for(var d=0;$_GLOBAL.rssIcons[d];d++){var e=$_GLOBAL.rssIcons[d];if(e.cls==="rss_shiye"){b=a+"&sub=1"}c.push('<span><a target="_blank" href="');c.push(e.href);if(e.encode){c.push(encodeURIComponent(b))}else{c.push(b)}c.push('" class="');c.push(e.cls);c.push('" title="');c.push(e.title);c.push('"></a></span>')}c.push('<span class="news"><img width="15" height="15" align="top" class="SG_icon SG_icon11" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" title="新"></span>');$E("rssDy").innerHTML=c.join("")}};this._dialog.show();this._dialog.setAreaLocked(true);this._dialog.setMiddle();if($_GLOBAL.rssIcons){a()}else{Utils.Io.JsLoad.request("http://sjs.sinajs.cn/blog7common/conf/rss_conf.js",{onComplete:function(){a()},noreturn:true,isRemove:false})}},hidden:function(){this._dialog.hidden()}};$registJob("subscribe",function(){Core.Events.addEvent($E("SubscribeNewRss"),function(){if(!window.mySubscribe)window.mySubscribe=new Lib.subscribe;window.mySubscribe.show()})});$registJob("updownurl",function(){var a=$E("new_nextprev_"+scope.$articleid);if(!a){Lib.checkAuthor();if(scope.$pn_x_rank=="1"&&!$isAdmin){return false}var b=$E("nextprev_"+scope.$articleid);var c=new Interface("http://blogtj.sinajs.cn/api/get_prevnext_article.php","jsload");var d=$E("t_"+scope.$articleid).parentNode;var e=Core.Dom.getChildrenByClass(d,"time")[0].innerHTML;e=e.replace("(","").replace(")","");c.request({GET:{uid:scope.$uid,blog_id:scope.$articleid,varname:"prevnext",blog_pubdate:e,pn_x_rank:scope.$pn_x_rank},onSuccess:function(a){var c="";if(a.prev!=null){c+='<div><span class="SG_txtb">前一篇：</span><a href="'+a.prev.blog_url+'">'+a.prev.blog_title+"</a></div>"}if(a.next!=null){c+='<div><span class="SG_txtb">后一篇：</span><a href="'+a.next.blog_url+'">'+a.next.blog_title+"</a></div>"}b.innerHTML=c},onError:function(){}})}});Lib.AudioCheck={};var random="";if(window.$Maxthon||window.$360||window.$TT){random="?t="+(new Date).getTime()}Lib.AudioCheck.swfUrl=$_GLOBAL.flashBasicURL+"mp3.swf"+random;Lib.AudioCheck.soundUrl="http://interface.blog.sina.com.cn/riaapi/cksound/cksound.php";Lib.AudioCheck.render=function(a,b){$E(a).innerHTML='		<a style="margin-left:3px;" id="comment_get_vcode" href="javascript:;" onclick="Lib.AudioCheck.callAudioCheck();return false;">收听验证码</a>		<img id="play_img" name="play_img" src="http://image2.sina.com.cn/blog/tmpl/v3/images/blank.gif" align="absmiddle" style="margin-right:2px;" height="15">		<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=5,0,0,0" width="0" height="0" id="mp3_player" align="middle">		<param name="allowScriptAccess" value="always" />		<param name="movie" value="'+this.swfUrl+'" />		<param name="quality" value="high" />		<param name="bgcolor" value="#ffffff" />		<param name="FlashVars" value="mp3URL='+b+'" />		<embed src="'+this.swfUrl+'" FlashVars="mp3URL='+b+'" quality="high" bgcolor="#ffffff" width="0" height="0" name="mp3_player" swLiveConnect="true" align="middle" allowScriptAccess="always" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer"/>		</object>	'};Lib.AudioCheck.callAudioCheck=function(){setTimeout(function(){$E("play_img").src="http://blogimg.sinajs.cn/v5images/play_img.gif";window.document.mp3_player.SetVariable("isPlay","1");$E("login_check").value="";$E("login_check").focus()},500);Utils.Io.JsLoad.request("http://hits.blog.sina.com.cn/hits?act=3&uid=00000203",{onComplete:function(){}})};$registJob("audioCheck",function(){if(!$E("article_comment_list")){return}if(scope.$private.cms!=1&&scope.$isCommentAllow!=1){var a=$E("comment_get_vcode");var b=Core.Dom.wrap(a,"span");if(b){Lib.AudioCheck.render(b,Lib.AudioCheck.soundUrl+"?"+(new Date).getTime())}}});Lib.RandomStroll=Core.Class.create();Lib.RandomStroll.prototype={link_url:null,swf_url:$_GLOBAL.flashBasicURL+"lookViewSpring.swf?2",initialize:function(a){this.link_url=a&&a[Math.floor(Math.random()*a.length)];var b=SinaEx.createNode('<div id="ramdomVisitDiv" style="position:absolute;width:140px;z-index:101;"></div>');b.style.top=scope._AD_HEIGHT?scope._AD_HEIGHT+30+"px":"30px";document.body.appendChild(b);this.div=b;this.lock();Core.Events.addEvent(window,function(){this.lock()}.bind2(this),"resize");Core.Events.addEvent(window,function(){this.lock()}.bind2(this),"scroll")},load:function(a){Utils.Flash.swfView.Add(this.swf_url,"ramdomVisitDiv","map","140","87","8.0.0.0","#000",{url:this.link_url},{scale:"noscale",allowScriptAccess:"always",wmode:"transparent"})},lock:function(){this.div.style.right="0px"},show:function(){$E("ramdomVisitDiv").style.display=""},hide:function(){$E("ramdomVisitDiv").style.display="none"}};$registJob("randomScroll",function(){Utils.Io.JsLoad.request("http://blog.sina.com.cn/lm/rndurllist.js",{onComplete:function(){if(typeof RND_URL_LIST==="undefined"||!RND_URL_LIST||!RND_URL_LIST.length){return}var a=new Lib.RandomStroll(RND_URL_LIST);a.load({target:"_self",URL:""})}})});if(typeof sina!="object"){var sina={}}sina.$=function(a){if(!a){return null}return document.getElementById(a)};var sinaFlash=function(a,b,c,d,e,f,g,h,i,j,k){var l=this;if(!document.createElement||!document.getElementById){return}l.id=b?b:"";var m=function(a,b){for(var c=0;c<a.length;c++){if(a[c]==b){return c}}return-1},n="8.0.42.0";if(m(["eladies.sina.com.cn","ent.sina.com.cn"],document.domain)>-1){l.ver=n}else{l.ver=e?e:n}l.ver=l.ver.replace(/\./g,",");l.__classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000";l.__codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version="+l.ver;l.width=c;l.height=d;l.movie=a;l.src=l.movie;l.bgcolor=f?f:"";l.quality=h?h:"high";l.__pluginspage="http://www.macromedia.com/go/getflashplayer";l.__type="application/x-shockwave-flash";l.useExpressInstall=typeof g=="boolean"?g:false;l.xir=i?i:window.location;l.redirectUrl=j?j:window.location;l.detectKey=typeof k=="boolean"?k:true;l.escapeIs=false;l.__objAttrs={};l.__params={};l.__embedAttrs={};l.__flashVars=[];l.__flashVarsStr="";l.__forSetAttribute("id",l.id);l.__objAttrs["classid"]=l.__classid;l.__forSetAttribute("codebase",l.__codebase);l.__forSetAttribute("width",l.width);l.__forSetAttribute("height",l.height);l.__forSetAttribute("movie",l.movie);l.__forSetAttribute("quality",l.quality);l.__forSetAttribute("pluginspage",l.__pluginspage);l.__forSetAttribute("type",l.__type);l.__forSetAttribute("bgcolor",l.bgcolor)};sinaFlash.prototype={getFlashHtml:function(){var a=this,b="<object ";for(var c in a.__objAttrs){b+=c+'="'+a.__objAttrs[c]+'"'+" "}b+=">\n";for(var c in a.__params){b+='	<param name="'+c+'" value="'+a.__params[c]+'" />\n'}if(a.__flashVarsStr!=""){b+='	<param name="flashvars" value="'+a.__flashVarsStr+'" />\n'}b+="	<embed ";for(var c in a.__embedAttrs){b+=c+'="'+a.__embedAttrs[c]+'"'+" "}b+="></embed>\n</object>";return b},__forSetAttribute:function(a,b){var c=this;if(typeof a=="undefined"||a==""||typeof b=="undefined"||b==""){return}a=a.toLowerCase();switch(a){case"classid":break;case"pluginspage":c.__embedAttrs[a]=b;break;case"onafterupdate":case"onbeforeupdate":case"onblur":case"oncellchange":case"onclick":case"ondblClick":case"ondrag":case"ondragend":case"ondragenter":case"ondragleave":case"ondragover":case"ondrop":case"onfinish":case"onfocus":case"onhelp":case"onmousedown":case"onmouseup":case"onmouseover":case"onmousemove":case"onmouseout":case"onkeypress":case"onkeydown":case"onkeyup":case"onload":case"onlosecapture":case"onpropertychange":case"onreadystatechange":case"onrowsdelete":case"onrowenter":case"onrowexit":case"onrowsinserted":case"onstart":case"onscroll":case"onbeforeeditfocus":case"onactivate":case"onbeforedeactivate":case"ondeactivate":case"codebase":c.__objAttrs[a]=b;break;case"src":case"movie":c.__embedAttrs["src"]=b;c.__params["movie"]=b;break;case"width":case"height":case"align":case"vspace":case"hspace":case"title":case"class":case"name":case"id":case"accesskey":case"tabindex":case"type":c.__objAttrs[a]=c.__embedAttrs[a]=b;break;default:c.__params[a]=c.__embedAttrs[a]=b}},__forGetAttribute:function(a){var b=this;a=a.toLowerCase();if(typeof b.__objAttrs[a]!="undefined"){return b.__objAttrs[a]}else if(typeof b.__params[a]!="undefined"){return b.__params[a]}else if(typeof b.__embedAttrs[a]!="undefined"){return b.__embedAttrs[a]}else{return null}},setAttribute:function(a,b){this.__forSetAttribute(a,b)},getAttribute:function(a){return this.__forGetAttribute(a)},addVariable:function(a,b){var c=this;if(c.escapeIs){a=escape(a);b=escape(b)}if(c.__flashVarsStr==""){c.__flashVarsStr=a+"="+b}else{c.__flashVarsStr+="&"+a+"="+b}c.__embedAttrs["FlashVars"]=c.__flashVarsStr},getVariable:function(a){var b=this,c=b.__flashVarsStr;if(b.escapeIs){a=escape(a)}var d=(new RegExp(a+"=([^\\&]*)(\\&?)","i")).exec(c);if(b.escapeIs){return unescape(RegExp.$1)}return RegExp.$1},addParam:function(a,b){this.__forSetAttribute(a,b)},getParam:function(a){return this.__forGetAttribute(a)},write:function(a){var b=this;if(typeof a=="string"){document.getElementById(a).innerHTML=b.getFlashHtml()}else if(typeof a=="object"){a.innerHTML=b.getFlashHtml()}}};addAdvertise=function(){var a=$E("blogads");if(scope.$pageid.indexOf("article")>-1){if(a!=null){var b=$C("div");b.id="blogads2";b.className="blogads2 borderc";b.innerHTML='<p><a href="javascript:;" id="adversite_bottom"></a></p><p class="SG_txtc">新浪广告共享计划</p>'+($isAdmin?'<div class="manage SinaAd_mg2">'+'<a href="http://share.sass.sina.com.cn/widget_ad/index_out.php?done" class="SinaAd_linkcolor SinaAd_link" target="_blank">[管理]</a></div>':"");b.style.display="none";if(scope.$pn_x_rank&&window.parseInt(scope.$pn_x_rank)==0){if($E("nextprev_"+scope.$articleid)){Core.Dom.insertAfter(b,$E("nextprev_"+scope.$articleid))}else if($E("new_nextprev_"+scope.$articleid)){Core.Dom.insertAfter(b,$E("new_nextprev_"+scope.$articleid))}}}}Utils.Io.JsLoad.request("http://sjs.sinajs.cn/blog7/adwidget.js?v1",{onComplete:function(){if(typeof adShare!="undefined"){adShare.init(scope.$uid,"sinablog","SINABLOG")}},noreturn:true,isRemove:false})};addAdvertise2=function(){var a=$E("adps_person");if(a!=null){Utils.Io.JsLoad.request("http://ba.sass.sina.com.cn/front/blog/deliver?p1="+scope.$uid+",adps000001|adps000002",{onComplete:function(){var b=$E("adps000001");if(b!=null){var c=$T(b,"div");for(var d=0,e=c.length;d<e;d++){if(c[d].className=="widgetconn"){b.innerHTML=c[d].innerHTML;b.style.paddingTop="10px";a.style.display="";break}}}},noreturn:true})}};$registJob("renderAd",function(){scope.$private.ad=scope.$private.ad||0;if(scope.$private.ad>0){addAdvertise();addAdvertise2()}});$TEMPLATECLONE_MSG={A00001:"操作失败，可能系统繁忙或系统遇到未知错误，请稍后再试。也可联系新浪客服：致电4006900000。",A00002:"操作失败，可能系统繁忙或系统遇到未知错误，请稍后再试。也可联系新浪客服：致电4006900000。",A00003:"操作失败，可能系统繁忙或系统遇到未知错误，请稍后再试。也可联系新浪客服：致电4006900000。",A00004:"未登录",A00005:"抱歉，你暂时不能复制该模板",A00006:"操作成功",A11007:'你还未开通新浪博客，请先 <a href="http://login.sina.com.cn/hd/reg_sec.php?entry=blog"  id="cloneTemplateButNoReg">开通博客</a>'};Lib.TemplateClone=Core.Class.create();Lib.TemplateClone.prototype={type:"1",version:"7",interfaceClone:null,btnClone:null,initialize:function(a,b){var c=this;this.interfaceClone=new Interface("http://control.blog.sina.com.cn/riaapi/conf/template_clone.php","jsload");this.btnClone=a;if(this.btnClone){Core.Events.addEvent(this.btnClone,function(){c.clone(b)},"click")}},clone:function(a,b){var c=this;var d="<a style='color:red' href='http://finance.sina.com.cn/333/2010-02-05/guest920.shtml' target='_blank'>315十大行业满意度调查</a>";var e=b?d:"";Lib.checkAuthor();if($isLogin){winDialog.confirm("确定使用此模板吗?",{subText:e,funcOk:function(){scope.blogOpener.showDialog(function(){c.request(a)})}})}else{var f=new Lib.Login.Ui;f.login(function(){winDialog.confirm("确定使用此模板吗?",{subText:e,funcOk:function(){scope.blogOpener.showDialog(function(){c.request(a)})},funcCancel:function(){location.reload()}})})}},request:function(a){var b=this;this.interfaceClone.request({GET:{uid_cloned:scope.$uid,type:b.type,version:b.version},onSuccess:function(b){if(a){a()}},onError:function(a){if(a["code"]=="A11007"){Lib.checkAuthor();var b=winDialog.alert($TEMPLATECLONE_MSG[a["code"]].replace(/#\{linkNewBlog\}/g,"http://control.blog.sina.com.cn/reg/reg_blog.php?version=7"),{icon:"01"});$E("cloneTemplateButNoReg").onclick=function(){b.hidden().destroy()}}else{winDialog.alert($TEMPLATECLONE_MSG[a["code"]],{icon:"02"})}},onFail:function(){}})}};$registJob("templateClone",function(){Lib.checkAuthor();if($isAdmin){trace("博主。不执行代码");return}Lib.getTplNum(function(){var a=function(){function a(a){var b=new Ui.Template($_GLOBAL.cloneTemplateConfig[scope["tpl"]].count_text);var c={};c.template_pv=a;$E("template_clone_link").innerHTML=b.evaluate(c)}if(scope["tpl"]){var b;var c=$_GLOBAL.cloneTemplateConfig[scope["tpl"]];if(c&&c["template_clone_pic"].replace(/\s/g,"")!=""){if(scope["tpl"]=="8_52"){$E("template_clone_pic").parentNode.parentNode.style.top="0px";if(window.screen.width<1280){$E("template_clone_pic").parentNode.parentNode.style.right="88px"}$E("template_clone_pic").parentNode.parentNode.style.zIndex=201}$E("template_clone_pic").innerHTML=c["template_clone_pic"];$E("template_clone_link").innerHTML=c["template_clone_link"];$E("template_clone_other").innerHTML=c["template_clone_other"];if(c["count_id"]){Utils.Io.JsLoad.request("http://hits.blog.sina.com.cn/hits?act=3&uid="+c["count_id"]+"&varname=templatecc",{onComplete:function(){if(typeof templatecc!="undefined"){a(templatecc.pv)}else{$E("template_clone_link").style.display="none"}}})}b=new Lib.TemplateClone($E("template_clone_pic"),function(){winDialog.alert("克隆模板成功!",{icon:"03",funcOk:function(){Lib.checkAuthor();window.location.href="http://blog.sina.com.cn/u/"+$UID}})})}var d=$_GLOBAL.GUANWANG[scope["tpl"]];if(d&&d["template_clone_pic"].replace(/\s/g,"")!=""){$E("template_clone_pic").innerHTML=d["template_clone_pic"];$E("template_clone_other").innerHTML=d["template_clone_other"];if($E("template_clone_pic")){if($E("template_clone_pic").parentNode.tagName.toLowerCase()=="a"){$E("template_clone_pic").parentNode.href=d["template_clone_link"];$E("template_clone_pic").parentNode.target="_blank"}}}var e=$_GLOBAL.famous_conf[scope["tpl"]];if(e&&e["template_clone_pic"].replace(/\s/g,"")!=""){$E("template_clone_pic").innerHTML=e["template_clone_pic"];$E("template_clone_link").innerHTML=e["template_clone_link"];$E("template_clone_other").innerHTML=e["template_clone_other"];if($E("template_clone_pic")){if($E("template_clone_pic").parentNode.tagName.toLowerCase()=="a"){$E("template_clone_pic").parentNode.href="http://ba.sass.sina.com.cn/front/tp/deliver?blogId="+scope.$uid+"&tp="+scope.tpl}}}}};if($_GLOBAL.cloneTemplateConfig){a()}else{Utils.Io.JsLoad.request("http://sjs.sinajs.cn/blog7common/conf/tmp_clone.js",{onComplete:function(){a()},noreturn:true,isRemove:false})}})});if(typeof Lib.flashComponent=="undefined"){Lib.flashComponent={}}Lib.FlashDetector=function(a){this.version=a}.$define({version:"",detect:function(){var a=window.navigator,b,c,d,e="0.0.0";if(a.plugins&&a.plugins.length){for(b=0,c=a.plugins.length;b<c;b++){if(a.plugins[b].name.toLowerCase().indexOf("shockwave flash")!=-1){e=a.plugins[b].description.toLowerCase().replace(/shockwave flash\s?/,"").split(" ")[0];d=true;break}}}else if(window.ActiveXObject){for(b=11;b>=1;b--){try{if(new ActiveXObject("ShockwaveFlash.ShockwaveFlash."+b)){e=b+".0";d=true;break}}catch(f){}}}if(d){this._detectVersion(e)}else{this.onUninstalled&&this.onUninstalled.call(this)}},_detectVersion:function(a){var b=this._getFormatVersion(a).split("."),c=this._getFormatVersion(this.version).split("."),d,e=c.length;for(d=0;d<e;d++){if(+b[d]>+c[d]){this.onSuccess&&this.onSuccess.call(this);return}else{if(+b[d]<+c[d]){this.onVersionLower&&this.onVersionLower.call(this,a);return}}}this.onSuccess&&this.onSuccess.call(this)},_getFormatVersion:function(a){var b=a+"";b.indexOf(".")==-1&&(b+=".0.0");b.split(".").length<3&&(b+=".0");return b},onVersionLower:function(a){},onUninstalled:function(){},onSuccess:function(){}});Lib.flashComponent.FlashContianer=function(a){this._initCfg(a);this._flashDetector=new Lib.FlashDetector(this.flashCfg.version);this._detect()}.$define({flashCfg:{url:"",width:0,height:0,containerID:"divContainer",flashID:"flashID",flashVar:"",version:"9",wmode:"transparent",allowScriptAccess:"always"},rerender:function(){this._initFlash()},_renderText:["#{reason}，为了能够正常显示，请您 ",'<a target="_blank" href="http://get.adobe.com/cn/flashplayer/">','<img src="http://simg.sinajs.cn/blog7style/images/common/baby/flash.png">',"下载最新版本","</a>","。"].join(""),_flash:null,_falshEntity:null,_flashDetector:null,_initFlash:function(){this._addFlash();this._initFlashEntity()},_detect:function(){var a=this._flashDetector,b=this;a.onSuccess=function(){b._initFlash()};a.onUninstalled=function(){b._renderUninstalled()};a.onVersionLower=function(a){b._renderVersionLower()};a.detect()},_renderVersionLower:function(){$E(this.flashCfg.containerID).innerHTML=this._renderText.replace(/\#\{reason\}/g,"您的Flash播放器版本过低")},_renderUninstalled:function(){$E(this.flashCfg.containerID).innerHTML=this._renderText.replace(/\#\{reason\}/g,"您的浏览器未安装Flash播放器")},_initCfg:function(a){var b;for(b in this.flashCfg){typeof a[b]!="undefined"&&(this.flashCfg[b]=a[b])}},_addFlash:function(){var a=this.flashCfg,b=this;this._flash=new Utils.Flash.swfObject(a.url,a.flashID,a.width,a.height,a.version,"#ffffff");this._flash.addParam("allowScriptAccess",a.allowScriptAccess);this._flash.addParam("wmode",a.wmode);this._flash.addParam("flashVars",a.flashVar);this._flash.write(a.containerID)},_initFlashEntity:function(){this._flashEntity=$IE?window[this.flashCfg.flashID]:document[this.flashCfg.flashID]}});Lib.flashComponent.HeadPhoto=function(a){}.$extends(Lib.flashComponent.FlashContianer).$define({setMaskPosition:function(a,b){a=isNaN(a)?0:a;b=isNaN(b)?0:b;this._flashEntity.setMaskPosition&&this._flashEntity.setMaskPosition(a,b)},setPhotoURL:function(a){this._flashEntity.setPhotoURL&&this._flashEntity.setPhotoURL(a)},getPhotoURL:function(a){if(this._flashEntity.getPhotoURL){return this._flashEntity.getPhotoURL()}},setPhotoPosition:function(a,b){a=isNaN(a)?0:a;b=isNaN(b)?0:b;this._flashEntity.setPhotoPosition&&this._flashEntity.setPhotoPosition(a,b)},setPhotoZoom:function(a){a=isNaN(a)?1:a;this._flashEntity.setPhotoZoom&&this._flashEntity.setPhotoZoom(a)},setPhotoAngle:function(a){a=isNaN(a)?0:a;this._flashEntity.setPhotoAngle&&this._flashEntity.setPhotoAngle(a)}});Lib.flashComponent.HeadPhotoEditorConfig={t3_34:{middlePointX:350,middlePointY:100,maskX:108,maskY:0,maskURL:"http://simg.sinajs.cn/blog7swf/baby/mask3_34.swf",frameURL:"http://simg.sinajs.cn/blog7style/images/bring/baby_flashResource/frame3_34.png",defaultPhoto:"http://simg.sinajs.cn/blog7style/images/bring/baby_flashResource/babyPhoto.png"},t3_35:{middlePointX:200,middlePointY:100,maskX:6,maskY:0,maskURL:"http://simg.sinajs.cn/blog7swf/baby/mask3_35.swf",frameURL:"http://simg.sinajs.cn/blog7style/images/bring/baby_flashResource/frame3_35.png",defaultPhoto:"http://simg.sinajs.cn/blog7style/images/bring/baby_flashResource/babyPhoto.png"},t3_36:{middlePointX:300,middlePointY:120,maskX:131,maskY:23,maskURL:"http://simg.sinajs.cn/blog7swf/baby/mask3_36.swf",frameURL:"http://simg.sinajs.cn/blog7style/images/bring/baby_flashResource/frame3_36.png",defaultPhoto:"http://simg.sinajs.cn/blog7style/images/bring/baby_flashResource/babyPhoto.png"},t3_37:{middlePointX:230,middlePointY:100,maskX:71,maskY:0,maskURL:"http://simg.sinajs.cn/blog7swf/baby/mask3_37.swf",frameURL:"http://simg.sinajs.cn/blog7style/images/bring/baby_flashResource/frame3_37.png",defaultPhoto:"http://simg.sinajs.cn/blog7style/images/bring/baby_flashResource/babyPhoto.png"}};$registJob("baby_headPhoto",function(){var a=scope.UserBabyPic||{},b=$E("headflash"),c=scope.babyTpl_conf||["3_34","3_35","3_36","3_37"];scope.renderHeadPhoto=function(c){if(!b){return}b.style.display="";var d=Lib.flashComponent.HeadPhotoEditorConfig["t"+c]||Lib.flashComponent.HeadPhotoEditorConfig["t3_34"];scope.headPhoto=new Lib.flashComponent.HeadPhoto({url:$_GLOBAL.flashBasicURL+"baby/headPhoto.swf",width:540,height:285,containerID:"headflash",flashID:"flashHeadPhoto",flashVar:["maskURL=",d.maskURL,"&maskX=",d.maskX,"&maskY=",d.maskY,"&middlePointX=",d.middlePointX,"&middlePointY=",d.middlePointY,"&photoURL=",a.photoURL||d.defaultPhoto,"&photoX=",a.photoX||0,"&photoY=",a.photoY||0,"&photoZoom=",a.zoom||1,"&photoAngle=",a.angle||0].join("")})};for(var d=0,e=c.length;d<e;d++){if(c[d]==scope.tpl){scope.renderHeadPhoto(scope.tpl);break}}});$registJob("baby_babyBarFlashDetect",function(){var a=$E("divBabyBarFlash"),b=new Lib.FlashDetector("9.0.0"),c=["#{reason}，为了能够正常显示，请您 ",'<a target="_blank" href="http://get.adobe.com/cn/flashplayer/">','<img src="http://simg.sinajs.cn/blog7style/images/common/baby/flash.png">',"下载最新版本","</a>","。"].join("");b.onUninstalled=function(){a&&(a.innerHTML=c.replace(/\#\{reason\}/g,"您的浏览器未安装Flash播放器"))};b.onVersionLower=function(b){a&&(a.innerHTML=c.replace(/\#\{reason\}/g,"您的Flash播放器版本过低"))};b.detect()});$SYSMSG.extend({B24001:"未同意服务条款",B24002:"你输入的手机号有误，请重新输入。",B24003:"你输入的验证码有误，请重新输入。<br/>若忘记验证码，可重新获取。",B24004:"此博客已绑定手机号",B24005:"此手机号已绑定博客",B24006:"你输入的手机号或验证码有误，请重新输入。<br/>若忘记验证码，可重新获取。",B24007:"此博客未开通手机订阅",B24008:"被访问者uid错误",B24009:"自己不能订阅自己",B24010:"你已手机订阅此用户。",B24011:"抱歉！你的手机订阅用户数已达上限，手机订阅失败。",B24012:"自己不能取消自己",B24013:"此用户未被订阅",B24014:"手机关注订阅失败！",B24015:"确定要取消对他的手机订阅吗？",B24017:"抱歉！您所在的地区暂不支持此服务。",B24018:"抱歉！系统繁忙，请稍后再试。",B24019:"抱歉！您输入的手机号码错误，请重新输入。",B24020:"抱歉！系统繁忙，请稍后再试。",B24021:"抱歉！为防止用户恶意骚扰，您今天尝试开通的次数已达上限。",B24022:"手机绑定但是没有开通，点击确定后将返回个人中心。"});scope.PhoneAttentionAdd=Core.Class.create();scope.PhoneAttentionAdd.prototype={initialize:function(){},add:function(a){try{Core.Events.stopEvent()}catch(b){}a=a||scope.$uid;if(!this.addInterface){this.addInterface=new Interface("http://control.blog.sina.com.cn/admin/iphoneattention/attention.php","jsload")}Lib.checkAuthor();if(!$isLogin){v7sendLog("48_01_31");(new Lib.Login.Ui).login(Core.Function.bind3(this.request,this,[a]),false,"referer:"+location.hostname+location.pathname+",func:0005")}else{this.request(a)}},request:function(a){this.addInterface.request({GET:{fuid:a},onSuccess:function(a){var b='手机订阅成功！若此人有新博文发布，我们会短信提醒你。" <br/><span style="font-weight: 100; font-size: 12px;"><a target="_blank" href="http://i.blog.sina.com.cn/blogprofile/profilephone.php">管理我的手机订阅</a>>></span>';winDialog.alert(b,{icon:"03",funcOk:function(){if(scope.$pageid=="profile_phone"||scope.$pageid=="profile_attention"){window.location.reload()}}})},onError:function(a){if(a.code=="B24007"){window.location.href="http://i.blog.sina.com.cn/blogprofile/profilephone.php"}else if(a.code=="B24016"){var b="你还没有开通博客，现在立即开通？";winDialog.confirm(b,{icon:"04",textOk:"是",textCancel:"否",funcOk:function(){window.open("http://control.blog.sina.com.cn/reg/reg_blog.php?version=7")}})}else{showError(a.code)}},onFail:function(){}})}};$registJob("phone_attention_add",function(){scope.pa_add=new scope.PhoneAttentionAdd});$registJob("quote",function(){$E("quote_set_sign")&&(scope.article_quote=new Quote("quote_set_sign"));$E("quote_set_sign2")&&(scope.article_quote=new Quote("quote_set_sign2"));if(!$E("quote_set_sign")&&!$E("quote_set_sign2")){!scope.article_quote&&(scope.article_quote=new Quote);scope.articel_quote_alert=function(a){scope.article_quote.check(a)}}});var QuoteList=Core.Class.create();QuoteList.prototype={saving:false,articleID:"",pageCount:0,initialize:function(a,b){this.container_id=b;this.articleID=scope.$articleid||"";this.initInterface();this.bindEvent(a);$E(this.container_id)&&this.initHtml()},bindEvent:function(a){var b=this;if($E(a)){Core.Events.addEvent($E(a),function(){b.show()})}},initInterface:function(){this.addInterface=new Interface("http://control.blog.sina.com.cn/myblog/htmlsource/quotelist.php","jsload");this.delInterface=new Interface("http://control.blog.sina.com.cn/admin/article/article_quote_del.php","jsload")},show:function(a,b,c){this.pageCount=c||scope.$x_quote_c||0;b&&(this.container_id=b);if(!this.container_id){return}this.articleID=a||scope.$articleid;b&&(this.container_id=b);if($E(this.container_id)&&$E(this.container_id).innerHTML.replace(/\s/g,"")===""){this.initHtml()}if(this.isShow){this.hidden();return}$E(this.container_id).style.display="block";this.loadData();this.isShow=true},hidden:function(){$E(this.container_id).style.display="none";this.isShow=false},initHtml:function(){var a=$E(this.container_id);if(a){var b=this.articleID||"";var c='<h3><a href="#" onclick="return false" title="关闭" id="ql_close'+b+'" class="blogzz_closepic SG_floatR"></a>转载列表：</h3>                <ul class="ul_zzlist" id="ql_content'+b+'">                </ul>				<ul style="display:none"><li id="ql_tip'+b+'"></li></ul>                <div class="SG_clearB"></div>                <div class="blogzz_btn">					<a id="btnArticleQuote'+b+'" href="#" onclick="scope.article_quote && scope.article_quote.check(\''+b+'\');return false;" class="SG_aBtn SG_aBtn_ico SG_turn"><cite><img class="SG_icon SG_icon111" id="quoteList_quote'+b+'" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" align="absmiddle" />转载</cite></a>					<p id="quoteDescription'+b+'" class="SG_turntxt">转载是分享博文的一种常用方式...</p>				</div>				<div id="ql_page'+b+'" class="blogzz_paged"></div>				<div class="clearit"></div>';a.innerHTML=c;Lib.checkAuthor();$E("btnArticleQuote"+b)&&($E("btnArticleQuote"+b).style.display=$isAdmin?"none":"");$E("quoteDescription"+b)&&($E("quoteDescription"+b).style.display=$isAdmin?"":"none");Core.Events.addEvent($E("ql_close"+b),this.hidden.bind2(this))}},setTip:function(a){var b=this.articleID||"";var c=$E("ql_tip"+b);var d=$E("ql_content"+b);if(a!="ok"){c.innerHTML="暂无转载。";d.style.display="none";c.parentNode.style.display="block"}else{c.parentNode.style.display="none";d.style.display="block"}},loadData:function(a){var b=this;var a=a||1;var c={blogid:b.articleID,version:7,page:a};this.addInterface.request({GET:c,onSuccess:function(b){if(b.length>0){this.setTip("ok");this.parseData(b);this.page(a)}else{this.setTip()}}.bind2(this),onError:function(a){showError(a.code)},onFail:function(){}})},parseData:function(a){var b=this.articleID||"";var c="";var d=a.length;for(var e=0;e<d;e++){c+=this.buildListHtml(a[e])}$E("ql_content"+b).innerHTML=c;scope.quoteList_quote=new Quote("quoteList_quote"+b)},page:function(a){var b=this.articleID||"";var c=this.pageCount;var d=Math.ceil(c/10,10);if(d>1){Ui.Pagination.init({pageNode:"ql_page"+b,nodeClassNamePrefix:"SG",curPage:a,maxPage:d,pageTpl:this.loadData.bind2(this),type:3}).show()}else{$E("ql_page"+b).innerHTML=""}},buildListHtml:function(a){if($isAdmin){a.isShow=""}else{a.isShow="none"}var b=['<li id="pl_#{rp_blogid}">','<p class="blogzz_pinfo SG_txtb SG_floatL">','<a target="_blank" href="http://blog.sina.com.cn/u/#{rp_bloguid}">#{rp_bloguname}</a>','<span class="zzlist_mleft zzlist_mright">等级<em class="SG_txtc">(#{rp_ugrade})</em></span>','<span class="zzlist_mleft">转载了此文：</span><a target="_blank" href="http://blog.sina.com.cn/s/blog_#{rp_blogid}.html">#{rp_blogtitle}</a>',"</p>",'<p class="SG_floatR">','<em class="SG_txtc">#{rp_blogpubdate}</em>','<a href="#" style="display:#{isShow}" class="CP_a_fuc" onclick="scope.article_quoteList.del(\'#{rp_blogid}\',\''+this.articleID+'\');return false;">[<cite id="pl_del_#{rp_bloguid}">删除</cite>]</a>',"</p>","</li>"].join("");a.rp_ugrade=a.rp_ugrade.toString();return(new Ui.Template(b)).evaluate(a)},del:function(a,b){var c=this;var d={sblog_id:scope.$articleid||b,version:7,blog_id:a},c=this;$E("quote_sign_count")&&($E("quote_sign_count").innerHTML=+$E("quote_sign_count").innerHTML-1);Core.Dom.removeNode($E("pl_"+a));var e=c.articleID||"";if($E("ql_content"+e)&&$E("ql_content"+e).getElementsByTagName("li").length==0){c.setTip()}this.delInterface.request({GET:d,onSuccess:function(a){c.onDeleted()}.bind2(this),onError:function(a){showError(a.code)},onFail:function(){}})},onDeleted:function(){}};$registJob("quote_list",function(){var a=$E("z_"+scope.$articleid);if($E("quote_sign")){scope.article_quoteList=new QuoteList("quote_sign","blog_quote")}else if(a){scope.article_quoteList=new QuoteList("z_"+scope.$articleid,"blog_quote");a.innerHTML=="(0)"&&(a.style.display="none")}});Core.String.StringBuffer=function(){this.buffer=[]};Core.String.StringBuffer.prototype.append=function(a){this.buffer.push(a);return this};Core.String.StringBuffer.prototype.toString=function(){return this.buffer.join("")};$SYSMSG.extend({B00901:"投票不存在。",B00902:"投票已截止。",B00903:"超出允许投票个数。",B00904:"你已投过票了!<br/>重复投票是没有意义的。",B00905:"投票主题过短<br/>至少要5个汉字或10个字符！",B00906:"投票选项至少要填写2项",B00907:"投票的截止时间不能小于当前时间，请重新选择 ",B00908:"投票选项最多可填写7项",B00909:"投票主题不能为空"});if(typeof infosoftglobal=="undefined")var infosoftglobal=new Object;if(typeof infosoftglobal.FusionChartsUtil=="undefined")infosoftglobal.FusionChartsUtil=new Object;infosoftglobal.FusionCharts=function(a,b,c,d,e,f,g,h,i,j,k){if(!document.getElementById){return}this.initialDataSet=false;this.params=new Object;this.variables=new Object;this.attributes=new Array;if(a){this.setAttribute("swf",a)}if(b){this.setAttribute("id",b)}e=e?e:0;this.addVariable("debugMode",e);c=c.toString().replace(/\%$/,"%25");if(c){this.setAttribute("width",c)}d=d.toString().replace(/\%$/,"%25");if(d){this.setAttribute("height",d)}if(g){this.addParam("bgcolor",g)}this.addParam("quality","high");this.addParam("allowScriptAccess","always");this.addVariable("chartWidth",c);this.addVariable("chartHeight",d);this.addVariable("DOMId",b);f=f?f:0;this.addVariable("registerWithJS",f);h=h?h:"noScale";this.addVariable("scaleMode",h);i=i?i:"EN";this.addVariable("lang",i);this.detectFlashVersion=j?j:1;this.autoInstallRedirect=k?k:1;this.installedVer=infosoftglobal.FusionChartsUtil.getPlayerVersion();if(!window.opera&&document.all&&this.installedVer.major>7){infosoftglobal.FusionCharts.doPrepUnload=true}};infosoftglobal.FusionCharts.prototype={setAttribute:function(a,b){this.attributes[a]=b},getAttribute:function(a){return this.attributes[a]},addParam:function(a,b){this.params[a]=b},getParams:function(){return this.params},addVariable:function(a,b){this.variables[a]=b},getVariable:function(a){return this.variables[a]},getVariables:function(){return this.variables},getVariablePairs:function(){var a=new Array;var b;var c=this.getVariables();for(b in c){a.push(b+"="+c[b])}return a},getSWFHTML:function(){var a="";if(navigator.plugins&&navigator.mimeTypes&&navigator.mimeTypes.length){a='<embed type="application/x-shockwave-flash" src="'+this.getAttribute("swf")+'" width="'+this.getAttribute("width")+'" height="'+this.getAttribute("height")+'"  ';a+=' id="'+this.getAttribute("id")+'" name="'+this.getAttribute("id")+'" ';var b=this.getParams();for(var c in b){a+=[c]+'="'+b[c]+'" '}var d=this.getVariablePairs().join("&");if(d.length>0){a+='flashvars="'+d+'"'}a+="/>"}else{a='<object id="'+this.getAttribute("id")+'" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="'+this.getAttribute("width")+'" height="'+this.getAttribute("height")+'">';a+='<param name="movie" value="'+this.getAttribute("swf")+'" />';var b=this.getParams();for(var c in b){a+='<param name="'+c+'" value="'+b[c]+'" />'}var d=this.getVariablePairs().join("&");if(d.length>0){a+='<param name="flashvars" value="'+d+'" />'}a+="</object>"}return a},setDataURL:function(a){if(this.initialDataSet==false){this.addVariable("dataURL",a);this.initialDataSet=true}else{var b=infosoftglobal.FusionChartsUtil.getChartObject(this.getAttribute("id"));if(!b.setDataURL){__flash__addCallback(b,"setDataURL")}b.setDataURL(a)}},encodeDataXML:function(a){var b=["\\$","\\+"];var c=a.match(/=\s*\".*?\"/g);if(c){for(var d=0;d<c.length;d++){var e=c[d].replace(/^=\s*\"|\"$/g,"");e=e.replace(/\'/g,"%26apos;");var f=a.indexOf(c[d]);var g="='"+e+"'";var h=a.substring(0,f);var i=a.substring(f+c[d].length);var a=h+g+i}}a=a.replace(/\"/g,"%26quot;");a=a.replace(/%(?![\da-f]{2}|[\da-f]{4})/ig,"%25");a=a.replace(/\&/g,"%26");return a},setDataXML:function(a){if(this.initialDataSet==false){this.addVariable("dataXML",this.encodeDataXML(a));this.initialDataSet=true}else{var b=infosoftglobal.FusionChartsUtil.getChartObject(this.getAttribute("id"));b.setDataXML(a)}},setTransparent:function(a){if(typeof a=="undefined"){a=true}if(a)this.addParam("WMode","transparent");else this.addParam("WMode","Opaque")},render:function(a){if(this.detectFlashVersion==1&&this.installedVer.major<8){if(this.autoInstallRedirect==1){var b=window.confirm("You need Adobe Flash Player 8 (or above) to view the charts. It is a free and lightweight installation from Adobe.com. Please click on Ok to install the same.");if(b){window.location="http://www.adobe.com/shockwave/download/download.cgi?P1_Prod_Version=ShockwaveFlash"}else{return false}}else{return false}}else{var c=typeof a=="string"?document.getElementById(a):a;if(this.getVariable("scaleMode").search(/noscale/i)>=0&&(this.getAttribute("width").search("%")>0||this.getAttribute("height").search("%")>0)){var d=this;if(window.addEventListener){window.addEventListener("load",function(){c.innerHTML=d.getSWFHTML()},false)}else if(window.attachEvent){window.attachEvent("onload",function(){c.innerHTML=d.getSWFHTML()})}else{c.innerHTML=this.getSWFHTML()}}else{c.innerHTML=this.getSWFHTML()}if(!document.embeds[this.getAttribute("id")]&&!window[this.getAttribute("id")])window[this.getAttribute("id")]=document.getElementById(this.getAttribute("id"));return true}}};infosoftglobal.FusionChartsUtil.getPlayerVersion=function(){var a=new infosoftglobal.PlayerVersion([0,0,0]);if(navigator.plugins&&navigator.mimeTypes.length){var b=navigator.plugins["Shockwave Flash"];if(b&&b.description){a=new infosoftglobal.PlayerVersion(b.description.replace(/([a-zA-Z]|\s)+/,"").replace(/(\s+r|\s+b[0-9]+)/,".").split("."))}}else if(navigator.userAgent&&navigator.userAgent.indexOf("Windows CE")>=0){var c=1;var d=3;while(c){try{d++;c=new ActiveXObject("ShockwaveFlash.ShockwaveFlash."+d);a=new infosoftglobal.PlayerVersion([d,0,0])}catch(e){c=null}}}else{try{var c=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7")}catch(e){try{var c=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6");a=new infosoftglobal.PlayerVersion([6,0,21]);c.AllowScriptAccess="always"}catch(e){if(a.major==6){return a}}try{c=new ActiveXObject("ShockwaveFlash.ShockwaveFlash")}catch(e){}}if(c!=null){a=new infosoftglobal.PlayerVersion(c.GetVariable("$version").split(" ")[1].split(","))}}return a};infosoftglobal.PlayerVersion=function(a){this.major=a[0]!=null?parseInt(a[0]):0;this.minor=a[1]!=null?parseInt(a[1]):0;this.rev=a[2]!=null?parseInt(a[2]):0};infosoftglobal.FusionChartsUtil.cleanupSWFs=function(){var a=document.getElementsByTagName("OBJECT");for(var b=a.length-1;b>=0;b--){a[b].style.display="none";for(var c in a[b]){if(typeof a[b][c]=="function"){a[b][c]=function(){}}}}};if(infosoftglobal.FusionCharts.doPrepUnload){if(!infosoftglobal.unloadSet){infosoftglobal.FusionChartsUtil.prepUnload=function(){__flash_unloadHandler=function(){};__flash_savedUnloadHandler=function(){};window.attachEvent("onunload",infosoftglobal.FusionChartsUtil.cleanupSWFs)};window.attachEvent("onbeforeunload",infosoftglobal.FusionChartsUtil.prepUnload);infosoftglobal.unloadSet=true}}if(!document.getElementById&&document.all){document.getElementById=function(a){return document.all[a]}}if(Array.prototype.push==null){Array.prototype.push=function(a){this[this.length]=a;return this.length}}infosoftglobal.FusionChartsUtil.getChartObject=function(a){var b=null;if(navigator.appName.indexOf("Microsoft Internet")==-1){if(document.embeds&&document.embeds[a])b=document.embeds[a];else b=window.document[a]}else{b=window[a]}if(!b)b=document.getElementById(a);return b};var getChartFromId=infosoftglobal.FusionChartsUtil.getChartObject;var FusionCharts=infosoftglobal.FusionCharts;var voteValues=[];RenderFlash=Core.Class.create();RenderFlash.prototype={flashId:null,data:null,current:null,eventDom:null,_labels:null,selected:[],initialize:function(){this.eventDom={tab:$E("tabDiv")?$E("tabDiv"):null,line:$E("lineView")?$E("lineView"):null,pie:$E("pieView")?$E("pieView"):null,column:$E("columnView")?$E("columnView"):null,content:$E("voteViewContent")?$E("voteViewContent"):null};this._refreshFlashId();this._addClickEvent(this.eventDom.line);this._addClickEvent(this.eventDom.pie);this._addClickEvent(this.eventDom.column);this.combineData()},showTab:function(a,b,c){if(this.current==a)return;var d=Core.Dom.getElementsByClass($E("voter"),"div","vShape")[0];if(d){d.style.display=""}window.clearAllInterval();if(a=="line"){this.current="line";$E("voteViewContent").innerHTML=window.vote_cache_content_html;window.renderVoteNum();var e=document.getElementsByName("chb1");for(var f=0;f<e.length;f++){e[f].disabled="true";try{e[f].parentNode.childNodes[3].style.cursor="default"}catch(g){}}}else if(a=="Pie3D.swf"){this.current="Pie3D.swf";var h=this._tabTemplate.chooses.join("");var i="";for(var j=0;j<this._labels.length;j++){var k=this._tabTemplate.item.join("");k=k.replace("#{type}",window.vote_rc_type+"");k=k.replace(/([#][{]index[}])/ig,j+1);k=k.replace("#{text}",this._labels[j]);i+=k}h=h.replace("#{uls}",i);h+=this._tabTemplate.flash.join("");this.eventDom["content"].innerHTML=h;var l=this._labels.length*30;if(l<150)l=150;var m="<chart baseFontSize='12' baseFontColor='888888' numberSuffix='%25' showAboutMenuItem='0' decimals='2' chartTopMargin='0' chartBottomMargin='0' caption='' showValues='0' formatNumberScale='0' bgColor='99CCFF,FFFFFF' bgAlpha='0,0' startingAngle='60'>";for(var j=0;j<this.data.length;j++){var n=this.data[j];if(this.selected[j]!=null){m+="<set label='"+(j+1)+"' value='"+voteValues[j].replace("%","")+"' displayValue='"+Core.String.shorten(this._labels[j],7,"…")+"' toolText='"+this._labels[j]+"("+voteValues[j]+")' isSliced='1' />"}else{m+="<set label='"+(j+1)+"' value='"+voteValues[j].replace("%","")+"' displayValue='"+Core.String.shorten(this._labels[j],7,"…")+"' toolText='"+this._labels[j]+"("+voteValues[j]+")' />"}}m+="</chart>";var o=new FusionCharts($_GLOBAL.flashBasicURL+"Pie3D.swf",b,"360",l,"0","0");o.setDataXML(m);o.setTransparent(true);o.render(c)}else if(a=="Column3D.swf"){this.current="Column3D.swf";var h=this._tabTemplate.chooses.join("");var i="";for(var j=0;j<this._labels.length;j++){var k=this._tabTemplate.item.join("");k=k.replace("#{type}",window.vote_rc_type+"");k=k.replace(/([#][{]index[}])/ig,j+1);k=k.replace("#{text}",this._labels[j]);i+=k}h=h.replace("#{uls}",i);h+=this._tabTemplate.flash.join("");this.eventDom["content"].innerHTML=h;var l=this._labels.length*30;if(l<150)l=150;var m="<chart baseFontSize='12' baseFontColor='888888' showValues='1' outCnvBaseFontColor='999999' outCnvBaseFontSize='12' numberSuffix='%25' showAboutMenuItem='0' decimals='2' yAxisMaxValue='100' palette='2' enableRotation='1' canvasBgColor='ffffff' canvasBgAlpha='0' canvasBgDepth='3' canvasBaseColor='ffffff' divLineColor='d8d8d8' numDivLines='4' bgAlpha='0' divLineColor='d8d8d8' canvasPadding='8' chartLeftMargin='0' chartRightMargin='5' chartTopMargin='5' chartBottomMargin='0' maxColWidth='70' showValues='0'><styles><definition><style name='myToolTip' type='font' size='12' color='666666' /></definition><application><apply toObject='ToolTip' styles='myToolTip' /></application></styles>";for(var j=0;j<this.data.length;j++){var n=this.data[j];m+="<set label='"+(j+1)+"' value='"+voteValues[j].replace("%","")+"' toolText='"+this._labels[j]+"("+voteValues[j]+")' />"}m+="</chart>";var o=new FusionCharts($_GLOBAL.flashBasicURL+"Column3D.swf",b,"360",l,"0","0");o.setDataXML(m);o.setTransparent(true);o.render(c)}if($E("flashContent"))$E("flashContent").style.padding="13px 0 0 "},_refreshFlashId:function(){this.flashId=Core.Math.getUniqueId()},_addClickEvent:function(a){var b=this;if(a){a.onclick=function(){b._onClickHandler(this)}}},_onClickHandler:function(a){function c(a){b.eventDom["line"].parentNode.className="";b.eventDom["pie"].parentNode.className="";b.eventDom["column"].parentNode.className="";b.eventDom[a].parentNode.className="cur SG_txtb"}var b=this;if(a!=null){var d=a.id;if(d=="lineView"){this.showTab("line","lineId","voteViewContent");c("line")}else if(d=="pieView"){this.showTab("Pie3D.swf","Pie3D_"+this.flashId,"flashContent");c("pie")}else if(d=="columnView"){this.showTab("Column3D.swf","Column3D_"+this.flashId,"flashContent");c("column")}}},combineData:function(a){this.data=[];var b=this._getLabel();for(var c=0;c<b.length;c++){this.data[this.data.length]={label:b[c],num:window.vote_count.detail[c]}}},_getLabel:function(){var a=[];var b=Core.Dom.getElementsByClass($E("voteViewContent"),"span","");var c=b.length;for(var d=0;d<c;d++){a[a.length]=b[d].innerHTML}this._labels=a;return a},_tabTemplate:{chooses:['<div class="vContentRe">',"<ul>","#{uls}","</ul>","</div>"],item:['<li class="clearfix">','<div class="choosed">','<input type="#{type}" disabled="disabled" id="chb#{index}"/><label for="chb#{index}" style="cursor:default"><em>#{index}.</em><span>#{text}</span></label>',"</div>","</li>"],flash:['<div id="flashContent" class="vContentPic">',"</div>"]}};(function(a){a.rf=null;a.changeType=function(a){$E("mutiple").style.display=a?"":"none";$E("voteType").value=a?$E("mutiple").value:1};a.checkNum=function(a,b){var c=document.getElementsByName("chb1");var d=0;for(var e=0;e<c.length;e++){var f=c[e];if(f.checked){d++}}if(d>b){winDialog.alert("最多只能选"+b+"项！",{icon:"01"});a.checked=false}};a.isExpired=function(a){return a.replace(/(-)|\s/g,"")<getTimestamp("yyyy-MM-dd hh").replace(/(-)|\s/g,"")};a.getTimestamp=function(a){var b=new Date;var c=b.getFullYear();var d=b.getMonth()+1;d=d>9?d:"0"+d;var e=b.getDate()>9?b.getDate():"0"+b.getDate();var f=b.getHours();var g=b.getMinutes()>9?b.getMinutes():"0"+b.getMinutes();var h=b.getSeconds()>9?b.getSeconds():"0"+b.getSeconds();return a.replace(/(y{2,4})/,c).replace("MM",d).replace("dd",e).replace("hh",f).replace("mm",g).replace("ss",h)};a.readyFun=function(){var a;var b=false;Lib.checkAuthor();if($isLogin)a=$UID;else a="0";var c=swfAPI.getC(a);if(c){var d=c.split("|");for(var e=0;e<d.length;e++){var f=d[e];if(f==scope.$articleid){b=true;break}}}if(!b){Core.Events.addEvent("voteBtn",function(){function i(){try{var b=Core.Dom.getElementsByClass($E("voter"),"div","vShape")[0];if(b){b.style.display=""}if(c){if(d.length>99){swfAPI.clearK(a)}else c=scope.$articleid+"|"+c}else{c=scope.$articleid}swfAPI.setC(a,c.toString())}catch(e){Debug.error("投票种flash cookie失败！错误原因："+e)}}var e=$T($E("voteViewContent"),"input");var f=[];for(var g=0;g<e.length;g++){var h=e[g];if(h.checked&&h.name&&h.name=="chb1"){f.push(g+1)}}if(f.length<1){winDialog.alert("请选择要投票的项！",{icon:"01"});return false}Lib.checkAuthor();if($isLogin)a=$UID;else a="0";this.flag=true;var j=f.length;(new Interface("http://control.blog.sina.com.cn/admin/vote/shot_vote.php?version=7","ijax")).request({POST:{blog_id:scope.$articleid,vote_checklist:f.join(",")},onSuccess:function(a){i();try{var b=Core.Dom.getElementsByClass(document,"div","vBtn")[0];Core.Dom.removeParentNode($E("voteBtn"));b.innerHTML='<span class="voteState">已投票</span>';clearAllInterval()}catch(c){}window.vote_count.total+=1;var d=Core.Dom.getElementsByClass($E("voteViewContent"),"span","");var e=[];for(var g=0;g<j;g++){var h=f[g];window.vote_count.detail[h-1]+=1;e.push(d[h-1].innerHTML)}var k={};k.uid=$UID;var l=(new Date).getTime();l/=1e3;l=Math.ceil(l);k.time=l;k.vote=e;var m=window.vote_interface_result;var n=[];for(var o=0;o<m.length;o++){n[o+1]=m[o]}n[0]=k;window.vote_interface_result=n;renderVoteNum();initLoginBar()},onError:function(a){try{winDialog.alert($SYSMSG[a.code]);if(a.code=="B00902"){var c=Core.Dom.getElementsByClass(document,"div","vBtn")[0];Core.Dom.removeParentNode($E("voteBtn"));c.innerHTML='<span class="voteState">投票已截止</span>';var d=$N("chb1");for(var e=0;e<d.length;e++){d[e].disabled=true;try{d[e].parentNode.childNodes[3].style.cursor="default"}catch(f){}}var g=Core.Dom.getElementsByClass($E("voter"),"div","vShape")[0];if(g){g.style.display=""}}else if(a.code=="B00904"){if(!b){i()}var c=Core.Dom.getElementsByClass(document,"div","vBtn")[0];Core.Dom.removeParentNode($E("voteBtn"));c.innerHTML='<span class="voteState">已投票</span>';var d=$N("chb1");for(var e=0;e<d.length;e++){d[e].disabled=true;try{d[e].parentNode.childNodes[3].style.cursor="default"}catch(f){}}}}catch(f){}}})},"click",false)}else{var g=Core.Dom.getElementsByClass(document,"div","vBtn")[0];Core.Dom.removeParentNode($E("voteBtn"));g.innerHTML='<span class="voteState">已投票</span>';var h=document.getElementsByName("chb1");for(var i=0;i<h.length;i++){h[i].disabled="true";try{if($IE){h[i].parentNode.childNodes[2].style.cursor="default"}else{h[i].parentNode.childNodes[3].style.cursor="default"}}catch(j){}}var k=Core.Dom.getElementsByClass($E("voter"),"div","vShape")[0];if(k){k.style.display=""}}};a.swfAPI={setC:function(a,b){$E("swfId").setC(a,b)},getC:function(a){return $E("swfId").getC(a)},clearK:function(a){$E("swfId").clearK(a)},clearC:function(){$E("swfId").clearC()}};a.insertList=function(a){function b(a){var b=new Date(a*1e3);return b.getFullYear()+"-"+(b.getMonth()+1<10?"0"+(b.getMonth()+1):b.getMonth()+1)+"-"+b.getDate()+" "+b.getHours()+":"+(b.getMinutes()<10?"0"+b.getMinutes():b.getMinutes())}var c='<li><span class="SG_dot"></span><span class="txt"><a target="_blank" href="#{url}">#{nick}</a>#{userV}&nbsp;<span class="SG_txtb">投票给 #{vote}</span><em class="SG_txtc">#{time}</em></span></li>';var d="";var e=Lib.blogv.getVHTML;if(this.vote_interface_result){for(var f=0;f<vote_interface_result.length;f++){var g=vote_interface_result[f];var h=c;h=h.replace("#{url}","http://blog.sina.com.cn/u/"+g["uid"]);h=h.replace("#{nick}",a[g["uid"]]);h=h.replace("#{userV}",e(g["wtype"]));h=h.replace("#{time}",b(g["time"]));var i="";for(var j=0;j<g["vote"].length;j++){i+='"'+g["vote"][j]+'" '}h=h.replace("#{vote}",i);d+=h;if(f==10){break}}if($E("voterlist")){$E("voterlist").innerHTML=d}}};a.initLoginBar=function(){Lib.checkAuthor();if($E("vote_login_txt")){if($isLogin){$E("vote_login_txt").style.display="none"}else{$E("vote_login_txt").style.display="";$E("vote_login").onclick=function(){var a=new Lib.Login.Ui;a.login()}}}};a.initNewVote=function(){Lib.checkAuthor();if($E("voteAD")){$E("voteAD").innerHTML='<a class="SG_linka"><img height="15" align="top" width="15" class="SG_icon SG_icon33" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" title="投票"></a>&nbsp;<a target="_blank" href="http://control.blog.sina.com.cn/admin/article/article_add.php#voteadd">发起新投票</a>&nbsp;&nbsp;&nbsp;<a class="SG_linka"><img height="18" align="top" width="18" title="" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" class="SG_icon SG_icon110"></a>&nbsp;<a href="#" id="shareVote">分享此投票</a>';$E("shareVote").onclick=function(){var a=encodeURIComponent("分享投票："+$T($E("voter"),"span")[0].innerHTML+"——来自"+scope.owenerNickName+"的博文："+Core.Dom.byClz(document.body,"h2","titName")[0].innerHTML||""),b="新浪-博客",c="http://blog.sina.com.cn",d="http://v.t.sina.com.cn/share/share.php?searchPic=false&title="+a+"&url="+encodeURIComponent(document.location)+"&source="+b+"&sourceUrl="+encodeURIComponent(c)+"&content=utf-8&appkey=1617465124";window.open(d,"mb","toolbar=0,status=0,resizable=1,width=440,height=430,left="+(screen.width-440)/2+",top="+(screen.height-430)/2);return false}}var a=$E("cc_morevote");if(!a){a=$C("div");a.id="cc_morevote";a.className="voteapp_btnMore";a.innerHTML='<a href="http://control.blog.sina.com.cn/blogprofile/profilevote.php?type=1" target="blank" title="查看更多投票">查看更多投票&gt;&gt;</a><img class="SG_icon SG_icon11" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" title="新" align="absmiddle" />';$E("voterlist").parentNode.parentNode.appendChild(a)}};a.renderVoteNum=function(){var a=[];var b=window.vote_interface_result;for(var c=0;c<b.length;c++){var d=b[c];a[a.length]=d["uid"]}Lib.Uic.getNickName(a,insertList);this.initNewVote();var e=$E("chb1");if(e!=null&&e.type=="radio"){window.vote_rc_type="radio"}else{window.vote_rc_type="checkbox"}this.valueContents=Core.Dom.getElementsByClass($E("voter"),"div","num");var f=0;voteValues=[];var g;var h=window.vote_count.detail;var f=window.vote_count.total;$E("total").innerHTML=f+"人";var i=0;for(var j=0;j<h.length;j++){i+=h[j]}for(g=0;g<valueContents.length;g++){var k=h[g];if(i==0){var l="0%"}else{if(Math.round(k/i*100)>100){var l="100%"}else{var l=Math.round(k/i*100)+"%"}}voteValues.push(l);valueContents[g].innerHTML=k+'<span class="SG_txtc">('+l+")</span>"}renderProgress(voteValues)};a.renderProgress=function(b){window.itvIds=[];var c;var d=Core.Dom.getElementsByAttr($E("voter"),"name","voteResult");var e=Core.Dom.getElementsByClass($E("voter"),"div","num");var f=[];for(c=0;c<e.length;c++){/\((.*)\)/.test(e[c].innerHTML);f[c]=RegExp.$1}for(c=0;c<d.length;c++){d[c].className="color c"+(c+1);d[c].style.fontSize="8px";d[c].style.width="0px";window.itvIds[c]=window.setInterval(function(a){return function(){if(parseInt(d[a].style.width)<parseInt(f[a])){d[a].style.width=parseInt(d[a].style.width,10)+1+"%"}else{window.clearInterval(itvIds[a])}}}(c),10)}if(!this.rf)a.rf=new RenderFlash};a.clearAllInterval=function(){if(window.itvIds){for(var a=0;a<window.itvIds.length;a++){window.clearInterval(itvIds[a])}}}})(window);$registJob("dynamicVoteView",function(){var a=$E("voter");window.vote_progress_css=["1px solid #8d458e","1px solid #578425","1px solid #89ba00","1px solid #008d8e","1px solid #7da4cf","1px solid #d54545","1px solid #ff8d46","1px solid #f6bd0e","1px solid #008dd5","1px solid #b2aa01"];if($E("voterlist")){Lib.checkAuthor();var b="";try{b=Core.Dom.getElementsByClass($E("voter"),"span","voteState")[0].innerHTML}catch(c){}Utils.Io.JsLoad.request("http://control.blog.sina.com.cn/blog_rebuild/riaapi/blog/get_user_vote.php",{GET:{blog_id:scope.$articleid},onComplete:function(a){try{if(a.code=="A00006"){window.vote_cache_content_html=$E("voteViewContent")?$E("voteViewContent").innerHTML:"";window.vote_interface_result=a.data&&a.data.newten;window.vote_count=a.data&&a.data.count;renderVoteNum()}else{winDialog.alert(a.code,{icon:"02"});if($E("voterlist")&&$isLogin&&b!="投票已截止"){$E("voterlist").innerHTML="还没有博主投票呢，赶紧抢个沙发吧。"}else if(b=="投票已截止"){try{var c=Core.Dom.getElementsByClass($E("voter"),"div","vShape")[0];if(c){c.style.display="none"}Core.Dom.getElementsByClass($E("module_920"),"div","newVoteList SG_j_linedot1")[0].style.display="none"}catch(d){}}else{if(!$isLogin)$E("voterlist").innerHTML="还没有博主投票呢，赶紧抢个沙发吧。";else $E("voterlist").innerHTML="加载中…"}}}catch(e){trace("vote error")}},noencode:true,onError:function(a){if($E("voterlist")){$E("voterlist").innerHTML="加载中…"}if(b=="投票已截止"){try{Core.Dom.getElementsByClass($E("module_920"),"div","newVoteList SG_j_linedot1")[0].style.display="none"}catch(c){}}}})}});(function(){function b(a,b,c,d){var e=function(){var e=new Utils.Flash.swfObject(b,d,"1","1","9","#00ff00");e.addParam("quality","high");e.addParam("allowScriptAccess","always");e.addVariable("readyFun",c);e.write(a)};e()}var a="readyFun";var c="";if(window.$Maxthon||window.$360||window.$TT){c="?uid="+Core.Math.getUniqueId(1,10)}b("swfbox",$_GLOBAL.flashBasicURL+"voteCookie.swf"+c,a,"swfId")})();$SYSMSG.extend({B03020:"博文已收藏成功！",B03002:"已达收藏数2000条上限，不能继续收藏。",B03004:"已收藏过此博文，不能重复收藏。",B03005:"确实要取消此收藏吗？",B03006:"确实要删除此博文吗？删除后可在“回收站”恢复。",B03007:"确实要删除此草稿吗？删除后不可恢复。",B03008:"确实要彻底删除此博文吗？删除后不可恢复。",B03010:"确实要替换已置顶的博文吗？",B03011:"确实要取消置顶吗？取消后可在“博文”页恢复。",B03014:"博文已成功置顶到首页！",B03015:"抱歉，您的博客尚未升级，请<a href='http://blog.sina.com.cn/u/#UID' target='_blank'>升级</a>后再“收藏” 。",S01107:"已收藏过此博文，不能重复收藏。",B03016:"是否要彻底删除此博文？博文删除后不可恢复，博文内图片如被其他博文引用也将无法显示。",B03017:"私密博文不能被收藏。",B119000:"对不起，您短时间点击收藏过多，请多休息，注意身体！感谢您对新浪博客的支持和关注！"});$SYSMSG.extend({B00007:"跳转到自动开通页",B00008:"自动开通用户(跳转到假页)",B00009:"跳转到自动开通页",B00010:"无权限。 ",B00011:"抱歉，Blog ID 错误，操作无法完成。",B00012:"抱歉，可能因为重复操作而无法执行，请刷新本页再试。",B00013:"用户ID被封杀",B00014:"很抱歉，您输入的验证码不正确。",B04101:"请输入您的昵称！",B04102:"请正确输入您的邮件地址！",B04103:"请选择您举报信息的位置！",B04104:"请选择您举报的不良信息的类型！",B04105:"简单描述最多只能输入500个字符！",B04106:"再次感谢您帮助我们进行不良信息的验证工作，我们将认真仔细地处理您提交的内容。",B07006:"您已发的博文正在审查中，请稍后再发文"});App.ArticleMange=Core.Class.create();Core.Class.extend(App.ArticleMange.prototype,{initialize:function(a,b){for(var c in b){this[c]=b[c]}this.articleId=a;Lib.checkAuthor();this.pretreat()},pretreat:function(){if(this.articleId==null){Debug.error("ArticleManage need the article id.");return}else{this.checkLogin();return this}},checkLogin:function(){this.needLogin=this.needLogin();Debug.log("checkLogin : "+this.needLogin);var a=function(a){(new Lib.Login.Ui).login(a)};var b=Core.Function.bind2(this.confirm,this);Lib.checkAuthor();if(this.needLogin||!$isLogin){a(b)}else{b()}},confirm:function(){if(!$isLogin){Lib.checkAuthor();$tray.renderLogin()}this.needLogin=false;var a=this.textOk||"确定";var b=this.textCancel||"取消";if(this.confirmMSG){winDialog.confirm(this.confirmMSG,{funcOk:Core.Function.bind2(this.doAction,this),textOk:a,textCancel:b})}else{this.doAction()}},doAction:function(){if($IE&&Core.Events.getEvent()){Core.Events.stopEvent()}var a={};for(var b in this.param){if(typeof this.param[b]=="function"){a[b]=Core.Function.bind2(this.param[b],this)()}else{a[b]=this.param[b]}}if(a.getType=="POST"){if(a.getType){delete a.getType}this.Interface.request({POST:a,onSuccess:this.callback||this.requestOk||function(){window.location.reload()},onError:this.requestError||function(a){showError(a.code)},onFail:function(){showError("A00001")}})}else{if(a.getType){delete a.getType}this.Interface.request({GET:a,onSuccess:this.callback||this.requestOk||function(){window.location.reload()},onError:this.requestError||function(a){showError(a.code)},onFail:function(){showError("A00001")}})}}});Lib.IframeDialog=Core.Class.create();Lib.IframeDialog.prototype={dialog:null,initialize:function(a){this.id=Core.Math.getUniqueId();this.option=a},initDialog:function(){var a=this,b=this.option;var c={ad:false,drag:true,tpl:b.tpl||a.tpl,title:b.title,content:'<iframe frameborder="0" id="ifrDialog_'+a.id+'" scrolling="no"></iframe>',renderer:Ui.SimpleRenderer,width:b.width,height:b.height};this.dialog=winDialog.createCustomsDialog(c);this.dialog.setAreaLocked(true);var d=$E("ifrDialog_"+this.id);d.src=b.url;d.style.width=b.width+"px";d.style.height=b.height+"px";b.funcClose&&this.bindColseFunc()},tpl:'<table id="#{entity}" class="CP_w">'+'<thead id="#{titleBar}">'+"<tr>"+'<th class="tLeft"><span></span></th>'+'<th class="tMid">'+'<div class="bLyTop">'+'<strong id="#{titleName}">提示</strong>'+'<cite><a id="#{btnClose}" href="javascript:;" class="CP_w_shut" title="关闭">关闭</a></cite>'+"</div>"+"</th>"+'<th class="tRight"><span></span></th>'+"</tr>"+"</thead>"+"<tfoot>"+"<tr>"+'<td class="tLeft"><span></span></td>'+'<td class="tMid"><span></span></td>'+'<td class="tRight"><span></span></td>'+"</tr>"+"</tfoot>"+"<tbody>"+"<tr>"+'<td class="tLeft"><span></span></td>'+'<td class="tMid" id="#{content}">'+"</td>"+'<td class="tRight"><span></span></td>'+"</tr>"+"</tbody>"+"</table>",reset:function(){if(this.dialog){this.hidden();var a=this.dialog.nodes.panel||this.dialog.nodes.entity;a.parentNode.removeChild(a);this.dialog=null}},bindColseFunc:function(){Core.Events.addEvent(this.dialog.nodes.btnClose,this.option.funcClose)},setSize:function(a,b){var c=this.dialog.nodes.content.firstChild;this.dialog.setSize(a,b);c.style.width=a+"px";c.style.height=b+"px"},show:function(){this.reset();this.initDialog();this.dialog.show();this.dialog.setMiddle()},close:function(){this.dialog.hidden()}};Lib.AccountChecker=Core.Class.create();Lib.AccountChecker.prototype={initialize:function(a){if(a.indexOf("vt=1")>0||a.indexOf("vt=2")>0){this.showDialog(a)}else{window.location.href=a}},showDialog:function(a){document.domain="sina.com.cn";if(!window.accDialog){window.accDialog=new Lib.IframeDialog({url:a,title:"账号安全",width:300,height:165});scope.accCallback=function(){window.accDialog.close()}}window.accDialog.show();var b=window.accDialog.dialog.nodes;var c=b.content;c.firstChild.style.marginLeft="25px";b.btnClose.style.display="none";var d=document.createElement("p");d.style.lineHeight="70px";d.innerHTML="　　为了您的账号安全，请输入验证码后再进行操作";c.insertBefore(d,c.firstChild)},hideDialog:function(){window.accDialog&&window.accDialog.hidden()}};App.deleteArticle=Core.Class.define(null,App.ArticleMange,{Interface:new Interface("http://control.blog.sina.com.cn/admin/article/article_del_recycle.php","ijax"),needLogin:function(){trace("检查用户");Lib.checkAuthor();return!$isAdmin},confirmMSG:$SYSMSG.B03006,param:{getType:"POST","blog_id[]":function(){return this.articleId},uid:scope.$uid},requestOk:function(){window.location.reload()},requestError:function(a){if(a&&a.code==="B30001"){new Lib.AccountChecker(a.data.ssoUseUrl)}else{showError(a.code)}}});App.deleteDraftArticle=Core.Class.define(null,App.ArticleMange,{Interface:new Interface("http://control.blog.sina.com.cn/admin/article/article_draft_del.php","jsload"),needLogin:function(){Lib.checkAuthor();return!$isAdmin},confirmMSG:$SYSMSG.B03016,textOk:"是",textCancel:"否",param:{"blog_id[]":function(){return this.articleId},uid:scope.$uid},requestOk:function(){window.location.reload()}});App.clearRecycleBinArticle=Core.Class.define(null,App.ArticleMange,{Interface:new Interface("http://control.blog.sina.com.cn/admin/article/article_recycle_del.php","jsload"),needLogin:function(){Lib.checkAuthor();return!$isAdmin},confirmMSG:$SYSMSG.B03016,textOk:"是",textCancel:"否",param:{"blog_id[]":function(){return this.articleId},uid:scope.$uid},requestOk:function(){window.location.reload()}});App.restoreRecycleBinArticle=Core.Class.define(null,App.ArticleMange,{Interface:new Interface("http://control.blog.sina.com.cn/admin/article/article_recycle_resume.php","jsload"),needLogin:function(){Lib.checkAuthor();return!$isAdmin},param:{blog_id:function(){return this.articleId},uid:scope.$uid},requestOk:function(){window.location.reload()}});App.addFavoriteArticle=Core.Class.define(null,App.ArticleMange,{Interface:new Interface("http://control.blog.sina.com.cn/admin/article/favourites_save.php","jsload"),needLogin:function(){Lib.checkAuthor();return!$isLogin},param:{blog_id:function(){return this.articleId},uid:scope.$uid},requestOk:function(){if($E("f_"+scope.$articleid)){$E("f_"+scope.$articleid).innerHTML=$E("f_"+scope.$articleid).innerHTML.replace(/\((\d*)\)/gi,function(a,b){return"("+(window.parseInt(b)+1)+")"})}winDialog.alert($SYSMSG.B03020,{icon:"03"})}});App.deleteFavoriteArticle=Core.Class.define(null,App.ArticleMange,{Interface:new Interface("http://control.blog.sina.com.cn/admin/article/favourites_del.php","jsload"),needLogin:function(){Lib.checkAuthor();return!$isAdmin},confirmMSG:$SYSMSG.B03005,param:{resourceids:function(){return this.articleId},uid:scope.$uid},requestOk:function(){window.location.reload()}});App.setTopArticle=Core.Class.define(null,App.ArticleMange,{Interface:new Interface("http://control.blog.sina.com.cn/admin/article/article_top.php","jsload"),needLogin:function(){Lib.checkAuthor();return!$isAdmin},param:{blog_id:function(){return this.articleId},uid:scope.$uid},requestOk:function(){window.location.reload()}});App.replaceTopArticle=Core.Class.define(null,App.ArticleMange,{Interface:new Interface("http://control.blog.sina.com.cn/admin/article/article_top.php","jsload"),needLogin:function(){Lib.checkAuthor();return!$isAdmin},confirmMSG:$SYSMSG.B03010,param:{blog_id:function(){return this.articleId},uid:scope.$uid},requestOk:function(){window.location.reload()}});App.unsetTopArticle=Core.Class.define(null,App.ArticleMange,{Interface:new Interface("http://control.blog.sina.com.cn/admin/article/article_top_del.php","jsload"),needLogin:function(){Lib.checkAuthor();return!$isAdmin},confirmMSG:$SYSMSG.B03011,param:{blog_id:function(){return this.articleId},uid:scope.$uid},requestOk:function(){window.location.reload()}});App.moreLayer=function(a,b){function f(a,b){if(a.hasChildNodes()){var c=a.childNodes;for(var d=0;c[d];d++){if(f(c[d],b)){return true}}}return a==b}var c="";var d="";var e="";if(!scope.moreLayerId)scope.moreLayerId=[0,0];scope.moreLayerId.push(a);scope.moreLayerId.shift();c=$E("a_layer_"+scope.moreLayerId[0]);e=$E("a_more_"+scope.moreLayerId[1]);d=$E("a_layer_"+scope.moreLayerId[1]);d.style.left=Core.Dom.getLeft(e)-30+"px";d.style.top=Core.Dom.getTop(e)+e.offsetHeight+"px";if(c)c.style.display="none";d.style.height="80px";d.style.display="";d.onmouseout=function(a){return function(b){b=b||window.event;var c=b.relatedTarget||b.toElement;if($FF){if(!f(a,c)){a.style.display="none"}}else{if(!a.contains(c)){a.style.display="none"}}}}(d)};App.modifyCategory=Core.Class.define(null,App.ArticleMange,{Interface:new Interface("http://control.blog.sina.com.cn/riaapi/article/edit_cat.php","jsload"),param:{},requestOk:function(){window.location.reload()},requestError:function(a){},needLogin:function(){trace("检查用户");Lib.checkAuthor();return!$isAdmin},confirmMSG:['<div id="#{content}" class="CP_layercon1">','<div class="CP_prompt" style="padding:0;">','<table class="CP_w_ttl"><tr><td id="#{text}">','<p style="font-size:13px; font-weight:normal; padding-left:30px;">文章分类：','<select id="#{cateSel}" style="width:130px;">{0}</select>',"</p>","</td></tr></table>",'<div id="#{subText}" class="CP_w_cnt SG_txtb"></div>','<p class="CP_w_btns" style="padding-left:60px;">','<a id="#{linkOk}" class="SG_aBtn SG_aBtnB" href="#" onclick="return false;"><cite id="#{btnOk}"><span id="#{ok}">确认</span></cite></a>','<a style="margin-left:5px;" id="#{linkCancel}" class="SG_aBtn SG_aBtnB" href="#" onclick="return false;"><cite id="#{btnCancel}"><span id="#{cancel}">取消</span></cite></a>',"</p>","</div>","</div>"].join(""),confirm:function(){if(!$isLogin){Lib.checkAuthor();$tray.renderLogin()}this.needLogin=false;if(this.confirmMSG){var a=this;if(!App.cacheSort){App.getArticlesSort(function(b){App.cacheSort=b.data;a.showLayer()})}else{this.showLayer()}}else{this.doAction()}},showLayer:function(){var a=this;var b,c,d,e=+this.cateId,f=0;var g="<option value='{1}'>{0}</option>";var h="<option value='00'>选择分类</option>";for(var i=0;i<App.cacheSort.length;i++){d=App.cacheSort[i];h+=g.format(d.name,d.id);if(d.id===e){f=i+1}}h+="<option value='0'>私密博文</option>";this.confirmMSG=this.confirmMSG.format(h);b=winDialog.createCustomsDialog({title:"修改博文分类",content:this.confirmMSG});b.setFixed(true);b.setMiddle();b.show();c=b.nodes.cateSel;c.selectedIndex=f;b.nodes.linkCancel.onclick=function(){b.close();return false};b.nodes.btnClose.onclick=function(){b.close();return false};b.nodes.linkOk.onclick=function(){a.param={old_cat:a.cateId,new_cat:c.options[c.selectedIndex].value,blog_id:a.articleId};Core.Function.bind2(a.doAction,a)();b.close();return false}},requestOk:function(){winDialog.alert("修改分类成功",{icon:"03",funcOk:function(){window.location.reload()}})}});App.deleteClockpub=Core.Class.define(null,App.ArticleMange,{Interface:new Interface("http://control.blog.sina.com.cn/admin/article/article_clockpub_del.php","jsload"),needLogin:function(){Lib.checkAuthor();return!$isAdmin},confirmMSG:"博文删除后将无法恢复，确定要删除吗？",textOk:"是",textCancel:"否",param:{"blog_id[]":function(){return this.articleId},uid:scope.$uid},requestOk:function(){window.location.reload()},requestError:function(a){if(a.code==="B00011"){winDialog.alert("博文已不在定时列表中",{funcOk:function(){window.location.reload()},icon:"01"})}else{showError(a.code)}}});App.sendClockpub=Core.Class.define(null,App.ArticleMange,{Interface:new Interface("http://control.blog.sina.com.cn/blog_rebuild/riaapi/blog/clockPubImmediate.php","jsload"),needLogin:function(){Lib.checkAuthor();return!$isAdmin},param:{blog_id:function(){return this.articleId}},requestOk:function(a){winDialog.alert("博文已发布成功",{funcOk:function(){setTimeout(function(){window.location.href="http://blog.sina.com.cn/s/blog_"+a+".html"},1)},icon:"03"})},requestError:function(a){if(a.code==="B40003"||a.code==="B36101"){winDialog.alert("博文已不在定时列表中",{funcOk:function(){window.location.reload()},icon:"01"})}else{showError(a.code)}}});App.articleHide=Core.Class.define(null,App.ArticleMange,{Interface:new Interface("http://control.blog.sina.com.cn/riaapi/article/edit_cat.php?old_cat=0&new_cat=0","jsload"),param:{blog_id:function(){return this.articleId}},confirmMSG:"是否要隐藏此博文",needLogin:function(){trace("检查用户");Lib.checkAuthor();return!$isAdmin},requestOk:function(){winDialog.alert("隐藏成功",{icon:"03",funcOk:function(){window.location.reload()}})},requestError:function(a){winDialog.alert("失败，请重试")}});App.articleRestore=Core.Class.define(null,App.ArticleMange,{Interface:new Interface("http://control.blog.sina.com.cn/riaapi/article/edit_cat.php?old_cat=0&new_cat=00","jsload"),param:{blog_id:function(){return this.articleId}},confirmMSG:"是否恢复此博文",needLogin:function(){Lib.checkAuthor();return!$isAdmin},requestOk:function(){winDialog.alert("恢复成功",{icon:"03",funcOk:function(){window.location.reload()}})},requestError:function(a){winDialog.alert("恢复失败，请重试")}});$articleManage=function(a,b,c){if($IE){try{Core.Events.stopEvent();$E("a_layer_"+scope.moreLayerId[1]).style.display="none";$E("a_layer_"+scope.moreLayerId[0]).style.display="none"}catch(d){}}c=c||{};switch(b){case 1:new App.deleteArticle(a,c);break;case 2:new App.deleteDraftArticle(a,c);break;case 3:new App.clearRecycleBinArticle(a,c);break;case 4:new App.restoreRecycleBinArticle(a,c);break;case 5:var e=function(){scope.blogOpener.showDialog(function(){new App.addFavoriteArticle(a,c)})};Lib.checkAuthor();if(!$isLogin){v7sendLog("48_01_35");(new Lib.Login.Ui).login(e)}else{e()}break;case 6:new App.deleteFavoriteArticle(a,c);break;case 7:new App.setTopArticle(a,c);break;case 8:new App.replaceTopArticle(a,c);break;case 9:new App.unsetTopArticle(a,c);break;case 10:App.moreLayer(a,Core.Events.getEvent());break;case 11:new App.modifyCategory(a,c);break;case 12:new App.articleHide(a,c);break;case 13:new App.articleRestore(a,c);break;case 14:new App.deleteClockpub(a,c);break;case 15:new App.sendClockpub(a,c);break}};$registJob("report_bodyArticle",function(){var a=new Lib.BlogReport,b="";window.report=function(c){var d=scope.$uid,e,f="",g='<a target="_blank" href="http://blog.sina.com.cn/s/blog_'+c+'.html">'+$E("t_"+c).innerHTML+"</a>",h=$E("t_"+c).innerHTML;if(b===""){Lib.Uic.getNickName([d],function(b){if(b&&b[d]){var e=b[d];a.start("blog",e,c,d,'<a target="_blank" href="http://blog.sina.com.cn/u/'+scope.$uid+'">'+e+"</a>",f,g,h)}else{a.start("blog","新浪网友",c,d,"新浪网友",f,g,h)}})}else{e='<a target="_blank" href="http://blog.sina.com.cn/u/'+scope.$uid+'">'+b+"</a>";a.start("blog",b,c,d,e,f,g,h)}};window.article_report=function(c){var d=scope.$uid,e,f="",g='<a target="_blank" href="http://blog.sina.com.cn/s/blog_'+c+'.html">'+$E("t_"+c).innerHTML+"</a>",h=$E("t_"+c).innerHTML;if(b===""){Lib.Uic.getNickName([d],function(b){if(b&&b[d]){var e=b[d];a.start("blog",e,c,d,'<a target="_blank" href="http://blog.sina.com.cn/u/'+scope.$uid+'">'+e+"</a>",f,g,h)}else{a.start("blog","新浪网友",c,d,"新浪网友",f,g,h)}})}else{e='<a target="_blank" href="http://blog.sina.com.cn/u/'+scope.$uid+'">'+b+"</a>";a.start("blog",b,c,d,e,f,g,h)}}});$registJob("flashtemplate",function(){Lib.getTplNum(function(){if(scope["tpl"]){Lib.insertMoban()}})});$registJob("imageLazyLoad",function(){var a=document.getElementsByTagName("IMG");var b=[];for(var c=0,d=a.length;c<d;c++){if(a[c].getAttribute("real_src")!=null){b.push(a[c])}}if(b.length>0){Lib.LazyLoad(b,{callback:function(a){scope.sharePhoto&&scope.sharePhoto.bindFn&&scope.sharePhoto.bindFn(a,"real_src");var b=a.getAttribute("real_src");if(scope.showPicSlide){scope.showPicSlide(a,b)}a.src=b;if(scope.$pageid==="articletjTech"){if(a.complete&&a.width>550){a.width=550}else{a.onload=function(){if(a.width>550){a.width=550}}}}}})}});scope.$worldCupInfos={teams:{1:{name:"南非",group:"A",URL:"http://2010.sina.com.cn/teams/southafrica.shtml"},2:{name:"墨西哥",group:"A",URL:"http://2010.sina.com.cn/teams/mexico.shtml"},3:{name:"乌拉圭",group:"A",URL:"http://2010.sina.com.cn/teams/uruguay.shtml"},4:{name:"法国",group:"A",URL:"http://2010.sina.com.cn/teams/france.shtml"},5:{name:"阿根廷",group:"B",URL:"http://2010.sina.com.cn/teams/argentina.shtml"},6:{name:"尼日利亚",group:"B",URL:"http://2010.sina.com.cn/teams/nigeria.shtml"},7:{name:"韩国",group:"B",URL:"http://2010.sina.com.cn/teams/korearepublic.shtml"},8:{name:"希腊",group:"B",URL:"http://2010.sina.com.cn/teams/greece.shtml"},9:{name:"英格兰",group:"C",URL:"http://2010.sina.com.cn/teams/england.shtml"},10:{name:"美国",group:"C",URL:"http://2010.sina.com.cn/teams/usa.shtml"},11:{name:"阿尔及利亚",group:"C",URL:"http://2010.sina.com.cn/teams/algeria.shtml"},12:{name:"斯洛文尼亚",group:"C",URL:"http://2010.sina.com.cn/teams/slovenia.shtml"},13:{name:"德国",group:"D",URL:"http://2010.sina.com.cn/teams/germany.shtml"},14:{name:"澳大利亚",group:"D",URL:"http://2010.sina.com.cn/teams/australia.shtml"},15:{name:"塞尔维亚",group:"D",URL:"http://2010.sina.com.cn/teams/serbia.shtml"},16:{name:"加纳",group:"D",URL:"http://2010.sina.com.cn/teams/ghana.shtml"},17:{name:"荷兰",group:"E",URL:"http://2010.sina.com.cn/teams/netherlands.shtml"},18:{name:"丹麦",group:"E",URL:"http://2010.sina.com.cn/teams/denmark.shtml"},19:{name:"日本",group:"E",URL:"http://2010.sina.com.cn/teams/japan.shtml"},20:{name:"喀麦隆",group:"E",URL:"http://2010.sina.com.cn/teams/cameroon.shtml"},21:{name:"意大利",group:"F",URL:"http://2010.sina.com.cn/teams/italy.shtml"},22:{name:"巴拉圭",group:"F",URL:"http://2010.sina.com.cn/teams/paraguay.shtml"},23:{name:"新西兰",group:"F",URL:"http://2010.sina.com.cn/teams/newzealand.shtml"},24:{name:"斯洛伐克",group:"F",URL:"http://2010.sina.com.cn/teams/slovakia.shtml"},25:{name:"巴西",group:"G",URL:"http://2010.sina.com.cn/teams/brazil.shtml"},26:{name:"朝鲜",group:"G",URL:"http://2010.sina.com.cn/teams/koreadpr.shtml"},27:{name:"科特迪瓦",group:"G",URL:"http://2010.sina.com.cn/teams/cotedivoire.shtml"},28:{name:"葡萄牙",group:"G",URL:"http://2010.sina.com.cn/teams/portugal.shtml"},29:{name:"西班牙",group:"H",URL:"http://2010.sina.com.cn/teams/spain.shtml"},30:{name:"瑞士",group:"H",URL:"http://2010.sina.com.cn/teams/switzerland.shtml"},31:{name:"洪都拉斯",group:"H",URL:"http://2010.sina.com.cn/teams/honduras.shtml"},32:{name:"智利",group:"H",URL:"http://2010.sina.com.cn/teams/chile.shtml"}},games:{1:{teams:["1","2"],time:"2010-06-11 22:00:00",score:"",group:"A"},2:{teams:["3","4"],time:"2010-06-12 02:30:00",score:"",group:"A"},3:{teams:["5","6"],time:"2010-06-12 22:00:00",score:"",group:"B"},4:{teams:["7","8"],time:"2010-06-12 19:30:00",score:"",group:"B"},5:{teams:["9","10"],time:"2010-06-13 02:00:00",score:"",group:"C"},6:{teams:["11","12"],time:"2010-06-13 19:30:00",score:"",group:"C"},7:{teams:["13","14"],time:"2010-06-14 02:30:00",score:"",group:"D"},8:{teams:["15","16"],time:"2010-06-13 22:00:00",score:"",group:"D"},9:{teams:["17","18"],time:"2010-06-14 19:30:00",score:"",group:"E"},10:{teams:["19","20"],time:"2010-06-14 22:00:00",score:"",group:"E"},11:{teams:["21","22"],time:"2010-06-15 02:30:00",score:"",group:"F"},12:{teams:["23","24"],time:"2010-06-15 19:30:00",score:"",group:"F"},13:{teams:["27","28"],time:"2010-06-15 22:00:00",score:"",group:"G"},14:{teams:["25","26"],time:"2010-06-16 02:30:00",score:"",group:"G"},15:{teams:["31","32"],time:"2010-06-16 19:30:00",score:"",group:"H"},16:{teams:["29","30"],time:"2010-06-16 22:00:00",score:"",group:"H"},17:{teams:["1","3"],time:"2010-06-17 02:30:00",score:"",group:"A"},18:{teams:["2","4"],time:"2010-06-18 02:30:00",score:"",group:"A"},19:{teams:["6","8"],time:"2010-06-17 22:00:00",score:"",group:"B"},20:{teams:["5","7"],time:"2010-06-17 19:30:00",score:"",group:"B"},21:{teams:["13","15"],time:"2010-06-18 22:00:00",score:"",group:"D"},22:{teams:["12","10"],time:"2010-06-18 22:00:00",score:"",group:"C"},23:{teams:["9","11"],time:"2010-06-19 02:30:00",score:"",group:"C"},24:{teams:["16","14"],time:"2010-06-19 02:30:00",score:"",group:"D"},25:{teams:["17","19"],time:"2010-06-19 19:30:00",score:"",group:"E"},26:{teams:["18","20"],time:"2010-06-20 02:30:00",score:"",group:"E"},27:{teams:["22","24"],time:"2010-06-20 19:30:00",score:"",group:"F"},28:{teams:["21","23"],time:"2010-06-20 22:00:00",score:"",group:"F"},29:{teams:["25","27"],time:"2010-06-21 02:00:00",score:"",group:"G"},30:{teams:["26","28"],time:"2010-06-21 19:30:00",score:"",group:"G"},31:{teams:["30","32"],time:"2010-06-21 22:00:00",score:"",group:"H"},32:{teams:["29","31"],time:"2010-06-22 02:00:00",score:"",group:"H"},33:{teams:["2","3"],time:"2010-06-22 22:00:00",score:"",group:"A"},34:{teams:["1","4"],time:"2010-06-22 22:00:00",score:"",group:"A"},35:{teams:["6","7"],time:"2010-06-23 02:30:00",score:"",group:"B"},36:{teams:["5","8"],time:"2010-06-23 02:30:00",score:"",group:"B"},37:{teams:["9","12"],time:"2010-06-23 22:00:00",score:"",group:"C"},38:{teams:["10","11"],time:"2010-06-23 22:00:00",score:"",group:"C"},39:{teams:["13","16"],time:"2010-06-24 02:30:00",score:"",group:"D"},40:{teams:["15","14"],time:"2010-06-24 02:30:00",score:"",group:"D"},41:{teams:["21","24"],time:"2010-06-24 22:00:00",score:"",group:"F"},42:{teams:["22","23"],time:"2010-06-24 22:00:00",score:"",group:"F"},43:{teams:["18","19"],time:"2010-06-25 02:30:00",score:"",group:"E"},44:{teams:["17","20"],time:"2010-06-25 02:30:00",score:"",group:"E"},45:{teams:["25","28"],time:"2010-06-25 22:00:00",score:"",group:"G"},46:{teams:["26","27"],time:"2010-06-25 22:00:00",score:"",group:"G"},47:{teams:["29","32"],time:"2010-06-26 02:30:00",score:"",group:"H"},48:{teams:["30","31"],time:"2010-06-26 02:30:00",score:"",group:"H"},49:{},50:{},51:{},52:{},53:{},54:{},55:{},56:{},57:{},58:{},59:{},60:{},61:{},62:{},63:{},64:{}},teammatches:{1:["1","17","34"],2:["1","18","33"],3:["2","17","33"],4:["2","18","34"],5:["3","20","36"],6:["3","19","35"],7:["4","20","35"],8:["4","19","36"],9:["5","23","37"],10:["5","22","38"],11:["6","23","38"],12:["6","22","37"],13:["7","21","39"],14:["7","24","40"],15:["8","21","40"],16:["8","24","39"],17:["9","25","44"],18:["9","26","43"],19:["10","25","43"],20:["10","26","44"],21:["11","28","41"],22:["11","27","42"],23:["12","28","42"],24:["12","27","41"],25:["14","29","45"],26:["14","30","46"],27:["13","29","46"],28:["13","30","45"],29:["16","32","47"],30:["16","31","48"],31:["15","32","48"],32:["15","31","47"]}};$registJob("favGames",function(){function a(){var a=scope.wc_match_info;var c=scope.wc_teams_info;var d=attentionWorldCup.show_attentiongame;var e=attentionWorldCup.show_attentionteam;var f=6;var g=['<table border="0" cellpadding="0" cellspacing="1">',"<tr>",'<th scope="col" class="w1">日期</th>','<th scope="col" class="w2">时间</th>','<th scope="col">对阵</th>',"</tr>#{itemLines}","</table>"].join("");var h=["<tr>","<td>#{date}</td>",'<td class="wdc_ta">#{time}</td>','<td class="wdc_te"><span class="matchL">#{army1}</span><span class="vs wdc_ta"> VS </span><span class="matchR">#{army2}</span></td>',"</tr>"].join("");var i=$E("favGames");var j="";var k=["星期日","星期一","星期二","星期三","星期四","星期五","星期六"];var l,m;var n=[];var o=[];var p=[];var q=[];for(l=0;l<d.length;l++){trace("userGameHash "+a[d[l]].score+"////"+l);q.push(a[d[l]])}var r=b(q,"score",f,true);trace("length: "+r.length);for(l=0;l<r.length;l++){trace(l);var s=r[l].time.split(" ")[0].split("-");var t=r[l].time.split(" ")[1].split(":")[0];var u=new Date;u.setMonth(s[1]-1);u.setDate(s[2]);u.setHours(t);n[l]=u.getTime()}o=o.concat(n);var v;var w;var x=[];for(m=0;m<n.length;m++){v=n[0];w=0;for(l=1;l<n.length;l++){if(n[l]<v){v=n[l];w=l}}x.push(w);n[w]=Infinity}for(l=0;l<n.length;l++){var s=r[x[l]].time.split(" ")[0].split("-");var u=new Date;u.setMonth(s[1]-1);u.setDate(s[2]);var y=u.getDay();u=u.getMonth()+1+"月"+u.getDate()+"日";j+=(new Ui.Template(h)).evaluate({army1:c[r[x[l]].teams[0]].name,army2:c[r[x[l]].teams[1]].name,date:u+" "+k[y],time:r[x[l]].time.split(" ")[1].slice(0,-3)})}i.innerHTML=(new Ui.Template(g)).evaluate({itemLines:j})}function b(a,b,c,d){var e;var f=[];var g=[];for(e=0;e<a.length;e++){if(d?!a[e][b]:a[e][b]){f.push(a[e])}}for(e=0;e<c;e++){if(!f[e]){trace("src not enough");break}g.push(f[e])}return g}if(typeof attentionWorldCup=="undefined")return;if(!attentionWorldCup.show_attentiongame.length)return;if(scope.wc_match_info){a()}else{Utils.Io.JsLoad.request("http://blog.sina.com.cn/2010worldcup/worldcup.js",{onComplete:function(){scope.wc_match_info=wc_match_info;scope.wc_teams_info=wc_team_info;a()}})}});$registJob("teams_wc",function(){if(typeof attentionWorldCup=="undefined")return;new FavTeamsInfo;Utils.Io.JsLoad.request("http://hits.blog.sina.com.cn/hits?act=3&uid=00000300&tm"+(new Date).getTime(),{onComplete:function(){}})});var FavTeamsInfo=function(){this.entity=$E("favTeams");if(!this.entity)return;this.allTeams=$T(this.entity,"li");this.isTweenIn=[];this.isTweenOut=[];this.initialize()};FavTeamsInfo.prototype={initialize:function(){if(!this.entity)return;var a=this;var b=64;Core.Array.foreach(this.allTeams,function(c,d){var e=$T(c,"p")[1];e.style.zIndex=512;c.style.zIndex=b--;Core.Events.addEvent(c,function(){if(!$IE)if(!a.justIn(Core.Events.getEvent(),c))return;a.tweenIn(c,e,d)},$IE?"mouseenter":"mouseover");Core.Events.addEvent(c,function(){if(!$IE)if(!a.justIn(Core.Events.getEvent(),c))return;a.tweenOut(c,e,d)},$IE?"mouseleave":"mouseout")})},justIn:function(a,b){var c=a.relatedTarget;while(c&&c!=b)c=c.parentNode;return c!=b},tweenIn:function(a,b,c){try{Ui.tween.stop(b)}catch(d){}var e=this;a.className="hover";Core.Dom.setStyle(b,"opacity",1);b.style.display=""},tweenOut:function(a,b,c){var d=this;new Ui.tween(b,["opacity"],[0],.3,"simple",{end:function(){b.style.display="none";a.className=""}})}};var CalendarWc=function(){this.entity=$E("wdc_calender");this.closeBtn=$E("wcc_close");this.fakeImg=$C("div");this.switchOn=false;this.isTween=false;this.posRelDom=null;this.lockPosX;this.lockPosY;this.initialize()};CalendarWc.prototype={initialize:function(){if(!this.entity)return;var a=this;this.fakeImg.style.cssText="z-index:612; position:absolute; border:2px solid #d2d9e6; background-color:white;";document.body.insertBefore(this.fakeImg,document.body.firstChild);this.renderNew();this.renderToday();Core.Events.addEvent(this.closeBtn,function(){a.resetCalendar()});Core.Events.addEvent(window,function(){a.justiPos()},"resize")},resetCalendar:function(){try{Ui.tween.stop(this.fakeImg)}catch(a){}Core.Dom.setStyle(this.entity,"display","none");Core.Dom.setStyle(this.entity,"visibility","hidden");Core.Dom.setStyle(this.fakeImg,"display","none");this.switchOn=false;this.isTween=false},justiPos:function(){if(!this.switchOn)return;Core.Dom.setStyle(this.entity,"left",Core.Dom.getLeft(this.posRelDom)-this.lockPosX+"px");Core.Dom.setStyle(this.entity,"top",Core.Dom.getTop(this.posRelDom)-this.lockPosY+"px")},renderNew:function(){var a=this;var b=attentionWorldCup.show_attentiondate;if(!b&&!b.length)return;for(var c=0;c<b.length;c++){var d;var e=b[c].split("_");d=$E("wcc_"+e[0]+"_"+e[1]);if(!d)break;$T(d,"a")[0].title="有关注的赛事";this.addClass(d,"new");Core.Events.addEvent(d,function(c){return function(){a.resetCalendar();window.location.href="#"+b[c]}}(c))}},renderToday:function(){var a=(new Date).getMonth()+1;var b=(new Date).getDate();this.addClass($E("wcc_"+a+"_"+b),"cur")},setPos:function(a,b,c){this.posRelDom=a;var d=Core.Dom.getLeft(a)+(b?b:0);var e=Core.Dom.getTop(a)+(c?c:0);if($IE6&&$IE7){d+=document.documentElement.scrollLeft;e+=document.documentElement.scrollTop}this.fakeImg.style.left=d+"px";this.fakeImg.style.top=e+"px"},arcFunc:function(a,b,c){return function(d){return a*d*d+b*d+c}},tweenPlay:function(){this.resetCalendar();var a=this;Core.Dom.setStyle(this.entity,"display","");Core.Dom.setStyle(this.fakeImg,"display","");Core.Dom.setStyle(this.fakeImg,"opacity",.6);Core.Dom.setStyle(this.fakeImg,"width","48px");Core.Dom.setStyle(this.fakeImg,"height","15px");this.isTween=true;new Ui.tween(this.fakeImg,["opacity","height","width","left"],[1,this.entity.offsetHeight-4,this.entity.offsetWidth-4,Core.Dom.getLeft(this.posRelDom)-217],.3,"strongEaseIn",{end:function(){new Ui.tween(a.fakeImg,["opacity"],[1],.1,"simple",{end:function(){a.entity.style.left=Core.Dom.getLeft(a.fakeImg)+"px";a.entity.style.top=Core.Dom.getTop(a.fakeImg)+"px";a.fakeImg.style.display="none";a.entity.style.visibility="visible";a.switchOn=true;a.lockPosX=Core.Dom.getLeft(a.posRelDom)-Core.Dom.getLeft(a.entity);a.lockPosY=Core.Dom.getTop(a.posRelDom)-Core.Dom.getTop(a.entity)}})}})},addClass:function(a,b){if(!a)return false;if(!this.hasClass(a,b)){a.className=Core.String.trim(a.className.concat(" "+b))}},delClass:function(a,b){if(!a)return false;var c=new RegExp("(?: +|^)"+b+"(?=( |$))","ig");a.className=Core.String.trim(a.className.replace(c,""))},hasClass:function(a,b){if(!a)return false;var c=new RegExp("(?: +|^)"+b+"(?=( |$))","ig");return c.test(a.className)}};$registJob("calendar_wc",function(){if(typeof attentionWorldCup=="undefined")return;var a=new CalendarWc;$E("calendar_wc").onmouseover=function(){if(a.isTween)return;a.setPos(this,0,0);a.tweenPlay();return false}});$SYSMSG.extend({B00802:"抱歉，此篇图片已经被删除",B00803:"抱歉，此篇专辑已经被删除",B00804:"抱歉，此篇文章已经被删除"});$registJob("digger",function(){function h(a){var e=0;var f=setInterval(function(){e+=500;if(e>=$_GLOBAL.diggerFlashTimeout){trace("已超时，不再尝试放进flash cookie:"+a.res_id+"_"+(a.res_uid||scope.$uid)+"_"+b+"_"+a.res_type);clearInterval(f);d=true}if(c){clearInterval(f);i(a)}},500)}function i(a){if(d){trace("不等待,flash已经是不可靠的，顶没有放入flash cookie");return}if(!c){h(a)}else{g.setData(a.res_id+"_"+(a.res_uid||scope.$uid)+"_"+b+"_"+a.res_type);trace(a.res_id+"_"+(a.res_uid||scope.$uid)+"_"+b+"_"+a.res_type+"放入成功!")}}function j(a){var b=0;var e=setInterval(function(){b+=500;trace("waitOrExecute:等待flash加载..."+b);if(c){clearInterval(e);scope.digger.bindEvent(a)}if(b>=$_GLOBAL.diggerFlashTimeout){trace("响应超时，直接执行代码");clearInterval(e);k(a);d=true;return}},500)}function k(a){for(var b in a.events){a.targetEle["on"+b]=a.events[b](a)}}function m(a){if(l){return}l=true;(new Interface(a.url,"jsload")).request({GET:a.params,onSuccess:function(b){a.onSuccess&&a.onSuccess(b);l=false},onError:function(b){a.onError&&a.onError(b);l=false},onFail:function(){a.onFail&&a.onFail();l=false}})}function s(){r.innerHTML='<div style="text-align:center;"><img src="http://simg.sinajs.cn/blog7style/images/common/loading.gif" />加载中…</div>'}var a=$E("d1_digg_"+scope.$articleid);if(!scope.digger){scope.digger={}}scope.digger.flashReady=function(){};scope.digger.diggerPer=function(){};scope.digger.diggerNums=function(){};scope.digger.setData=function(){};scope.digger.diggerPost=function(){};scope.digger.bindEvent=function(){};scope.digger.showLast10=function(){};scope.digger.hiddenLast10=function(){};if(!$E("diggerFla")){trace("no diggerFla");return}if(!$_GLOBAL.diggerOpenFlag){trace("close...");return}Lib.checkAuthor();var b="";if($isLogin){b=$UID;trace("当前用户:"+$UID)}var c=false;var d=false;scope.digger.flashReady=function(){trace("--------顶踩加载完毕....");c=true};trace("--------顶踩开始加载完毕....");var e="";if(window.$Maxthon||window.$360||window.$TT){e="?t="+Core.Math.getUniqueId()}var f=new Utils.Flash.swfObject($_GLOBAL.flashBasicURL+"digger.swf"+e,"digger","1","1","9","#00ff00");f.addParam("quality","high");f.addParam("wmode","transparent");f.addParam("allowScriptAccess","always");f.write("diggerFla");var g=$E("digger");scope.digger.diggerPer=function(a){if(!a.params){a.params={res_id:a.res_id,res_uid:a.res_uid||scope.$uid}}a.url="http://control.blog.sina.com.cn/riaapi/digg/get_digg.php";m(a)};scope.digger.diggerNums=function(a){if(!a.params){a.params={res_id:a.res_id,res_uid:a.res_uid||scope.$uid}}a.url="http://blogtj.sinajs.cn/api/get_digg_num.php";m(a)};scope.digger.setData=function(a,b,c){i({res_id:a,res_uid:b,res_type:c})};scope.digger.diggerPost=function(a){if(!a.params){a.params={res_id:a.res_id,res_uid:a.res_uid||scope.$uid,action:a.action||"0",res_type:a.res_type}}a.url="http://control.blog.sina.com.cn/admin/digg/post_digg.php";if(!a.onSuccess){a.onSuccess=function(b){i(a)}}else{var b=a.onSuccess;a.onSuccess=function(c){b(c);i(a)}}m(a)};scope.digger.bindEvent=function(a){if(d){trace("不等待,flash已经是不可靠的，直接执行代码");k(a);return}if(!c){trace("falsh还没有加载完毕");j(a)}else{trace("读取"+a.res_id+"_"+(a.res_uid||scope.$uid)+"_"+b+"_"+a.res_type+":"+g.getData(a.res_id+"_"+(a.res_uid||scope.$uid)+"_"+b+"_"+a.res_type));if(g.getData(a.res_id+"_"+(a.res_uid||scope.$uid)+"_"+b+"_"+a.res_type)){trace(a.res_id+"_"+(a.res_uid||scope.$uid)+"_"+b+"_"+a.res_type+": 找到，不绑定事件");a.whenFind&&a.whenFind(a)}else{trace(a.res_id+"_"+(a.res_uid||scope.$uid)+"_"+b+"_"+a.res_type+": 未找到，绑定事件");k(a)}}};var l=false;var n=document.createElement("div");n.className="tb_layer_Y tb_layer_w3";n.style.cssText="z-index: 511;position:absolute;display:none;width:160px";var o=document.createElement("div");o.className="tb_layer_arrow";var p=document.createElement("div");p.className="tb_layer_Y_main tip_ps";p.style.cssText="width:auto;";if(a&&a.innerHTML==="顶"){p.innerHTML='<a style="margin-top: 5px;" title="关闭" class="tb_friend_inputDel" href="javascript:void(0)"></a>						<div style="text-align:left;color:#999999">最近顶了的博主：</div>						<div></div>'}else{p.innerHTML='<a style="margin-top: 5px;" title="关闭" class="tb_friend_inputDel" href="javascript:void(0)"></a>						<div style="text-align:left;color:#999999">最近喜欢了的博主：</div>						<div></div>'}n.appendChild(o);n.appendChild(p);document.body.appendChild(n);var q=p.getElementsByTagName("a")[0];var r=p.getElementsByTagName("div")[1];r.style.whiteSpace="nowrap";s();q.onclick=function(){scope.digger.hiddenLast10()};scope.digger.showLast10=function(b){s();scope.digger.diggerPer(b);var c=Core.Dom.getXY(b.ele);b.onError=function(a){r.innerHTML='<div style="text-align:center;color:#999999;font-weight:bolder;">数据请求失败，请稍后重试</div>'};b.onFail=b.onError;b.onSuccess=function(b){if(n.style.display){trace("已经被关闭，不再往里面写入信息");return}var c=[];var d=Lib.blogv.getVHTML;for(var e=0;b[e];e++){var f=b[e];var g=f["action_uname"];c.push("<div>",'<a target="_blank" title="到',f["action_uname"],'的博客去看看" href="http://blog.sina.com.cn/u/',f["action_uid"],'">',g,"</a>",d(parseInt(f.wtype||-1)),"</div>")}if(!c.length){if(a&&a.innerHTML==="顶"){r.innerHTML='<div style="text-align:center;color:#999999;font-weight:bolder;">暂无登录用户顶过</div>'}else{r.innerHTML='<div style="text-align:center;color:#999999;font-weight:bolder;">暂无登录用户喜欢过</div>'}}else{r.innerHTML=c.join("")}};var d=0;var e=50;var f=(b.dx||-76)+c[0];var g=(b.dy||10)+c[1];if($IE){f-=1;g-=2}if($SAFARI){f+=1}if($CHROME){f+=1;g+=2}n.style.display="";n.style.left=f+"px";n.style.top=g+"px";Core.Dom.opacity(n,d);new Ui.tween(n,["opacity"],[1],.3,"strongEaseIn");window.onresize=function(){var a=Core.Dom.getXY(b.ele);n.style.left=a[0]-76+"px";n.style.top=a[1]+10+"px"}};scope.digger.hiddenLast10=function(){var a=1;new Ui.tween(n,["opacity"],[0],.3,"strongEaseOut")}});$registJob("stylefix",function(){if($IE6&&scope.UserPic&&scope.UserPic[1]&&scope.UserPic[1].apply=="1"){$E("blognavBg").style.filter="none"}});$registJob("articleDigger",function(){function b(){var a=0;var b=setInterval(function(){if(scope.useNewInterfaceToGetNum){trace("通过别的借口进行装载");scope.useNewInterfaceToGetNum.onSuccess=function(a){scope.useNewInterfaceToGetNum=null;g(a)};scope.useNewInterfaceToGetNum.onError=function(a){scope.useNewInterfaceToGetNum=null;g(null)};scope.useNewInterfaceToGetNum.onFail=function(a){scope.useNewInterfaceToGetNum=null;g(null)};trace("装载完毕");clearInterval(b)}},50)}function c(a){a.ele.parentNode.className="SG_aBtn SG_aBtn_ico SG_turn SG_click";a.ele.children[1].innerHTML="已喜欢"}function d(a){var b;if("articletj"!==scope.$pageid){a.ele.className="upBox upBox_dis";a.ele.style.cursor="default";b=a.ele.getElementsByTagName("p")[1];var c=b.innerHTML;var d=SinaEx.createNode("<div>"+c+"</div>");var e=SinaEx.findNode(d,"nextSibling","firstChild");d.removeChild(e);var f=d.innerHTML;if(f==="顶"){b.innerHTML='<img width="15" height="15" align="absmiddle" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" class="SG_icon SG_icon34">已顶'}else{b.innerHTML="已喜欢"}}else{var g=a.ele.getElementsByTagName("span");b=g[0];var h=b.parentNode;var i=h.parentNode.parentNode;i.className="upBox upBox_dis";b.style.cursor="default";h.style.cursor="default";g[1].style.cursor="default";g[2].style.cursor="default";b.innerHTML="已喜欢"}}function e(a){if("articletj"!==scope.$pageid){a.ele.className="upBox upBox_click";a.ele.getElementsByTagName("p")[0].innerHTML="+1"}else{var b=a.ele.getElementsByTagName("span");states=b[0];var c=states.parentNode;var d=c.parentNode.parentNode;d.className="upBox upBox_click";states.innerHTML='<span class="up1">+1</span>喜欢'}}function f(a){if("articletj"!==scope.$pageid){a.ele.className="upBox";var b=a.ele.getElementsByTagName("p")[0];b.innerHTML=b.getAttribute("mnum")}else{var c=a.ele.getElementsByTagName("span");states=c[0];var d=states.parentNode;var e=d.parentNode.parentNode;e.className="upBox";states.innerHTML='<img class="SG_icon SG_icon34" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" title="推荐" align="absmiddle">喜欢'}}function g(b){var g=scope.$pageid==="articletjTech";var h=b?b["digg_m_"+a]:0;var i=$E("dbox2_"+a);if(!i){trace("没有找到计数模块，认为这是不需要顶踩功能的");return}if(h){i.innerHTML=h}else{i.innerHTML="0"}var j=a;i.setAttribute("mnum",h);var k=i.parentNode;k.style.cursor="pointer";scope.digger.bindEvent({ele:k,targetEle:k,ti_title:encodeURIComponent(i.getAttribute("ti_title")||""),disClass:"upBox upBox_dis",res_id:j,uid:scope.$uid,res_type:"1",whenFind:function(a){if(g){c(a)}else{d(a)}},events:{mouseover:function(a){return function(){if(!g){e(a)}}},mouseout:function(a){return function(){if(!g){f(a)}}},click:function(a){return function(){scope.digger.diggerPost({params:{res_id:a.res_id,res_uid:a.res_uid||scope.$uid,action:"0",res_type:"1",ti_title:a.ti_title},res_id:a.res_id,res_uid:a.res_uid||scope.$uid,action:"0",res_type:"1",onSuccess:function(b){a.targetEle.onmouseover=function(){};a.targetEle.onmouseout=function(){};a.targetEle.onclick=function(){};if(g){c(a)}else{d(a)}var e=$E("dbox2_"+a.res_id);var f=parseInt(e.getAttribute("mnum"))+1;e.innerHTML=f},onError:function(b){if(b.code=="B00801"){winDialog.alert("这篇博文您已经喜欢过啦!",{icon:"01"});a.targetEle.onmouseover=function(){};a.targetEle.onmouseout=function(){};a.targetEle.onclick=function(){};if(g){c(a)}else{d(a)}scope.digger.setData(a.res_id,scope.$uid,1);var e=$E("dbox2_"+a.res_id);var f=e.getAttribute("mnum");e.innerHTML=f}else{showError(b.code)}}});return false}}}});var l=$E("d1_digg_"+a);if(!l){return}$E("d1_digg_"+a).onclick=function(a){return function(b){scope.digger.showLast10(a);return false}}({ele:$E("d1_digg_down_"+a),res_id:a,res_uid:scope.$uid});$E("d1_digg_down_"+a).onclick=function(a){return function(b){scope.digger.showLast10(a);return false}}({ele:$E("d1_digg_down_"+a),res_id:a,res_uid:scope.$uid})}if(!$E("diggerFla")){return}if(!$_GLOBAL.diggerOpenFlag){return}var a=scope.$articleid;b()});$registJob("miniBlogAttention",function(){var a=new Interface("http://weibo.com/attention/aj_addfollow.php","jsload");scope.attMiniBlog=function(){Lib.checkAuthor();if($UID){Utils.Io.JsLoad.request("http://weibo.com/attention/aj_addfollow.php?jsdomain=1&uid=1231759973&fromuid="+$UID,{onComplete:function(){}})}}});Lib.register("util.loadScript",function(){var a=!0,b=!1,c={};var d=function(d,e){Utils.Io.JsLoad.request(d,{isRemove:b,noreturn:a,onComplete:function(a){c[d].isLoading=b;var e=c[d].cb;for(var f=0,g=e.length;f<g;f++){e[f](a)}c[d].cb=null}})};return function(b,e){var f=c[b];var g=f&&f["cb"];if(!f){g=[e];f={isLoading:a,cb:g};c[b]=f;d(b,f)}else if(f.isLoading){g.push(e)}else{e()}}});Lib.register("sendSuda",function(a){var b="http://www.sinaimg.cn/unipro/pub/suda_s_v851c.js";return function(c){a.util.loadScript(b,c)}});$registJob("suda",function(){function e(a,b,d,e,f){if(c){v7sendLog(f)}switch(a){case"index":case"indexM":v7sendLog(b);break;case"editor":v7sendLog(d);break;case"articletj":v7sendLog(e);break}}var a=scope&&scope.$pageid;var b=window.location.href;var c=b.indexOf("tj=1")>-1;var d=a&&(a==="articletj"||a==="index"||a==="indexM"||a==="editor"||c);if(d){var f=encodeURIComponent(b);var g=encodeURIComponent(document.referrer)}if(typeof _S_pSt=="function"){if(d){v7sendLog("42_01_03_"+(new Date).getTime()+"_"+f+"_"+g)}return}if(d){if(!$isLogin){var h="42_01_01_"+(new Date).getTime()+"_"+f+"_"+g}else{var h="42_01_01_"+$UID+"_"+(new Date).getTime()+"_"+f+"_"+g}e(a,"42_01_08","42_01_14",h,"42_01_05")}Lib.sendSuda(function(){try{_S_pSt("")}catch(b){}if(d){if(!$isLogin){var c="42_01_02_"+(new Date).getTime()+"_"+f+"_"+g}else{var c="42_01_02_"+$UID+"_"+(new Date).getTime()+"_"+f+"_"+g}e(a,"42_01_09","42_01_15",c,"42_01_06")}})});Lib.register("execZhitou",function(a){var b="http://d5.sina.com.cn/litong/zhitou/sinaads/release/sinaads.js";document.createElement("inc");return function(c){a.util.loadScript(b,c)}});var blogAd={};blogAd.getInitPermission=function(a){var b;if(a&&a.ads&&a.ads[0]){b=a&&a.ads&&a.ads[0];return b.type=="mixed"||b.ref}else{return false}};blogAd.insertIns=function(a,b,c,d){c=c||"beforeend",d=d||"display:block;";var e='<ins class="sinaads" data-ad-pdps="'+a+'" style="'+(d||"")+'"></ins>';b=b||document.body;return Core.Dom.insertHTML(b,e,c)};$registJob("scrollAd",function(){blogAd.insertIns("PDPS000000025949");Lib.execZhitou(function(a){(window.sinaads||[]).push({params:{sinaads_follow_top:40,sinaads_follow_mini_top:200}})})});$registJob("SinglesDay",function(){scope.addFriendForSinglesDay=function(){Lib.checkAuthor();if($UID){(new Interface("http://control.blog.sina.com.cn/riaapi/profile/attention_add.php","ijax")).request({POST:{uid:$UID,aid:1259295385}})}}});Core.Events.stopDefaultEvent=function(a){var b=a?a:Core.Events.getEvent();if(b!=null){if(b.preventDefault){b.preventDefault()}else{b.returnValue=false}}};Utils.excBeforeCloseWin=function(a,b,c,d){closeVar={};closeVar.func=c;closeVar.tips1=a;closeVar.tips2=b;closeVar.args=d;closeVar.length=arguments.length;window.beforeunloadfunc=function(){if(closeVar.length==1){return closeVar.tips1;Core.Events.stopEvent()}else{if($IE){var a=Core.Events.fixEvent(Core.Events.getEvent());if(a.clientY<0||a.altKey){if(confirm(closeVar.tips2)){if(closeVar.args)Core.Function.bind3(closeVar.func,closeVar.func,[closeVar.args])();else closeVar.func()}else{}}}else{function b(a){if(a==true){if(closeVar.args)Core.Function.bind3(closeVar.func,closeVar.func,[closeVar.args])();else closeVar.func()}else{}}return b.call(this,confirm(closeVar.tips2))}}};Core.Events.addEvent(window,beforeunloadfunc,"beforeunload")};var StaticUser=Core.Class.create();StaticUser.prototype={container_id:null,is_init:false,localDB:null,initialize:function(a){this.container_id=a;if(!Lib.LocalDB.FlaDom){trace("first 加载");var b=this;Lib.LocalDB.registerFun(function(){setTimeout(function(){b.loaded()},10)});Lib.LocalDB.loadFlash("trayFlashConnetion")}else{this.loaded()}},loaded:function(){var a=this;if(Lib.LocalDB.get("SUKeya",31536e6)){window.staticunload=function(){if($IE){var a=Core.Events.fixEvent(Core.Events.getEvent());this.record()}else{this.record()}};Core.Events.addEvent(window,Core.Function.bind2(window.staticunload,a),"beforeunload")}else{Lib.LocalDB.set("SUKeya",window.staticTime+parseInt(Math.random()*1e5).toString());this.record();this.send()}var b=Lib.LocalDB.get("SUInfo",31536e6);if(Lib.LocalDB.get("SULastTime",31536e6)){var c=Lib.LocalDB.get("SULastTime",31536e6);if((new Date).getTime()-c>36e5){this.send()}}else{Lib.LocalDB.set("SULastTime",(new Date).getTime())}},record:function(){var a=decodeURIComponent(Lib.LocalDB.get("SUInfo",31536e6));var b="";var c=document.referrer;if((ts=Utils.Cookie.getCookie("SUP"))!=""){ts=decodeURIComponent(ts);if(ts!="")b+="|lu:"+ts.split("&uid=")[1].split("&")[0];if(scope.unreadMsg&&scope.unreadMsg.isbloguser){b+="|ib:"+scope.unreadMsg.isbloguser}if(!Lib.LocalDB.get("SULoginFlag")){b+="|al:1|at:"+(new Date).getTime()}else{if(c==""){b+="|al:4"}else if(c.indexOf("blog.sina.com.cn")>-1){b+="|al:2"}else{b+="|al:3"}}if(Utils.Cookie.getCookie("ALF")!=""){b+="|pu:1"}Lib.LocalDB.set("SULoginFlag",true)}else{Lib.LocalDB.set("SULoginFlag",false)}var d="et:"+window.staticTime+"|r:"+c+"|u:"+window.location.href+"|lt:"+(new Date).getTime().toString()+"|vu:"+scope.$uid+b+";";Lib.LocalDB.set("SUInfo",encodeURIComponent(a+d))},send:function(){var a=Lib.LocalDB.get("SUKeya",31536e6);var b=decodeURIComponent(Lib.LocalDB.get("SUInfo",31536e6));var c=b.split(";");if(c.length>5){var d="";for(var e=0;e<c.length;e++){if((e+1)%5==0){v7sendLog("StaticUser","",encodeURIComponent("k:"+a+";"+d));d=""}else{d+=c[e]+";"}}if(d!=""){v7sendLog("StaticUser","",encodeURIComponent("k:"+a+";"+d))}}else{v7sendLog("StaticUser","",encodeURIComponent("k:"+a+";"+b))}Lib.LocalDB.set("SUInfo","");Lib.LocalDB.set("SULastTime",(new Date).getTime())}};$registJob("static",function(){window.staticClass=new StaticUser;var a=function(){var a=document.createElement("div");a.className="dowAndroidTip";a.id="dow_AndroidTip";a.innerHTML=""+'<div class="dowAndroidTipInner">'+'<p style="cursor:pointer;" id="save2mobile">将此博客<span>保存到手机</span></p>'+'<p style="cursor:pointer;" id="save2mobile2">阅读随时随地</p>'+'<span class="arrowMod"><span class="arrowModInner"></span></span>'+'<a id="close_discover" class="close" href="javascript:;" title="关闭">关闭</a>'+"</div>";$E("headarea").appendChild(a);var b=Core.Dom.getXY(document.body);var c=Core.Dom.getXY($E("blogtopoption"));a.style.position="absolute";a.style.left=b[0]+728+"px";a.style.top=c[1]-45+"px";$E("close_discover").onclick=function(){v7sendLog("70_01_05_"+($UID||0));$E("dow_AndroidTip").style.visibility="hidden";return false};$E("save2mobile").onclick=$E("save2mobile2").onclick=function(a){Core.Events.stopEvent(a);v7sendLog("70_01_06_"+($UID||0));window.open("http://appmaster.hudee.com/sina/download.jsp?uid="+scope.$uid);$E("dow_AndroidTip").style.visibility="hidden"}};var b=Core.Dom.byClz($E("blogtopoption"),"a","dwnAndroid");if(b.length){b=b[0];if(Core.String.trim(b.innerText||b.textContent||"")==="下载应用"){a()}Core.Events.addEvent(b,function(){var a=Core.String.trim(b.innerText||b.textContent||""),c;switch(a){case"下载应用":c="70_01_01_"+($UID||0);break;case"制作应用":c="70_01_02_"+$UID;break;case"管理应用":c="70_01_04_"+$UID;break;case"制作中":c="70_01_03_"+$UID}c&&v7sendLog(c)})}});$registJob("sharePhoto",function(){function p(){if(this.width<165||this.height<k){return false}var a=Core.Dom.getXY(this)[0]+this.width-124;a=Math.min(a,i-134);s.left=a+"px";s.top=Core.Dom.getXY(this)[1]+this.height-k+4+"px";if(l){s.display=""}f=encodeURIComponent(this.getAttribute("real_src")||this.src);g=this}function q(){var a=Core.Events.getEvent(),b=a.relatedTarget||a.toElement;if(!b||!Core.Dom.contains(m,b)){s.display="none"}}function t(a,b){if(!(a.getAttribute(b)||"").indexOf("http://www.sinaimg.cn/uc/myshow/blog/misc/gif/E___")||!Core.Dom.contains(h,a)){return}u();j=new Image;Core.Events.addEvent(j,function(){if(this.width>165&&this.height>35){Core.Events.addEvent(a,p.bind2(a),"mouseover");Core.Events.addEvent(a,q.bind2(a),"mouseout")}}.bind2(j),"load");j.src=a.getAttribute(b)}function u(){i=Core.Dom.getXY(h)[0]+h.clientWidth}function v(a){if(c){return}var b;while(a=a.parentNode){if(a.className=="content"&&a.nodeName=="DIV"&&(b=a.nextElementSibling||a.nextSibling).className=="tagMore"){return($T(b,"a")[0]||{}).href||""}}}function w(){l=1;a($T(h,"img"),function(a){t(a,"src")})}var a=Core.Array.foreach,b=scope.$pageid,c=b=="article"||b=="articleM",d=scope.$uid,e,f,g,h=$E("sina_keyword_ad_area2")||document.body,i,j,k=62,l=1;var m=SinaEx.createNode('<div id="sharePhoto" style="display:none;width:120px;position:absolute;">'+'<div class="picShareQing"><div class="share SG_txtb"><span>分享到新浪Qing</span></div></div>'+'<div class="picShareFlt"><div class="share SG_txtb" style="margin-top:5px;"><span>分享到新浪微博</span></div></div>'+"</div>");var n=m.children[0];var o=n.nextSibling;document.body.appendChild(m);setTimeout(function(){Lib.Uic.getNickName([d],function(a){e=a[d]})},500);var r=m,s=r.style;Core.Events.addEvent(n,function(){var a=c?"的《"+Core.Dom.byClz(document.body,"h2","titName")[0].innerHTML+"》":"",b=$_GLOBAL.qingURL+"blog/controllers/share.php?searchPics=0&content="+encodeURIComponent("分享"+e+a+"的博文图片，查看原文：")+"&url="+encodeURIComponent(v(g)||location.href)+"&ralateNick="+encodeURIComponent("新浪博客")+"&pics="+f;window.open(b,"shareQing","toolbar=0,status=0,resizable=1,width=600,height=520,left="+(screen.width-600)/2+",top="+(screen.height-520)/2);v7sendLog("80_01_02");return false});Core.Events.addEvent(o,function(){var a="http://v.t.sina.com.cn/share/share.php?",b=encodeURIComponent("分享"+e+"的博文图片："+(c?Core.Dom.byClz(document.body,"h2","titName")[0].innerHTML:"")),d="新浪-博客",h="http://blog.sina.com.cn",i="http://v.t.sina.com.cn/share/share.php?searchPic=false&title="+b+"&url="+encodeURIComponent(v(g)||document.location)+"&source="+d+"&sourceUrl="+encodeURIComponent(h)+"&content=utf-8&appkey=1617465124&pic="+f;window.open(i,"mb","toolbar=0,status=0,resizable=1,width=440,height=430,left="+(screen.width-440)/2+",top="+(screen.height-430)/2);v7sendLog("80_01_09");Core.Events.stopEvent()});Core.Events.addEvent(window,u,"resize");if(b=="index"||b=="indexM"){a([$E("module_10001"),$E("module_10002"),$E("module_10003")],function(a){if(a&&a.clientWidth>500){h=a;w()}})}if(Lib&&Lib.Component["Comp_10001"]){var x=Lib.Component["Comp_10001"].prototype.afterLoadList;Lib.Component["Comp_10001"].prototype.afterLoadList=function(){l=0;s.display="none";x.apply(this,arguments);setTimeout(w,100)}}scope.sharePhoto={bindFn:t}});$registJob("selectionShare",function(){function i(){g=null;h=null;var a=Core.String.trim;if(document.selection){var b=document.selection.createRange();var c=b.text;if(c.length>=10){g=c}var d=b.htmlText;var e=/<img[\s\S]+src="(\S+)"[\s\S]+>/img;if(e.test(d)){h=RegExp.$1}}else{try{var b=window.getSelection().getRangeAt(0);if(!Core.Dom.contains($E("sina_keyword_ad_area2"),b.commonAncestorContainer)){return}var c=b.toString();if(c.length>=10){g=c}var f=$C("div");f.appendChild(b.cloneContents());var i=$T(f,"img");if(i.length>0){h=i[0].src||i[0].real_src}}catch(j){}}if(g){g=a(g).replace(/\r|\n/g,"")}return g}function j(){if(g&&g.length>80){g=g.substr(0,80)+"……"}var a=Core.Dom.byClz(document.body,"h2","titName")[0];var c=a.textContent||a.innerHTML;if(g){var d=encodeURIComponent(g+"——博文片段来自"+b+"："+c)}else{var d=encodeURIComponent("分享"+b+"的博文图片："+c)}var e="http://v.t.sina.com.cn/share/share.php?",f="新浪-博客",i="http://blog.sina.com.cn",j="http://v.t.sina.com.cn/share/share.php?searchPic=false&title="+d+"&url="+document.location+"&source="+f+"&sourceUrl="+encodeURIComponent(i)+"&content=utf-8&appkey=1617465124";if(h){j=j+"&pic="+h}window.open(j,"selectionshare","toolbar=0,status=0,resizable=1,width=440,height=430,left="+(screen.width-440)/2+",top="+(screen.height-430)/2);l()}function k(){a.style.left=c+"px";a.style.top=d+"px";a.style.display=""}function l(){a.style.display="none"}function m(a){if(!$IE){n();return}var b=document.selection.createRange();var g=b.duplicate();g.collapse(false);g.moveStart("word",-1);while(g.text.length==0){g.moveStart("word",-1)}var h=false;if(a.pageY-f<=-g.boundingHeight){h=true;trace(11111)}if(Math.abs(a.pageY-f)<g.boundingHeight){if(a.pageX-e<0){h=true;trace(11111)}else{h=false;trace(22222)}}b.collapse(h);if(!h){b.moveStart("word",-1);while(b.text.length==0){b.moveStart("word",-1);b.moveEnd("word",-1)}}var i=b.htmlText;var j="temp_"+parseInt(Math.random()*1e3);var k=b.boundingWidth,l=b.boundingHeight;b.pasteHTML('<a id="'+j+'" >$</a>'+i);var m=$E(j);if(h){c=Core.Dom.getLeft(m)+10;d=Core.Dom.getTop(m)-26-7}else{c=Core.Dom.getLeft(m)+k-36;d=Core.Dom.getTop(m)+l}m.parentNode.removeChild(m)}function n(){var a=window.getSelection();var b=a.rangeCount-1;var e=a.getRangeAt(b);var f=$C("span");var g=e.cloneRange();var h=false;var i;var j;var k;i=e.startContainer;if(e.startContainer!=e.endContainer){if(a.focusNode!=e.startContainer){h=true;i=e.endContainer}}else{if(a.focusOffset>a.anchorOffset){h=true}}g.collapse(!h);g.insertNode(f);k=Core.Dom.getXY(f);if(i.nodeType==3){i=i.parentNode}if(i.tagName.toUpperCase()=="IMG"){j=i.offsetWidth}else{j=Core.Dom.getStyle(i,"fontSize");j=parseInt(j.substring(0,j.length-2))}if(h){c=k[0]-33;d=k[1]+10;if(!$FF){d+=j}}else{c=k[0]+7;d=k[1]-36;if($FF){d-=j}}f.parentNode.removeChild(f);a.removeAllRanges();a.addRange(e)}if(!$E("sina_keyword_ad_area2")){return}var a=$C("div");a.innerHTML='<img src="http://simg.sinajs.cn/blog7style/images/common/share.gif" title="将选中内容分享到新浪微博"/>';a.id="selectionShare";a.style.display="none";a.style.position="absolute";a.style.cursor="pointer";document.body.appendChild(a);Core.Events.addEvent(document.body,function(){l()});Core.Events.addEvent(a,function(){j();Core.Events.stopEvent()});var b=null;Lib.Uic.getNickName([scope.$uid],function(a){b=a[scope.$uid]});var c=0,d=0;var e=0,f=0;var g,h;Core.Events.addEvent($E("sina_keyword_ad_area2"),function(a){var a=Core.Events.getEvent();a=Core.Events.fixEvent(a);setTimeout(function(){var b=i();if(b){setTimeout(function(){k()},100);m(a)}else{l()}})},"mouseup");Core.Events.addEvent($E("sina_keyword_ad_area2"),function(a){var a=Core.Events.getEvent();a=Core.Events.fixEvent(a);e=a.pageX;f=a.pageY},"mousedown")});$registJob("toZoneStatic",function(){if(scope.$uid=="1513474044"||scope.$uid=="1632440911"||scope.$uid=="1311747503"||scope.$uid=="1374847633"||scope.$uid=="1265252974"||scope.$uid=="1218670734"||scope.$uid=="1156966391"){Utils.Io.JsLoad.request("http://sjs.sinajs.cn/blog7activity/zoneStatic.js",{isRemove:false,onComplete:function(){if(typeof zoneStatic=="function"){zoneStatic()}if(typeof traceFunction=="function"){traceFunction()}},noreturn:true})}});Lib.templateUtils=function(){};Lib.templateUtils.prototype.getTemplateNodes=function(a){var b=document.createElement("div");var c={};var d=[];var e=(new Date).getTime().toString().slice(-5)+Math.floor(Math.random()*1e5);var f=/#{([a-z0-9_]+)}/gi;a=a.replace(f,function(a,b){d.push(b);return b+"_"+e});b.innerHTML=a;var g;var h=d.length;var i;for(g=0;g<h;g++){i=d[g];c[i]=this.findById(i+"_"+e,b)}return c};Lib.templateUtils.prototype.getIdNodes=function(a){var b,c,d,e,f,g;var h={};var i=[];var j=[];var k=[];var l=document.createElement("div");l.innerHTML=a;k=l.getElementsByTagName("*");a.replace(/id *= *"([^{ ]+?)"/ig,function(a,b){i[i.length]=b});d=k.length;for(b=0;b<d;b++){if(k[b].id)j[j.length]=k[b]}d=i.length;for(b=0;b<d;b++){f=i[b];c=0;e=j.length;while(c<e){g=j[c];if(f==g.id){h[f]=g;j.splice(c,1)}c++}}return h};Lib.templateUtils.prototype.findById=function(a,b,c){var d;var b=b||document;var e=b.getElementsByTagName(c||"*");var f=e.length;for(d=0;d<f;d++){if(e[d].getAttribute("id")==a){return e[d]}}};Lib.templateUtils.prototype.formatTemplate=function(a,b){var a;var c=new RegExp("#{([a-z0-9]+)}","ig");a=a.replace(c,function(a,c,d,e){return b[c]});return a};(function(){function a(a){function b(){}b.prototype=a;return new b}Function.prototype.$defineProto=function(a){var b;for(b in a){this.prototype[b]=a[b]}if(this.__interface__){for(b in this.prototype){if(this.prototype[b]==="NI"){throw new Error("类定义错误，接口方法["+b+"]未实现")}}}this.prototype.constructor=this;this.$extendClass=this.$defineProto=this.$implements=function(){throw new Error("$defineProto 语句定义后面不能再作其它定义")};return this};Function.prototype.$extendClass=function(){var b=this;var c=arguments.length;var d;var e;if(c===0){throw new Error("$extendClass 语句错误：未指定父类")}d=arguments[0];e=function(){var a=this;this.$super={};for(var c in d.prototype){if(!d.prototype[c])continue;this.$super[c]=function(b){return function(){d.prototype[b].apply(a,arguments)}}(c)}d.apply(this,arguments);b.apply(this,arguments)};e.prototype=a(d.prototype);e.prototype.constructor=e;return e};Function.prototype.$implements=function(){var a=Array.prototype.slice.call(arguments,0);var b;var c=a.length;var d;while(c--){if(typeof a[c]!=="object"){throw new Error("$implements 语句错误：参数必须为 object 类型")}for(d in a[c]){typeof this.prototype[d]==="undefined"&&(this.prototype[d]="NI")}}this.__interface__=true;this.$extendClass=function(){throw new Error("$extendClass 语句错误：$extendClass 语句不能出现在 $implements 定义之后")};return this};Function.prototype.$mixProto=function(){this.$extendClass=this.$defineProto=function(){throw new Error("$mixProto 必须放在最后使用")};var a=arguments[0];var b=a.prototype;for(var c in b){if(this[c])throw new Error("目标类有同名方法");if(!b[c])continue;this.prototype[c]=b[c]}return this}})();blogAd.CommAd=function(a){Lib.checkAuthor();var b,c,d;var e=$E("commAd_1");var f=$E("commAd_2");if(!e){trace("no id");b=$E("articlebody");c=articlebody.getElementsByTagName("strong");for(d=0;d<c.length;d++){if(c[d].innerHTML=="评论"){e=c[d].parentNode.getElementsByTagName("span")[0]}else if(c[d].innerHTML=="发评论"){f=c[d].parentNode.getElementsByTagName("span")[0]}}}this.MARK_ID=2;this.LIMITED=24;var g=['<span style="margin-left:15px; width:220px; display:inline-block;">','<a target="_blank" href="http://blog.sina.com.cn/lm/8/2009/0325/105340.html">重要提示：警惕虚假中奖信息</a>',"</span>"].join("");var h='<span style="display:inline-block;width:220px;white-space:nowrap;">#{link}</span>';var i='<span style="margin:0 60px 0 20px; display:inline-block;">|</span>';var j="";var k="";var l="",m=false;if(!$isAdmin&&a&&!+a.code&&a.ads){if(a.ads[0]&&a.ads[0].link){m=true;j=this.formatTemplate(h,{link:a.ads[0].link});if(a.ads[0].status&&a.ads[0].status.adstart)(new Image).src=a.ads[0].status.adstart}if(a.ads[1]&&a.ads[1].link){m=true;k=this.formatTemplate(h,{link:a.ads[1].link});if(a.ads[1].status&&a.ads[1].status.adstart)(new Image).src=a.ads[1].status.adstart}if(a.ads[2]&&a.ads[2].link){m=true;l=this.formatTemplate(h,{link:a.ads[2].link});if(a.ads[2].status&&a.ads[2].status.adstart)(new Image).src=a.ads[2].status.adstart}}if(e){e.style.display="inline-block"}if(f){f.style.display="inline-block"}m&&commonLog("http://1092.adsina.allyes.com/main/adfshow?user=AFP6_for_SINA|2012_add|2012_blog_tjbw_plq_wzl&db=sina&border=0&local=yes&js=ie")}.$defineProto({}).$mixProto(Lib.templateUtils);blogAd.insertIns=function(a,b,c,d){c=c||"beforeend",d=d||"display:block;";var e='<ins class="sinaads" data-ad-pdps="'+a+'" style="'+(d||"")+'"></ins>';b=b||document.body;return Core.Dom.insertHTML(b,e,c)};var Article={};Article.getSearchReferrer=function(){var a={};var b=document.URL;if(b.indexOf("blog.sina.com.cn")!=-1&&b.indexOf("k=")!=-1){var c=new Utils.Url(b);a.key=c.getParam("k");a.type=c.getParam("t");return a}var d=document.referrer;if(!d||d===""){return false}var e={"www.google.co.jp":{param:"q",type:"utf-8"},"www.google.com.hk":{param:"q",type:"utf-8"},"www.baidu.com":{param:"wd",type:"GBK",needTrans:true},"www.soso.com":{param:"query",type:"GBK",needTrans:true},"search.yahoo.com":{param:"p",type:"utf-8"},"cn.bing.com":{param:"q",type:"utf-8"},"www.youdao.com":{param:"q",type:"utf-8"},"www.sogou.com":{param:"query",type:"GBK",needTrans:true},"www.so.com":{param:"q",type:"utf-8"}};for(var f in e){var g=new Utils.Url(d);if(d.indexOf(f)!=-1){a.key=g.getParam(e[f]["param"]);a.type=e[f]["type"];a.needTrans=e[f]["needTrans"];break}}if(!a.key||a.key===""){return false}else{return a}};window.sendLogToQing=function(a,b){if(typeof scope==="undefined"){window.scope={};scope.$uid=scope.$pageid=""}var c=a||"",d=b||scope.$uid,e=scope.$pageid,f=(new Date).getTime(),g=c+"|"+f+"|"+e+"|"+d;var h=window["actlog_img"]=new Image;h.onLoad=h.onError=function(){window["actlog_img"]=null};h.src=$_GLOBAL.qingURL+"blog/api/actlog.php?msg="+encodeURIComponent(g);h=null};$registJob("searchToQing",function(){function d(a){var d=decodeURIComponent,e="",f=$C("div"),g;f.className="blog_skeywords";f.style.overflow="hidden";f.style.position=$IE6?"absolute":"fixed";f.style.right="0px";f.style.zIndex=10;e=""+'<dl class="clearfix">'+'<dt><a href="'+d(a.ad_pic_url)+'" target="_blank" title="'+d(a.ad_title)+'">'+'<img width="208" height="48" src="'+d(a.ad_pic_address)+'" alt="'+d(a.ad_title)+'" />'+"</a></dt>"+"<dd>"+(a.ad_word1?'<p><a href="'+d(a.ad_word1_url)+'" target="_blank">'+d(a.ad_word1)+"</a></p>":"")+(a.ad_word2?'<p><a href="'+d(a.ad_word2_url)+'" target="_blank">'+d(a.ad_word2)+"</a></p>":"")+"</dd>"+"</dl>"+'<a onclick="this.parentNode.style.display=\'none\';return false;" href="javascript:;" class="close"></a>';f.innerHTML=e;c.appendChild(f);g=f.offsetHeight;f.style.top=(b.clientHeight||c.clientHeight)-g+"px";$IE6&&Core.Events.addEvent(window,function(a){var d=b.scrollTop||c.scrollTop,e=b.clientHeight||c.clientHeight;f.style.top=Math.abs(e+d-g)+"px"},"scroll");Core.Events.addEvent(window,function(){setTimeout(function(){var a=b.scrollTop||c.scrollTop,d=b.clientHeight||c.clientHeight;var e=Math.abs(d-g);if($IE6){e=Math.abs(d+a-g)}f.style.top=e+"px"},30)},"resize")}function e(){var a,d;var e=130,f=b.clientHeight||c.clientHeight;var g="http://blog.sina.com.cn/lm/iframe/article/searchqing.html?t="+ +(new Date);a=$C("iframe");a.src=g;a.width="100%";a.scrolling="no";a.style.border="0px";a.frameBorder="no";closeBtn=$C("a");closeBtn.className="nblog_searchBtmBtn";closeBtn.href="javascript:void(0);";closeBtn.title="关闭";closeBtn.innerHTML="关闭";closeBtn.id="serachToQingCloseBtn";closeBtn.onClick="return false";d=$C("div");d.id="searchToQing";d.style.width="100%";d.style.height="100px";d.style.left="0px";d.style.top=f-e+"px";d.style.position="fixed";d.style.zIndex=201;d.appendChild(closeBtn);d.appendChild(a);Core.Events.addEvent(closeBtn,function(){trace("add events to closeBtn");$E("searchToQing").parentNode.removeChild($E("searchToQing"))},"click");if($IE6){d.style.position="absolute";d.style.overflow="hidden";Core.Events.addEvent(window,function(){var a=b.scrollTop||c.scrollTop,d=b.clientHeight||c.clientHeight;var f=Math.abs(d-e);if($IE6){f=Math.abs(d+a-e)}$E("searchToQing").style.top=f+"px"},"scroll");a.style.left=d.style.left;a.style.top=d.style.top}c.appendChild(d);Core.Events.addEvent(window,function(a){setTimeout(function(){var a=b.scrollTop||c.scrollTop,d=b.clientHeight||c.clientHeight;var f=Math.abs(d-e);if($IE6){f=Math.abs(d+a-e)}$E("searchToQing").style.top=f+"px"},20)},"resize");Core.Events.addEvent($E("serachToQingCloseBtn"),function(a){sendLogToQing("79_01_12|blog7",$UID||"")},"click");d=null;a=null;if($E("searchToQing")&&SUDA){SUDA.uaTrack("blog_sflow","v_sflow")}}var a=scope.isFromSearchEngine||Article.getSearchReferrer();if(!a){return}var b=document.documentElement,c=document.body;e()});Lib.BlogRecommendDialog=Core.Class.create();Lib.BlogRecommendDialog.prototype={template:['<div class="blogreco" id="#{panel}">','<div id="#{frame}">','<div class="TB" id="#{titleBar}">','<a id="blogNorAd_Cls" class="btnClose" style="position:absolute;left:240px;" href="javascript:">&nbsp;</a>','<a class="btnMin" style="position:absolute;left:220px;" id="#{btnMin}" href="javascript:">&nbsp;</a>',"</div>",'<div id="#{content}"></div>',"</div>","</div>"].join(""),contentUrl:'<iframe frameborder="0" scrolling="no" class="IF" src="http://blog.sina.com.cn/lm/mini/01.html"></iframe>',name:"blogRecoDialog",_slide:null,_dialog:null,_cookie:"dlg680",_mode:null,_timePoints:null,_toolbarHeight:0,width:260,height:190,isMin:false,displayState:"max",closedADLayer:null,closedFlashTemplate:"",_evt:null,initialize:function(a,b,c){var d=this;var e;this._mode=a;this._timePoints=b;this.oParam=c;this.isShowClosedAD=!+c.code;if(!this._dialog){this._dialog=new Ui.Panel;this._dialog.setTemplate(this.template);e=this._dialog.nodes;e.btnClose=$E("blogNorAd_Cls");this._dialog.entity.style.zIndex="100";this._dialog.ifm&&(this._dialog.ifm.style.zIndex="100");this._dialog.setContent(this.contentUrl);this._dialog.setFixed(true);this.setPos();if(scope.isFromSearchEngine){this._searchToQing()}}this._evt=new Core.Events.EventDispatcher(this);Core.Events.addEvent(e.btnClose,this.close.bind2(this));Core.Events.addEvent(e.btnMin,this.toggle.bind2(this));Core.Events.addEvent(window,function(){if(d._dialog&&d._dialog.entity){var a=document.documentElement.clientWidth||document.body.clientWidth;var b=document.documentElement.clientHeight||document.body.clientHeight;var c=Math.max(a)-d.width,e=Math.max(b)-d.height-d._toolbarHeight;if(scope.isFromSearchEngine){e-=100}d._dialog.setPosition({x:c,y:e})}},"resize")},setPos:function(){var a=document.documentElement.clientWidth||document.body.clientWidth;var b=document.documentElement.clientHeight||document.body.clientHeight;var c=a-this.width;var d=b-this.height-this._toolbarHeight;if(scope.isFromSearchEngine){d-=100}this._dialog.setPosition({x:c,y:d})},show:function(){var a=this;this._dialog.show();this._evt.dispatchEvent("show");this.uiStatus="2";this._slide=new Ui.Slide($E(this._dialog.entity.id));var b=this._slide.container.style;if($IE6){b.overflow="visible";b.height=0}else{b.position="absolute"}this._slide.onSlideMax=function(){a._evt.dispatchEvent("max")};this._slide.slideMax=function(){this.node.style.marginTop=this.offset+"px";new Ui.tween(this.node,"marginTop",0,this.duration,this.animation,{tween:function(a){}.bind2(this),end:this.onSlideMax})}.bind2(this._slide);this._slide.onSlideMin=function(){a._evt.dispatchEvent("min")};this._slide.slideMin=function(){new Ui.tween(this.node,"marginTop",this.offset-28,this.duration,this.animation,{tween:function(a){}.bind2(this),end:this.onSlideMin})}.bind2(this._slide);this._slide.slideIn=function(){new Ui.tween(this.node,"marginTop",this.offset,5*this.duration,this.animation,{tween:function(a){}.bind2(this),end:this.onSlideIn})}.bind2(this._slide);this._slide.onSlideIn=function(){Core.Dom.removeNode(this._dialog.entity);this._dialog.entity=null;a._evt.dispatchEvent("close");setTimeout(function(){var a=$E("rightADWrap");if(a){Core.Dom.setStyle(a,"right","0")}},1e3)}.bind2(this);this._slide.slideMax();if(!blogAd.getInitPermission(this.oParam))return;this.oParam=this.oParam.ads[0];var c=$E("rightADWrap");var d=this.width;if(c){Core.Dom.setStyle(c,"right",d+"px")}},toggle:function(){if(this._dialog.nodes.btnMin){var a=this._dialog.nodes.btnMin.className;if(a=="btnMin"){a="btnMax";this.uiStatus="1";this._slide.slideMin()}else{a="btnMin";this.uiStatus="2";this._slide.slideMax()}this._dialog.nodes.btnMin.className=a;a=null;this.onToggle()}},close:function(){Utils.Cookie.setCookie(this._cookie,(new Date).getHours(),24,"/");var a=this;a.uiStatus="0";Lib.execZhitou(function(a){var b=new sinaadToolkit.Box({position:"right bottom",width:260,height:190,follow:1});b.getMain().innerHTML='<ins class="sinaads" id="PDPS000000025956" data-ad-status="async" data-ad-pdps="PDPS000000025956"></ins>';setTimeout(function(){(sinaads=window.sinaads||[]).push({element:$E("PDPS000000025956"),params:{sinaads_success_handler:function(){b.show();setTimeout(function(){b.hide()},5e3)}}})},1e3)});this._slide.slideIn()},createNode:function(a){var b=$C("div");b.innerHTML=a;return b.childNodes[0]},_initClosedAD:function(){this.closedFlashTemplate=['<div id="#{panel}">','<div id="#{content}">','<div id="blogVideoAd" width="'+this.oParam.width+'" height="'+this.oParam.height+'"></div>',"</div>","</div>"].join("");this.closedADLayer=new Ui.Panel;this.closedADLayer.setTemplate(this.closedFlashTemplate);this.closedADLayer.entity.style.zIndex="100";this.closedADLayer.__iframe&&(this.closedADLayer.__iframe.style.zIndex="100");var a=Core.System.pageSize();var b=Math.min(a[2],document.documentElement.clientWidth)-this.oParam.width;var c=Math.min(a[3],document.documentElement.clientHeight)-this.oParam.height;if(scope.isFromSearchEngine){c-=100}this.closedADLayer.setFixed(true).setPosition({x:b,y:c});var d=this.oParam;var e=this.closedADLayer.nodes;var f=$E("blogVideoAd");if(!f)return;switch(d.type){case"mixed":f.innerHTML=d.content;trace(d.content);break;case"pic":f.innerHTML='<img src="'+d.ref+'" style="width:'+d.width+"px; height:"+d.height+'px;" />';if(d.click){f.style.position="relative";e.cantSeeMe=this.createNode('<a href="#" target="_blank"></a>');e.cantSeeMe.href=d.click;e.cantSeeMe.style.cssText=($IE?"filter:alpha(opacity=0);":"opacity:0")+"; height:"+d.height+"px; width:"+d.width+"px; background:#F00; display:block;"+"z-index:1020; position:absolute; left:0; top:0;";f.appendChild(e.cantSeeMe)}break;case"swf":this.appendSwf(d.ref,"",d.width,d.height,f.id);if(d.click){f.style.position="relative";e.cantSeeMe=this.createNode('<a href="#" target="_blank"></a>');e.cantSeeMe.href=d.click;e.cantSeeMe.style.cssText=($IE?"filter:alpha(opacity=0);":"opacity:0")+"; height:"+d.height+"px; width:"+d.width+"px; background:#F00; display:block;"+"z-index:1020; position:absolute; left:0; top:0;";f.appendChild(e.cantSeeMe)}break}},appendSwf:function(a,b,c,d,e){if(typeof sinaFlash=="undefined")return;var f=new sinaFlash(a,b,c+"",d+"","9","#FFFFFF",false,"High","http://www.sina.com.cn/","http://www.sina.com.cn/",false);f.addParam("allowScriptAccess","always");f.addParam("wmode","transparent");f.write(e)},onToggle:function(){},addEventListener:function(a,b){this._evt.addEventListener(a,b)},getHeight:function(){var a=this.closedADLayer;var b=0;if(this._dialog.entity){trace("dialog height");b=this._dialog.entity.clientHeight-parseInt(this._slide.node.style.marginTop);b>0?b:0;trace("dialog height"+b)}if(a){trace("flash height====");b=a.clientHeight;trace("flash height===="+b)}return b},_searchToQing:function(){var a=this;Core.Events.addEvent($E("serachToQingCloseBtn"),function(){if(scope.isFromSearchEngine){scope.isFromSearchEngine=!1;if(a._dialog&&a._dialog.entity){var b=Math.max(document.documentElement.clientHeight)-a.height-a._toolbarHeight,c=Math.max(document.documentElement.clientWidth)-a.width;a._dialog.setPosition({x:c,y:b})}if(a.closedADLayer&&a.closedADLayer.entity){var d=a.closedADLayer.entity;var e=d.style.top;d.style.top=parseInt(e)+100+"px"}}},"click")}};Lib.ADBlogRecommendDialog=Core.Class.create();Lib.ADBlogRecommendDialog.prototype={template:['<div id="#{panel}" class="popBox">','<div id="#{frame}" class="popBox_bg">','<div id="#{popFlashContent}" class="popFlash" style="z-index:10;">','<a target="_blank" id="#{clickURL}" style="display:none;position:absolute;"></a>',"</div>",'<div id="#{popMain_bg}" class="popMain_bg" style="z-index:11;"></div>','<div class="popMain" style="z-index:12">','<div id="#{content}">',"</div>","</div>",'<div id="#{titleBar}" class="popBox_btn" style="z-index:12;">','<a id="#{btnMin}" href="#" onclick="return false;" title="" class="mini"></a>','<a id="blogNorAd_Cls" href="#" onclick="return false;" title="" class="close"></a>',"</div>","</div>","</div>"].join(""),contentUrl:'<iframe style="width:100%;height:185px;" allowtransparency="yes" frameborder="0" scrolling="no" src="http://blog.sina.com.cn/lm/mini/noborder/01.html"></iframe>',name:"blogRecoDialog",_slide:null,_dialog:null,_cookie:"ad680",_mode:null,_timePoints:null,flashURL:"",picURL:"",flashWidth:0,flashHeight:0,tjURL:"",btnURL:"",clickURL:"",_toolbarHeight:0,width:262,height:255,isMin:false,displayState:"max",closedADLayer:null,closedFlashTemplate:"",_evt:null,initialize:function(a,b,c,d,e,f,g,h,i,j){var k=this;var l;this._mode=a;this.flashURL=d;this.picURL=c;this.flashWidth=e;this.flashHeight=f;this.tjURL=g;this.btnURL=h;this.clickURL=i;this._timePoints=b;this.oParam=j;if(!+j.code){this.isShowClosedAD=true}if(!this._dialog){this._dialog=new Ui.Panel;this._dialog.setTemplate(this.template);l=this._dialog.nodes;l.btnClose=$E("blogNorAd_Cls");this._dialog.entity.style.zIndex="100";this._dialog.ifm&&(this._dialog.ifm.style.zIndex="100");this._dialog.setContent(this.contentUrl);this._dialog.setFixed(true);this.setPos();if(scope.isFromSearchEngine){this._searchToQing()}}this._evt=new Core.Events.EventDispatcher(this);Core.Events.addEvent(l.btnClose,this.close.bind2(this));Core.Events.addEvent(l.btnMin,this.toggle.bind2(this));Core.Events.addEvent(window,function(){if(k._dialog&&k._dialog.entity){var a=Math.max(document.documentElement.clientHeight)-k.height-k._toolbarHeight,b=Math.max(document.documentElement.clientWidth)-k.width;if(scope.isFromSearchEngine){a-=100}k._dialog.setPosition({x:b,y:a})}},"resize");!this.clickURL&&this.initFlashAD(l.popFlashContent.id)},setPos:function(){var a=document.documentElement.clientWidth||document.body.clientWidth;var b=document.documentElement.clientHeight||document.body.clientHeight;var c=a-this.width;var d=b-this.height-this._toolbarHeight;if(scope.isFromSearchEngine){d-=100}this._dialog.setPosition({x:c,y:d})},initFlashAD:function(a){var b=new sinaFlash(this.flashURL,"popSmallFlash",this.flashWidth,this.flashHeight,"8","#FFFFFF",false,"High","http://www.sina.com.cn/","http://www.sina.com.cn/",false);b.addParam("allowScriptAccess","always");b.addParam("wmode","transparent");b.write(a)},show:function(){var a=this._dialog.nodes;a.frame.style.backgroundImage="url("+this.picURL+")";a.btnClose.style.backgroundImage="url("+this.btnURL+")";a.btnMin.style.backgroundImage="url("+this.btnURL+")";a.popMain_bg.style.backgroundImage="url("+this.tjURL+")";if(this.clickURL){a.clickURL.style.display="";a.clickURL.style.width=(this.flashWidth||260)+"px";a.clickURL.style.height=(this.flashHeight||50)+"px";a.clickURL.href=this.clickURL}var b=this;this._dialog.show();this._evt.dispatchEvent("show");this.uiStatus="2";this._slide=new Ui.Slide($E(this._dialog.entity.id));var c=this._slide.container.style;if($IE6){c.overflow="visible";c.height=0}else{c.position="absolute"}this._slide.onSlideMax=function(){b._evt.dispatchEvent("max")};this._slide.slideMax=function(){this.node.style.marginTop=this.offset+"px";new Ui.tween(this.node,"marginTop",0,this.duration,this.animation,{tween:function(a){}.bind2(this),end:this.onSlideMax})}.bind2(this._slide);this._slide.onSlideMin=function(){b._evt.dispatchEvent("min")};this._slide.slideMin=function(){new Ui.tween(this.node,"marginTop",this.offset-55,this.duration,this.animation,{tween:function(a){}.bind2(this),end:this.onSlideMin})}.bind2(this._slide);this._slide.slideIn=function(){new Ui.tween(this.node,"marginTop",this.offset,5*this.duration,this.animation,{tween:function(a){}.bind2(this),end:this.onSlideIn})}.bind2(this._slide);this._slide.onSlideIn=function(){Core.Dom.removeNode(this._dialog.entity);this._dialog.entity=null;b._evt.dispatchEvent("close");setTimeout(function(){var a=$E("rightADWrap");if(a){Core.Dom.setStyle(a,"right","0")}},1e3)}.bind2(this);this._slide.slideMax();if(!blogAd.getInitPermission(this.oParam))return;this.oParam=this.oParam.ads[0];commonLog("http://1088.adsina.allyes.com/main/adfshow?user=AFP6_for_SINA|2012_add|2012_blog_fdtc_bk&db=sina&border=0&local=yes&js=ie");var d=$E("rightADWrap");if(d){Core.Dom.setStyle(d,"right","260px")}},toggle:function(){if(this._dialog.nodes.btnMin){if(this.displayState=="max"){this.uiStatus="1";this._slide.slideMin();this.displayState="min"}else{this.uiStatus="2";this._slide.slideMax();this.displayState="max"}this.onToggle()}},close:function(){Utils.Cookie.setCookie(this._cookie,(new Date).getHours(),24,"/");var a=this;a.uiStatus="0";Lib.execZhitou(function(a){var b=new sinaadToolkit.Box({position:"right bottom",width:260,height:190,follow:1});b.getMain().innerHTML='<ins class="sinaads" id="PDPS000000025956" data-ad-status="async" data-ad-pdps="PDPS000000025956"></ins>';setTimeout(function(){(sinaads=window.sinaads||[]).push({element:$E("PDPS000000025956"),params:{sinaads_success_handler:function(){b.show();setTimeout(function(){b.hide()},5e3)}}})},1e3)});this._slide.slideIn()},createNode:function(a){var b=$C("div");b.innerHTML=a;return b.childNodes[0]},appendSwf:function(a,b,c,d,e){if(typeof sinaFlash=="undefined")return;var f=new sinaFlash(a,b,c+"",d+"","9","#FFFFFF",false,"High","http://www.sina.com.cn/","http://www.sina.com.cn/",false);f.addParam("allowScriptAccess","always");f.addParam("wmode","transparent");f.write(e)},onToggle:function(){},addEventListener:function(a,b){this._evt.addEventListener(a,b)},getHeight:function(){var a=this.closedADLayer;var b=0;if(this._dialog.entity){trace("dialog height");b=this._dialog.entity.clientHeight-parseInt(this._slide.node.style.marginTop);b>0?b:0;trace("dialog height"+b)}if(a&&a.entity.style.display!="none"){trace("flash height====");b=this.oParam.height;trace("flash height===="+b)}return b},_searchToQing:function(){var a=this;Core.Events.addEvent($E("serachToQingCloseBtn"),function(){if(scope.isFromSearchEngine){scope.isFromSearchEngine=!1;if(a._dialog&&a._dialog.entity){var b=Math.max(document.documentElement.clientHeight)-a.height-a._toolbarHeight,c=Math.max(document.documentElement.clientWidth)-a.width;a._dialog.setPosition({x:c,y:b})}if(a.closedADLayer&&a.closedADLayer.entity){var d=a.closedADLayer.entity;var e=d.style.top;d.style.top=parseInt(e)+100+"px"}}},"click")}};Core.System.getParam=function(a){var b=window.location.search.match(new RegExp("(\\?|&)"+a+"=([^&]*)(&|$)"));if(b!=null)return unescape(b[2]);return null};scope.searchEngineList={"www.google.com":{param:"q",encode:"utf-8"},"www.google.com.hk":{param:"q",encode:"utf-8"},"www.baidu.com":{param:"wd",encode:"gbk"},"www.soso.com":{param:"w",encode:"gbk"},"cn.yahoo.com":{param:"p",encode:"utf-8"},"search.yahoo.com":{param:"p",encode:"utf-8"},"web.gougou.com":{param:"search",encode:"utf-8"},"cn.bing.com":{param:"q",encode:"utf-8"},"www.youdao.com":{param:"q",encode:"utf-8"},"www.sogou.com":{param:"query",encode:"gbk"},"uni.sina.com.cn":{param:"k",encode:"gbk"},"search.sina.com.cn":{param:"q",encode:"utf-8"}};scope.searchFloatingLayerTemplate=['<div id="statBottomforniangs" class="blog_sfout">','<div class="blog_srhflt">','<div id="searchFloatingLayer_LeftContentArea" class="blog_sfL">','<div class="blog_sfTit"><a href="#" onclick="v7sendLog && v7sendLog(\'85_01_01\');return false;" id="searchFloatingLayer_RelatedArticle" target="_blank">相关博文</a></div>','<div class="blog_sflist">','<ul id="searchFloatingLayer_RelatedArticleList"></ul>','<span class="SG_more"><a href="#" onclick="v7sendLog && v7sendLog(\'85_01_04\');return false;" id="searchFloatingLayer_More" target="_blank">更多&gt;&gt;</a></span>',"</div>","</div>",'<div class="blog_sM" id="searchFloatingLayer_ad"></div>','<div class="blog_sfR">','<div class="mren">',"<strong>看看名嘴们都在说什么</strong>",'<ul class="mren_list" id="searchFloatingLayer_CelebrityList"></ul>','<div class="clear"></div>',"</div>","</div>",'<div class="clear"></div>',"</div>",'<div class="blog_sfClo"><a id="searchFloatingLayer_CloseBtn" href="#" onclick="return false;"></a></div>',"</div>"].join("");scope.searchFloatingLayer={dataURL:"http://control.blog.sina.com.cn/riaapi/article/search_recommend.php",isDisplay:function(){var a=(new Utils.Url(window.location.href)).anchor||{};var b=a.sFLKeyword;var c=document.referrer;if(window.location.host==="blog.sina.com.cn"&&b){this.keyword=b;this.encode=a.sFLEncode||"utf-8";return true}if(!c)return;var d=scope.searchEngineList;var e=new Utils.Url(c);for(var f in d){if(e.url.indexOf(f)>-1){this.keyword=e.getParam(d[f]["param"]);if((f==="search.sina.com.cn"||f==="www.baidu.com")&&e.getParam("ie")){this.encode=e.getParam("ie")}else{this.encode=d[f]["encode"]}return true}}},displayFloatingLayer:function(a){var b=this;if(!blogAd.getInitPermission(a))return;a=a.ads[0];Utils.Io.JsLoad.request(this.dataURL,{charset:"utf-8",noencode:true,GET:{encode:this.encode,keyword:this.keyword},onComplete:function(c){if(c&&c.code==="A00006"){b.createFloatingLayerWithData(c.data,a)}else{}}})},createFloatingLayerWithData:function(a,b){function d(a){var b=document.documentElement.clientWidth;var d=document.documentElement.clientHeight;c.setPosition({x:0,y:d-(a?0:c.entity.offsetHeight)});$E("statBottomforniangs").style.width=b+"px"}if(a.relatedArticle&&a.relatedArticle.length===0)return;var c=new Ui.Panel;c.setTemplate('<div id="#{panel}">'+scope.searchFloatingLayerTemplate+"</div>").setFixed(true);c.show();c.entity.style.zIndex="9999";d($IE6?"":"first");Core.Events.addEvent($E("searchFloatingLayer_CloseBtn"),function(){c.destroy()});Core.Events.addEvent(window,function(){d()},"resize",false);this.updateContent(a,b);!$IE6&&this.playDisplayEffect(c)},updateContent:function(a,b){var c=a.relatedArticle;var d=a.celebrity;var e;var f=[];var g=[];var h="http://search.sina.com.cn/?c=blog&by=title&range=all&q="+this.keyword+"&ie="+this.encode;var i=$E("searchFloatingLayer_ad");var j;for(e=0;e<c.length&&e<2;e++){f[f.length]="<li>";if(c[e].isRecommend){f[f.length]='<img class="SG_icon SG_icon107" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="18" height="18" title="推荐" align="absmiddle" />'}f[f.length]="<a onclick=\"v7sendLog && v7sendLog('85_01_0"+(2+e)+'\');" href="'+c[e].url.replace(/\?.*/,"")+"#sFLKeyword="+this.keyword+"&sFLEncode="+this.encode+'" target="_blank">'+c[e].title.replace(a.keyword,'<span class="blog_sfNm">'+a.keyword+"</span>")+"</a>";f[f.length]="</li>"}if(c.length===1){$E("searchFloatingLayer_LeftContentArea").className="blog_sfL blog_onlyone"}if(a.type===1){$E("searchFloatingLayer_RelatedArticle").parentNode.className="blog_sfTit blog_nofTit"}$E("searchFloatingLayer_RelatedArticleList").innerHTML=f.join("");for(e=0;e<d.length&&e<5;e++){g[g.length]="<li>";g[g.length]="<a onclick='v7sendLog && v7sendLog(\"85_01_0"+(5+e)+"\");' href='http://blog.sina.com.cn/u/"+d[e].uid+"#sFLKeyword="+encodeURIComponent(d[e].uname)+"&sFLEncode=utf-8' target='_blank'>"+d[e].uname+"</a>";g[g.length]="</li>"}$E("searchFloatingLayer_CelebrityList").innerHTML=g.join("");$E("searchFloatingLayer_RelatedArticle").href=h;$E("searchFloatingLayer_More").href=h+"&s=2";if(!b||!i)return;if(b.type=="swf"){this.appendSwf(b.ref,"",b.width,b.height,i)}else{i.style.cssText="height:"+b.height+"px; width:"+b.width+"px;";i.innerHTML="<img src='"+b.ref+"' alt=''/>"}if(b.click){i.style.position="relative";j=this.createNode('<a href="#" target="_blank"></a>');j.href=b.click;j.style.cssText=($IE?"filter:alpha(opacity=0);":"opacity:0")+"; height:"+b.height+"px; width:"+b.width+"px; background:#F00; display:block;"+"z-index:1020; position:absolute; left:0; top:0;";i.appendChild(j)}i.style.marginTop=parseInt((70-b.height)/2)+"px"},createNode:function(a){var b=$C("div");b.innerHTML=a;return b.childNodes[0]},playDisplayEffect:function(a){var b=a.entity;var c=parseInt(b.style.top);var d=new Ui.TweenStrategy(c,c-b.offsetHeight,.5);d.onTween=function(a){b.style.top=a+"px"};d.onEnd=function(){a.setPosition({x:0,y:document.documentElement.clientHeight-b.offsetHeight})};d.start()},appendSwf:function(a,b,c,d,e){if(typeof sinaFlash=="undefined")return;var f=new sinaFlash(a,b,c+"",d+"","9","#FFFFFF",false,"High","http://www.sina.com.cn/","http://www.sina.com.cn/",false);f.addParam("allowScriptAccess","always");f.addParam("wmode","transparent");f.write(e)}};$registJob("outSearch",function(){function a(){Utils.Io.JsLoad.request("http://pfp.sina.com.cn/blog/js/blogad.js",{charset:"gb2312",onComplete:function(){if(typeof BlogAd=="undefined")return;b()},isRemove:false})}function b(){(new BlogAd({pos:"jumpin"})).getAd(function(a){if(!+a.code)Utils.Io.loadExternalCSS($_GLOBAL.cssBasicURL+"module/layer/re_seach.css",function(){var b=scope.searchFloatingLayer;if(b.isDisplay()){b.displayFloatingLayer(a)}})})}(typeof BlogAd=="undefined"?a:b)()});blogAd.popAd=function(){function f(){var a=document.cookie.match(/(?:ad|dlg)680=(\d+)/);return a?g(a[1])!==g((new Date).getHours()):true}function g(a){if(a>21){return 1}else if(a>14){return 3}else if(a>7){return 2}else{return 1}}function h(){if(!b._dialog.entity){$callJob("outSearch")}else{if(b._dialog.entity.style.display=="none"){$callJob("outSearch")}}}function i(a){for(var b=0;b<a.length;b++){commonLog&&commonLog(a[b])}}var a=1;var b;var c=false;var d={code:"2101",ads:{0:{type:"mixed"}}};var e={};if(scope.handler_680!=null){return}scope.handler_680=null;e.renderPopAd=function(e){if(f()==false){$callJob("outSearch");return}var g=e&&e.isAD;if(g){var j="?"+(new Date).getTime();e.flashURL&&(e.flashURL+=j);e.picURL&&(e.picURL+=j);e.borderImg&&(e.borderImg+=j);e.btnImg&&(e.btnImg+=j);b=new Lib.ADBlogRecommendDialog("once",a,e.picURL,e.flashURL,e.flashWidth,e.flashHeight,e.borderImg,e.btnImg,e.clickUrl,d);b.onToggle=function(){c=true};var k=new Image;k.onload=function(){scope.handler_680=b;scope.Bind680EventHandler&&scope.Bind680EventHandler();b.show();h();setTimeout(function(){if(!c&&b._slide&&b.displayState=="max"){b.toggle()}},6e4);k=null};k.src=e.picURL;var l=false;if(e.logurls){b.addEventListener("show",function(){if(!l){l=true;Core.Events.addEvent(b._dialog.nodes.popFlashContent,Core.Function.bind3(i,this,[e.logurls]),"click")}})}}else{b=new Lib.BlogRecommendDialog("once",a,d);b.onToggle=function(){c=true};scope.handler_680=b;scope.Bind680EventHandler&&scope.Bind680EventHandler();b.show();h();setTimeout(function(){if(!c&&b._slide&&b._dialog.nodes.btnMin.className=="btnMin"){b.toggle()}},6e4)}};return e};$registJob("tjAd",function(){scope.isFromSearchEngine=Article.getSearchReferrer();var a=window.location.href.indexOf("tj=1")>-1;var b=scope.$pageid.indexOf("articletj")>-1;new blogAd.CommAd;(function(){if(!b&&a){Lib.execZhitou(function(a){function d(){var a=$E("sinabloga");if(a){var b=$E("ramdomVisitDiv");b&&(b.style.top=a.offsetTop+"px")}}var b=Lib.Listener;var c=blogAd.insertIns("PDPS000000049439",$E("trayFlashConnetion").parentNode,"beforebegin");b.notify("topad680-show-start",{});(window.sinaads||[]).push({element:c,params:{sinaads_success_handler:function(){d();b.notify("topad680-show-end",{show:!0})},sinaads_fail_handler:function(){d();b.notify("topad680-show-end",{show:!1})}}})})}Lib.execZhitou(function(a){var b=blogAd.insertIns("PDPS000000051781");b.style.display="none";var c=blogAd.popAd();(window.sinaads||[]).push({element:b,params:{sinaads_success_handler:function(a,b){function e(a){var c={};if(b.content[0].src[0].replace(/(^\s*)|(\s*$)/g,"").length===0){c.isAD=false}else{c={isAD:true,flashURL:"http://d3.sina.com.cn/litong/kuaijieweibo/yafeng/boke/sc/bk.swf",flashWidth:293,flashHeight:60,picURL:a.content[0].src[0],clickUrl:a.content[0].link[0],borderImg:"http://d1.sina.com.cn/litong/kuaijieweibo/yafeng/boke/images/imgbgnn.gif",btnImg:"http://d1.sina.com.cn/201007/09/237719_btn.gif",logurls:a.content[0].monitor}}return c}a.style.display="none";var d;d=e(b);c.renderPopAd(d)},sinaads_fail_handler:function(a,b){a.style.display="none";c.renderPopAd({isAD:false})}}})});if(!b){Lib.checkAuthor();var c=!$isAdmin;if(!c)return;Lib.execZhitou(function(a){var b,c=$E("module_910")||$E("module_911");c&&(b=SinaEx.prev(c));if(!b){var d=$E("module_904")||$E("module_903");var e=d.parentNode.children;if(3>e.length){b=d.parentNode.lastChild}else{b=e[2]}}var f=blogAd.insertIns("PDPS000000033239",b,"afterend");(window.sinaads||[]).push({element:f,params:{sinaads_success_handler:function(){f.style.marginBottom="10px"}}})})}})()});Utils.Io.TimeoutJsLoad=function(a,b){this._opts={url:"",charset:"utf-8",noreturn:false,noencode:false,timeout:-1,GET:{},onComplete:null,onException:null,type:"blogScript",jsonpParamName:"callback"};if(!a||typeof a!=="string"){throw new Error("url参数不能为空!")}this._opts.url=a;this.isAborted=false;this.scriptIdentifier="";this.varname="";this.loadComplete=false;this.timeObj;Core.System.parseParam(this._opts,b);this.loadScript()};Utils.Io.TimeoutJsLoad.prototype={constructor:Utils.Io.TimeoutJsLoad,__jsonpCounter:(new Date).getTime(),loadScript:function(){function f(f){var g=a.type;if(g==="blogScript"&&b&&b.readyState&&b.readyState!="loaded"&&b.readyState!="complete"){return}d.loadComplete=true;if(g==="jsonp"){window[e]=undefined;try{delete window[e]}catch(h){}}else if(g==="blogScript"){b.onload=b.onreadystatechange=b.onerror=null}c.removeChild(b);if(!d.isAborted&&typeof a.onComplete==="function"){d.timeObj&&clearTimeout(d.timeObj);a.onComplete(g==="blogScript"?window[d.varname]:f)}}var a=this._opts,b=$C("script"),c=$T(document,"head")[0],d=this,e=this._processUrl();b.async=true;b.src=a.url;b.charset=a.charset;b.id="script"+this.scriptIdentifier;if(a.type==="jsonp"){window[e]=f}else if(a.type==="blogScript"){b.onload=b.onerror=b.onreadystatechange=f}c.insertBefore(b,c.firstChild);if(a.timeout>0){this.timeObj=setTimeout(function(){d.abortRequest()},a.timeout)}},abortRequest:function(){if(this.loadComplete){return}this.isAborted=true;if(/opera/i.test(navigator.userAgent)&&$E("script"+this.scriptIdentifier)){$E("script"+this.scriptIdentifier).src=""}typeof this._opts.onException==="function"&&this._opts.onException()},_processUrl:function(){var a=this._opts,b=a.url,c=a.GET,d,e=window.parseInt(Math.random()*1e8),f=new Utils.Url(b);for(d in c){f.setParam(d,a.noencode===true?c[d]:Core.String.encodeDoubleByte(c[d]))}this.scriptIdentifier=e;if(a.type==="blogScript"){this.varname=f.getParam("varname")||"requestId_"+e;a.noreturn!==true&&f.setParam("varname",this.varname)}else if(a.type==="jsonp"){var g="jsonp"+this.constructor.prototype.__jsonpCounter++;f.setParam(a.jsonpParamName,g)}a.url=f.toString();return g}};$registJob("tranVideo",function(){function a(){var a=navigator.userAgent.toLowerCase();return{isIpad:a.match(/ipad/i)!=null,isIphone:a.match(/iphone/i)!=null,isIpod:a.match(/ipod/i)!=null}}var b=a();if(!(b.isIpad||b.isIphone||b.isIpod))return;var c=Utils.Io.JsLoad.request;var d=Utils.Io.TimeoutJsLoad;var e=Core.Dom.insertHTML;var f=Core.String.j2o;var g={getVid:function(a){var b=new RegExp("vid=([^&]*)?&","i");var c=a.match(b);if(c){return c[1]||""}else{return""}},createVideoTag:function(a){var b="http://video.sina.com.cn/api/getIpadUrl.php?url="+encodeURIComponent(a.src.replace(".swf",""));new d(b,{type:"blogScript",GET:{rmd:Math.random()},onComplete:function(b){if(b.ipad_url=="")return;a.style.display="none";var c=$C("video");c.className="video";c.setAttribute("width","482px");c.setAttribute("height","388px");c.setAttribute("controls","controls");c.setAttribute("src",b.ipad_url);a.parentNode.insertBefore(c,a)},onException:Function()})}};allEmbed=document.getElementsByTagName("embed");for(var h=0;h<allEmbed.length;h++){if(allEmbed[h].src.indexOf("http://p.you.video.sina.com.cn")!=-1||allEmbed[h].src.indexOf("http://you.video.sina.com.cn")!=-1){g.createVideoTag(allEmbed[h])}}});$registJob("errorTips",function(){function a(a){var b=$C("div");b.innerHTML=a;return b.firstChild}Lib.checkAuthor();if($isLogin){Utils.Io.JsLoad.request("http://control.blog.sina.com.cn/riaapi/warning.php",{GET:{uid:$UID},onComplete:function(b){function j(){var a=Core.Dom.getXY(d);var b=c.offsetWidth;c.style.visibility="inherit";c.style.top=a[1]+23+"px";c.style.left=a[0]-b+41+"px"}var c,d;if(b&&b.iswarning==1){var e=Utils.Cookie.getCookie("i8t9c"+$UID)!==b.date?"block":"none";var f='<div id="err_i8t9c" class="tb_layer_Y tb_layer_w6" style="display:'+e+';z-index:500;position:absolute;top:-300px;">'+'<div class="tb_layer_arrow" style="margin:0 0;left:219px"></div>'+'<div class="tb_layer_Y_main">'+'<div class="tb_mas">'+'<span style="float:right;"><a class="conn" href="javascript:;" onclick="scope.i8t9c()">×</a></span>'+"</div>"+'<div class="tb_mas">'+b.msg+'<p style="text-align:center;padding:6px;"><input type="button" value="知道了" onclick="scope.i8t9c()" /></p></div>'+"</div>"+"</div>"+"</div>";scope.i8t9c=function(){$E("err_i8t9c").style.display="none";Utils.Cookie.setCookie("i8t9c"+$UID,b.date,8760,"/");Utils.Cookie.setCookie("i8t9c"+$UID,b.date,8760,"/","blog.sina.com.cn")};scope.i8t9c.show=function(){$E("err_i8t9c").style.display="";j()};c=a(f);document.body.appendChild(c);var g=$E("loginBarActivity"),h;d=a('<div class="topbar_activity"><a href="javascript:;" onclick="scope.i8t9c&&scope.i8t9c.show();">[公告]</a></div>');g.parentNode.insertBefore(d,g);setTimeout(j,10);Core.Events.addEvent(window,function(){j()},"resize");var i=document.documentElement.scrollTop+document.body.scrollTop}}})}});var ReblogToQing=Core.Class.create();ReblogToQing.prototype={saving:false,blogId:"",initialize:function(){},reblog:function(a){this.blogId=a;if(!this.blogId){throw new Error("转载博文ID未定义")}this.checkUser(this.blogId)},checkUser:function(a){this.blogId=a||scope.$blogId;Lib.checkAuthor();var b=this;if(!$isLogin){v7sendLog("48_01_32");(new Lib.Login.Ui).login(function(){scope.blogOpener.showDialog(function(){b.save.bind2(b)()})})}else{var b=this;scope.blogOpener.showDialog(function(){b.save()})}},save:function(){var a=this;if(this.saving){return}this.saving=true;var b={version:7,blogId:a.blogId,rnd:+(new Date)};var c=function(){winDialog.alert("对不起，系统繁忙请稍后！",{icon:"01",funcOk:function(){}})};var d="http://control.blog.sina.com.cn/blog_rebuild/riaapi/blog/share2qing.php?rnd="+ +(new Date);Utils.Io.Ijax.request(d,{POST:b,returnType:"json",onComplete:function(d){this.saving=false;if(!d){c();return}try{d=(new Function("return "+d))()}catch(e){c()}if("A00006"==d.code){winDialog.alert(["已成功转载到Qing博客！<br/><span style='font-weight: 100; font-size: 12px;'>",d.data.qingId?"<a target='_blank' href='"+$_GLOBAL.qingURL+d.data.userId+"/"+d.data.qingId+".html'>去查看已转载的文章>></a>":"","</span>"].join(""),{icon:"03"});a.onSuccess(d,b)}else if("A00420"==d.code){a.showOpenQingWnd()}else if("A00421"==d.code){a.showShareToQingFailure()}else{c()}}.bind2(this),onException:function(a){this.saving=false;if(!a){c();return}}.bind2(this)})},showOpenQingWnd:function(){var a=winDialog.createCustomsDialog({content:['<div class="CP_layercon2 unilayer">','<div class="CP_prompt toQing">','<table class="CP_w_ttl"><tbody><tr><td>您的新浪博客账号未开通Qing。开通后可转载到Qing中。</td></tr></tbody></table>','<p class="CP_w_btns_Mid"><a id="#{openQing}" class="SG_aBtn SG_aBtnB" href="'+$_GLOBAL.qingURL+'home" target="_blank"><cite>开通Qing</cite></a>','&nbsp;&nbsp;<a id="#{cancel}" class="SG_aBtn SG_aBtnB" href="javascript:void(0);"><cite>取消</cite></a></p>',"</div>","</div>"].join(""),shadow:1},"openQing");a.setMiddle();a.show();a.nodes["openQing"].onclick=function(){setTimeout(function(){a.close();a.onclick=null;a=null},200)};a.nodes["cancel"].onclick=function(){setTimeout(function(){a.close();a.onclick=null;a=null},200)}},showShareToQingFailure:function(){var a="对不起，转载至Qing博客失败。";winDialog.alert(a,{icon:"01",funcOk:function(){}})},onSuccess:function(a){},onError:function(){}};$registJob("renderReblogDiv",function(){function showError(a,b){if(a.message){var c=a.message}winDialog.alert(c,{icon:b||"01"})}var _addEvent=Core.Events.addEvent,_getEventTarget=Core.Events.getEventTarget,_getXY=Core.Dom.getXY,delegateEl,delegateElId,reblogDivId="reblog_"+ +(new Date);var reblogDivInnerHTML="<ul>"+"<li>"+'<a action-type="click_reblog" action-data="{action:\'toQing\'}" href="javascript:void(0);" title="转载到Qing博客">'+'<img width="15" height="15" align="absmiddle" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" class="SG_icon SG_icon205"/>Qing'+"</a>"+"</li>"+"<li>"+'<a action-type="click_reblog" action-data="{action:\'toBlog\'}" href="javascript:void(0);" title="转载到博客">'+'<img width="18" height="18" align="absmiddle" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" class="SG_icon SG_icon141"/>博客'+"</a>"+"</li>"+'<li style="display:none;">'+'<a action-type="click_reblog" action-data="{action:\'toBlog\'}" href="javascript:void(0);" title="转载原文">'+'<img width="18" height="18" align="absmiddle" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" class="SG_icon SG_icon141"/>转载原文'+"</a>"+"</li>"+'<li style="display:none">'+'<a action-type="click_reblog" action-data="{action:\'editor\'}" href="javascript:void(0);" title="采编">'+'<img width="18" height="18" align="absmiddle" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" class="SG_icon SG_icon142"/>采编'+"</a>"+"</li>"+"<li>"+'<a action-type="click_reblog" action-data="{action:\'cwb\'}" href="javascript:;" title="发布长微博">'+'<img width="18" height="18" align="absmiddle" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" class="SG_icon SG_icon143"/>长微博'+"</a>"+"</li>"+"</ul>";var reblogDiv=SinaEx.createNode('<div id="'+reblogDivId+'" class="turnList" style="display:none;position:absolute;z-index:20;">'+reblogDivInnerHTML+"</div>");document.body.appendChild(reblogDiv);var getActionData=Lib.util.getActionData;var sinablogbody=$E("sinablogbody");var idCard,reblogBtn;var isIdCard=false;var isValidateIdentity=0;var onMouseOverReblogBtn=function(e){var srcEl=$E(this.id),tEl=_getEventTarget(e);var eventData=getActionData(e,"reblog");if(!eventData){return}$E("sinablogbody").setAttribute("ismouseover","1");var data=eval("("+eventData.data+")");reblogBtn=eventData.targetEl.parentNode.parentNode;setTimeout(function(){var a=$E("sinablogbody").getAttribute("ismouseover")||0;a=parseInt(a)||parseInt($E(reblogDivId).getAttribute("ismouseover")||0);if(!a){return}var b=$E(reblogDivId),c=_getXY(eventData.targetEl);b.style.display="";b.style.top=c[1]+23+"px";if($IE6||$IE7){b.style.left=c[0]-2+"px"}else{b.style.left=c[0]+"px"}b.setAttribute("blogId",data.blogId);Lib.checkAuthor();var d=b.children[0].children[3].children[0];if(!reblogBtn.getAttribute("isreblog")){d.innerHTML='<img width="18" height="18" align="absmiddle" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" class="SG_icon SG_icon142"/>采编'}else{d.innerHTML='<img width="18" height="18" align="absmiddle" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" class="SG_icon SG_icon142"/>已采编'}var e=b.children[0];setTimeout(function(){if(data.srcBlog){b.children[0].children[2].style.display="none";if($isAdmin){e.children[1].style.display="none"}else{e.children[1].style.display=""}}else{e.children[1].style.display="none";if($isAdmin){e.children[2].style.display="none"}else{e.children[2].style.display=""}}if(data.srcBlog=="0"){b.children[0].children[3].style.display="none"}if(isIdCard&&reblogBtn.getAttribute("isshow")){return}if(data.srcBlog=="1"&&$isLogin){if(isValidateIdentity){return}Utils.Io.Ijax.request("http://control.blog.sina.com.cn/blog_rebuild/riaapi/blog/qingEditing.php",{onComplete:function(a){var b=Core.String.j2o(a);if(b.code==="A00006"){idCard=b.data.message;if(idCard){e.children[3].style.display=""}}isIdCard=true;reblogBtn.setAttribute("isshow","1")}})}else{e.children[3].style.display="none"}},2)},400)};var onMouseOutReblogBtn=function(a){var b=$E(this.id),c=_getEventTarget(a);var d=getActionData(a,"reblog");if(!d){return}$E("sinablogbody").setAttribute("ismouseover","0");var e=$E("sinablogbody").getAttribute("timer");if(e){return}var e=setInterval(function(){var a=$E("sinablogbody").getAttribute("ismouseover")||0;var b=$E(reblogDivId).getAttribute("ismouseover")||0;a=parseInt(a)||parseInt(b);if(!a){$E(reblogDivId).style.display="none";$E("sinablogbody").removeAttribute("timer");clearInterval(e)}},1e3)};var MOUSEOVER="mouseover";var MOUSEOUT="mouseout";var addModuleMouseEvent=function(a){if(!$E(a)){trace("没有组件："+a);return}try{if(scope.$pageid==="articletjTech"){b=$E(a);_addEvent(b,Core.Function.bind2(onMouseOverReblogBtn,b),MOUSEOVER);_addEvent(b,Core.Function.bind2(onMouseOutReblogBtn,b),MOUSEOUT)}var b=$E(a).children[1];if(b&&"SG_connBody"==b.className){b.id=a+"_SG_connBody";_addEvent(b,Core.Function.bind2(onMouseOverReblogBtn,b),MOUSEOVER);_addEvent(b,Core.Function.bind2(onMouseOutReblogBtn,b),MOUSEOUT)}}catch(c){trace("注册转载博问按钮事件代理出错，组件ID："+a)}};addModuleMouseEvent("module_10001");addModuleMouseEvent("module_10002");addModuleMouseEvent("module_10003");addModuleMouseEvent("module_920");addModuleMouseEvent("module_921");addModuleMouseEvent("module_3001_SG_connBody");var onMouseOverReblogDiv=function(a){$E(reblogDivId).setAttribute("ismouseover",1)};var onMouseOutReblogDiv=function(a){$E(reblogDivId).setAttribute("ismouseover",0)};_addEvent(reblogDiv,onMouseOverReblogDiv,MOUSEOVER);_addEvent(reblogDiv,onMouseOutReblogDiv,MOUSEOUT);!scope.article_quote&&(scope.article_quote=new Quote);scope.articel_quote_alert=function(a){scope.article_quote.check(a)};var reblogToQing=new ReblogToQing;var reblog=function(e){var srcEl=$E(reblogDivId),tEl=_getEventTarget(e);var eventData=getActionData(e,"click_reblog");if(!eventData){return}if(reblogBtn.getAttribute("isreblog")==="1"){return}var blogId=$E(reblogDivId).getAttribute("blogId"),data=eval("("+eventData.data+")");if("toQing"===data.action){reblogToQing.reblog(blogId)}else if("cwb"===data.action){window.open("http://control.blog.sina.com.cn/admin/article/changWeiBo.php?url="+encodeURIComponent("http://blog.sina.com.cn/s/blog_"+blogId+".html"))}else if("editor"===data.action){winDialog.confirm("确定采编至 #"+idCard+" 标签下",{icon:"04",funcOk:function(){var a="http://control.blog.sina.com.cn/blog_rebuild/riaapi/blog/editing2qing.php?rnd="+ +(new Date);Utils.Io.Ijax.request(a,{POST:{blogId:blogId},returnType:"json",onComplete:function(a){var b=Core.String.j2o(a);if(b&&b.code==="B00015"){winDialog.alert("采编 #"+idCard+" 成功",{icon:"03"});tEl.innerHTML='<img width="18" height="18" align="absmiddle" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" class="SG_icon SG_icon142"/>已采编';reblogBtn.setAttribute("isReblog","1")}else if(b&&b.code){showError(b.data,"01")}else{winDialog.alert("系统繁忙，请稍后在试！",{icon:"01"})}}})},funcClose:function(){},textOk:"确定",isAdamant:$IE})}else{scope.articel_quote_alert(blogId)}v7sendLog&&v7sendLog("79_01_22",scope.$pageid,"qingLink")};_addEvent(reblogDiv,reblog,"click");reblogDiv=null;delegateEl=null});Core.Dom.findNode=function(a,b,c){for(var d=a[c];d;d=d[b]){if(d.nodeType==1){return d}}return null};Core.Dom.nextNode=function(a){return Core.Dom.findNode(a,"nextSibling","nextSibling")};blogAd.shareToWeibo=function(a){var b=new Utils.Url("http://v.t.sina.com.cn/share/share.php"),c=encodeURIComponent;if(a.clickCode){(new Image).src=a.clickCode}for(var d in a){if(a.hasOwnProperty(d)){b.setParam(d,c(a[d]))}}if(!a.title){b.setParam("title",c(a.title||document.title))}b.setParam("content","utf-8");var e=function(){b=b.toString();if(!window.open(b,"mb",["toolbar=0,status=0,resizable=1,width=440,height=430,left=",(screen.width-440)/2,",top=",(screen.height-430)/2].join("")))location.href=b};if(/Firefox/.test(navigator.userAgent)){setTimeout(e,0)}else{e()}};blogAd.nickTrayAd=function(a,b){b.innerHTML=a["adLink"];var c=this,d=['<div id="#{entity}" class="tips_layer1 tips_bg_a" style="z-index:150;position:absolute;top:23px;left:0px;display:none;">','<div id="#{body}" class="tips_bd">','<a id="#{imageLink}" href="" class="link" title="" target="_blank"></a>','<div class="tips_detail"> <span id="#{closeBtn}" class="close" title="关闭">×</span>','<p id="#{userNick}" class="tips_nickname"></p>','<p id="#{tipsTitle}" class="tips_txt"></p>','<p id="#{tipsTxtLink}" class="tips_ad"></p>','<p id="#{tipsBtn}" class="tips_btn"></p>',"</div>","</div>","</div>"].join("");this.relativeNodeId=b.id;this.MARK_ID=1;this.LIMITED=24;var e=this.nodes=this.getTemplateNodes(d);Core.Dom.insertAfter(e.entity,document.body.lastChild);if($IE6&&a.ie6BackgroundPic){e.entity.style.backgroundImage="url("+a.ie6BackgroundPic+")"}else if(a.backgroundPic){try{e.entity.style.backgroundImage="url("+a.backgroundPic+")"}catch(f){}}e.imageLink.href=a.imageLinkHref;var g=typeof $nick;if("undefined"==g){g="亲爱的网友"}else{g=$nick}e.userNick.innerHTML="HI，"+g.replace(/</g,"&lt;");e.tipsTitle.innerHTML=a.tipsTitle;if(a.tipsTxtLink){e.tipsTxtLink.innerHTML=a.tipsTxtLink}var h=e.tipsTxtLink.children[0],i=h.style;if(!$IE6&&a.tipsTxtLinkBgPic){i.backgroundImage="url("+a.tipsTxtLinkBgPic+")";i.backgroundRepeat="no-repeat"}else if($IE6&&a.ie6TipsTxtLinkBgPic){i.backgroundImage="url("+a.ie6TipsTxtLinkBgPic+")";i.backgroundRepeat="no-repeat"}e.tipsBtn.innerHTML=a.tipsBtn;Core.Events.addEvent(e.closeBtn,function(){c.hide();scope.$channel=null;var b=a.status.adclose;if(b){(new Image).src=b}},"click");setTimeout(function(){c.setPos();c.show();c.initResizeEvent()},15);var j=a.status&&a.status.adclose;Core.Events.addEvent(e.entity,function(b){var d=b.target||b.srcElement,f=e.entity;do{if("A"===d.nodeName.toUpperCase()&&-1!=d.href.indexOf("http")){c.hide();scope.$channel=null;var g=a.status.adclose;if(g){(new Image).src=g}break}}while(d&&d==f)},"click");if(a.status.adstart){(new Image).src=a.status.adstart}if(!a.blogTip){commonLog("http://1090.adsina.allyes.com/main/adfshow?user=AFP6_for_SINA|2012_add|2012_blog_tip&db=sina&border=0&local=yes&js=ie")}else{v7sendLog(a.logCode)}}.$defineProto({setMark:function(){var a=(new Date).getHours();var b=24-a;Utils.Cookie.setCookie("blogTipsAd",1,b,"/",".blog.sina.com.cn")},setPos:function(){var a=$E(this.relativeNodeId);var b=Core.Dom.getXY(a);var c=a.offsetWidth,d=this.nodes.entity.style;d.left=parseInt(b[0])+(c-100)+"px";d.top=parseInt(b[1])+23+"px"},show:function(){this.isHidden=false;var a=this.nodes.entity,b=Core.Dom.setStyle;var c=new Ui.TweenStrategy(0,1,.5,function(a,b,c,d){return-c*(a/=d)*(a-2)+b});c.onTween=function(c){b(a,"opacity",c)};c.onEnd=function(){if(!$IE){b(a,"opacity","none")}else{a.style.filter="none"}};b(a,"opacity",0);a.style.display="block";c.start()},hide:function(){this.setMark();this.isHidden=true;var a=this.nodes.entity,b=Core.Dom.setStyle;var c=new Ui.TweenStrategy(1,0,.5,function(a,b,c,d){return-c*(a/=d)*(a-2)+b});c.onTween=function(c){b(a,"opacity",c)};c.onEnd=function(){if(!$IE){b(a,"opacity","none")}else{a.style.filter="none"}a.style.display="none"};c.start()},initResizeEvent:function(){var a=this;Core.Events.addEvent(window,function(){if(!a.isHidden){a.setPos()}},"resize")}}).$mixProto(Lib.templateUtils);blogAd.loadNickTrayAd=function(a){var b=Lib.Listener;var c=$E("loginBarActivity")||$E("divPopularize");var d=c.getAttribute("shouldShow"),e=(new Date).getDay(),f=Utils.Cookie.getCookie("blogTipsAd");c.style.display="";var g=e==1||e==3||e==5;if(!g){return}if(f){return}var h="http://simg.sinajs.cn/blog7style/css/module/layer/layer20.css";Utils.Io.loadExternalCSS(h,function(){if(a){if(!a||!a["isShow"]){return}if(a.logCode){a.logCode=a.logCode+"|"+$UID}blogAd.trayAdHandle=new blogAd.nickTrayAd(a,c);c=null}})};$registJob("trayTipsAd",function(){var a=Lib.Listener;var b,c,d;var e=function(c){c=c&&c.weicaopan&&c.weicaopan.weicaopan_con;Lib.execZhitou(function(){function a(a){var b=d.firstChild,c=a?"":"none";while(b){if("a"===b.nodeName.toLowerCase()){b.style.display=c}b=b.nextSibling}}var d=$E("loginBarActivity")||$E("divPopularize");d.style.display="";var e=d.parentNode;var f=e.parentNode.offsetHeight,g,h;a(false);if("none"===e.style.display){e.style.position="absolute";e.style.top="-40px";e.style.display="";h=Core.Dom.getXY(d);var i=$E("login_bar_logo_link_350");i.style.display="";var j=i.children[0].offsetWidth;g=j+h[0];if(b){f+=90}e.style.position="";e.style.top="";e.style.display="none";i.style.display="none"}else{h=Core.Dom.getXY(d);f+=h[1];g=h[0]}var k=blogAd.insertIns("PDPS000000033238",d);(window.sinaads||[]).push({element:k,params:{sinaads_tip_top:f,sinaads_tip_left:g,sinaads_success_handler:function(){a(false);window.BLOG_AD_TIPS=1},sinaads_fail_handler:function(){a(true);blogAd.loadNickTrayAd(c)},sinaads_ad_zindex:590}})});a.off({name:"ad_show_hide_conditions",callBack:e});e=null};a.on({name:"ad_show_hide_conditions",callBack:function(a){if("undefined"!==typeof b){e(a)}else{d=a}c=!0}});a.on({name:"topad680-show-end",callBack:function(a){b=a.show;if(c){e(d)}}})});SinaEx.enterLeave=function(a,b,c,d){var e=Core.Events.addEvent,f=null,g=0,h=0;b=b||function(){};c=c||function(){};d=d||0;e(a,function(a){clearTimeout(h);var e=a||window.event,i=e.target||e.srcElement;g=setTimeout(function(){if(f&&SinaEx.contains(f,i))return;var a=SinaEx.parent(i,"li");if(a){if(f){c(f)}b(a);f=a}else if(f){c(f);f=null}},d)},"mouseover");e(a,function(){clearTimeout(g);h=setTimeout(function(){if(f){c(f);f=null}},d)},"mouseout")};$registJob("qingRecommend",function(){function j(e){e=parseInt(e);if(f===e){return}clearTimeout(b);clearTimeout(c);SinaEx.removeClass(SinaEx.parent(d[f],"li"),"current");SinaEx.addClass(SinaEx.parent(d[e],"li"),"current");i(a,0);var g=d[e];if($E("module_911")){if(e==0){a.innerHTML='<a suda-uatrack="key=blog_qing_g&value=h_SLOT_49" href="'+g.parentNode.href+'" target="_blank" onclick="v7sendLog(\''+(g.parentNode.getAttribute("bigcode")||"00_00_qzj")+'\');return true;"><img src="'+g.getAttribute("bigsrc")+'" /><span>'+(g.getAttribute("alt")||"")+"</span></a>"}else if(e==1){a.innerHTML='<a suda-uatrack="key=blog_qing_g&value=h_SLOT_50" href="'+g.parentNode.href+'" target="_blank" onclick="v7sendLog(\''+(g.parentNode.getAttribute("bigcode")||"00_00_qzj")+'\');return true;"><img src="'+g.getAttribute("bigsrc")+'" /><span>'+(g.getAttribute("alt")||"")+"</span></a>"}else if(e==2){a.innerHTML='<a suda-uatrack="key=blog_qing_g&value=h_SLOT_51" href="'+g.parentNode.href+'" target="_blank" onclick="v7sendLog(\''+(g.parentNode.getAttribute("bigcode")||"00_00_qzj")+'\');return true;"><img src="'+g.getAttribute("bigsrc")+'" /><span>'+(g.getAttribute("alt")||"")+"</span></a>"}}else{a.innerHTML='<a href="'+g.parentNode.href+'" target="_blank" onclick="v7sendLog(\''+(g.parentNode.getAttribute("bigcode")||"00_00_qzj")+'\');return true;"><img src="'+g.getAttribute("bigsrc")+'" /><span>'+(g.getAttribute("alt")||"")+"</span></a>"}h=30;k();f=e;c=setTimeout(l,5e3)}function k(){i(a,h);h+=g;if(h<100){b=setTimeout(k,15)}else{i(a,100)}}function l(){var a=f+1;a>=e&&(a=0);j(a)}function m(){for(var b=0,c;b<e;b++){c=SinaEx.parent(d[b],"li");c&&c.setAttribute("noo",b)}setTimeout(function(){a.style.background="";l()},5e3)}var a=$E("qingRecWindow");if(!a){return}var b=0,c=0,d=$T($E("qingRecPic"),"img"),e=d.length,f=0,g=$IE?5:2,h=0;var i=Core.Dom.opacity;m();SinaEx.enterLeave($E("qingRecPic"),function(a){var b=a.getAttribute("noo");j(b)},function(a){},100)});$registJob("qingRecomNew",function(){function l(e){if(f===e){return}clearTimeout(b);clearTimeout(c);var g=d[e];SinaEx.removeClass(d[f],"current");SinaEx.addClass(g,"current");j(a,0);a.innerHTML='<a href="'+g.getAttribute("imghref")+'" target="_blank" onclick="v7sendLog(\''+(g.getAttribute("imgcode")||"00_00_qzj")+'\');return true;"><img src="'+g.getAttribute("imgsrc")+'" /><span>'+g.getAttribute("imgtitle")+"</span></a>";h=30;m();f=e;c=setTimeout(n,3e3)}function m(){j(a,h);h+=g;if(h<100){b=setTimeout(m,15)}else{j(a,100)}}function n(){var a=f+1;a>=e&&(a=0);l(a)}var a=$E("qingRecNew");if(!a){return}var b=0,c=0,d=$E("qingRecPic").children,e=d.length,f=0,g=$IE?5:2,h=0;var i=Core.Events.addEvent,j=Core.Dom.opacity;for(var k=0;k<e;k++){(function(a){var b=0;i(d[a],function(){b=setTimeout(function(){l(a)},100)},"mouseover");i(d[a],function(){clearTimeout(b)},"mouseout")})(k)}a.children[0].innerHTML='<img src="'+d[0].getAttribute("imgsrc")+'" /><span>'+d[0].getAttribute("imgtitle")+"</span>";a.style.background="";setTimeout(n,3e3)});$registJob("adNoticeChannel",function(){var a=Core.Events.addEvent;var b=Lib.Listener,c=scope.$pageid;var d=window.location.href.indexOf("tj=1")>-1;var e=document.referrer;if(e){var f=e.match(/(\:\/\/)(.*?)(\/)/g);e=f&&f[0].replace(/(\:\/\/){0,}(\/){0,}/g,"")}else{e=""}Lib.checkAuthor();var g="http://blogtj.sinajs.cn/riaapi/afterLoadChannel/after_load_channel.php";Utils.Io.JsLoad.request(g,{GET:{uid:$UID,bloguid:scope.$uid,refer:e},onComplete:function(a){if(a&&a.code==="A00006"){scope.$channel=a.data;if(c==="article"||c==="articleM"||c==="index"||c==="indexM"||c==="articlelist"||c==="articlelistM"||c==="wanwan_index"){b.notify("notice_ad_layer",scope.$channel||{})}b.notify("ad_show_hide_conditions",scope.$channel||{})}}})});(function(){var a=function(a){var b=a.split("-");var c=b[0];for(var d=1;d<b.length;d++){c+=b[d].charAt(0).toUpperCase()+b[d].substring(1)}return c};Core.Dom.setStyle2=function(b,c){if(typeof b=="string"){b=$E(b)}for(var d in c){styleAttr=a(d);Core.Dom.setStyle(b,styleAttr,c[d])}}})();$registJob("blogNotice",function(){var a=$E("login_bar_logo_link_350");var b=Core.Events.addEvent,c=Core.Events.removeEvent,d=Utils.Cookie.setCookie,e=Utils.Cookie.getCookie,f=Core.Dom.setStyle,g=Lib.Listener,h,i;var j=e("closeNotice_fzp");Lib.checkAuthor();if(j&&j===$UID){return}var k=scope.$pageid,l=scope.$uid,m=window.location.href.indexOf("tj=1")>-1;if(a&&"ntopbar_main"===a.parentNode.className){g.on({name:"notice_ad_layer",callBack:function(a){g.notify("tray-announce-loaed",a)}});return}else{var n;var o=document.documentElement;var p={guideLayer:'<div class="l_hornbg" id="#{guideLayer}" style="display:none;">'+'<div class="l_horn">'+'<span class="close" title="关闭" id="#{close}">&times;</span>'+'<div class="horn1" id="#{noticeLayer}" style="display:none;">'+'<div class="horn_left">'+'<span class="horn_icon" id="#{noticeIcon}"></span>'+"</div>"+'<div class="horn_right" id="#{noticeAdLayer}">推荐：'+'<a href="" target="blank" id="#{noticeAdCon1}" onclick="v7sendLog(\'48_01_12\');"></a>'+'<a href="" target="blank" id="#{noticeAdCon2}" onclick="v7sendLog(\'48_01_13\');"></a>'+"</div>"+"</div>"+'<div class="horn2" id="#{adLayer}">推荐：'+'<a href="" target="blank" id="#{adContent1}" onclick="v7sendLog(\'48_01_12\');"></a>'+'<a href="" target="blank" id="#{adContent2}" onclick="v7sendLog(\'48_01_13\');"></a>'+"</div>"+"</div>"+"</div>"};var q={mid:{"z-index":"500",position:$IE6?"absolute":"fixed"}};var r=$_GLOBAL.cssBasicURL+"module/layer/layer24.css";Utils.Io.loadExternalCSS(r);var s=function(a){n=Utils.insertTemplate($E("sinabloga"),p.guideLayer,"BeforeBegin");w(n.guideLayer);if($IE6){n.guideLayer.style.position="absolute";o.style.backgroundImage="url(ablout:blank)";o.style.backgroundAttachment="fixed";b(window,x,"scroll")}b(window,u,"scroll");t(a)};g.on({name:"notice_ad_layer",callBack:s});function t(a){if($isLogin&&a.announce.result&&(k==="indexM"||k==="articleM"||k==="articlelistM")){n.noticeLayer.style.display="";n.adLayer.style.display="none";var c=a.announce;Core.Dom.insertHTML(n.noticeIcon,c.announce_con,"AfterEnd")}else{n.adLayer.style.display=""}if(a.advertise){var e=a.advertise;var f=decodeURIComponent(e.advertise_con1.content),g=decodeURIComponent(e.advertise_con2.content),h=decodeURIComponent(e.advertise_con1.link),i=decodeURIComponent(e.advertise_con2.link);n.noticeAdCon1.innerHTML=f;n.noticeAdCon1.href=h;n.noticeAdCon2.innerHTML=g;n.noticeAdCon2.href=i;n.adContent1.innerHTML=f;n.adContent1.href=h;n.adContent2.innerHTML=g;n.adContent2.href=i;if(n.close){b(n.close,function(){d("closeNotice_fzp",$UID,24,"/",".blog.sina.com.cn");v()})}}}function u(){var a=document.body.scrollTop+document.documentElement.scrollTop;if(a>height){y(n.guideLayer);if(!$IE6){n.guideLayer.style.top="0"}if(!h){h=1;v7sendLog("48_01_11")}}else{z(n.guideLayer)}}function v(){Core.Dom.removeNode(n.guideLayer);c(window,u,"scroll");c(window,x,"scroll");scope.$channel=null}function w(a){Core.Dom.setStyle2(a,q.mid)}function x(){n.guideLayer.style.top=document.documentElement.scrollTop+"px";n.guideLayer.style.left=0+"px"}function y(a){if(!i){i=1;var b=new Ui.TweenStrategy(0,1,.6,function(a,b,c,d){return-c*(a/=d)*(a-2)+b});b.onTween=function(b){f(a,"opacity",b)};b.onEnd=function(){if(!$IE){f(a,"opacity","none")}else{a.style.filter="none"}};f(a,"opacity",0);a.style.display="block";b.start()}}function z(a){if(i){i=0;var b=new Ui.TweenStrategy(1,0,.6,function(a,b,c,d){return-c*(a/=d)*(a-2)+b});b.onTween=function(b){f(a,"opacity",b)};b.onEnd=function(){if(!$IE){f(a,"opacity","none")}else{a.style.filter="none"}a.style.display="none"};b.start()}}}});$registJob("trashPv",function(){});Ui.LayerCount=function(){var a=500;var b=1024;return function(c){if("mode"===c){return b}else{a+=24}return a>b?b-50:a}}();Lib.OnlyShadow=function(a,b,c,d){this.entity=null;this.parent=b||document.body;d=Lib.apply({zIndex:1024,backgroundColor:"black"},d);this._ie6Fixed=function(){if(e.entity){e.entity.style.top=document.documentElement.scrollTop+"px";var a=document.documentElement.scrollLeft-e._ie6EntityXY[0];var b=a+e.entity.offsetWidth;var c=document.documentElement.scrollWidth||document.body.scrollWidth;if(b<=c){e.entity.style.left=a+"px"}if(e.ifm){e.ifm.style.top=e.entity.style.top;if(b<=c){e.ifm.style.left=e.entity.style.left}}}};var e=this;this.resetShadowDiv=Core.Function.bind3(function(){if(e.entity){setTimeout(function(){e.updateSize();if($IE6&&e.isShow()){e.entity.style.left="0px";var a=Core.Dom.getXY(e.entity);e._ie6EntityXY=a;e._ie6Fixed()}},1)}},this);this._create=function(){e.entity=$C("div");if(c){e.entity.id=c}e.entity.style.position="absolute";e.entity.style.width=e.getAreaWidth()+"px";e.entity.style.height=e.getAreaHeight()+"px";e.entity.style.left="0px";e.entity.style.top="0px";e.entity.style.zIndex=d.zIndex;e.entity.style.backgroundColor=d.backgroundColor;e.parent.appendChild(e.entity);e._setOpacity(e.entity,isNaN(a)?.5:a);if($IE6){var b=Core.Dom.getXY(e.entity);e._ie6EntityXY=b;var f=document.documentElement.scrollLeft-e._ie6EntityXY[0];e.entity.style.left=f+"px"}e.addIframe();Core.Events.addEvent(window,e.resetShadowDiv,"resize");e.setFixed(true);e.hidden()};(function(){if(c&&$E(c)){e.entity=$E(c)}else{e._create()}})()};Lib.OnlyShadow.prototype={isShow:function(){return this.entity.offsetHeight>0?true:false},show:function(){this.entity.style.display="";if(this.ifm){this.ifm.style.display=""}if($IE6){this.updateSize();this.entity.style.left="0px";var a=Core.Dom.getXY(this.entity);this._ie6EntityXY=a;this._ie6Fixed()}this.onShow()},hidden:function(){this.entity.style.display="none";if(this.ifm){this.ifm.style.display="none"}this.onHidden()},close:function(){this.hidden();this.destroy()},destroy:function(){Core.Events.removeEvent(window,this._ie6Fixed,"scroll");Core.Events.removeEvent(window,this.resetShadowDiv,"resize");this.entity.parentNode.removeChild(this.entity);this.entity=null;if(this.ifm){this.ifm.parentNode.removeChild(this.ifm);this.ifm=null}},addIframe:function(){this.ifm=$C("iframe");this._setOpacity(this.ifm,0);this.ifm.style.position="absolute";this.ifm.style.zIndex=this.entity.style.zIndex;this.ifm.style.left=this.entity.style.left;this.ifm.style.top=this.entity.style.top;this.ifm.style.width=this.entity.style.width;this.ifm.style.height=this.entity.style.height;this.entity.parentNode.insertBefore(this.ifm,this.entity)},insertBefore:function(a){a.parentNode.insertBefore(this.entity,a);if(this.ifm){this.entity.parentNode.insertBefore(this.ifm,this.entity)}},updateSize:function(){var a=this.getAreaWidth();var b=this.getAreaHeight();this.entity.style.width=a+"px";this.entity.style.height=b+"px";if(this.ifm){this.ifm.style.width=a+"px";this.ifm.style.height=b+"px"}},getAreaHeight:function(){var a=Math.max(document.documentElement.clientHeight,document.body.clientHeight);return a},getAreaWidth:function(){var a=document.documentElement.clientWidth||document.body.clientWidth;return a},setFixed:function(a){if($IE6){var b=this;if(a){b._ie6Fixed();Core.Events.addEvent(window,b._ie6Fixed,"scroll")}else{Core.Events.removeEvent(window,b._ie6Fixed,"scroll")}}else{this.entity.style.position=a?"fixed":"absolute"}},_setOpacity:function(a,b){if($IE){a.style.filter="alpha(opacity="+b*100+")"}else{a.style.opacity=b}},onShow:function(){},onHidden:function(){}};Article.SlideTJCover=function(a){var b=arguments;var c=b.callee._instance;this.cfg=a=Lib.apply(this.cfg||{},a);if(c){return c}var d=this;b.callee._instance=this;var e=function(a,b,c){var d=new Image;d.src=b;$E(a).setAttribute("blogId",c);var e=function(a,b){var d=$E(a).getAttribute("blogId");if(d===c){$E(a).src=b}};if(d.complete){$E(a).src=b}else{$E(a).src=o;d.onload=function(){e(a,b)};d.onerror=function(){$E(a).src="http://s4.sinaimg.cn/image/default_cover.gif#4"}}};var f=function(a,b,c){a=$E(a);b=b||"查看原文";if(a.textContent){a.textContent=b}else{a.innerText=b}var d;if(c){d="http://blog.sina.com.cn/s/blog_"+c+".html"}else{d="javascript:;"}a.href=d};var g=function(a,b){var c=(a.offsetHeight-b.offsetHeight)/2;var d=(a.offsetWidth-b.offsetWidth)/2;if(c<0){c=0}b.style.top=c+"px";if(d<0){d=0}b.style.left=d+"px"};var h=function(a){var b=Lib.util.getActionData(a,"show-next-slide");if(!b){return}var c=decodeURIComponent(b.data).split("###");var d=c[0];var e=new Article.MultipleImgLayer;e.showNextSlide(d)};var i=function(a){var b=Lib.util.getActionData(a,"show-next-tj");if(!b){return}var c=decodeURIComponent(b.data).split("###");var e=c[0];var f=c[1]||"";var g=c[2]||"next";var h=new Article.MultipleImgLayer;h.setDirection("next");h.getNextSlideData(e,f,function(a){if(a.pre.blogId||a.next.blogId){l();d.show(a)}else{k(g)}},g);return false};var j=function(a,b,c,d){if(b){$E(a).setAttribute("action-data",encodeURIComponent(b+"###"+c+"###"+d))}};var k=function(a){$E(t[a+"Btn"]).style.visibility="hidden"};var l=function(){$E(t["nextBtn"]).style.visibility="";$E(t["preBtn"]).style.visibility=""};var m=function(a){f(t[a+"Title"],"");e(t[a+"Img"],"http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif");j(t[a+"Btn"],"");$E(t[a+"Img"]).style.visibility="hidden";$E(t[a+"Title"]).style.visibility="hidden";k(a)};var n=function(a){var b=/(?:(?:ww\d+|s\d+).sinaimg.cn|photo\.sina\.com\.cn)\/(mw690|mw600|middle|bmiddle)/;var c=a.match(b);if(c){switch(c[1]){case"bmiddle":return a.replace(/\/bmiddle\//,"/cover/");case"mw690":return a.replace(/\/mw690\//,"/cover/");case"middle":return a.replace(/\/middle\//,"/cover/");case"mw600":return a.replace(/\/mw600\//,"/cover/");default:return a}}else{return a}};var o="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif";var p='<div id="#{entity}" class="showEnd" style="position:absolute;visibility:hidden;">'+'<div class="tit">'+"<strong>该篇博文浏览结束</strong>"+'<a id="#{review}" href="javascript:;" class="replay" title="重新浏览" hidefocus="true"></a></div>'+'<div class="pages">'+'<a id="#{preBtn}" href="javascript:void(0);" class="preview" action-type="show-next-tj" hidefocus="true">&lt;&lt;上一篇</a>'+'<a id="#{nextBtn}" href="javascript:void(0);" class="next" action-type="show-next-tj" hidefocus="true">下一篇&gt;&gt;</a></div>'+'<div class="content"><ul><li>'+'<a id="#{preImgBtn}" action-type="show-next-slide" href="javascript:;" hidefocus="true"><img id="#{preImg}" src="'+o+'" /></a>'+'<a id="#{preTitle}" href="javascript:;" target="_blank" hidefocus="true">标题</a></li>'+'<li class="nomgr">'+'<a id="#{nextImgBtn}" action-type="show-next-slide" href="javascript:;" hidefocus="true">'+'<img id="#{nextImg}" src="'+o+'" /></a>'+'<a id="#{nextTitle}" href="javascript:;" target="_blank" hidefocus="true">标题</a>'+"</li>"+"</ul>"+"</div>"+"</div>";var q=document,r=null,s=new Lib.HtmlTemplate(p);Core.Dom.addHTML(a.renderTo,s.getHtmlString());var t=s.getNodeIds();var u=Core.Events.addEvent;u($E(t["review"]),function(){v7sendLog("49_01_06");this.cfg.review(this)}.bind2(this));u($E(t["preBtn"]),function(){v7sendLog("49_01_07")});u($E(t["nextBtn"]),function(){v7sendLog("49_01_08")});u($E(t["preImgBtn"]),function(){v7sendLog("49_01_09")});u($E(t["nextImgBtn"]),function(){v7sendLog("49_01_10")});u($E(t["entity"]),h);u($E(t["entity"]),i);var v={isHidden:true,getEntity:function(){return $E(t["entity"])},fixPos:function(){if(!this.isHidden){g(this.cfg.renderTo,this.getEntity())}},show:function(a){var b=$E(t["preImgBtn"]).parentNode.parentNode.parentNode;var c=$E(t["preBtn"]).parentNode;if(!a){b.style.display="none";c.style.display="none";a={}}else{b.style.display="";c.style.display=""}var d=this.cfg,h=d.renderTo,i=this.getEntity();if(i.offsetHeight==0||i.offsetWidth==0){return false}g(h,i);this.isHidden=false;i.style.visibility="inherit";var k=$E(t["preTitle"]),l=$E(t["nextTitle"]);var o=false;if(a.pre&&a.pre.images&&a.pre.images.length>0){var p=a.pre.blogId;var q=a.pre.publishTime;$E(t["preTitle"]).style.visibility="inherit";f(k,a.pre.title,p);e(t["preImg"],n(a.pre.images[0]),p);$E(t["preImg"]).style.visibility="inherit";j(t["preBtn"],p,q,"pre");$E(t["preBtn"]).style.visibility="inherit";j(t["preImgBtn"],p)}else{o=true;m("pre")}if(a.next&&a.next.images&&a.next.images.length>0){var r=a.next.blogId;var s=a.next.publishTime;$E(t["nextTitle"]).style.visibility="inherit";f(l,a.next.title,r);e(t["nextImg"],n(a.next.images[0]),r);$E(t["nextImg"]).style.visibility="inherit";j(t["nextBtn"],r,s,"next");$E(t["nextBtn"]).style.visibility="inherit";j(t["nextImgBtn"],r)}else{o=true;m("next")}if(o){b.style.backgroundImage="none"}else{if(!$IE6){b.style.background="url("+w+") 235px 100px no-repeat"}else{b.style.backgroundImage="url("+w+")"}}this.cfg.data=a;return true},hide:function(){var a=this.getEntity();a.style.visibility="hidden";this.isHidden=true;return true}};var w="http://simg.sinajs.cn/blog7style/images/common/multishow_or."+($IE==6?"gif":"png");Lib.apply(this,v)};Lib.register("diYuanXinLog",function(){var a=!1;var b;var c=[];var d=typeof $_GLOBAL!="undefined"&&$_GLOBAL.ver!=null?$_GLOBAL.ver["di_yuan_xin"]||"-1":"-1";var e="http://sjs.sinajs.cn/xblogtheme/js/di_yuan_xin.js?ver="+d+".js";var a=function(){Utils.Io.JsLoad.request(e,{isRemove:!1,noreturn:true,onComplete:function(){b=!1;a=!0;for(var d=0,e=c.length;d<e;d++){c[d]()}c=[]}})};return function(d){if(!0===a){d()}else if(!0===b){c.push(d)}else{c.push(d);a()}}});Article.MultipleImgLayer=function(a){var b=arguments;var c=b.callee._instance;if(c){return c}b.callee._instance=this;var d=this;var e=function(){if($FF){d.scrollTop=document.documentElement.scrollTop}if($IE6){document.body.setAttribute("scroll","no")}else{document.documentElement.style.overflow="hidden";!$IE8&&(document.body.style.overflow="hidden")}};var f=function(){if($IE6){document.body.removeAttribute("scroll")}else{document.documentElement.style.overflow="auto";!$IE8&&(document.body.style.overflow="auto")}if($FF){document.documentElement.scrollTop=d.scrollTop}};var g=function(){var a=function(a){var b=document,c=b.documentElement["client"+a],d=b.body;return b.compatMode==="CSS1Compat"&&c||d&&d["client"+a]||c};return{height:a("Height"),width:a("Width")}};var h=function(a){var b=$E(V["multiPicLoading"]),c=Math.max(a.height,500),d=Math.max(a.width,500);b.style.top=(c-181)/2+"px";b.style.left=(d-141)/2+"px";l()};var i=function(){$E(V["multiPicLoading"]).style.top="-1000px"};var j=function(a){var b=g(),c=Math.max(b.height,500),d=Math.max(b.width,500),e=document,f=e.documentElement.scrollTop+e.body.scrollTop;a.style.height=c+"px";a.style.width=d+"px";a.style.top=f+"px";var h=$E(V["multiPicContent"]);h.style.height=c-88+"px"};var k=function(){var a=$E(V["multiPicContent"]);var b=a.getElementsByTagName("IMG"),c,d;for(var e=0,f=b.length;e<f;e++){c=b[e];d=c.getAttribute("origin-size");if(d){return c}}return null};var l=function(){var a=k();if(a){a.parentNode.removeChild(a)}};var m=function(a,b){var c=Math.max(a.height-88,412);var d=Math.max(a.width,500);var e=b.height;var f=b.width;b.setAttribute("origin-size",f+"*"+e);var g=(a.height-88)/e;var h=a.width/f;if(!isFinite(g)||!isFinite(h)){return}var i=1,j,k;if(1>g&&g<h){k=Math.min(e,c);i=k/e;j=i*f;b.height=k;b.width=j}else if(1>h){j=Math.min(f,d);i=j/f;k=i*e;b.width=j;b.height=k}if($IE&&$IE<8){b.style.zoom=1}};var n=function(a,b){if(b.offsetHeight==0||b.offsetWidth==0){return}var c=(a.offsetHeight-b.offsetHeight)/2;var d=(a.offsetWidth-b.offsetWidth)/2;if(c<0){c=0}b.style.top=c+"px";if(d<0){d=0}b.style.left=d+"px";trace("left: "+d+" top:"+c);var e=$E(V["orignalPic"]);e.style.top=c+10+"px";e.style.left=d+10+"px"};var o=function(){var a=$E(V["orignalPic"]);a.style.visibility="inherit"};var p=function(){var a=$E(V["orignalPic"]);a.style.visibility="hidden"};var q=function(a){var b="___$image"+(new Date).getTime();var c=window[b]=new Image;blogId=$E(V["multiPicLike"]).getAttribute("blog-id");c.src="http://control.blog.sina.com.cn/riaapi/article/filmslide.php?"+b+"&blogId="+blogId+"&img="+a;c.onload=c.onerror=function(){c=null;window[b]=null}};var r=false;var s=function(a,b,c){if(r){return}r=true;winDialog.alert(a,{icon:"01",textOk:"知道了",funcOk:function(){X=0;r=false;x();b&&b()},funcClose:function(){X=0;r=false;x();c&&c()}},"slide-box-tips")};var t=function(a){if(ab){return}Y=0;s(a||"图片太小啦，无法展示！")};var u=function(a){var b=/(?:(?:ww\d+|s\d+).sinaimg.cn|photo\.sina\.com\.cn)\/large/;var c=a.match(b);if(b.test(a)){a=a.replace(/\/large\//,"/orignal/")}$E(V["orignalLink"]).href=a};var v="";var w=function(a,c,d,e){if(ab){return}var f=y(a.url);if(!e){var e=new Image;e.src=f}v=f;var j="<em>"+(bb+1)+"</em>/<span>"+c+"</span>";$E(V["multiPicIndex"]).innerHTML=j;l();var k=g();e.style.top="-10000px";e.style.position="absolute";fb.appendChild(e);var o=e.width>200||e.height>200;if(!$IE6&&o||e.complete&&o){_(e,"opacity",.5);i();setTimeout(function(a){var b=$E(V["multiPicContent"]);return function(){if(a.src!==v){fb.removeChild(a);return}q(a.src);a.setAttribute("action-type","show-large-layer");a.setAttribute("action-data",encodeURIComponent(a.src));b.appendChild(a);setTimeout(function(){m(g(),a);n(b,a);var c=new Ui.TweenStrategy(.5,1,.5);c.onTween=function(b){if(e.src!==v){if(a.parentNode){a.parentNode.removeChild(a)}c.stop();a=null;return}_(a,"opacity",b)};c.start();u(a.src)})}}(e))}else{b=arguments;h(k);var p=0,r=15;var w=setInterval(function(a,c){return function(){if(!Z){clearInterval(w);return}var d=a.offsetWidth>200||a.offsetHeight>200;var e=p*r/1e3;p++;var f=a.complete&&a.width>0&&a.height>0&&a.width<200&&a.height<200;if(f&&!Z[c].recordSmall){Y++;Z[c].recordSmall=1}if(Z&&Z.length==Y+X){clearInterval(w);if(X==0){t()}return}if(e>5||f){clearInterval(w);X++;if(c===bb){l();x()}return}if(a.complete&&d){clearInterval(w);var g=[];for(var h=0,i=b.length;h<i;h++){g.push(b[h])}g.push(a);b.callee.apply(null,g);return}}}(e,d),r);e.onerror=function(a){return function(b){if(!Z[a].recordError){X++;Z[a].recordError=1}if(X+Y>=c){clearInterval(w);s("抱歉，图片读取失败。");return}e.onerror=null;l();x()}}(d)}};var x=function(){if("pre"===$E(V["multiPicEntity"]).getAttribute("direction")){K()}else{L()}};var y=function(a){var b=/(?:(?:ww\d+|s\d+).sinaimg.cn|photo\.sina\.com\.cn)\/(mw690|mw600|middle|bmiddle)/;var c=a.match(b);if(c){switch(c[1]){case"bmiddle":return a.replace(/\/bmiddle\//,"/large/");case"mw690":return a.replace(/\/mw690\//,"/large/");case"middle":return a.replace(/\/middle\//,"/large/");case"mw600":return a.replace(/\/mw600\//,"/large/");default:return a}}else{return a}};var z=function(a,b){var c=null,d=Math.abs(b),e=a.length;for(var f=1;f<d;f++){var g=b>0?bb+f:bb-f;c=a[g];if(c&&c.loaded===0){(function(a,b){setTimeout(function(){var c=new Image;c.onload=c.onerror=function(){c=null};c.src=a;Z[b].loaded=1},40)})(y(c.url),g)}}};var A=function(a){if(-1!==a.indexOf("sinaimg.cn/uc/myshow")){return true}if(-1!==a.indexOf("img.t.sinajs.cn")){return true}if(-1!==a.indexOf("simg.sinajs.cn")){return true}if(-1!==a.indexOf("sinaimg.cn/small")){return true}if(-1!==a.indexOf("sinaimg.cn/square")){return true}return false};var B=function(a,b){var c,d=a.length,e=g();Z=a;if(0<d){h(e);H();var f=false;for(c=0;c<d;c++){if(Z[c].click){bb=c;w(Z[c],d,c);f=true;break}}if(!f){bb=0;w(Z[0],d,0)}z(Z,3);z(Z,-3)}else{C()}};var C=function(a){if(a){var b=Core.Events.getEventTarget(a);if("IMG"===b.nodeName.toUpperCase()){return}}if(db){db.hide()}if(fb){fb.innerHTML="";document.body.removeChild(fb);fb=null}ab=true;var c=g();f();var d=V["multiPicEntity"];var e=$E(d);e.style.display="none";S.hidden();Z=[];bb=0;X=0;Y=0;eb=null;T.data=null;if(gb&&gb.dialog){gb.dialog.hidden()}};var D=false;var E=function(a){$E(a).style.visibility="hidden"};var F=function(a){$E(a).style.visibility="inherit"};var G=function(a){E(V["multiPicLike"]);E(V["multiPicTitle"]);E(V["multiPicIndex"]);if("next"===a){E(V["multiPicNext"])}else{E(V["multiPicPre"])}};var H=function(){F(V["multiPicLike"]);F(V["multiPicTitle"]);F(V["multiPicIndex"]);F(V["multiPicNext"]);F(V["multiPicPre"])};var I=function(){if(db){db.hide()}};var J=function(a){D=true;var b=k();if(b){b.style.visibility="hidden";b=null}G(a);p();if(!db){db=new Article.SlideTJCover({renderTo:$E(V["multiPicContent"]),review:function(){H();bb=-1;L();db.hide()}})}var c=$E(V["multiPicEntity"]).getAttribute("blog-id");var d=$E(V["multiPicTitle"]);var e=decodeURIComponent(d.getAttribute("publish-time")||"");T.getNextSlideData(c,e,function(a){db.show(a)},"")};var K=function(a){if(a){Core.Events.stopEvent(a)}Lib.sendSuda(function(){try{SUDA.log("","blog_slide_page")}catch(a){}});Lib.diYuanXinLog(function(){try{vjEventTrack("")}catch(a){}});var b=Z.length;if(bb<=0){J("pre");bb=-1;return}else{bb--}D&&I();D&&H();D=false;var c=Z[bb];w(c,b,bb);$E(V["multiPicEntity"]).setAttribute("direction","pre");z(Z,-3)};var L=function(a){Lib.sendSuda(function(){try{SUDA.log("","blog_slide_page")}catch(a){}});Lib.diYuanXinLog(function(){try{vjEventTrack("")}catch(a){}});if(a){Core.Events.stopEvent(a)}var b=Z.length;if(bb>=b-1){J("next");bb=b;return}else{bb++}D&&I();D&&H();D=false;var c=Z[bb];w(c,b,bb);$E(V["multiPicEntity"]).setAttribute("direction","next");z(Z,3)};var M=function(a){Core.Events.stopEvent(a);var b=$E(V["multiPicLike"]),c=b.getAttribute("blog-id"),d="http://control.blog.sina.com.cn/admin/digg/post_digg.php";var e=b.getAttribute("block");if(e==="1"){return}var f=$E(V["multiPicTitle"]);var g=f.innerText||f.textContent;b.setAttribute("block","1");Utils.Io.JsLoad.request(d,{onComplete:function(a){b.setAttribute("block","0");var d=a.code;if(d==="A00006"||d==="B00801"){b.className="ico_unlike ico_liked";b.innerHTML="已喜欢";if(scope.digger){scope.digger.setData(c,scope.$uid,1)}var e=$E("dbox_"+c);e.onmouseover=function(){};e.onmouseout=function(){};e.onclick=function(){};e.className="upBox upBox_dis";var f=$E("dbox2_"+c);e.style.cursor="default";var g=e.getElementsByTagName("p")[1];var h=g.innerHTML;var i=SinaEx.createNode("<div>"+h+"</div>");var j=SinaEx.findNode(i,"nextSibling","firstChild");i.removeChild(j);var k=i.innerHTML;if(k==="顶"){g.innerHTML='<img width="15" height="15" align="absmiddle" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" class="SG_icon SG_icon34">已顶'}else{g.innerHTML="已喜欢"}var l=parseInt(f.getAttribute("mnum"))+1;f.innerHTML=l}else if("A00800"===d){s("对不起，您短时间点击喜欢过多，请多休息，注意身体！感谢您对新浪博客的支持和关注！",function(){},function(){})}else{s(a.message||"发生错误，请稍候再试",function(){},function(){})}},GET:{res_id:c,res_uid:scope.$uid,action:"0",res_type:"1",ti_title:encodeURIComponent(g)},onException:function(){aObj.setAttribute("block","false");s(result.message||"发生错误，请稍候再试",function(){},function(){})}})};var N=function(){j($E(V["multiPicEntity"]));setTimeout(function(){var a=g(),b=null;if(!D){b=k();b&&m(a,b);b&&n($E(V["multiPicContent"]),b)}else{if(db&&!db.isHidden){db.fixPos()}}},25)};var O=function(a){if(ab){return}var b=g(),c=document.body,d=arguments,e=this;setTimeout(function(){var a=g();if(a.height===b.height&&a.width===b.width){N()}},80)};var P=Ui.LayerCount();var Q='<div id="#{multiPicEntity}" class="dialogMultiShow"                 style="display:none;z-index:'+(P+1)+';">              <a id="#{multiPicClose}" href="javascript:void(0);" title="关闭" class="close" style="z-index:'+(P+2)+'" hidefocus="true">关闭</a>              <a id="#{multiPicPre}" href="javascript:void(0);" class="btn_preview" style="z-index:'+(P+2)+'" hidefocus="true"></a>              <a id="#{multiPicNext}" href="javascript:void(0);" class="btn_next" style="z-index:'+(P+2)+'" hidefocus="true"></a>              <a id="#{multiPicLike}" href="javascript:void(0);" class="ico_unlike" style="z-index:'+(P+2)+'" hidefocus="true">喜欢</a>              <div class="bd">                <div id="#{multiPicIndex}" class="count"><em>5</em>/<span>20</span></div>                <div id="#{multiPicContent}" class="pic" style="position:relative;">                    <div class="con" id="#{orignalPic}" style="position:absolute;z-index:1025;">                        <a id="#{orignalLink}" target="_blank" href="#" class="opic" title="查看原图"  hidefocus="true">查看原图</a>                    </div>                    <div id="#{multiPicLoading}" class="loadding" style="top:-10000px;">图片加载中......</div>                </div>                <div class="title"><a id="#{multiPicTitle}" target="_blank" href="javascript:void(0);"  hidefocus="true">标题</a></div>              </div>            </div>';var R=document,S=null,T=this,U=new Lib.HtmlTemplate(Q),V=U.getNodeIds(),W=U.getHtmlString(),X=0,Y=0,Z=[],$=Core.Events.addEvent,_=Core.Dom.setStyle,ab=true,bb=0,cb="http://simg.sinajs.cn/blog7style/css/common/multishow.css",db=null,eb=null;Utils.Io.loadExternalCSS(cb,function(){});Core.Dom.addHTML(document.body,W);$($E(V["multiPicClose"]),C);$($E(V["multiPicPre"]),K);$($E(V["multiPicNext"]),L);$($E(V["multiPicLike"]),M);$(document,function(a){if(ab){return}var b=$E(V["multiPicEntity"]).getAttribute("direction");if(37===a.keyCode&&!(D&&b==="pre")){K()}else if(39===a.keyCode&&!(D&&b==="next")){L()}},"keydown");$($E(V["multiPicTitle"]),function(a){Core.Events.stopBubble(a)});$($E(V["multiPicContent"]),function(a){var b=Lib.util.getActionData(a,"show-large-layer");if(!b){return}o()},"mouseover");$($E(V["multiPicContent"]),function(a){var b=Lib.util.getActionData(a,"show-large-layer");if(!b){return}var c=a.toElement||a.relatedTarget;var d=a.srcElement||a.target;if("A"===c.nodeName.toUpperCase()&&"IMG"===d.nodeName.toUpperCase()){return}p()},"mouseout");$(window,O,"resize");var fb=null;var gb=null;Lib.checkAuthor();if(!$isLogin){gb=new Lib.Login.Ui}var hb={scrollTop:0,show:function(a,b,d,f,h,i){var k=V["multiPicEntity"];var l=$E(k);if(!l||!a.length){return}Lib.checkAuthor();D=false;if(!fb){fb=document.createElement("DIV");fb.id="_sile-img-box"+(new Date).getTime();fb.style.position="absolute";fb.style.top="-10000px";this.imgContainer=fb;document.body.appendChild(fb)}p();X=0;Y=0;d=d||"";ab=false;var m=g();e();h=h||scope.$articleid;$E(V["multiPicEntity"]).setAttribute("blog-id",h);setTimeout(function(){if(!S){S=new Lib.OnlyShadow(.9,R.body,"mask_mutiplepic",{zIndex:P});S.entity.style.zIndex=P;S.entity.style.backgroundColor="black"}var e=g();S.entity.style.width=e.width+"px";S.show();l.style.display="";j(l);var k=[];for(var m=0,n=a.length;m<n;m++){c=a[m];if(!A(c.url)){k.push(c)}}if(0<k.length){B(k,h)}else{t()}if(b){var o=typeof b!=="string"?b.href:b;var p=$E(V["multiPicTitle"]);p.href=o;p.innerHTML="";p.setAttribute("publish-time",encodeURIComponent(i));var q=document.createTextNode(Core.String.trim(d)||"查看原文");p.appendChild(q);var r=$E(V["multiPicLike"]);r.setAttribute("blog-id",h);if(f){r.className="ico_unlike ico_liked";r.innerHTML="已喜欢"}else{r.className="ico_unlike";r.innerHTML="喜欢"}}},25);var n=this},getNextSlideData:function(a,b,c,d){var e=this;Utils.Io.JsLoad.request("http://control.blog.sina.com.cn/riaapi/article/getArticlePrevNextPic.php?rnd="+Math.random(),{GET:{blog_id:a,blog_pubdate:b,uid:$UID||"",action:d||""},onComplete:function(a){if("A00006"===a.code){e.data=a.data}else{e.data={pre:{},next:{}}}c&&c(e.data)},onException:function(){}})},setDirection:function(a){$E(V["multiPicEntity"]).setAttribute("direction",a)},showNextSlide:function(a){var b=this.data;if(b){this.recordPV(a);var c;for(var d in b){c=b[d];if(c&&a===c.blogId){break}}if(c){var e="http://blog.sina.com.cn/s/blog_"+c.blogId+".html",f,g=[],h=c.images;for(var i=h.length-1;i>=0;i--){f=c.images[i];g.unshift({url:f,loaded:0,click:0})}this.show(g,e,c.title,c.isLiked,c.blogId,c.publishTime);if(db){db.hide()}}}},recordPV:function(a){if(a!==scope.$articleid){var b=new Image;var c=parseInt(Math.random()*1e3);var d="http://hits.blog.sina.com.cn/hits?act=4&aid="+a+"&ref="+encodeURIComponent(location.href)+"&rnd="+c;b.src=d;window["log_pv"+c]=b;b.onload=b.onerror=function(){window["log_pv"+c]=null;b=null}}},hide:function(){C()},destroy:function(){C();f();document.body.removeChild($E(V["multiPicEntity"]));W=null;Z=null;V=null;if(db){db.destroy();db=null}}};Lib.apply(this,hb)};$registJob("showSlideBox",function(a){var b=Lib.util.getActionData,c=Core.Events.addEvent,d=/([^\/]+)$/;var e=function(a,b,c,d,e,f){Lib.sendSuda(function(){try{SUDA.log("","blog_slide_page")}catch(a){}});Lib.diYuanXinLog(function(){try{vjEventTrack("")}catch(a){}});var g=new Article.MultipleImgLayer;g.show(a,b,c,d,e,f)};var f=function(a){if(-1!==a.indexOf("sinaimg.cn/uc/myshow")){return true}if(-1!==a.indexOf("img.t.sinajs.cn")){return true}if(-1!==a.indexOf("simg.sinajs.cn")){return true}if(-1!==a.indexOf("sinaimg.cn/small")){return true}if(-1!==a.indexOf("sinaimg.cn/square")){return true}return false};var g=function(a,b,c){var e=a===b,g=null;var h=f(a);if(-1===a.indexOf("/blog7style")&&-1===a.indexOf("sg_trans.gif")&&!e&&!h){g={url:a,loaded:0,click:c===a.match(d)[1].replace(/\&amp;690/,"&690")}}return g};c(document.body,function(a){var c=b(a,"show-slide");if(!c){return}Core.Events.stopDefaultEvent(a);var f=scope.$articleid,h=location.protocol+"//"+location.host+location.pathname,i=[],j,k,m,n,o,p,f,q,r,s=scope.$pageid;if("article"===s||"articleM"===s){var t=$E("dbox_"+f);var n=location.href;var u=$E("t_"+f),o=u.innerText||u.textContent;var p=/\bupBox_dis\b/.test(t.className);var v=$E("sina_keyword_ad_area2");var w=$T(v,"img");var x=decodeURIComponent(c.data);r=x.match(d)[1];for(E=0,l=w.length;E<l;E++){m=w[E];j=m.getAttribute("real_src");k=m.getAttribute("src");var y=j===k;if(y){var z=m.width>1&&m.width<200;var A=m.height>1&&m.height<200;if(z&&A){continue}}k=j||k;var B=g(k,h,r);if(B){i.push(B)}}var C=$T(document.body,"span"),D,q=scope.$publishTime;if(!q){for(var E=C.length-1;E>=0;E--){D=C[E];if("time SG_txtc"===D.className){q=D.innerText||D.textContent;break}}q=q.replace("(","").replace(")","")}e(i,n,o,p,scope.$articleid,q)}else{var F=c.data.split("&");var k=decodeURIComponent(F[0]),G=decodeURIComponent(F[1]),H=decodeURIComponent(F[2]),o=decodeURIComponent(F[3]),q=decodeURIComponent(F[4]);Utils.Io.JsLoad.request("http://control.blog.sina.com.cn/riaapi/article/getArticlePic.php?rnd="+Math.random(),{GET:{blog_id:G,blog_pubdate:q,uid:$UID||""},onComplete:function(a){if("A00006"===a.code){var b=a.data;var c=b.images;r=k.match(d)[1];for(E=0,l=c.length;E<l;E++){k=c[E];var f=g(k,h,r);if(f){i.push(f)}}e(i,H,o,b.isLiked,G,b.publishTime)}},onException:function(){}})}})});$registJob("showSlideBtn",function(a){function n(){if(this.width<200&&this.height<200){return false}var a=this.getAttribute("real_src")||this.getAttribute("src");this.setAttribute("action-data",encodeURIComponent(a));this.setAttribute("action-type","show-slide");var b=Core.Dom.getXY(this)[0]+10;b=Math.min(b,h-134);m.style.left=b+"px";m.style.top=Core.Dom.getXY(this)[1]+10+"px";if(k){m.style.display="";m.setAttribute("action-data",encodeURIComponent(this.src))}}function o(){if(this.width<200&&this.height<200){return false}var a=Core.Events.getEvent(),b=a.relatedTarget||a.toElement;if(!b||!Core.Dom.contains(m,b)){m.style.display="none"}}function p(a){var b=a.getAttribute("real_src")||a.getAttribute("src")||"";if(-1!==b.indexOf("sinaimg.cn/uc/myshow")){return true}if(-1!==b.indexOf("img.t.sinajs.cn")){return true}if(-1!==b.indexOf("simg.sinajs.cn")){return true}if(-1!==b.indexOf("sinaimg.cn/small")){return true}if(-1!==b.indexOf("sinaimg.cn/square")){return true}return false}function q(a){while(a=a.parentNode){if("A"===a.nodeName.toUpperCase()){return a}}return null}function r(a){l(a,n.bind2(a),"mouseover");l(a,o.bind2(a),"mouseout")}function s(a){if(p(a)||!Core.Dom.contains(g,a)){return}t();var b=u(a);if(b&&-1===b.href.indexOf("photo.blog.sina.com.cn")){return}var c=a.getAttribute("src");var d=-1!==c.indexOf("sg_trans.gif");if(a.complete&&!d){r(a)}else{a.onload=function(){r(this);var b=this.getAttribute("real_src");var c=this.getAttribute("src");if(!b&&b===c){a.onload=null}}.bind2(a)}}function t(){h=Core.Dom.getXY(g)[0]+g.clientWidth}function u(a){if(!d){return null}var b;while(a=a.parentNode){if(a.nodeName.toUpperCase()=="A"){return a}}return null}function v(){k=1;b($T(g,"img"),function(a){s(a,"src")})}var b=Core.Array.foreach,c=scope.$pageid,d=c=="article"||c=="articleM",e=scope.$uid,f,g=$E("sina_keyword_ad_area2")||document.body,h,i,j=62,k=1,l=Core.Events.addEvent;var m=SinaEx.createNode('<div style="left: -1000px; top: -1000px;position:absolute;" class="picSlideBtn" action-type="show-slide" action-data="http%3A%2F%2Fww4.sinaimg.cn%2Flarge%2F697db644jw1dw1s1zljvaj.jpg"><a href="javascript:void(0);">幻灯播放</a></div>');document.body.appendChild(m);Core.Events.addEvent(window,t,"resize");v();scope.showPicSlide=function(a,b){s(a)}});Core.Dom.byClass=function(a,b,c){c=c||document;if(c.getElementsByClassName){return c.getElementsByClassName(a)}var d=new RegExp("\\b"+a+"\\b"),e=[],f=c.getElementsByTagName(b),g,h=f.length;for(g=0;g<h;g++){c=f[g];if(c.nodeType===1&&c.className&&d.test(c.className)){e.push(c)}}return e};$registJob("xingqu",function(){var a={171:"娱乐博客",172:"财经博客",173:"股票博客",174:"体育博客",175:"IT博客",176:"博客首页",177:"文化博客",178:"教育博客",179:"军事博客",180:"女性博客",181:"育儿博客",182:"健康博客",183:"星座博客",184:"游戏博客",185:"美食博客",186:"旅游博客",187:"杂谈博客",191:"汽车博客",192:"房产博客",193:"佛学博客",194:"宠物博客"};var b=function(a){window._cateIdForThisPage_=a;Utils.Io.JsLoad.request("http://news.sina.com.cn/js/694/2013/0220/guess.boot.blog.js",{charset:"gb2312",isRemove:false,onComplete:function(){}})};var c;var d=window.location.href;if(d.indexOf("tj=")!==-1){var e=Core.Dom.byClass("SG_icon107","img",$E("articlebody")),f,g;if(e){f=e[0].title}if(f){for(g in a){if(f.indexOf(a[g])>-1){c=g;break}}}b(c)}else if(c=scope.$cate_id){b(c)}Utils.Io.JsLoad.request("http://ent.sina.com.cn/js/470/2013/0506/collect.js",{charset:"gb2312",isRemove:false,onComplete:function(){}})});Lib.countOSLink=function(a){var b=Core.Events.addEvent;var c=/^http:\/\/[\w\.]*?blog.sina.com.cn/i,d=a.length,e,f,g,h,i;while(d--){f=a[d].blogid;g=a[d].uid;h=a[d].container?$T(a[d].container,"a"):document.links;e=h.length;while(e--){i=h[e].href;if(!i||i.match(c)||i.indexOf("javascript:")>-1){continue}!function(a,c,d,e){if(a){b(c,function(){commonLog("http://interface.blog.sina.com.cn/riaapi/article/click_url.php?blogid="+a+"&url="+encodeURIComponent(d))})}else{b(c,function(){commonLog("http://interface.blog.sina.com.cn/riaapi/article/click_url.php?uid="+e+"&url="+encodeURIComponent(d))})}c=null}(f,h[e],i,g)}}h=null;b=null};$registJob("osl_article",function(){Lib.countOSLink([{blogid:scope.$articleid||"",container:$E("sina_keyword_ad_area2")}])});slideBox=Core.Class.create();slideBox.prototype={assertNull:function(a,b){if(null==a){throw Error(b)}},initialize:function(a,b,c,d,e){this.assertNull(a,"boxBody不能为null");this.assertNull(b,"slideBody不能为null");this.assertNull(c,"previousBtn不能为null");this.assertNull(d,"nextBtn不能为null");this.boxBody=a;this.slideBody=b;this.previousBtn=c;this.nextBtn=d;this.isFirst=true;this.isLast=false;this.currentPage=1;this.cfg=e;var f=Core.Function.bind2,g={direction:"leftToRight",motion:Ui.Transition.simple,duration:.5,slideChildCount:1,onTweenBegin:function(){},onTweenEnd:function(){}};Core.Events.addEvent(c,f(function(){this.cfg.onTweenBegin("",this.currentPage,"previous");this.previousPage()},this));Core.Events.addEvent(d,f(function(){this.cfg.onTweenBegin("",this.currentPage,"next");this.nextPage()},this));var h=function(a,b){var c;for(c in b){a[c]=b[c]}return a};this.cfg=h(g,e||{});this.startTweenStyle=parseInt(this._getSlideBeginValue()||0);b.style[this._getTweenStyle()]=this.startTweenStyle+"px"},getCurrentSlideLength:function(){var a=0,b=this.slideBody.style;switch(this.cfg.direction){case"leftToRight":a=b.left;break;case"bottomToTop":a=b.bottom;break;case"topToBottom":a=b.left;break}return parseInt(a||0)},hasNextPage:function(){return this.slideBody.children.length>this.currentPage*this.cfg.slideChildCount},hasPreviousePage:function(){return this.currentPage>1},getSlideLegnth:function(){var a=this.cfg.slideLength||0;if(a){return a}var b=this.slideBody,c=b.children,d=c.length;if(d<1){return 0}var e=c[0],f=f||(window.getComputedStyle?window.getComputedStyle(e,""):e.currentStyle);var g=0,h,i,j,k;switch(this.cfg.direction){case"leftToRight":var l=e.offsetWidth;h=this._getCurrentStyle(e,"margin-right",f)||0;i=this._getCurrentStyle(e,"margin-left",f)||0;g=l+parseInt(h)+parseInt(i);break;case"bottomToTop":case"topToBottom":var m=e.offsetHeight,n=0;j=parseInt(this._getCurrentStyle(e,"margin-top",f)||0,10);k=parseInt(this._getCurrentStyle(e,"margin-bottom",f)||0,10);n=Math.max(j,k);g=m+(d-1)*n+j+k;break}var o=g*this.cfg.slideChildCount;this.cfg.slideLength=o;return o},previousPage:function(){var a=!this.hasPreviousePage();if(a||this.onTweening){a&&this.cfg.onTweenEnd("begin",this.currentPage,"previous");return}var b=this.boxBody,c=this.slideBody,d=window.getComputedStyle?window.getComputedStyle(c,""):c.currentStyle,e=this.getCurrentSlideLength(d),f,g=this.getSlideLegnth();this.currentPage--;f=e+g;this._tween(e,f)},nextPage:function(){var a=!this.hasNextPage();if(a||this.onTweening){a&&this.cfg.onTweenEnd("end",this.currentPage,"next");return}var b=this.boxBody,c=this.slideBody,d=window.getComputedStyle?window.getComputedStyle(c,""):c.currentStyle,e=this.getCurrentSlideLength(d),f,g=this.getSlideLegnth();this.currentPage++;f=e-g;this._tween(e,f)},_getCurrentStyle:function(a,b,c){var d,c=c||(window.getComputedStyle?window.getComputedStyle(a,""):a.currentStyle);try{d=c.getPropertyValue(b)}catch(e){b=b.replace(/^(-)/,"").replace(/-(\S)/g,function(a,b){return b.toUpperCase()});d=c[b]}return d},_getSlideBeginValue:function(a){var b=this.slideBody,c=0;switch(this.cfg.direction){case"leftToRight":c=this._getCurrentStyle(b,"left",a)||0;break;case"bottomToTop":c=this._getCurrentStyle(b,"top",a)||0;break;case"topToBottom":c=this._getCurrentStyle(b,"bottom",a)||0;break}return parseInt(c)},_getTweenStyle:function(){switch(this.cfg.direction){case"leftToRight":return"left";case"bottomToTop":return"bottom";case"topToBottom":return"top"}return"left"},_tween:function(a,b){var c=this.slideBody.style,d=this._getTweenStyle();tween=new TweenStrategyEx([a],[b],this.cfg.duration,this.cfg.motion);this.onTweening=true;tween.onTween=function(a){c[d]=parseInt(a[0],10)+"px"};var e=this;tween.onEnd=function(){var a=!e.hasNextPage(),b=!e.hasPreviousePage(),c="";if(a){e.isLast=true;e.isFirst=false;c="end"}else if(b){e.isFirst=true;e.isLast=false;c="begin";}else{e.isFirst=false;e.isLast=false}e.onTweening=false;e.cfg.onTweenEnd(c,e.currentPage)};tween.start()}};$registJob("blog365Slide",function(){if(!$E("calendarCon")){return}$E("calendarCon").style.width=9999+"px";new slideBox($E("swrap"),$E("calendarCon"),$E("btn_preview"),$E("btn_next"),{slideChildCount:7,duration:1})});Lib.classUtils=function(){};Lib.classUtils.prototype.addClass=function(a,b){if(!a){return false}if(!this.hasClass(a,b)){a.className=Core.String.trim(a.className.concat(" "+b))}};Lib.classUtils.prototype.delClass=function(a,b){if(!a){return false}var c=new RegExp("( +|^)"+b+"(?=( |$))","ig");a.className=Core.String.trim(a.className.replace(c,""))};Lib.classUtils.prototype.hasClass=function(a,b){if(!a){return false}var c=new RegExp("( +|^)"+b+"(?=( |$))","ig");return c.test(a.className)};(function(){function c(){var b=$C("div");b.className="module365";b.style.position="absolute";b.style.top="0px";b.style.right="0px";b.style.zIndex="200";b.innerHTML=a;$E("headarea")&&$E("headarea").appendChild(b);var c=$E("blog365_calCon")&&$E("blog365_calCon").children;var d=new Date,f=d.getDate(),g=d.getFullYear(),h=d.getMonth()+1;var i=d.getTime();var j=(new Date(g,0,1)).getTime();var k=i-j;if(k==0){k=1}else{k=Math.floor(k/(24*60*60*1e3))+1}$E("blog365_dateNum").innerHTML=k;if($isAdmin){var l=c[f-1];todayDiv=l.getElementsByTagName("div")[0];l.className+=" today";var m='<a onclick="v7sendLog(\'48_01_22\')" href="http://control.blog.sina.com.cn/admin/article/article_add.php?tag365" target="_blank"><span class="rectoday" title="记录今天"></span></a>';todayDiv.innerHTML=m;var n=e(g,h);for(var o=f;o<n;o++){var p=c[o],q=p.getElementsByTagName("div")[0];p.className+=" coming";var r=g+"-"+h+"-"+(o+1);var m='<a onclick="v7sendLog(\'48_01_23\')" href="http://control.blog.sina.com.cn/admin/article/article_add.php?tag365='+r+'" target="_blank"><span class="tq">提前<br>记录</span></a>';q.innerHTML=m}}}function d(a){var b=$E("blog365_calCon")&&$E("blog365_calCon").children;var c=new Date,d=c.getDate(),e=c.getFullYear(),f=c.getMonth()+1;for(var g in a){var h=g.split("-")[2]-1;var i=b[h],j=i.getElementsByTagName("div")[0];if(a[g].pre&&a[g].href){i.className="d"+(h+1)+" writed";var k="";if($isAdmin){k='<a href="'+a[g].href+'" target="_blank" ><span class="date">'+(h+1)+"日</span></a>";j.innerHTML=k}j.innerHTML=k}else{if(h===d-1){i.className="d"+d}var l,k;l=a[g].href?a[g].href:"javascript:void(0);";target=a[g].href?"_blank":"";if(a[g].src&&a[g].src.indexOf("sinaimg.cn")>=0){k='<a href="'+l+'" target="'+target+'"><img src="'+a[g].src+'"/><span class="date">'+(h+1)+"日</span></a>"}else{k='<a href="'+l+'" target="'+target+'"><span class="date">'+(h+1)+"日</span></a>"}j.innerHTML=k}}}function e(a,b){var c=function(a){return a%400?a%100?a%4?0:1:0:1};if(!a*b){return 0}var d=31;switch(b){case 4:case 6:case 9:case 11:d=30;break;case 2:d=c(a)?29:28;break}return d}if(scope.tpl!=="8_52"){return}Lib.checkAuthor();var a='<ul id="blog365_calCon">'+'<li class="d1"><div class="pic"></div></li>'+'<li class="d2"><div class="pic"></div></li>'+'<li class="d3"><div class="pic"></div></li>'+'<li class="d4"><div class="pic"></div></li>'+'<li class="d5"><div class="pic"></div></li>'+'<li class="d6"><div class="pic"></div></li>'+'<li class="d7"><div class="pic"></div></li>'+'<li class="d8"><div class="pic"></div></li>'+'<li class="d9"><div class="pic"></div></li>'+'<li class="d10"><div class="pic"></div></li>'+'<li class="d11"><div class="pic"></div></li>'+'<li class="d12"><div class="pic"></div></li>'+'<li class="d13"><div class="pic"></div></li>'+'<li class="d14"><div class="pic"></div></li>'+'<li class="d15"><div class="pic"></div></li>'+'<li class="d16"><div class="pic"></div></li>'+'<li class="d17"><div class="pic"></div></li>'+'<li class="d18"><div class="pic"></div></li>'+'<li class="d19"><div class="pic"></div></li>'+'<li class="d20"><div class="pic"></div></li>'+'<li class="d21"><div class="pic"></div></li>'+'<li class="d22"><div class="pic"></div></li>'+'<li class="d23"><div class="pic"></div></li>'+'<li class="d24"><div class="pic"></div></li>'+'<li class="d25"><div class="pic"></div></li>'+'<li class="d26"><div class="pic"></div></li>'+'<li class="d27"><div class="pic"></div></li>'+'<li class="d28"><div class="pic"></div></li>'+'<li class="d29"><div class="pic"></div></li>'+'<li class="d30"><div class="pic"></div></li>'+'<li class="d31"><div class="pic"></div></li>'+'<li class="actpage"><div class="pic"><a title="活动页" target="_blank" href="http://qing.blog.sina.com.cn/tag/365"></a></div></li>'+"</ul>"+'<div class="wdate" id="blog365_dateNum"></div>';var b="http://control.blog.sina.com.cn/riaapi/activity/get_blog365.php?data=1";c();Utils.Io.JsLoad.request(b,{GET:{uid:scope.$uid||""},onComplete:function(a){if(a.code&&a.code==="A00006"){d(a.data)}}});})();$registJob("loginStatus",function(){Lib.checkAuthor();var a=Utils.Cookie.getCookie;var b=Utils.Cookie.setCookie;var c=a("_s_loginStatus");var d=a("_s_loginuid");if($isLogin){if(d===$UID){return}}else{if(!c||c===d){return}}b("_s_loginuid",$UID||c,24-(new Date).getHours(),"","blog.sina.com.cn");var e="http://control.blog.sina.com.cn/blog_rebuild/riaapi/padblog/padInfo.php?rnd="+Math.random();Utils.Io.JsLoad.request(e,{onComplete:function(){},onException:function(){}})});$registJob("showTB680",function(){var a=document.getElementById("column_1");var b=Core.Dom.byClass("SG_conn","div",a);var c=b[2]||b[b.length-1];var d="<div class='SG_conn'><iframe frameborder=0 scrolling='no' marginwidth='0' marginheight='0' width='210' height='220' src='http://d1.sina.com.cn/litong/tanx2014/tanx_blog.html'></iframe></div>";if(a.insertAdjacentHTML){c.insertAdjacentHTML("BeforeBegin",d)}else{var e=el.ownerDocument.createRange();e.setStartBefore(c);var f=e.createContextualFragment(d);c.parentNode.insertBefore(f,c)}});$registJob("padSwitch",function(){function f(a){var b=new Date;b.setTime(b.getTime()-1);document.cookie=a+"=_pass;path=/;domain=.blog.sina.com.cn;expires="+b.toGMTString()}var a=navigator.userAgent,b=/(iPad).*OS\s([\d_]+)/.test(a);var c='<div class="webSelect"><a id="sw_web" class="current" href="javascript:void(0);">电脑版</a><a id="sw_pad" href="javascript:void(0)">PAD版</a></div>';var d=Core.Events.addEvent;var e=window.location.href;if(b){Core.Dom.insertHTML($E("sinablogfooter"),c,"AfterBegin");d($E("sw_pad"),function(a){a.target.className="current";Core.Dom.removeClass($E("sw_web"),"current");f("ipad4web");e=e.replace("blog","m.blog");window.location.href=e})}});$registJob("loginFollow",function(){function i(){var a=new Ui.TweenStrategy;a.onTween=function(a){};a.onEnd=function(){};a.start()}Lib.checkAuthor();var a=$E("loginFollow");var b=unescape(Utils.Cookie.getCookie("onceloggedonblog"));var c=Lib.Login.info();var d=c.uid;var e=c.nick;if(!a||!b||$isLogin||!d||!e){return}if(d===scope.$uid){return}var f='<div class="loginFollow">'+'<div class="con">'+'<p id="#{loginFollowCon}"></p>'+'<div class="btm"><a id="#{loginBtn}" href="javascript:void(0);" class="btn" title="登录并关注"></a><span>还没有博客账号？点此<a href="https://login.sina.com.cn/signup/signupmail.php?entry=blog&r=&srcuid=&src=blogicp" target="_blank" onclick="v7sendLog(\'44_01_03_'+d+"')\">注册</a>一个</span></div>"+"</div>"+"</div>";var g=Utils.insertTemplate(a,f,"BeforeEnd");g.loginFollowCon.innerHTML="Hi，"+e+"！我是"+(scope.owenerNickName||$E("ownernick").innerHTML.replace(/(\r|\n)/g,""))+"。  现在就登录关注我的博客，不要错过我的任何更新！";v7sendLog("44_01_01_"+d);var h=new Lib.Login.Ui;Core.Events.addEvent(g.loginBtn,function(){v7sendLog("44_01_02_"+d);h.login(function(){v7sendLog("44_01_04_"+d);Lib.Component.Attention($UID,scope.$uid,function(){location.reload()})})},"click")});$registJob("blogTip",function(){var a=Lib.Listener;a.on({name:"article-msg-loaded",callBack:function(a){h(a)},scope:this});var b=null;var c="";var d="";var e="";var f="";var g=function(a){c=a;var b=b||50;var d=parseInt(a)%8+1;f="http://portrait"+d+".sinaimg.cn/"+a+"/blog/"+b};var h=function(a){if(a){if(a.cms_id==d){return}g(a.uid);d=a.cms_id+"";e=a.nick_name;i();m()}};var i=function(){if(!$E("blogTip")){var a='<div id="blogTip" class="mDynaState" style="position:fixed;z-index:300; left:580px; top:92px; opacity:0.0;"><div class="con"><a onclick="v7sendLog(\'40_01_47\')" href="###"><img id="UIMG" width="30" height="30" alt=""></a><a href="###" onclick="v7sendLog(\'40_01_47\')" id="NName" class="nickname"></a>刚刚对此博文进行了评论<span id="blogTipShowBtn">,<a href="###" onclick="v7sendLog(\'40_01_46\')">查看</a></span></div><a href="###" onclick="v7sendLog(\'40_01_48\');" class="close" title="关闭" id="blogTip_closeBtn">×</a></div>';Core.Dom.addHTML(document.body,a);var b=Core.Dom.getXY($E("sinabloga"));$E("blogTip").style.top=b[1]+"px";Core.Events.addEvent(blogTip,function(){n();if($E("article_comment_list").childNodes[0].childNodes.length<1){var a=new Comment.List;a.load(1);scope.$comment_is_load_page_1=1;setTimeout(j,1e3)}else{j()}Core.Events.stopEvent()},"click");Core.Events.addEvent(blogTip_closeBtn,function(){n();Core.Events.stopEvent()},"click");Core.Events.addEvent(UIMG,function(){window.open("http://blog.sina.com.cn/u/"+c);n();Core.Events.stopEvent()},"click");Core.Events.addEvent(NName,function(){window.open("http://blog.sina.com.cn/u/"+c);n();Core.Events.stopEvent()},"click")}$E(UIMG).src=f;var g=0;var h=e.split("");var i=0;for(var k=0;k<h.length;k++){if(h[k].charCodeAt(0)<299){g+=.75}else{g+=1}if(g>=8&&i==0){i=k}}if(i>0){$E(NName).innerHTML=e.substr(0,i)+"..."}else{$E(NName).innerHTML=e}if(d){$E("blogTipShowBtn").style.display=""}else{$E("blogTipShowBtn").style.display="none"}};var j=function(){if($E("cmt_"+d)){l()}else{var a="http://control.blog.sina.com.cn/blog_rebuild/riaapi/profile/note/getCms.php?uid="+scope.$uid+"&cms_id="+d;Utils.Io.JsLoad.request(a,{onComplete:function(a){if(a&&"A00006"===a.code){a.data["cid"]=d;k(a.data)}},onException:function(){location.hash="commonComment"},timeout:3e3})}};var k=function(a){var b=$E("article_comment_list");var c=new CommentV2.Add;var d=a;d.action_data=Utils.Json.flatten({articleid:scope.$articleid,commentid:d.id,fromProduct:d.fromProduct,comm_uid:d.uid,uname:d.nick_name,ulink:d.ulink,src_uid:d.src_uid,cms_reply_num:d.cms_reply_num});d.uname=d.nick_name;d.action_data=encodeURIComponent(d.action_data);var e=c.render(d);b.insertBefore(e,b.firstChild);l()};var l=function(){location.hash="cmt_"+d};var m=function(){v7sendLog("40_01_45");$E("blogTip").style.display="";var a=new Ui.TweenStrategy(0,1,.5);a.onTween=function(a){Core.Dom.setStyle($E("blogTip"),"opacity",a)};a.onEnd=function(){a=null;setTimeout(n,5e3)};a.start()};var n=function(){var a=new Ui.TweenStrategy(1,0,.5);a.onTween=function(a){Core.Dom.setStyle($E("blogTip"),"opacity",a)};a.onEnd=function(){a=null;$E("blogTip").style.display="none"};a.start()}});CommentV2.CommentForCheck=Core.Class.create();CommentV2.CommentForCheck.prototype={initialize:function(a){this._opt=a;if(scope.$commentlistIsReady){this.load()}else{Lib.Listener.on({name:"commentlist-isready",callBack:this.load,scope:this})}},getParam:function(){return this._opt},load:function(){if($E("cmt_"+this._opt.cms_id)){this.setHashPos();return}var a=this.getParam();this.getInterface=new Interface("http://control.blog.sina.com.cn/blog_rebuild/riaapi/profile/note/getCms.php","jsload");this.getInterface.request({GET:a,onSuccess:function(a){this.rander(a)}.bind2(this),onError:function(a){},onFail:function(){}})},rander:function(a){var b=$E("article_comment_list");var c=new CommentV2.Add;a.action_data=Utils.Json.flatten({commentid:a.id,articleid:scope.$articleid,fromProduct:a.fromProduct,comm_uid:a.comm_uid,uname:a.nick_name,ulink:a.ulink});a.uname=a.nick_name;a.action_data=encodeURIComponent(a.action_data);if(a.fromProduct=="weibo"){a.from='<img height="15" align="absmiddle" width="15" class="SG_icon SG_icon51" src="http://simg.sinajs.cn/images/common/sg_trans.gif">'}var d=c.render(a);b.insertBefore(d,b.firstChild);this.setHashPos()},setHashPos:function(){var a=window.location.hash;window.location.hash="cmt_"+this._opt.cms_id;window.location.hash=a}};$registJob("commentForCheck",function(){if(/cmtforcheck_/.test(location.hash)){var a=location.hash.split("_");var b={cms_id:a[1],uid:a[2]};new CommentV2.CommentForCheck(b)}});$registJob("diYuanXin",function(){Lib.diYuanXinLog(function(){try{vjEventTrack("")}catch(a){}})});$registJob("uatrack",function(){Lib.sendSuda(function(){var a=scope.$pageid;var b=Core.Dom.byClass;switch(a){case"editor":var c=b("msnTips_lx","div");if(c){v7sendLog("41_01_05");SUDA.uaTrack("blog_post","v_post1")}break;case"article":case"articleM":var d=$E("module_910");var e=$E("module_911");var f=$E("module_909");var g=$E("module_903");var h=$E("module_904");if(d){SUDA.uaTrack("blog_wqing_g","v_wqing_g")}if(e){v7sendLog("41_01_03");SUDA.uaTrack("blog_bjqing_g","v_bjqing_g");SUDA.uaTrack("blog_qing_g","v_SLOT_49");SUDA.uaTrack("blog_qing_g","v_SLOT_50");SUDA.uaTrack("blog_qing_g","v_SLOT_51")}if(f){SUDA.uaTrack("blog_btjblog","v_btjblog")}if(g){v7sendLog("41_01_06");SUDA.uaTrack("blog_xg","v_blogxg")}if(h){SUDA.uaTrack("blog_tjblog","v_tjblog")}break}})});$registJob("hotAdvertise",function(){var a=document.getElementById("column_1");var b=Core.Dom.byClass("SG_conn","div",a);var c=document.getElementById("module_911")||b[b.length-1];var d='<div class="SG_conn" id="hotShangPin"></div>';Utils.insertTemplate(c,d,"AfterEnd");Lib.execZhitou(function(a){blogAd.insertIns("PDPS000000052389",$E("hotShangPin"),"Afterbegin");(window.sinaads||[]).push({})});var e=document.getElementById("module_903")||b[b.length-1];var f='<div class="SG_conn" id="recommendShangXun"><div class="SG_connHead"><span class="title">推荐商讯</span></div><div class="SG_connBody"><div class="atcTitList relaList"><ul></ul></div></div></div>';Utils.insertTemplate(e,f,"AfterEnd");Lib.execZhitou(function(a){blogAd.insertIns("PDPS000000052390",$E("recommendShangXun").children[1].children[0].children[0],"Afterbegin");(window.sinaads||[]).push({params:{sinaads_ad_tpl:'<li class="SG_j_linedot1"><p class="atcTitCell_tit SG_dot"><a target="_blank" href="#{link}" onclick="try{#{monitor}}catch(e){}">#{src}</a></p><p class="atcTitCell_nm"><a target="_blank" href="#{link}" onclick="try{#{monitor}}catch(e){}" class="SG_linkb" style="display:inline-block;height:14px; line-height:14px; white-space:normal; overflow:hidden;">#{src1}</a></p></li>'}})})});$registJob("xgBlogAD",function(){function o(a,b){var c,d,e;for(d in b){e=new RegExp("{{"+d+"}}","ig");c=(c||a).replace(e,b[d])}return c}function p(){Utils.Io.JsLoad.request(i,{GET:{id:j,uid:$UID||0,blogerid:scope.$uid||0},onComplete:function(a){var c=null;if(a[j]){c=a[j].res[0]}if(c){if(scope.$pageid=="articletj"){var d=o(l,c);b(e,d,"AfterEnd")}else{var f=o(k,c);b(e,f,"AfterEnd")}if(SUDA){SUDA.uaTrack(c.a_v_suda_key,c.a_v_suda_value)}}q()},onException:function(a){}})}function q(){var e=scope.$articleid;var f=scope.$cate_id;var i=scope.$sort_id;if(e){var j="http://blog.sina.com.cn/s/related_"+e+".js";var k={cate_id:f,sort_id:i};d=a(c,"div","SG_connBody");h=a(c,"div","atcTit_more");if(scope.$pageid=="articletj"){g=a(d[0],"li","reco_bloglist_con").length}else{g=a(d[0],"li","SG_j_linedot1").length}if(g>3){return}Utils.Io.Ajax.request(j,{returnType:"json",GET:k,onComplete:function(c){var e=c.slideReads;var c=c.relatedReads;if(scope.$pageid=="articletj"){var f=a(d[0],"ul","reco_bloglist have_user")[0];if(f){for(var g=0;g<c.length;g++){var j=o(n,c[g]);b(f,j,"BeforeEnd")}}}else{var f=a(d[0],"ul","")[0];if(f){for(var g=0;g<c.length;g++){var k=o(m,c[g]);b(f,k,"BeforeEnd")}}}var l=a(h[0],"a","")[0];if(l){if(i=="111"){l.setAttribute("href","http://finance.sina.com.cn/blog/8.html")}else if(i=="153"){l.setAttribute("href","http://finance.sina.com.cn/blog/2.html")}}if(typeof window.scope.___fnForListenerSlot==="function"){window.scope.___fnForListenerSlot(e)}else{window.scope.___fnForListenerSlot=e}},onException:function(a){}})}}var a=Core.Dom.getElementsByClass;var b=Core.Dom.insertHTML;var c=$E("module_903");var d,e,f,g,h;var i="http://interface.blog.sina.com.cn/riaapi/pageslot/pagexg.php";var j="SLOT_89";var k='<li class="SG_j_linedot1">'+'<p class="atcTitCell_tit SG_dot">'+'<a {{a_c_suda}} href="{{a_href}}" target="_blank" title="{{a_title}}">{{words}}</a>'+"</p>"+'<p class="atcTitCell_nm">'+'<a {{a_c_suda}} href="{{a_href}}" class="SG_linkb" target="_blank">{{author}}</a>'+"</p>"+"</li>";var l='<li class="reco_bloglist_con">'+'<span class="blogname">'+'<a {{a_c_suda}} onclick="v7sendLog(\'41_01_07\');" href="{{a_href}}" target="_blank" title="{{a_title}}">{{words}}</a>'+"</span>"+'<span class="bloguser">'+'<a {{a_c_suda}} onclick="v7sendLog(\'41_01_07\');" class="SG_linkb" href="{{a_href}}" target="_blank">{{author}}</a>'+"</span>"+"</li>";var m='<li class="SG_j_linedot1">'+'<p class="atcTitCell_tit SG_dot">'+'<a {{a_c_suda}} href="{{a_href}}" target="_blank" title="{{a_title}}">{{a_title}}</a>'+"</p>"+'<p class="atcTitCell_nm">'+'<a {{a_c_suda}} href="http://blog.sina.com.cn/u/{{uid}}" class="SG_linkb" target="_blank">{{author}}</a>'+"</p>"+"</li>";var n='<li class="reco_bloglist_con">'+'<span class="blogname">'+'<a {{a_c_suda}} onclick="v7sendLog(\'41_01_07\');" href="{{a_href}}" target="_blank" title="{{a_title}}">{{a_title}}</a>'+"</span>"+'<span class="bloguser">'+'<a {{a_c_suda}} onclick="v7sendLog(\'41_01_07\');" class="SG_linkb" href="http://blog.sina.com.cn/u/{{uid}}" target="_blank">{{author}}</a>'+"</span>"+"</li>";if(scope.$pageid=="articletj"){d=a(c,"div","SG_connBody");e=a(d[0],"li","reco_bloglist_con")[1]}else{d=a(c,"div","SG_connBody");e=a(d[0],"li","SG_j_linedot1")[1]}if(e){p()}});Core.Array.isArray=function(a){return Object.prototype.toString.call(a)==="[object Array]"};$registJob("rightAD",function(){function n(){Core.Dom.setStyle(c,"right","-"+g+"px");o(k,l)}function o(a,b){if(!c){return}var d={id:b};if(typeof scope!="undefined"){d.blogeruid=scope.$uid}if($UID){d.loginuid=$UID}var e=function(c){function e(e){if(e&&e.length>=2){e[0].words=e[0].a_title;e[1].words=e[1].a_title;if(c[b[1]]&&e[0].a_title){c[b[1]].res=[e[0]]}if(c[b[3]]&&e[1].a_title){c[b[3]].res=[e[1]]}}p(a,b,c);window.clearTimeout(d)}var d;b.splice(0,2);if(window.scope.___fnForListenerSlot){e(window.scope.___fnForListenerSlot)}else{window.scope.___fnForListenerSlot=e}d=window.setTimeout(function(){p(a,b,c)},5e3)};if(scope.__subscribeSlot==="waitting"){scope.__subscribeSlotFunc=e}else if(typeof scope.__subscribeSlot==="object"){e(scope.__subscribeSlot)}else{scope.__subscribeSlot="waitting";Utils.Io.JsLoad.request(m,{GET:d,onComplete:function(a){e(a);scope.__subscribeSlot=a;if("function"==typeof scope.__subscribeSlotFunc){scope.__subscribeSlotFunc(a)}},onException:function(){}})}}function p(a,b,c){for(var d=0;d<a.length;d++){var e=c[b[d]];var f=$E(a[d]);if(f&&e){var g=e.materialtype;var h=null;var i="";var j="";if(Core.Array.isArray(e.res)){h={a_c_suda:e.res[0].a_c_suda||"",a_h_suda_key:e.res[0].a_h_suda_key||"",a_h_suda_value:e.res[0].a_h_suda_value||"",a_v_suda_key:e.res[0].a_v_suda_key||"",a_v_suda_value:e.res[0].a_v_suda_value||"",a_href:e.res[0].a_href||"",a_title:e.res[0].a_title||"",imgurl:e.res[0].imgurl||"",words:e.res[0].words||"",author:e.res[0].author||""}}if(g===1&&h){j="v7sendLog('30_01_02')";i="<a "+h.a_c_suda+' onmousedown="'+j+'" target="_blank" href="'+h.a_href+'">'+'<img titlelink="'+h.a_href+'" destxt="'+(h.words||"")+'" title="'+h.a_title+'" src="'+h.imgurl+'" />'+"</a>";f.innerHTML=i}if(g===2&&h){switch(b[d]){case"SLOT_99":var k=e.res?e.res[0].type:"";if(k=="relative_0"){j="v7sendLog('30_01_03')"}else if(k=="relative_1"){j="v7sendLog('30_01_07')"}else if(k=="topic"){j="v7sendLog('30_01_09')"}else{j="v7sendLog('30_01_03')"}break;case"SLOT_100":j="v7sendLog('30_01_04')";break;case"SLOT_101":var k=e.res?e.res[0].type:"";if(k=="relative_0"){j="v7sendLog('30_01_05')"}else if(k=="relative_1"){j="v7sendLog('30_01_08')"}else if(k=="topic"){j="v7sendLog('30_01_10')"}else{j="v7sendLog('30_01_05')"}break;case"SLOT_102":j="v7sendLog('30_01_06')";break}i='<span class="SG_dot"></span>'+'<a onmousedown="'+j+'" title="'+h.a_title+'" href="'+h.a_href+'" '+h.a_c_suda+' target="_blank">'+h.words+"</a>";f.innerHTML=i}if(typeof SUDA!="undefined"&&h.a_v_suda_key&&h.a_v_suda_value){SUDA.uaTrack(h.a_v_suda_key,h.a_v_suda_value)}}}}function q(){if(j){return}var a=$E("sina_keyword_ad_area2");var b=Core.Dom.getElementsByClass($E("articlebody"),"div","shareUp")[0];var e=Core.System.getScrollPos();var f=Core.System.winSize();var g=Core.Dom.getTop(a);var h=Core.Dom.getTop(b);var k=i.getCookie("dajiakan_layer_close");if(!$E("SLOT_98_dajiakan").innerHTML&&!$E("SLOT_99_dajiakan").innerHTML&&!$E("SLOT_100_dajiakan").innerHTML&&!$E("SLOT_101_dajiakan").innerHTML&&!$E("SLOT_102_dajiakan").innerHTML){return}if(e[0]+f.height>=h){Core.Dom.setStyle(d,"display","");if(k){r(2)}else{if(parseInt(Core.Dom.getStyle(c,"right"),10)!==18){r(0)}}}else{r(1)}}function r(a){var b=0;switch(a){case 0:Core.Dom.removeClass(c,"blog-layer-seeclose");b=-18;break;case 1:b=g;break;case 2:b=h;break}Ui.tween(c,"right",-b,.5,"simple",{end:function(){if(a===0){Core.Dom.removeClass(c,"blog-layer-seeclose");if(typeof SUDA!="undefined"){SUDA.uaTrack("blog_slide_g","v_slide_g")}if(typeof v7sendLog!="undefined"){v7sendLog("30_01_01")}}if(a===1){Core.Dom.setStyle(d,"display","none")}if(a===2){Core.Dom.addClass(c,"blog-layer-seeclose")}}})}function s(){j=true;Core.Dom.setStyle(d,"display","none");i.setCookie("dajiakan_layer_close",true,8,"/",".blog.sina.com.cn")}function t(){var a=parseInt(Core.Dom.getStyle(c,"right"),10);j=true;if(a===18){r(2)}else{r(0)}}var a=scope.isFromSearchEngine||Article.getSearchReferrer();if(a){return}var b='<div id="rightADWrap" style="display:none;z-index:98;position:fixed;right:0;bottom:0;width:398px;height:160px;overflow:hidden;">'+'<div id="rightAD" class="blog-layer-see blog-layer-seeclose" style="position:absolute;right:0;bottom:15px;z-index:99;">'+'<div data-role="arrow" class="boxarrow">'+'<a class="arrow" href="javascript:void(0);"></a>'+"</div>"+'<div class="con">'+'<span data-role="close" class="close" title="关闭">×</span>'+'<h1 class="title">大家在看：</h1>'+'<div id="SLOT_98_dajiakan" class="pic"></div>'+'<ul class="txtul">'+'<li id="SLOT_99_dajiakan"></li>'+'<li id="SLOT_100_dajiakan"></li>'+'<li id="SLOT_101_dajiakan"></li>'+'<li id="SLOT_102_dajiakan"></li>'+"</ul>"+"</div>"+"</div>"+"</div>";Core.Dom.insertHTML("body",b,"BeforeEnd");var c=$E("rightAD");var d=$E("rightADWrap");var e=Core.Dom.getElementsByAttr(c,"data-role","close")[0];var f=Core.Dom.getElementsByAttr(c,"data-role","arrow")[0];var g=380;var h=333;var i=Utils.Cookie;var j=false;if($IE6){d.style.position="absolute"}var k=["SLOT_98_dajiakan","SLOT_99_dajiakan","SLOT_100_dajiakan","SLOT_101_dajiakan","SLOT_102_dajiakan"];var l=["SLOT_58","SLOT_59","SLOT_98","SLOT_99","SLOT_100","SLOT_101","SLOT_102"];var m="http://interface.blog.sina.com.cn/riaapi/pageslot/pageslot.php";if(c){g=parseInt(Core.Dom.getStyle(c,"width"),10)+20;h=g-48;n()}Core.Events.addEvent(window,q,"scroll");if(e){Core.Events.addEvent(e,s,"click")}if(f){Core.Events.addEvent(f,t,"click")}});
