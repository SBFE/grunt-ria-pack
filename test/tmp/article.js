function $E(e){var t="string"==typeof e?document.getElementById(e):e;return null!=t?t:null}function $C(e){return document.createElement(e)}function $N(e){return document.getElementsByName(e)}function $T(e,t){return e.getElementsByTagName(t)}function Jobs(e){this.option=e||{},this._jobTable=[[],[],[],[]]}function v6SendLog(){}function v7sendLog(e,t,i){return e?(3==e.split("_").length&&(Lib.checkAuthor(),$isLogin&&(e+="_"+$UID)),"undefined"==typeof scope&&(window.scope={},scope.$pageid=""),t=t||scope.$pageid,i=i||"",void Utils.Io.JsLoad.request("http://hits.sinajs.cn/A2/b.html?type="+e+"&pageid="+t+"&msg="+i,{onComplete:function(){}})):!1}function showError(e,t){var i=$SYSMSG[e]||e;winDialog.alert(i,{icon:t||"01"})}function msnrefreshWindow(){function e(e){if(trace("has Account"),e){trace("alt:"+e);var t=$C("iframe");t.setAttribute("height",0),t.setAttribute("width",0),document.body.appendChild(t),t.src="https://login.sina.com.cn/sso/login.php?entry=blogmsn&service=blogmsn&alt="+encodeURIComponent(e)+"&savestate=7&returntype=TEXT",function(){var e=arguments.callee;return e.count||(e.count=0),e.count++>10?(trace("放弃获取SUP"),void t.parentNode.removeChild(t)):(trace("尝试获取SUP, count:"+e.count),o("SUP")?(trace("获取到 SUP"+o("SUP")),void window.location.reload()):void setTimeout(e,1e3))}()}else window.location.reload()}function t(){trace("noAccount"),window.location.href="http://blog.sina.com.cn/blog_rebuild/msn/interface/connect_user_confirm.php"}function i(e){var t=new Date;t.setTime(t.getTime()-1),document.cookie=e+"=_pass;path=/;domain=.blog.sina.com.cn;expires="+t.toGMTString()}var n=Utils.Cookie.setCookie,o=Utils.Cookie.getCookie;clearTimeout(msnRefreshTimer);var s=o("reg_token");if(!s)return trace("no token..."),void(msnRefreshTimer=setTimeout(msnrefreshWindow,1e3));trace("token find out..."),n("reg_token","","","/",".blog.sina.com.cn");var a,r,l,c=o("c_uid"),d=o("msnLinkCB"),h=o("AlT");if(n("msnLoginComeFrom",window.location.href,1,"/",".blog.sina.com.cn"),d&&(a=d.split("_"),r=a[0],l=a[1]),c==r)switch(l){case"noCid":break;case"loginError":break;case"unlink":i("msnLinkCB"),t(s);break;case"done":i("msnLinkCB"),n("loginFromMsn","msn",24,"/",".blog.sina.com.cn"),e(h,s);break;case"pass":}}function CustomsDialog(e,t){this.nodesPattern=/[^\{\}]+(?=\})/g,this._dialog=DialogManager.create(e,t),this.entity=this._dialog.entity,this.templateString="",this.nodes={};var i=this;!function(){i._dialog.onDrag=function(){$IE6?this.getProperty().isFixed&&this.setPosition({x:parseInt(this.entity.style.left)-document.documentElement.scrollLeft,y:parseInt(this.entity.style.top)-document.documentElement.scrollTop}):this.getProperty().isFixed&&this.setPosition({x:parseInt(this.entity.style.left),y:parseInt(this.entity.style.top)}),i.onDrag()},i.updateNodes(),i.nodes.btnClose&&Core.Events.addEvent(i.nodes.btnClose,function(){var e=Core.Events.getEvent();e&&(e.cancelBubble=!0)},"mousedown")}(),this._hiddenDialog=function(){i.hidden()},this._closeDialog=function(){i.close()}}function rockIt(e,t,i,n,o,s,a){function r(e){return e?e.getAttribute("rotationId"):parseInt(1e4*Math.random())+ +new Date}function l(e){clearInterval(u[e].timer);for(var t in u[e])delete u[e][t];delete u[e]}function c(e,t){var i=g[u[e].mode],n=u[e],o=n.node.style,s=n.duration,a=n.startPos[0],r=n.endPos[0]-n.startPos[0];o.left=i(t,a,r,s)+"px",a=n.startPos[1],r=n.endPos[1]-n.startPos[1],o.top=i(t,a,r,s)+"px",a=0,r=0==n.round||t==s?0:2*Math.PI*n.round,d(n.node,i(t,a,r,s))}function d(e,t){costheta=Math.cos(t),sintheta=Math.sin(t),$IE?e.style.filter="progid:DXImageTransform.Microsoft.Matrix(M11="+costheta+",M12="+-sintheta+",M21="+sintheta+",M22="+costheta+',SizingMethod="auto expand")':$FF?e.style.MozTransform="matrix("+costheta+", "+sintheta+", "+-sintheta+", "+costheta+", 0, 0)":/WebKit/i.test(navigator.userAgent)&&(e.style.WebkitTransform="matrix("+costheta+", "+sintheta+", "+-sintheta+", "+costheta+", 0, 0)")}function h(){var e=u[p].node.style;e.position="",e.left="",e.top=""}if(e){var p=r(e);p||e.setAttribute("rotationId",p=r());var u=rockIt.instances||(rockIt.instances={});u[p]&&l(p);var g=Ui.Transition;window.$transitions=g,"function"==typeof a.begin&&a.begin(),e.style.position="absolute",document.body.appendChild(e),u[p]={node:e,startPos:t,endPos:i,round:n,func:a,sTime:+new Date,duration:o,mode:s||"simple",degree:0,timer:0},u[p].timer=setInterval(function(){var e=+new Date;u[p].sTime+u[p].duration<e?(c(p,u[p].duration),"function"==typeof a.end&&a.end({clear:h}),l(p)):c(p,e-u[p].sTime)},15)}}function clickSendRandomLog(){v7sendLog("79_01_14",scope.$pageid,"")}function mouseoverSendRandomLog(){v7sendLog("79_01_13",scope.$pageid,"")}function changeFontSize(e){var t,i="字体大小：",n="<strong>#</strong>&nbsp;",o=3,s=["小","中","大"];switch(i+=new Array(4).join(n),e){case 2:t="fontSize_L";break;case 0:t="fontSize_S";break;case 1:default:t="fontSize_M"}i=i.replace(/(<strong>)(#)(<\/strong>)/g,function(t,i,n,a){return o--,o!=e?'<a href="#" onclick="changeFontSize('+o+');return false;">'+s[o]+"</a>":i+s[e]+a}),$E("articleFontManage").innerHTML=i.substring(0,i.length-6),$E("articlebody").className="undefined"!=typeof attentionWorldCup?"worldcup_article "+t:"artical "+t}function commonLog(e){var t=window.clog_img=new Image;t.onload=t.onerror=function(){window.clog_img=null},t.src=e+(e.indexOf("?")>0?"&__rnd=":"?")+Math.random(),t=null}function main(){var e=window.location.href.indexOf("tj=1")>-1;e&&v7sendLog("42_01_07");var t=Lib.Listener;t.add("tray-ad-tips");var i=new Jobs;i.add("suda"),i.add("tray"),i.add("trayTipsAd"),i.add("renderAd"),i.add("showTB680"),i.add("digger"),i.add("articleDigger"),i.add("recordVisitor"),i.add("renderReblogDiv"),i.add("articleCommentV2"),i.add("blogNotice"),i.add("trashPv"),i.add("adNoticeChannel"),i.add("imageLazyLoad"),i.add("articleComp1"),i.add("articleNumberV2"),i.add("articleCommentPostV2"),i.add("quote"),i.add("quote_list"),i.add("dynamicVoteView"),i.add("updownurl"),i.add("articleComp2"),i.add("sharePhoto"),i.add("templateClone",3),i.add("favGames"),i.add("teams_wc"),i.add("calendar_wc"),i.add("phone_attention_add",3),i.add("randomScroll",3),i.add("audioCheck",3),i.add("subscribe",3),i.add("articleShare",3),i.add("report_bodyArticle"),i.add("flashtemplate",3),i.add("stylefix",3),i.add("miniBlogAttention"),i.add("baby_headPhoto"),i.add("baby_babyBarFlashDetect"),i.add("scrollAd"),i.add("static"),i.add("blog365Slide"),i.add("SinglesDay"),i.add("selectionShare"),i.add("qingRecommend",3),i.add("qingRecomNew",3),i.add("tranVideo"),i.add("errorTips"),i.add("toZoneStatic",3),i.add("tjAd",3),i.add("searchToQing",3),i.add("showSlideBox",3),i.add("showSlideBtn",3),i.add("xingqu",3),i.add("osl_article",3),i.add("padSwitch"),i.add("loginFollow"),i.add("uatrack"),i.add("blogTip"),i.add("commentForCheck"),i.add("diYuanXin"),i.add("xgBlogAD"),i.add("hotAdvertise"),i.add("rightAD"),i.start()}"undefined"==typeof Sina&&(Sina={}),Sina.pkg=function(e){if(!e||!e.length)return null;for(var t=e.split("."),i=Sina,n="Sina"==t[0]?1:0;n<t.length;++n)i[t[n]]=i[t[n]]||{},i=i[t[n]];return i};try{document.execCommand("BackgroundImageCache",!1,!0)}catch(e){}!function(){var e=function(e,t){var i=e;return function(){return i.apply(t,arguments)}},t="Debug";(null==window[t]||"undefined"==typeof window[t].log)&&(window[t]={cacheData:[],base_url:"http://sjs.sinajs.cn/bind2/",product:scope.$PRODUCT_NAME,baseColor:{1:{color:"#FFF",bgcolor:"#E00"},2:{color:"#F00"},3:{color:"#FFF000"},4:{color:"#0F0"},5:{color:"#FFF"}},fatal:function(e){this.addData(e,1)},error:function(e){this.addData(e,2)},warning:function(e){this.addData(e,3)},info:function(e){this.addData(e,4)},log:function(e){this.addData(e,5)},dir:function(e){this.addData(e,5)},addData:function(e,t,i,n){if(null!=e){"object"!=typeof e&&(e=e.toString());var o={type:t||"5",color:i||this.baseColor[t].color,bgcolor:n||this.baseColor[t].bgcolor};this.cacheData.push([e,o]),1==this.initFinished&&this.showCurrentData([e,o])}}},window.trace=e(window[t].log,window[t]),window.traceError=e(window[t].error,window[t]))}(),Sina.pkg("Core"),"undefined"==typeof Core&&(Core=Sina.Core),Sina.pkg("Core.Array"),Core.Array.foreach=function(e,t){if(null==e&&e.constructor!=Array)return[];for(var i=0,n=e.length,o=[];n>i;){var s=t(e[i],i);null!==s&&(o[o.length]=s),i++}return o},Sina.pkg("Core.Events"),function(e){function t(e,t){var i;for(i in t)e[i]=t[i]}var i=navigator.userAgent.toLowerCase(),n={$winXP:/windows nt 5.1/.test(i),$winVista:/windows nt 6.0/.test(i),$win7:/windows nt 6.1/.test(i),$macOS:/mac/.test(i)},o={$OPERA:!1,$IE6:!1,$IE7:!1,$IE8:!1,$IE9:!1,$SAFARI:!1,$FF2:!1,$FF3:!1,$FF4:!1,$FF:!1,$CHROME:!1,$TT:!1,$360:!1,$SOGO:!1,$Maxthon:!1},s={$IE:0,$MOZ:!1,$WEBKIT:!1,$KHTML:!1};if(/opera/.test(i)||e.opera)o.$OPERA=!0;else if(/chrome\/(\S+)/.test(i))o.$CHROME=!0;else if(/safari\/(\S+)/.test(i))o.$SAFARI=!0;else if(/msie/.test(i)){s.$IE=!0,/360se/.test(i)?o.$360=!0:/tencenttraveler/.test(i)?o.$TT=!0:/se\s\S+\smetasr\s\d+\.\d+/.test(i)&&(o.$SOGO=!0);var a=i.match(/msie (\d+)/),r=parseInt(a[1]);s.$IE=r,8===r?o.$IE8=!0:6===r?o.$IE6=!0:9===r?o.$IE9=!0:7===r?o.$IE7=!0:10===r&&(o.$IE10=!0)}else if(/firefox/.test(i)){var a=i.match(/firefox\/(\d+)/);o.$FF=parseInt(a[1]),/firefox\/3/.test(i)?o.$FF3=!0:/firefox\/4/.test(i)?o.$FF4=!0:/firefox\/2/.test(i)&&(o.$FF2=!0)}try{var l=window.external;o.$Maxthon=l.max_version?!0:!1}catch(c){}/applewebkit\/(\S+)/.test(i)?s.$WEBKIT=!0:/khtml\/(\S+)/.test(i)?s.$KHTML=!0:/rv:([^\)]+)\) gecko\/\d{8}/.test(i)&&(s.$MOZ=!0),o.$MOBILE=/mobile/i.test(i),o.$MOBILE||(o.$MOBILE=/HTC/.test(i)),t(e,o),t(e,s),t(e,n)}(window),Core.Events.addEvent=function(e,t,i,n){var o="string"==typeof e?$E(e):e;if(null==o)return void trace("addEvent 找不到对象："+e);if("undefined"==typeof n&&(n=!1),"undefined"==typeof i&&(i="click"),o.addEventListener)return"mousewheel"==i&&$FF&&(i="DOMMouseScroll"),o.addEventListener(i,t,n),!0;if(o.attachEvent){{o.attachEvent("on"+i,t)}return!0}o["on"+i]=t},Core.Events.removeEvent=function(e,t,i){var n=$E(e);return null==n?void trace("removeEvent 找不到对象："+e):void("function"==typeof t&&("undefined"==typeof i&&(i="click"),n.addEventListener?n.removeEventListener(i,t,!1):n.attachEvent&&n.detachEvent("on"+i,t),t[i]=null))},Sina.pkg("Core.Function"),Core.Function.bind3=function(e,t,i){i=null==i?[]:i;var n=e;return function(){return n.apply(t,i)}},Core.Array.findit=function(e,t){var i=-1;return Core.Array.foreach(e,function(e,n){t==e&&(i=n)}),i},window.onerror=function(e,t,i){return trace("Error occured:"+e+"<br/>file:"+t+"<br/>line:"+i+"<br/>"),!0},Jobs.prototype={_registedJobTable:{},errorMsg:[],_registJob:function(e,t){this._registedJobTable[e]=t},error:function(e){Debug.error(e),this.errorMsg.push(e)},add:function(e,t){t=t||1,-1==Core.Array.findit(this._jobTable[t],e)?this._jobTable[t].push(e):this.error("Error: Job <b>"+e+"</b> is existed now.")},start:function(){null!=this.option.onStart&&this.option.onStart();var e=(this._registedJobTable,this._jobTable[1].concat(this._jobTable[2])),t=this;this.fe=Core.Function.bind3(t.focus,t,[]);var i=function(){return 0==t._jobTable[3].length?void(null!=t.option.onEnd&&t.option.onEnd()):(Core.Events.addEvent(document.body,t.fe,"focus"),Core.Events.addEvent(window,t.fe,"scroll"),Core.Events.addEvent(document.body,t.fe,"mousemove"),void Core.Events.addEvent(document.body,t.fe,"mouseover"))};this.queue(e,i)},focus:function(){var e=this;if(this.focusdown)return Core.Events.removeEvent(document.body,e.fe,"focus"),Core.Events.removeEvent(window,e.fe,"scroll"),Core.Events.removeEvent(document.body,e.fe,"mousemove"),Core.Events.removeEvent(document.body,e.fe,"mouseover"),void(e.fe=null);this.focusdown=!0;var t=this._jobTable[3];this.queue(t,this.option.onEnd)},queue:function(e,t){var i=this,n=function(){return(new Date).valueOf()},o=this._registedJobTable,s=e.length,a=0,r=window.setInterval(function(){if(a>=s)return clearInterval(r),r=null,void(null!=t&&t());var l=e[a],c=o[l];if(a++,"undefined"==typeof c)return void i.error("<b>Job["+l+"] is undefiend!!!</b>");var d=!0,h=n();try{c.call()}catch(p){throw i.error("<b>Job["+l+"] failed!!!</b>"+p.message),null!=t&&t(),d=!1,p}finally{if(d){var u=n();Debug.info("<b>Job["+l+"] done in "+(u-h)+"ms.</b>")}}},10)},call:function(e,t){"undefined"!=typeof this._registedJobTable[e]?this._registedJobTable[e].apply(this,t):trace("<b>Job["+e+"] is undefined!!!</b>",{color:"#900",bgColor:"#FFF;"})}},$registJob=function(e,t){Jobs.prototype._registJob(e,t)},$callJob=function(e){var t=[];arguments.length>1&&(Core.Array.foreach(arguments,function(e,i){t[i]=e}),t.shift()),Jobs.prototype.call(e,t)},"undefined"==typeof Lib&&(Lib={}),Lib.pkg=function(e){if(!e||!e.length)return null;for(var t=e.split("."),i=Lib,n="Lib"==t[0]?1:0;n<t.length;++n)i[t[n]]=i[t[n]]||{},i=i[t[n]];return i},Lib.register=function(e,t){for(var i,n=e.split("."),o=Lib;i=n.shift();)n.length?(void 0===o[i]&&(o[i]={}),o=o[i]):void 0===o[i]&&(o[i]=t(Lib))},Lib.register("Listener",function(){var e={};return e.listeners={},{add:function(t){if(e.listeners[t])throw new Error("listener '"+t+"' has registed!");e.listeners[t]=[]},remove:function(t){return e.listeners[t]?(e.listeners[t]=null,!0):!1},notify:function(t,i){var n=e.listeners[t],o=null;if(n)for(var s=0,a=n.length;a>s;s++)o=n[s],o.callBack.call(o.scope,i)},on:function(){for(var t=arguments,i=null,n=0,o=t.length;o>n;n++)i=t[n],this.isListen(i)||(e.listeners[i.name]||(e.listeners[i.name]=[]),e.listeners[i.name].push(i))},off:function(t){var i=e.listeners[t.name];if(!i)return!0;for(var n=null,o=0,s=i.length;s>o;o++)n=i[o],n.callBack==t.callBack&&n.scope==t.scope&&i.splice(o,1)},isListen:function(t){var i=e.listeners[t.name],n=null;if(!i)return!1;for(var o=0,s=i.length;s>o;o++)if(n=i[o],n.callBack==t.callBack&&n.scope==t.scope)return!0;return!1}}}),Sina.pkg("Core.Dom"),Core.Dom.insertHTML=function(e,t,i){if(e=$E(e)||document.body,i=i.toLowerCase()||"beforeend",e.insertAdjacentHTML){switch(i){case"beforebegin":return e.insertAdjacentHTML("BeforeBegin",t),e.previousSibling;case"afterbegin":return e.insertAdjacentHTML("AfterBegin",t),e.firstChild;case"beforeend":return e.insertAdjacentHTML("BeforeEnd",t),e.lastChild;case"afterend":return e.insertAdjacentHTML("AfterEnd",t),e.nextSibling}throw'Illegal insertion point -> "'+i+'"'}var n,o=e.ownerDocument.createRange();switch(i){case"beforebegin":return o.setStartBefore(e),n=o.createContextualFragment(t),e.parentNode.insertBefore(n,e),e.previousSibling;case"afterbegin":return e.firstChild?(o.setStartBefore(e.firstChild),n=o.createContextualFragment(t),e.insertBefore(n,e.firstChild),e.firstChild):(e.innerHTML=t,e.firstChild);case"beforeend":return e.lastChild?(o.setStartAfter(e.lastChild),n=o.createContextualFragment(t),e.appendChild(n),e.lastChild):(e.innerHTML=t,e.lastChild);case"afterend":return o.setStartAfter(e),n=o.createContextualFragment(t),e.parentNode.insertBefore(n,e.nextSibling),e.nextSibling}throw'Illegal insertion point -> "'+i+'"'},Core.Dom.setStyle=function(e,t,i){switch(t){case"opacity":e.style.filter="alpha(opacity="+100*i+")",e.currentStyle&&e.currentStyle.hasLayout||(e.style.zoom=1);break;case"float":t="styleFloat";default:e.style[t]=i}},$IE&&9>$IE||(Core.Dom.setStyle=function(e,t,i){"float"==t&&(t="cssFloat"),e.style[t]=i}),Sina.pkg("Core.String"),Core.String.formatNumber=function(e){return e+="",e.replace(/(\d{1,3})(?=(\d{3})+(?:$|\.))/g,"$1,")},Core.String.encodeHTML=function(e){var t=document.createElement("div");return t.appendChild(document.createTextNode(e)),t.innerHTML.replace(/\s/g,"&nbsp;")},Core.String.trimHead=function(e){return e.replace(/^(\u3000|\s|\t)*/gi,"")},Core.String.trimTail=function(e){return e.replace(/(\u3000|\s|\t)*$/gi,"")},Core.String.trim=function(e){return Core.String.trimHead(Core.String.trimTail(e))},Sina.pkg("Utils"),"undefined"==typeof Utils&&(Utils=Sina.Utils),Sina.pkg("Utils.Io"),Sina.pkg("Core.System"),function(){var e=function(e,t){var i;try{if("undefined"!=typeof t)for(i in e)null!=t[i]&&(e[i]=t[i])}finally{return i=null,e}};Core.System.parseParam=e}(),Utils.Url=function(e){e=e||"",this.url=e,this.query={},this.parse()},Utils.Url.prototype={parse:function(e){e&&(this.url=e),this.parseAnchor(),this.parseParam()},parseAnchor:function(){var e=this.url.match(/\#(.*)/);e=e?e[1]:null,this._anchor=e,null!=e&&(this.anchor=this.getNameValuePair(e),this.url=this.url.replace(/\#.*/,""))},parseParam:function(){var e=this.url.match(/\?([^\?]*)/);e=e?e[1]:null,null!=e&&(this.url=this.url.replace(/\?([^\?]*)/,""),this.query=this.getNameValuePair(e))},getNameValuePair:function(e){var t={};return e.replace(/([^&=]*)(?:\=([^&]*))?/gim,function(e,i,n){""!=i&&(t[i]=n||"")}),t},getParam:function(e){return this.query[e]||""},clearParam:function(){this.query={}},setParam:function(e,t){if(null==e||""==e||"string"!=typeof e)throw new Error("no param name set");this.query=this.query||{},this.query[e]=t},setParams:function(e){this.query=e},serialize:function(e){var t=[];for(var i in e)t.push(null==e[i]||""==e[i]?i+"=":i+"="+e[i]);return t.join("&")},toString:function(){var e=this.serialize(this.query);return this.url+(e.length>0?"?"+e:"")+(this.anchor?"#"+this.serialize(this.anchor):"")},getHashStr:function(e){return this.anchor?"#"+this.serialize(this.anchor):e?"#":""}},Core.String.encodeDoubleByte=function(e){return"string"!=typeof e?e:encodeURIComponent(e)},Utils.Io.JsLoad={},function(){function e(e,i){t(e,i);var n,o=e.urls,s=o.length;for(n=0;s>n;n++){var a=$C("script");a.src=o[n].url,a.charset=o[n].charset,a.onload=a.onerror=a.onreadystatechange=function(){a&&a.readyState&&"loaded"!=a.readyState&&"complete"!=a.readyState||(i.script_loaded_num++,a.onload=a.onreadystatechange=a.onerror=null,!1!==e.isRemove&&(a.src="",a.parentNode.removeChild(a)),a=null)},document.getElementsByTagName("head")[0].appendChild(a)}}function t(e,t){var i,n,o,s,a,r=e.urls,l=e.GET,c=r.length;for(i=0;c>i;i++){a=window.parseInt(1e8*Math.random()),o=new Utils.Url(r[i].url);for(n in l)1==e.noencode?o.setParam(n,l[n]):o.setParam(n,Core.String.encodeDoubleByte(l[n]));s=o.getParam("varname")||"requestId_"+a,1!=e.noreturn&&o.setParam("varname",s),t.script_var_arr.push(s),r[i].url=o.toString(),r[i].charset=r[i].charset||e.charset}}function i(t,i){var n={isRemove:!0,urls:[],charset:"utf-8",noreturn:!1,noencode:!1,timeout:-1,POST:{},GET:{},onComplete:null,onException:null},o={script_loaded_num:0,is_timeout:!1,is_loadcomplete:!1,script_var_arr:[]};n.urls="string"==typeof t?[{url:t}]:t,Core.System.parseParam(n,i),e(n,o),function(){if(1!=n.noreturn||null!=n.onComplete){var e,t=[];if(o.script_loaded_num!=n.urls.length)1!=o.is_timeout&&setTimeout(arguments.callee,50);else if(o.is_loadcomplete=!0,null!=n.onComplete){for(e=0;e<o.script_var_arr.length;e++)t.push(window[o.script_var_arr[e]]);n.onComplete(o.script_var_arr.length<2?t[0]:t)}}}(),n.timeout>0&&setTimeout(function(){1!=o.is_loadcomplete&&(null!=n.onException&&n.onException(),o.is_timeout=!0)},n.timeout)}Utils.Io.JsLoad.request=function(e,t){new i(e,t)}}(),Sina.pkg("Core.Class"),Core.Class.AsPrototype={},Core.Class.create=function(){return function(e){e!=Core.Class.AsPrototype&&this.initialize.apply(this,arguments)}},Lib.pkg("Lib.Component"),Lib.Component=Core.Class.create(),Lib.Component.instances=Lib.Component.instances||{},Lib.Component.compSize={},Lib.Component.getInitCompSize=function(){if(null!=scope.component_lists){var e=scope.component_lists;for(var t in e)e[t].list.length>0&&Core.Array.foreach(e[t].list,function(i){Lib.Component.compSize[i]=e[t].size});return!0}return null},Lib.Component.refresh=function(e,t){t=t||{};try{null==Lib.Component.instances[e]&&("undefined"==typeof Lib.Component["Comp_"+e]&&$registComp(e,{},"static"),Lib.Component.instances[e]=new Lib.Component["Comp_"+e](e))}catch(i){}Debug.log("刷新组件 "+e+" ，新宽度是 "+t.width),Debug.log("组件 "+e+" 增加管理链接："+t.addManage),Lib.Component.instances[e].reload(t.width,t.addManage,t.forceRefresh)},Lib.Component.set=function(e){Debug.log("展开组件 "+e+" 的设置功能"),null==Lib.Component.instances[e]&&(Lib.Component.instances[e]=new Lib.Component["Comp_"+e](e)),Lib.Component.instances[e].getUserSet()},Core.Class.extend=function(e,t,i){for(var n in t)null!=i?e[n]||(e[n]=t[n]):e[n]=t[n];return e},Core.Class.define=function(e,t,i){if(e&&e.__isClass&&e.__isClass())throw new Error("class cnt be used as another class' constructor : "+e);if(t=t||Object,i=i||{},i.initialize=e||i.initialize||t.prototype.initialize||function(){},"function"!=typeof i.initialize)throw new Error("only function can be used as constructor");i.__isClass=function(){return!0};var n=Core.Class.create();n.__isClass=i.__isClass;var o=t==Object?{}:new t(Core.Class.AsPrototype);return n.prototype=Core.Class.extend(o,i),n},$registComp=Lib.Component.registComp=function(e,t,i){i=null==i?Lib.Component.Comp:Lib.Component["Comp_"+i],i=i||Lib.Component.Comp,t.compId=e,Lib.Component["Comp_"+e]=Core.Class.define(null,i,t)},Core.Function.bind2=function(e,t){var i=e;return function(){return i.apply(t,arguments)}},Function.prototype.bind2=function(e){var t=this;return function(){return t.apply(e,arguments)}},Core.Dom.getElementsByClass=function(e,t,i){e=e||document;var n=[];i=" "+i+" ";for(var o=e.getElementsByTagName(t),s=o.length,a=0;s>a;++a){var r=o[a];if(1==r.nodeType){var l=" "+r.className+" ";-1!=l.indexOf(i)&&(n[n.length]=r)}}return n},Core.Dom.byClz=Core.Dom.getElementsByClass,Core.Dom.removeNode=function(e){e=$E(e)||e;try{e.parentNode.removeChild(e)}catch(t){}},Lib.Component.Comp=Core.Class.create(),Lib.Component.Comp.prototype={initialize:function(e){return 1==this.isInit||null==e||null==Lib.Component.compSize[e]?void 0:(this.isInit=!0,this.compId=e,this.size=Lib.Component.compSize[e],Lib.Component.instances[e]=this,this)},compId:null,getContainer:function(){return $E("module_"+this.compId)},getTitle:function(){return Core.Dom.getElementsByClass($E("module_"+this.compId),"span","title")[0]},getManage:function(){var e=Core.Dom.getElementsByClass($E("module_"+this.compId),"span","edit");return 0!=e.length?e[0]:(Debug.error("组件添加管理链接失败，检查组件"+this.compId+"标题栏 SPAN[class=edit] 是否存在"),null)},getContent:function(){var e=Core.Dom.getElementsByClass($E("module_"+this.compId),"div","SG_connBody");return 0!=e.length?e[0]:(Debug.error("组件内容节点获取失败，检查组件"+this.compId+"内 DIV[class=SG_connBody] 是否存在"),null)},load:function(){trace("load compId="+this.compId),this.setContent("")},reload:function(){this.clearContent(),this.load()},setTitle:function(e){var t=this.getTitle();t&&(t.innerHTML=e||"")},setManage:function(){var e=this.getManage();$isAdmin&&e&&(e.innerHTML='<span class="move"><a href="#" onclick="funcMoveUpDown.up('+this.compId+');return false;">↑</a><a href="#" onclick="funcMoveUpDown.down('+this.compId+');return false;">↓</a></span><a href="#" onclick="hiddenComponents(\''+this.compId+'\');return false;" class="CP_a_fuc">[<cite>隐藏</cite>]</a>')},setContent:function(e){e="string"==typeof e?e:e+"",this.getContent().innerHTML=e||""},clearContent:function(){this.getContent().innerHTML=""},remove:function(){Core.Dom.removeNode(this.getContainer()),this.finalize()},finalize:function(){this.isInit=null,Lib.Component.instances[this.compId]=null}};var $SYSMSG={};$SYSMSG.extend=function(e,t){for(var i in e)$SYSMSG[i]=0==!!t?e[i]:$SYSMSG[i]},$SYSMSG.extend({A80001:"暂无内容。",A80002:"暂无内容。",A80101:"组件加载失败，请刷新。",A80201:"你要删除留下的访问记录吗？",A80202:'<div class="CP_w_cnt SG_txtb">删除后一小时内不会在此留下访问记录。</div>',A80203:"确实要删除此访问记录吗？",A80204:['<ul class="CP_w_part SG_txtb"><li><input type="checkbox" id="comp_12_deleteToBlack" class="CP_w_fm1" /><label for="comp_12_deleteToBlack" >将此人加入黑名单</label></li></ul><div class="CP_w_cnt SG_txtb">加入黑名单的用户无法和你沟通。</div>'].join(""),A02003:"已添加过此模块，不能重复添加。",A02004:"抱歉，该模块不能被克隆。",A02005:"抱歉，您的博客尚未升级，请<a href='http://blog.sina.com.cn/u/#UID' target='_blank'>升级</a>后再“添加到您的博客”。",A02006:"模块已成功添加到你的博客。",A02007:"确实要隐藏此模块吗？隐藏后可在“页面设置”中恢复。",A02008:"确实要隐藏此模块吗？此模块活动时间已结束，隐藏后不可恢复。"}),$registComp("dynamic",{render_210:function(){},render_510:function(){},render_730:function(){},show:function(e){this.setContent(e)},showEmpty:function(e){this.setContent('<div class="SG_nodata2">'+(e||$SYSMSG.A80001)+"</div>")},showError:function(e){this.setContent(e)},setManage:function(){$isAdmin&&this.getManage()&&(this.getManage().innerHTML='<span class="move"><a href="#" onclick="funcMoveUpDown.up('+this.compId+');return false;">↑</a><a href="#" onclick="funcMoveUpDown.down('+this.compId+');return false;">↓</a></span><a href="#" onclick="hiddenComponents(\''+this.compId+'\');return false;" class="CP_a_fuc">[<cite>隐藏</cite>]</a>')},reload:function(e,t,i){var n=null==e||e&&(210==e||510==e||730==e);return n?(this.size=e||this.size,this.getContent().innerHTML='<div class="wdtLoading"><img src="http://simg.sinajs.cn/blog7style/images/common/loading.gif" />加载中…</div>',this.isSetOn=null,Debug.log("this.isSetOn : "+this.isSetOn),1==i||null==this.cacheData?(Debug.log("强制刷新："+this.compId),this.load()):(Debug.log("缓存刷新："+this.compId),this["render_"+this.size]()),void(t&&this.setManage())):void Debug.error("请检查传入的组件尺寸是否正确。"+e)}}),Sina.pkg("Utils.Cookie"),Utils.Cookie.getCookie=function(e){e=e.replace(/([\.\[\]\$])/g,"\\$1");var t=new RegExp(e+"=([^;]*)?;","i"),i=document.cookie+";",n=i.match(t);return n?n[1]||"":""},Core.System.keyValue=function(e,t){var i=e.match(new RegExp("(\\?|&)"+t+"=([^&]*)(&|$)"));return null!=i?i[2]:null},Lib.checkAuthor=function(){var e=unescape(Utils.Cookie.getCookie("SUP"));if(e&&""!=e)$UID=Core.System.keyValue(e,"uid"),$nick=decodeURIComponent(Core.System.keyValue(e,"nick")),$isLogin=!!$UID,$isAdmin="undefined"==typeof scope.$uid?!1:scope.$uid==$UID;else if(e=Utils.Cookie.getCookie("SU"),e&&""!=e){var t=e.match(/^([^:]*:){2}(\d{5,11})/);$UID=t&&t[2]||null,window.$isLogin=!!$UID,window.$isAdmin="undefined"==typeof scope.$uid?!1:scope.$uid==$UID}else $UID=null,$isLogin=!1,$isAdmin=!1},Core.Array.uniq=function(e){for(var t,i=[],n=0;n<e.length;n++)t=e[n],-1==Core.Array.findit(i,t)&&i.push(t);return i},Lib.Uic={_interfaceMultiquery:"http://uic.sso.sina.com.cn/uic/Mutiquery.php",cacheNickName:{},getNickName:function(e,t,i){e=Core.Array.uniq(e)||[],i=i||10;for(var n=Core.String.trim,o=this.cacheNickName,s=[],a=[],r={},l=0,c=e.length;c>l;l++)if("undefined"==typeof o[e[l]]&&null==o[e[l]]){var d=$E("ownernick"),h=n(scope.$pageid);if(e[l]==scope.$uid&&null!=d&&"articleM"!=h&&"article"!=h&&"personal"!=h&&"personalM"!=h&&"index"!=h&&"indexM"!=h){r[e[l]]=n(d.textContent||d.innerText);continue}if(e[l]==$UID&&null!=scope.nickname){r[e[l]]=n(scope.nickname);continue}s.push(e[l])}else r[e[l]]=o[e[l]]||e[l];if(0==s.length)t(r),r=null;else{for(var p=[],l=0;l<s.length;l++)a[l]=1;s.length>0&&(a.length>0&&(a="["+a.toString().replace(/,$/g,"")+"]"),s="["+s.toString().replace(/,$/g,"")+"]",p.push({url:this._interfaceMultiquery+"?UID=0&Check=null&UIDS="+s+"&UserInfoTypes="+a+"&ProductType=2"}));var u=function(e){Utils.Io.JsLoad.request(e[0].url,{onComplete:function(e){if(e){for(var i=e.UserInfos,n=0;n<i.length;n++)r[i[n][0]]=i[n][2][1],Lib.Uic.cacheNickName[i[n][0]]=i[n][2][1];t(r)}}}),p.length>0&&setTimeout(function(){u(p.splice(0,1))},10)};p.length>0&&setTimeout(function(){u(p.splice(0,1))},10)}}},$registComp("901",{load:function(){Lib.checkAuthor(),0==$isAdmin&&$isLogin?this.loadIsFriend():0!=$isAdmin||$isLogin?(this.isOnline=!0,this.showOnlineInfo()):(this.isFriend=!1,this.loadOnline()),this.loadNickname(),this.loadOtherInfo()},loadIsFriend:function(){if($_GLOBAL.mashAddFriend)return void(this.mashAddFriend=!0);var e=new Interface("http://control.blog.sina.com.cn/riaapi/profile/IsFriend.php","jsload");e.request({GET:{friend_uids:scope.$uid,version:7},onSuccess:function(e){this.friendSuccessCallback(e)}.bind2(this),onError:function(){this.friendErrorCallback()}.bind2(this),onFail:function(){this.friendErrorCallback()}.bind2(this)})},friendSuccessCallback:function(e){for(var t=0,i=e.length;i>t;t++)e[t].uid==scope.$uid&&(this.isFriend=1==e[t].status?!0:!1);this.isFriend=null!=this.isFriend?this.isFriend:!1,this.loadOnline()},friendErrorCallback:function(){this.isFriend=!1,this.loadOnline()},loadOnline:function(){if($isAdmin)this.isOnline=!0,this.showOnlineInfo();else{Utils.Io.JsLoad.request("http://online.sso.sina.com.cn/status/MutiqueryVProduct.php",{GET:{UIDS:"["+scope.$uid+"]",Check:scope.$key,ProductType:"1000",Verbose:"0",noencode:!0},onComplete:Core.Function.bind2(function(e){try{var t=e.Status;this.isOnline=1==t[0]?!0:!1}catch(i){this.isOnline=$isAdmin?!0:!1}this.showVisitButton(),this.showOnlineInfo()},this),onException:Core.Function.bind2(function(){this.isOnline=!1,this.showVisitButton(),this.showOnlineInfo()},this)})}},loadNickname:function(){Lib.Uic.getNickName([scope.$uid],Core.Function.bind2(function(e){this.showNickName(e)},this))},showOnlineInfo:function(){},showNickName:function(){},showVisitButton:function(){},loadOtherInfo:function(){},mashAddFriend:!1,reload:function(e,t,i){var n=null==e||e&&(210==e||510==e||730==e);return n?(this.size=e||this.size,1==i||null==this.cacheData?this.load():this["render_"+this.size](),void(t&&this.setManage())):void Debug.error("请检查传入的组件尺寸是否正确。"+e)}},"dynamic"),Core.String.j2o=function(e){if(!e||""==e)return null;try{var t=window.eval("("+e+")");return t}catch(i){return trace("j2o : 数据分析出错"),traceError(i),null}},Utils.Io.Ijax={arrTaskLists:[],createLoadingIframe:function(){if(null!=this.loadFrames)return!1;var e="loadingIframe_thread"+Math.ceil(1e4*Math.random()),t="loadingIframe_thread"+Math.ceil(1e4*(Math.random()+1));this.loadFrames=[e,t];var i='<iframe id="'+e+'" name="'+e+'" class="invisible"	              scrolling="no" src=""	              allowTransparency="true" style="display:none;" frameborder="0"	              ></iframe>				  <iframe id="'+t+'" name="'+t+'" class="invisible"	              scrolling="no" src=""	              allowTransparency="true" style="display:none;" frameborder="0"	              ></iframe>',n=$C("div");n.id="ijax_iframes",n.innerHTML=i,trace("创建 Ijax 需要的 iframe"),document.body.appendChild(n);var o=setInterval(Core.Function.bind2(function(){null!=$E(this.loadFrames[0])&&null!=$E(this.loadFrames[1])&&(clearInterval(o),o=null,this.loadingIframe={thread1:{container:$E(this.loadFrames[0]),isBusy:!1},thread2:{container:$E(this.loadFrames[1]),isBusy:!1}},this.loadByList())},this),10)},isIjaxReady:function(){if("undefined"==typeof this.loadingIframe)return!1;for(var e in this.loadingIframe)if(0==this.loadingIframe[e].isBusy)return this.loadingIframe[e].isBusy=!0,this.loadingIframe[e];return!1},request:function(e,t){var i={};i.url=e,i.option=t||{},this.arrTaskLists.push(i),null==this.loadFrames?this.createLoadingIframe():this.loadByList()},loadByList:function(){if(0==this.arrTaskLists.length)return!1;var e=this.isIjaxReady();if(0==e)return!1;var t=this.arrTaskLists[0];this.loadData(t.url,t.option,e),this.arrTaskLists.shift()},loadData:function(e,t,i){var n=new Utils.Url(e);if(t.GET)for(var o in t.GET)n.setParam(o,Core.String.encodeDoubleByte(t.GET[o]));/\bdomain\b/.test(e)||n.setParam("domain","1"),n=n.toString();var s=i.container;if(s.listener=Core.Function.bind2(function(){try{var e,o=s.contentWindow.document,a=Core.Dom.byClz(o,"textarea","")[0];e="undefined"!=typeof a?a.value:o.body.innerHTML,t.onComplete?t.onComplete(e):t.onException()}catch(r){traceError(r),t.onException&&t.onException(r.message,n.toString())}i.isBusy=!1,Core.Events.removeEvent(s,s.listener,"load"),this.loadByList()},this),Core.Events.addEvent(s,s.listener,"load"),t.POST){var a=$C("form");a.id="IjaxForm",a.action=n,a.method="post",a.target=s.id;for(var r in t.POST){var l;l=t.noEncode?Core.String.encodeDoubleByte(t.POST[r]):t.POST[r];var c=$C("input");c.type="hidden",c.name=r,c.value=l,a.appendChild(c)}document.body.appendChild(a),a.submit()}else try{window.frames(s.id).location.href=n}catch(d){s.src=n}}},Utils.Io.Ajax={createRequest:function(){var e=null;try{e=new XMLHttpRequest}catch(t){try{e=new ActiveXObject("Msxml2.XMLHTTP")}catch(i){try{e=ActiveXObject("Microsoft.XMLHTTP")}catch(n){}}}return null!=e?e:void 0},request:function(e,t){return t=t||{},t.onComplete=t.onComplete||function(){},t.onException=t.onException||function(){},t.returnType=t.returnType||"txt",t.method=t.method||"get",t.data=t.data||{},"undefined"!=typeof t.GET&&"undefined"!=typeof t.GET.url_random&&0==t.GET.url_random&&(this.rand=!1,t.GET.url_random=null),this.loadData(e,t)
},loadData:function(url,option){var request=this.createRequest(),tmpArr=[],_url=new Utils.Url(url);if(option.POST)for(var postkey in option.POST){var postvalue=option.POST[postkey];null!=postvalue&&tmpArr.push(postkey+"="+Core.String.encodeDoubleByte(postvalue))}var sParameter=tmpArr.join("&")||"";if(option.GET)for(var key in option.GET)"url_random"!=key&&_url.setParam(key,Core.String.encodeDoubleByte(option.GET[key]));0!=this.rand,request.onreadystatechange=function(){if(4==request.readyState){var response,type=option.returnType;try{switch(type){case"txt":response=request.responseText;break;case"xml":if($IE)response=request.responseXML;else{var Dparser=new DOMParser;response=Dparser.parseFromString(request.responseText,"text/xml")}break;case"json":response=eval("("+request.responseText+")")}option.onComplete(response)}catch(e){return option.onException(e.message,_url),!1}}};try{option.POST?(request.open("POST",_url,!0),request.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),request.send(sParameter)):(request.open("GET",_url,!0),request.send(null))}catch(e){return option.onException(e.message,_url),!1}return request}},$IE6&&"undefined"!=typeof Utils.Io.Ijax&&(Utils.Io.Ijax.loadData=function(e,t,i){function n(){if(h>0)try{r.submit()}catch(e){setTimeout(n,10)}h--}var o=new Utils.Url(e);if(t.GET)for(var s in t.GET)o.setParam(s,Core.String.encodeDoubleByte(t.GET[s]));/\bdomain\b/.test(e)||o.setParam("domain","1"),o=o.toString();var a=i.container;if(a.listener=Core.Function.bind2(function(){try{var e,n=a.contentWindow.document,s=Core.Dom.byClz(n,"textarea","")[0];e="undefined"!=typeof s?s.value:n.body.innerHTML,t.onComplete?t.onComplete(e):t.onException()}catch(r){traceError(r),t.onException&&t.onException(r.message,o.toString())}i.isBusy=!1,Core.Events.removeEvent(a,a.listener,"load"),this.loadByList()},this),Core.Events.addEvent(a,a.listener,"load"),t.POST){var r=$C("form");r.id="IjaxForm",r.action=o,r.method="post",r.target=a.id;for(var l in t.POST){var c;c=t.noEncode?Core.String.encodeDoubleByte(t.POST[l]):t.POST[l];var d=$C("input");d.type="hidden",d.name=l,d.value=c,r.appendChild(d)}document.body.appendChild(r);var h=100;n()}else try{window.frames(a.id).location.href=o}catch(p){a.src=o}});var Interface=function(e,t){this.url=new Utils.Url(e),this.type=t.toLowerCase()};Interface.prototype={url:null,type:"",request:function(e){var t=e.onError,i=e.onSuccess;e.onComplete=e.onSuccess=function(e){try{if("string"==typeof e&&(e=e.replace(/;$/,"")),e="string"==typeof e&&/\s*{/.test(e)?Core.String.j2o(e):e,null!=e&&"undefined"==typeof e.code)return void trace("接口数据异常："+this.url,"#F00");null!=e&&"A00006"==e.code?i(e.data):t(e)}catch(n){traceError(n)}}.bind2(this),e.onException=e.onError=e.onFail||function(){if(trace("接口失败："+this.url,"#F00"),arguments.length>0)for(var e=0,t=arguments.length;t>e;e++)arguments[e]&&"undefined"!=typeof arguments[e]&&trace("错误信息："+arguments[e].toString())}.bind2(this);var n=this.url.toString();switch(this.type){case"ijax":Utils.Io.Ijax.request(n,e);break;case"ajax":Utils.Io.Ajax.request(n,e);break;case"script":case"jsload":Utils.Io.JsLoad.request(n,e);break;default:throw new Error("未指定有效的数据传输类型")}}},function(){function e(e){function t(){}return t.prototype=e,new t}Function.prototype.$define=function(e){var t;for(t in e)this.prototype[t]=e[t];if(this.__interface__)for(t in this.prototype)if("NI"===this.prototype[t])throw new Error("类定义错误，接口方法["+t+"]未实现");return this.prototype.constructor=this,this.$extends=this.$define=this.$implements=function(){throw new Error("$define语句定义后面不能再作其它定义")},this},Function.prototype.$extends=function(){var t,i,n=this,o=arguments.length;if(0===o)throw new Error("$extends语句错误：未指定父类");return t=arguments[0],i=function(){t.apply(this,arguments),n.apply(this,arguments)},i.prototype=e(t.prototype),i.prototype.constructor=i,i.$super=t.prototype,i},Function.prototype.$implements=function(){for(var e,t=Array.prototype.slice.call(arguments,0),i=t.length;i--;){if("object"!=typeof t[i])throw new Error("$implements语句错误：参数必须为object类型");for(e in t[i])"undefined"==typeof this.prototype[e]&&(this.prototype[e]="NI")}return this.__interface__=!0,this.$extends=function(){throw new Error("$extends语句错误:$extends语句不能出现在$implements定义之后")},this}}(),Core.Events.getEvent=function(){return window.event},(!$IE||$IE>8)&&(Core.Events.getEvent=function(){if(!$IE&&window.event)return window.event;for(var e,t=arguments.callee.caller,i=0;null!=t&&40>i;){if(e=t.arguments[0],e&&(e.constructor==Event||e.constructor==MouseEvent))return e;i++,t=t.caller}return e}),Core.Events.stopEvent=function(e){var t=e?e:Core.Events.getEvent();null!=t&&(t.cancelBubble=!0,t.returnValue=!1)},(!$IE||$IE>8)&&(Core.Events.stopEvent=function(e){var t=e?e:Core.Events.getEvent();null!=t&&(t.preventDefault(),t.stopPropagation())}),Sina.pkg("Ui"),"undefined"==typeof Ui&&(Ui=Sina.Ui),Ui.Template=function(e){this.tmpl=e,this.pattern=/(#\{(.*?)\})/g},Ui.Template.prototype={evaluate:function(e){return this.tmpl.replace(this.pattern,function(){return e[arguments[2]]||""})},evaluateMulti:function(e,t){var i=[];return Core.Array.foreach(e,Core.Function.bind2(function(n,o){o=t?e.length-o:o,i[o]=this.evaluate(n)},this)),i.join("")}},function(){function e(e){return"string"!=typeof e&&"function"==String.prototype.slice.call(e,0,8)}function t(e,t){var i=t.call(e);return"string"==typeof i||"number"==typeof i?i:null}Core.Function.defineGetter=function(i,n,o){if(n instanceof Array&&o instanceof Array)for(var s=Math.min(n.length,o.length);s--;)"string"==typeof n[s]&&e(o[s])&&(i[n[s]]={valueOf:function(e){return function(){return t(i,o[e])}}(s),toString:this.valueOf});else"string"==typeof n&&e(o)&&(i[n]={valueOf:function(){return t(i,o)},toString:this.valueOf})}}(),Ui.IE6FixedController=function(){var e=this;this.node=null,this.iframeNode=null,this.__orgX=0,this.__orgY=0,this.__isBindScroll=!1,this.__fixedHandle=function(){e.node&&(e.node.style.left=document.documentElement.scrollLeft+e.__orgX+"px",e.node.style.top=document.documentElement.scrollTop+e.__orgY+"px"),e.iframeNode&&(e.iframeNode.style.left=e.node.style.left,e.iframeNode.style.top=e.node.style.top)}}.$define({setFixed:function(e,t){this.updateOrgPosition(),t&&!this.__isBindScroll&&(Core.Events.addEvent(window,this.__fixedHandle,"scroll"),this.__isBindScroll=!0),!t&&this.__isBindScroll&&(Core.Events.removeEvent(window,this.__fixedHandle,"scroll"),this.__isBindScroll=!1)},setPosition:function(e,t,i){"undefined"!=typeof i.x&&(t?(e.style.left=i.x+document.documentElement.scrollLeft+"px",this.__orgX=parseInt(this.node.style.left)-document.documentElement.scrollLeft):e.style.left=i.x+"px"),"undefined"!=typeof i.y&&(t?(e.style.top=i.y+document.documentElement.scrollTop+"px",this.__orgY=parseInt(this.node.style.top)-document.documentElement.scrollTop):e.style.top=i.y+"px"),"undefined"!=typeof i.z&&(e.style.zIndex=i.z)},getX:function(e,t){return t?parseInt(e.style.left)-document.documentElement.scrollLeft:parseInt(e.style.left)},getY:function(e,t){return t?parseInt(e.style.top)-document.documentElement.scrollTop:parseInt(e.style.top)},updateIframe:function(e){this.setFixed(this.iframeNode,e),e&&this.__fixedHandle()},updateOrgPosition:function(){this.node&&(this.__orgX=parseInt(this.node.style.left)-document.documentElement.scrollLeft,this.__orgY=parseInt(this.node.style.top)-document.documentElement.scrollTop)},destroy:function(){Core.Events.removeEvent(window,this.__fixedHandle,"scroll"),this.__isBindScroll=!1,this.node=null,this.iframeNode=null}}),Core.Events.EventDispatcher=function(e){this.__target=e,this.__events={}}.$define({addEventListener:function(e,t){if(this.__checkFunction(t)){var i=this.__events;e=e.toLowerCase(),!i[e]&&(i[e]=[]),i[e].push(t)}},removeEventListener:function(e,t){var i=this.__events[e];if(e=e.toLowerCase(),this.__checkFunction(t)&&i&&i.length)for(var n=i.length-1;n>=0;n--)i[n]==t&&i.splice(n,1)},dispatchEvent:function(e){e=e.toLowerCase();var t=this.__events[e];if(t&&t.length){var i=Array.prototype.slice.call(arguments,0);i.shift();for(var n=0,o=t.length;o>n;n++)t[n].apply(this.__target,i)}},__checkFunction:function(e){return"string"!=typeof e&&"function"==String.prototype.slice.call(e,0,8)}}),Ui.IRenderer={setCanShow:function(){},setCanHidden:function(){},show:function(){},hidden:function(){},addEventListener:function(){},removeEventListener:function(){}},Ui.SimpleRenderer=function(){this.__canShow=!0,this.__canHidden=!0,this.__eventDispatcher=new Core.Events.EventDispatcher(this)}.$implements(Ui.IRenderer).$define({setCanShow:function(e){this.__canShow=!!e},setCanHidden:function(e){this.__canHidden=!!e},show:function(e){return this.__eventDispatcher.dispatchEvent("beforeShow"),this.__canShow&&(e.style.display="",this.__eventDispatcher.dispatchEvent("show")),this},hidden:function(e){return this.__eventDispatcher.dispatchEvent("beforeHidden"),this.__canHidden&&(e.style.display="none",this.__eventDispatcher.dispatchEvent("hidden")),this},addEventListener:function(e,t){return this.__eventDispatcher.addEventListener(e,t),this},removeEventListener:function(e,t){return this.__eventDispatcher.removeEventListener(e,t),this}}),Ui.DisplayObject=function(e,t){Core.Function.defineGetter(this,["x","y","z","width","height"],[this.__getX,this.__getY,this.__getZ,this.__getWidth,this.__getHeight]),this.__renderer=null,this.__entity=t,this.__isInited=!1,this.__parent=e||document.body,this.__eventDispatcher=new Core.Events.EventDispatcher(this);var i=this.__eventDispatcher;this.__onBeforeShow=function(){i.dispatchEvent("beforeShow")},this.__onShow=function(){i.dispatchEvent("show")},this.__onBeforeHidden=function(){i.dispatchEvent("beforeHidden")},this.__onHidden=function(){i.dispatchEvent("hidden")},this.__updateRenderer(Ui.SimpleRenderer)}.$define({isShow:!1,isHidden:!0,setPosition:function(e){return!this.__isInited&&this.__initEntity(),"undefined"!=typeof e.x&&(this.__entity.style.left=e.x+"px"),"undefined"!=typeof e.y&&(this.__entity.style.top=e.y+"px"),"undefined"!=typeof e.z&&(this.__entity.style.zIndex=e.z),this},setSize:function(e){return!this.__isInited&&this.__initEntity(),"undefined"!=typeof e.width&&(this.__entity.style.width=e.width+"px"),"undefined"!=typeof e.height&&(this.__entity.style.height=e.height+"px"),this},setRenderer:function(e){return!this.__isInited&&this.__initEntity(),this.__updateRenderer(e),this},show:function(e){return this.isHidden=!1,this.isShow=!0,!this.__isInited&&this.__initEntity(),this.__updateRenderer(e),this.__renderer.show(this.__entity),this},hidden:function(e){return this.hide(e)},hide:function(e){return this.isHidden=!0,this.isShow=!1,!this.__isInited&&this.__initEntity(),this.__updateRenderer(e),this.__renderer.hidden(this.__entity),this},setCanShow:function(e){return this.__renderer.setCanShow(e),this},setCanHidden:function(e){return this.__renderer.setCanHidden(e),this},addEventListener:function(e,t){return this.__eventDispatcher.addEventListener(e,t),this},removeEventListener:function(e,t){return this.__eventDispatcher.removeEventListener(e,t),this},destroy:function(){this.__entity&&(!this.__isInited&&this.__initEntity(),this.__entity.parentNode&&this.__entity.parentNode.removeChild(this.__entity),this.__entity=null)},__initEntity:function(){var e;!this.__entity&&(this.__entity=$C("div")),e=this.__entity.style,e.position="absolute",e.left=0,e.top=0,!this.__entity.parentNode&&this.__parent.appendChild(this.__entity),this.__isInited=!0},__updateRenderer:function(e){if(e){var t=function(){this.__renderer.addEventListener("beforeShow",this.__onBeforeShow).addEventListener("show",this.__onShow).addEventListener("beforeHidden",this.__onBeforeHidden).addEventListener("hidden",this.__onHidden)};this.__renderer?this.__renderer.constructor!==e&&(this.__renderer.removeEventListener("beforeShow",this.__onBeforeShow).removeEventListener("show",this.__onShow).removeEventListener("beforeHidden",this.__onBeforeHidden).removeEventListener("hidden",this.__onHidden),this.__renderer=new e,t.call(this)):(this.__renderer=new e,t.call(this))}},__getX:function(){return!this.__isInited&&this.__initEntity(),parseInt(this.__entity.style.left)},__getY:function(){return!this.__isInited&&this.__initEntity(),parseInt(this.__entity.style.top)},__getZ:function(){return!this.__isInited&&this.__initEntity(),parseInt(this.__entity.style.zIndex)},__getWidth:function(){return!this.__isInited&&this.__initEntity(),this.__getSize(this.__entity,"offsetWidth")},__getHeight:function(){return!this.__isInited&&this.__initEntity(),this.__getSize(this.__entity,"offsetHeight")},__getSize:function(e,t){var i,n=e,o=n.style.visibility;return"none"==n.style.display?(n.style.visibility="hidden",n.style.display="",i=n[t],n.style.display="none",n.style.visibility=o):i=n[t],i}}),Ui.Panel=function(){this.nodes={},this.uniqueID=this.__getUniqueID(),this.entity=null,this.__iframe=null,this.__isSetAdamant=!1,this.__templateNodesIDs=[],this.__isFixed=!1,$IE6&&(this.__ie6FixedController=new Ui.IE6FixedController)}.$extends(Ui.DisplayObject).$define({setTemplate:function(e){var t=$C("div");return t.innerHTML=new Ui.Template(e).evaluate(this.__getNodes(e,"i")),t.style.display="none",this.__parent.appendChild(t),this.__updateTemplate(t),this.nodes=this.__getNodes(e),this.entity=this.__entity,this.nodes.panel=this.entity,this},setFixed:function(e){!this.__isInited&&this.__initEntity();var t=parseInt(this.__entity.style.left),i=parseInt(this.__entity.style.top);return $IE6?(this.__ie6FixedController.setFixed(this.__entity,e),this.__isSetAdamant&&this.__ie6FixedController.setFixed(this.__iframe,e)):(e&&!this.__isFixed&&(this.setPosition({x:t-Math.max(document.documentElement.scrollLeft,document.body.scrollLeft),y:i-Math.max(document.documentElement.scrollTop,document.body.scrollTop)}),this.__entity.style.position="fixed"),!e&&this.__isFixed&&(this.setPosition({x:t+Math.max(document.documentElement.scrollLeft,document.body.scrollLeft),y:i+Math.max(document.documentElement.scrollTop,document.body.scrollTop)}),this.__entity.style.position="absolute")),this.__isFixed=!!e,this.__updateIframe(),this},setAdamant:function(e){return this.__isSetAdamant=!!e,this.__isSetAdamant&&!this.__iframe&&this.__createIframe(),this.__updateIframe(),this},destroy:function(){this.__entity&&(Ui.Panel.$super.destroy.call(this),this.__ie6FixedController&&this.__ie6FixedController.destroy(),this.__iframe&&this.__iframe.parentNode.removeChild(this.__iframe))},setPosition:function(e){return!this.__isInited&&this.__initEntity(),$IE6?this.__ie6FixedController.setPosition(this.__entity,this.__isFixed,e):Ui.Panel.$super.setPosition.call(this,e),this.__updateIframe(),this},setSize:function(e){return Ui.Panel.$super.setSize.call(this,e).__updateIframe(),this},show:function(e){return Ui.Panel.$super.show.call(this,e).__updateIframe(),this},hidden:function(e){return Ui.Panel.$super.hidden.call(this,e).__updateIframe(),this},__getX:function(){return!this.__isInited&&this.__initEntity(),$IE6?this.__ie6FixedController.getX(this.__entity,this.__isFixed):parseInt(this.__entity.style.left)},__getY:function(){return!this.__isInited&&this.__initEntity(),$IE6?this.__ie6FixedController.getY(this.__entity,this.__isFixed):parseInt(this.__entity.style.top)},__createIframe:function(){this.__iframe=$C("iframe"),this.__iframe.frameBorder="none",this.__parent.insertBefore(this.__iframe,this.__entity),Core.Dom.setStyle(this.__iframe,"opacity",0),this.__ie6FixedController&&(this.__ie6FixedController.iframeNode=this.__iframe),this.__updateIframe()},__updateIframe:function(){if(this.__iframe){var e=this.__iframe.style;e.backgroundColor="#ffffff",e.left=this.x+"px",e.top=this.y+"px",e.width=this.width+"px",e.height=this.height+"px",e.position=this.__entity.style.position,e.display=this.__entity.style.display,e.zIndex=this.__entity.style.zIndex,$IE6&&this.__ie6FixedController.updateIframe(this.__isFixed)}},__updateIE6FCOrgPosition:function(){this.__ie6FixedController&&this.__ie6FixedController.updateOrgPosition()},__updateTemplate:function(e){var t,i,n,o,s,a=this.__entity;if(a?(a.parentNode&&a.parentNode.removeChild(a),t=a.style.left,i=a.style.top,n=a.style.zIndex,o=a.style.position,s=a.style.display):s="none",a=this.__entity=$E("_"+this.uniqueID+"_panel"),a||(a=this.__entity=$E("_"+this.uniqueID+"_entity")),!a)throw new Error("[Panel Error]there missing identifier #{panel} in panel template");a.style.left=t||0,a.style.top=i||0,a.style.zIndex=n||0,a.style.position=o||"absolute",a.style.display=s,this.__parent.replaceChild(a,e),this.__ie6FixedController&&(this.__ie6FixedController.node=this.__entity)},__getNodes:function(e,t){var i,n,o,s=t||"o",a=/\{[^\}]+(?=\})/g,r={};if(this.__templateNodesIDs=e.match(a),n=this.__templateNodesIDs)for(i=n.length;i--;)switch(o=n[i].replace("{",""),s){case"o":r[o]=$E("_"+this.uniqueID+"_"+o);break;case"i":r[o]="_"+this.uniqueID+"_"+o}return r},__getUniqueID:function(){return parseInt(1e3*Math.random()).toString()+(new Date).getTime().toString()},setContent:function(e){this.nodes.content&&(this.nodes.content.innerHTML=e)},getNodes:function(){return this.nodes}}),Ui.Drag=function(e,t,i){var n=this;this.canDrag=!0,this.isLock=!1,this.lockArea={left:0,right:0,top:0,bottom:0},this.__captureNode=e,this.__dragNodes=[],this.__deltaX=[],this.__deltaY=[],this.__eventDispatcher=new Core.Events.EventDispatcher(this),this.__isDraging=!1,this.__canDragX=!0,this.__canDragY=!0,this.__dragHandle=function(){n.__drag()},this.__mouseDownHandle=function(){n.__isDraging=!0,n.__eventDispatcher.dispatchEvent("beforeDrag"),n.__setCapture(!0)},this.__mouseUpHandle=function(){n.__isDraging&&n.__eventDispatcher.dispatchEvent("afterDrag"),n.__isDraging=!1,n.__setCapture(!1)},this.__initNodes(e,t,i),this.__initCaputerNode()}.$define({addEventListener:function(e,t){return this.__eventDispatcher.addEventListener(e,t),this},removeEventListener:function(e,t){return this.__eventDispatcher.removeEventListener(e,t),this},destroy:function(){Core.Events.removeEvent(this.__captureNode,this.__mouseDownHandle,"mousedown"),Core.Events.removeEvent(document,this.__mouseUpHandle,"mouseup"),this.__captureNode=null,this.__dragNodes=null},__initNodes:function(e,t,i){t?(t instanceof Array?this.__dragNodes=t:this.__dragNodes.push(t),("undefined"==typeof i||i)&&this.__dragNodes.push(this.__captureNode)):this.__dragNodes.push(this.__captureNode);for(var n=this.__dragNodes,o=n.length;o--;)!n[o].style.position&&(n[o].style.position="absolute"),!n[o].style.left&&(n[o].style.left=0),!n[o].style.top&&(n[o].style.top=0)},__initCaputerNode:function(){var e=this.__captureNode;Core.Events.addEvent(e,this.__mouseDownHandle,"mousedown"),Core.Events.addEvent(document,this.__mouseUpHandle,"mouseup")},__setCapture:function(e){for(var t=this.__captureNode,i=this.__dragNodes,n=Core.Events.getEvent(),o=i.length;o--;)this.__deltaX[o]=n.clientX-parseInt(i[o].style.left),this.__deltaY[o]=n.clientY-parseInt(i[o].style.top);e?$IE?(t.setCapture(),Core.Events.addEvent(t,this.__dragHandle,"mousemove")):Core.Events.addEvent(document,this.__dragHandle,"mousemove"):$IE?(t.releaseCapture(),Core.Events.removeEvent(t,this.__dragHandle,"mousemove")):Core.Events.removeEvent(document,this.__dragHandle,"mousemove")},__drag:function(){if(this.canDrag){var e=this.__dragNodes,t=Core.Events.getEvent(),i=e.length,n=this.lockArea,o=0,s=0;for(this.__eventDispatcher.dispatchEvent("drag");i--;)o=t.clientX-this.__deltaX[i],s=t.clientY-this.__deltaY[i],this.isLock&&(o=Math.min(Math.max(o,n.left),n.right),s=Math.min(Math.max(s,n.top),n.bottom)),e[i].style.left=o+"px",e[i].style.top=s+"px"}}}),Ui.IDragger={addEventListener:function(){},removeEventListener:function(){},setDrag:function(){},setLock:function(){},setArea:function(){},destroy:function(){}},Ui.SimpleDragger=function(){this.__drag=null,this.__eventDispatcher=new Core.Events.EventDispatcher(this)}.$implements(Ui.IDragger).$define({addEventListener:function(e,t){return"afterdrag"===e.toLowerCase()?this.__eventDispatcher.addEventListener(e,t):this.__drag.addEventListener(e,t),this},removeEventListener:function(e,t){return"afterdrag"===e.toLowerCase()?this.__eventDispatcher.removeEventListener(e,t):this.__drag.removeEventListener(e,t),this},setDrag:function(e,t,i){var n=this;return this.__drag=new Ui.Drag(e,t,i),this.__drag.addEventListener("afterDrag",function(){n.__eventDispatcher.dispatchEvent("afterDrag")}),this},setLock:function(e){return this.__drag.isLock=!!e,this},setArea:function(e){return this.__drag.lockArea=e,this},destroy:function(){this.__drag.destroy()}}),Ui.Dialog=function(){var e=this;this.__dragger=null,this.__isBindUpadateAreaEvent=!1,this.__isBindUpdateIE6AreaEvent=!1,this.__beforeDragHandle=function(){e.__updateDraggerArea(),e.__eventDispatcher.dispatchEvent("beforedrag")},this.__dragHandle=function(){e.__isSetAdamant&&e.__updateIframe(),e.__eventDispatcher.dispatchEvent("drag")},this.__afterDragHandle=function(){e.__isFixed&&$IE6&&e.__updateIE6FCOrgPosition(),e.__eventDispatcher.dispatchEvent("afterdrag")},this.__updateDraggerAreaHandle=function(){setTimeout(function(){e.__updateDraggerArea()},1)},this.__setMiddleHandle=function(){e.setMiddle()}}.$extends(Ui.Panel).$define({setTemplate:function(e){return Ui.Dialog.$super.setTemplate.call(this,e),this.__initTitleBar(),this.setDragger(Ui.SimpleDragger),this},setContent:function(e){return this.nodes.content?(this.nodes.content.innerHTML=new Ui.Template(e).evaluate(this.__getNodes(e,"i")),this.__addContentNodes(this.__getNodes(e)),this):this},setFixed:function(e){return Ui.Dialog.$super.setFixed.call(this,e),e?Core.Events.addEvent(window,this.__setMiddleHandle,"resize"):Core.Events.removeEvent(window,this.__setMiddleHandle,"resize"),this.__updateDraggerArea(),this},setMiddle:function(){var e=this.__getDocumentSize().height-this.height,t=(Math.sqrt(5)-1)/2,i=1,n=e*t/(t+i),o=this.__getDocumentSize().width/2-this.width/2;return this.__isFixed||(n+=Math.max(document.documentElement.scrollTop,document.body.scrollTop),o+=Math.max(document.documentElement.scrollLeft,document.body.scrollLeft)),this.setPosition({x:Math.max(o,0),y:Math.max(n,0)}),this},setAreaLocked:function(e){return this.__dragger?(this.__dragger.setLock(e),this):this},setSize:function(e){return!this.__isInited&&this.__initEntity(),this.nodes.content?("undefined"!=typeof e.width&&(this.nodes.content.style.width=e.width+"px"),"undefined"!=typeof e.height&&(this.nodes.content.style.height=e.height+"px")):("undefined"!=typeof e.width&&(this.__entity.style.width=e.width+"px"),"undefined"!=typeof e.height&&(this.__entity.style.height=e.height+"px")),this},setDragger:function(e){if(!this.nodes.titleBar||!e)return this;if(this.__dragger){if(this.__dragger.constructor===e)return this}else this.__dragger=new e;return this.__updateDragger(e),this},destroy:function(){this.__entity&&(Ui.Dialog.$super.destroy.call(this),Core.Events.removeEvent(window,this.__updateDraggerAreaHandle,"resize"),Core.Events.removeEvent(window,this.__setMiddleHandle,"resize"))},__addContentNodes:function(e){var t,i=this.nodes;for(t in e)i[t]=e[t]},__updateDragger:function(e){this.__dragger.constructor!==e&&(this.__dragger.removeEventListener("beforedrag",this.__beforeDragHandle).removeEventListener("drag",this.__dragHandle).removeEventListener("afterdrag",this.__afterDragHandle),this.__dragger.destroy(),this.__dragger=new e),this.__dragger.setDrag(this.nodes.titleBar,this.__entity,!1),this.__dragger.addEventListener("beforedrag",this.__beforeDragHandle).addEventListener("drag",this.__dragHandle).addEventListener("afterdrag",this.__afterDragHandle)},__updateDraggerArea:function(){var e,t,i,n;this.__isFixed?(e=$IE6?document.documentElement.scrollLeft:0,t=$IE6?document.documentElement.scrollTop:0,i=$IE6?document.documentElement.scrollLeft+this.__getDocumentSize().width-this.width:this.__getDocumentSize().width-this.width,n=$IE6?document.documentElement.scrollTop+this.__getDocumentSize().height-this.height:this.__getDocumentSize().height-this.height):(e=0,t=0,i=document.documentElement.scrollWidth-this.width,n=document.documentElement.scrollHeight-this.height),this.__dragger.setArea({left:e,top:t,right:i,bottom:n})},__initTitleBar:function(){if(this.nodes.titleBar){var e=this.nodes.titleBar;e.style.cursor="move",$IE?Core.Events.addEvent(e,function(){return!1},"selectstart"):e.style.MozUserSelect="none"}},__getDocumentSize:function(){var e=document.documentElement.clientWidth||document.body.clientWidth,t=document.documentElement.clientHeight||document.body.clientHeight;return{width:e,height:t}}}),Ui.ModuleDialog=function(e,t,i){this.__bgShadow=null,this.__dialog=null,this.__isInitBgShadow=!1,this.__tplConfig=e,this.__iconSet=t,this.__dialogQueue=[],this.__zIndex=i&&i.zIndex||5e3,this.__cfg=i||{},this.__initDialogEvent()}.$define({alert:function(e,t){t=t||{};var i=this.__createMessageDialog(t.tplConfig||this.__tplConfig.alert,t);return i.nodes.text&&(i.nodes.text.innerHTML=e||""),i.show(t.renderer||this.__cfg.renderer).addEventListener("hidden",function(){this.destroy()}),i.nodes.linkOk&&"none"!==i.nodes.linkOk.style.display&&i.nodes.linkOk.focus(),i},newAlert:function(e,t,i){t.tplConfig=this.__tplConfig.newAlert,this.alert(e,t,i)},confirm:function(e,t){t=t||{};var i=this.__createMessageDialog(t.tplConfig||this.__tplConfig.confirm,t),n=this;return i.nodes.text&&(i.nodes.text.innerHTML=e||""),i.nodes.btnCancel&&(i.nodes.btnCancel.innerHTML=t.textCancel||"取消",Core.Events.addEvent(i.nodes.btnCancel,function(){t.funcCancel&&t.funcCancel.call(i),i.hidden(t.renderer||n.__cfg.renderer),Core.Events.stopEvent()},"click"),i.nodes.linkCancel&&Core.Events.addEvent(i.nodes.linkCancel,function(){var e=Core.Events.getEvent();"13"==e.keyCode&&(t.funcCancel&&t.funcCancel.call(i),i.hidden(t.renderer||n.__cfg.renderer))},"keydown")),i.show(t.renderer||n.__cfg.renderer).addEventListener("hidden",function(){this.destroy()}),0==t.defaultButton?i.nodes.linkCancel&&"none"!==i.nodes.linkCancel.style.display&&i.nodes.linkCancel.focus():i.nodes.linkOk&&"none"!==i.nodes.linkOk.style.display&&i.nodes.linkOk.focus(),i},newConfirm:function(e,t,i){t.tplConfig=this.__tplConfig.newConfirm,this.confirm(e,t,i)},create:function(e){e=e||{};var t=new Ui.Dialog;return t.setTemplate(e.tpl||this.__tplConfig.customs),e.content&&t.setContent(e.content),e.width&&!isNaN(e.width)&&t.setSize({width:e.width}),e.height&&!isNaN(e.height)&&t.setSize({height:e.height}),this.__initDialog(t,e)},__initDialogEvent:function(){var e=this.__dialogQueue;Core.Events.addEvent(document,function(){var t=Core.Events.getEvent();e.length&&"27"==t.keyCode&&e[e.length-1].hidden()},"keydown")},__createMessageDialog:function(e,t){var i=new Ui.Dialog,n=this;return i.setTemplate(e),t.width&&!isNaN(t.width)&&i.setSize({width:t.width}),t.height&&!isNaN(t.height)&&i.setSize({height:t.height}),i.nodes.subText&&(i.nodes.subText.innerHTML=t.subText||""),i.nodes.icon&&(i.nodes.icon.className=this.__iconSet[t.icon||"01"]["class"],i.nodes.icon.alt=this.__iconSet[t.icon||"01"].alt),i.nodes.btnOk&&(i.nodes.btnOk.innerHTML=t.textOk||"确定",Core.Events.addEvent(i.nodes.btnOk,function(){i.hidden(t.renderer||n.__cfg.renderer),t.funcOk&&t.funcOk.call(i),Core.Events.stopEvent()},"click")),i.nodes.linkOk&&Core.Events.addEvent(i.nodes.linkOk,function(){var e=Core.Events.getEvent();"13"==e.keyCode&&(i.hidden(t.renderer||n.__cfg.renderer),t.funcOk&&t.funcOk.call(i))},"keydown"),i.setDragger(t.dragger||n.__cfg.dragger).setFixed(!0).setAreaLocked(!0),this.__initDialog(i,t)},__initDialog:function(e,t){var i=this;return t.zIndex&&(i.__zIndex=t.zIndex),e.nodes.titleName&&(e.nodes.titleName.innerHTML=t.title||"提示"),e.nodes.btnClose&&(Core.Events.addEvent(e.nodes.btnClose,function(){var i=!0;t.funcBeforeClose&&(i=t.funcBeforeClose.call(e)!==!1),t.funcClose&&t.funcClose.call(e),i&&e.hidden()},"click"),Core.Events.addEvent(e.nodes.btnClose,function(){Core.Events.stopEvent()},"mousedown")),e.setPosition({z:t.zIndex||i.__zIndex}),e.setRenderer(t.renderer||this.__cfg.renderer),e.setDragger(t.dragger||this.__cfg.dragger),e.setMiddle(),e.addEventListener("beforeHidden",function(){i.__updateDialogQueue(this,"remove")}),e.addEventListener("beforeShow",function(){this.nodes.panel.parentNode.appendChild(this.nodes.panel);var e=this;i.__isInitBgShadow||i.__initBGShadow(this,t.isAdamant||i.__cfg.isAdamant),i.__setBGShadowOpacity(0!==t.bgShadowOpacity?t.bgShadowOpacity||.4:t.bgShadowOpacity),window.setTimeout(function(){i.__bgShadow.show(),i.__updateDialogQueue(e,"add")},1)}),e.setTitle=function(e){this.nodes.titleName&&(this.nodes.titleName.innerHTML=e)},e.setHelp=function(e){this.nodes.btnHelp&&(this.nodes.btnHelp.href=e)},e.close=function(){this.hidden()},e.getNodes=function(){return this.nodes},e.getX=function(){return this.x},e.getY=function(){return this.y},e.getWidth=function(){return this.width},e.getHeight=function(){return this.height},e},__initBGShadow:function(e,t){var i=this.__getDocumentSize().width,n=this.__getDocumentSize().height,o=this;this.__bgShadow=new Ui.Panel,this.__bgShadow.setTemplate('<div id="#{panel}" style="background-color:black"></div>').setSize({width:i,height:n}).setAdamant(t).setFixed(!0).setPosition({x:0,y:0,z:o.__zIndex}),Core.Events.addEvent(window,function(){o.__bgShadow.setPosition({x:0,y:0}).setSize({width:o.__getDocumentSize().width,height:o.__getDocumentSize().height})},"resize"),this.__isInitBgShadow=!0},__updateDialogQueue:function(e,t){var i,n;if("add"===t)this.__dialogQueue.push(e);else if("remove"===t)for(i=this.__dialogQueue.length;i--;)this.__dialogQueue[i]===e&&this.__dialogQueue.splice(i,1);0===this.__dialogQueue.length?this.__bgShadow.hidden():(n=this.__dialogQueue[this.__dialogQueue.length-1],this.__bgShadow.nodes.panel.parentNode.insertBefore(this.__bgShadow.nodes.panel,n.nodes.panel),this.__bgShadow.__iframe&&this.__bgShadow.__iframe.parentNode.insertBefore(this.__bgShadow.__iframe,this.__bgShadow.nodes.panel),n.nodes.linkOk&&"none"!==n.nodes.linkOk.style.display&&n.nodes.linkOk.focus())},__setBGShadowOpacity:function(e){e=isNaN(e)?0:Math.max(Math.min(e,1),0),Core.Dom.setStyle(this.__bgShadow.nodes.panel,"opacity",e)},__getDocumentSize:function(){var e=document.documentElement.clientWidth||document.body.clientWidth,t=document.documentElement.clientHeight||document.body.clientHeight;return{width:e,height:t}}}),Ui.Transition={simple:function(e,t,i,n){return i*e/n+t},backEaseIn:function(e,t,i,n){var o=1.70158;return i*(e/=n)*e*((o+1)*e-o)+t},backEaseOut:function(e,t,i,n){var o=1.70158;return i*((e=e/n-1)*e*((o+1)*e+o)+1)+t},backEaseInOut:function(e,t,i,n){var o=1.70158;return(e/=n/2)<1?i/2*e*e*(((o*=1.525)+1)*e-o)+t:i/2*((e-=2)*e*(((o*=1.525)+1)*e+o)+2)+t},bounceEaseOut:function(e,t,i,n){return(e/=n)<1/2.75?7.5625*i*e*e+t:2/2.75>e?i*(7.5625*(e-=1.5/2.75)*e+.75)+t:2.5/2.75>e?i*(7.5625*(e-=2.25/2.75)*e+.9375)+t:i*(7.5625*(e-=2.625/2.75)*e+.984375)+t},bounceEaseIn:function(e,t,i,n){return i-Transition.bounceEaseOut(n-e,0,i,n)+t},bounceEaseInOut:function(e,t,i,n){return n/2>e?.5*Transition.bounceEaseIn(2*e,0,i,n)+t:.5*Transition.bounceEaseOut(2*e-n,0,i,n)+.5*i+t},regularEaseIn:function(e,t,i,n){return i*(e/=n)*e+t},regularEaseOut:function(e,t,i,n){return-i*(e/=n)*(e-2)+t},regularEaseInOut:function(e,t,i,n){return(e/=n/2)<1?i/2*e*e+t:-i/2*(--e*(e-2)-1)+t},strongEaseIn:function(e,t,i,n){return i*(e/=n)*e*e*e*e+t},strongEaseOut:function(e,t,i,n){return i*((e=e/n-1)*e*e*e*e+1)+t},strongEaseInOut:function(e,t,i,n){return(e/=n/2)<1?i/2*e*e*e*e*e+t:i/2*((e-=2)*e*e*e*e+2)+t},elasticEaseIn:function(e,t,i,n){var o,s;if(0==e)return t;if(1==(e/=n))return t+i;if(s=.3*n,!o||o<Math.abs(i)){o=i;var a=s/4}else var a=s/(2*Math.PI)*Math.asin(i/o);return-(o*Math.pow(2,10*(e-=1))*Math.sin(2*(e*n-a)*Math.PI/s))+t},elasticEaseOut:function(e,t,i,n){var o,s;if(0==e)return t;if(1==(e/=n))return t+i;if(s||(s=.3*n),!o||o<Math.abs(i)){o=i;var a=s/4}else var a=s/(2*Math.PI)*Math.asin(i/o);return o*Math.pow(2,-10*e)*Math.sin(2*(e*n-a)*Math.PI/s)+i+t},elasticEaseInOut:function(e,t,i,n){var o,s;if(0==e)return t;if(2==(e/=n/2))return t+i;if(!s)var s=.3*n*1.5;
if(!o||o<Math.abs(i))var o=i,a=s/4;else var a=s/(2*Math.PI)*Math.asin(i/o);return 1>e?-.5*o*Math.pow(2,10*(e-=1))*Math.sin(2*(e*n-a)*Math.PI/s)+t:o*Math.pow(2,-10*(e-=1))*Math.sin(2*(e*n-a)*Math.PI/s)*.5+i+t}},Ui.TweenStrategy=function(e,t,i,n){this.startValue=e||0,this.endValue=t||0,this.duration=i||0,this.motion=n||Ui.Transition.simple,this.__eventDispatcher=new Core.Events.EventDispatcher(this)}.$define({motion:null,duration:0,startValue:0,endValue:0,_itvID:0,_isTweenning:!1,addEventListener:function(e,t){return this.__eventDispatcher.addEventListener(e,t),this},removeEventListener:function(e,t){return this.__eventDispatcher.removeEventListener(e,t),this},start:function(){if(!this._isTweenning){this._isTweenning=!0;var e,t,i=this,n=this.startValue,o=this.endValue,s=this.duration,a=(new Date).getTime();return this._itvID=window.setInterval(function(){e=((new Date).getTime()-a)/1e3,e>i.duration&&(e=i.duration),t=i.motion(e,n,o-n,s),i.onTween&&i.onTween(t),i.__eventDispatcher.dispatchEvent("tween",t),e==i.duration&&i.stop()},25),this}},stop:function(){return window.clearInterval(this._itvID),this._isTweenning=!1,this.onEnd&&this.onEnd(),this.__eventDispatcher.dispatchEvent("end"),this},onTween:function(){},onEnd:function(){}}),Ui.OpacityRenderer=function(){this.__canShow=!0,this.__canHidden=!0,this.__node=null,this.__tween=new Ui.TweenStrategy(0,0,.6,Ui.Transition.strongEaseOut),this.__state="",this.__lastState="",this.__value=0,this.__node=null,this.__eventDispatcher=new Core.Events.EventDispatcher(this),this.__initTweenEvent()}.$implements(Ui.IRenderer).$define({setCanShow:function(e){this.__canShow=!!e},setCanHidden:function(e){this.__canHidden=!!e},show:function(e){var t=this.__tween;return t.stop(),Core.Dom.setStyle(e,"opacity",this.__value),e.style.display="",this.__node=e,this.__state="show",this.__eventDispatcher.dispatchEvent("beforeShow"),this.__canShow&&(t.startValue=this.__value,t.endValue=1,t.start()),this},hidden:function(e){var t=this.__tween;return t.stop(),this.__node=e,this.__state="hidden",this.__eventDispatcher.dispatchEvent("beforeHidden"),this.__canHidden&&(t.startValue=this.__value,t.endValue=0,t.start()),this},addEventListener:function(e,t){return this.__eventDispatcher.addEventListener(e,t),this},removeEventListener:function(e,t){return this.__eventDispatcher.removeEventListener(e,t),this},__initTweenEvent:function(){var e=this;this.__tween.addEventListener("tween",function(t){e.__value=t,Core.Dom.setStyle(e.__node,"opacity",t)}),this.__tween.addEventListener("end",function(){e.__node&&e.__node.style.filter&&(e.__node.style.filter=""),""!==e.__state&&e.__state!==e.__lastState&&(e.__lastState=e.__state,e.__eventDispatcher.dispatchEvent(e.__state)),"hidden"===e.__state&&(e.__node.style.display="none")})}}),Ui.BorderDragger=function(){this.__drag=null,this.__isBindEvent=!1,this.__border=null,this.__dragNode=null,this.__isCreated=!1,this.__tweenX=new Ui.TweenStrategy(0,0,.5,Ui.Transition.strongEaseOut),this.__tweenY=new Ui.TweenStrategy(0,0,.5,Ui.Transition.strongEaseOut),this.__eventDispatcher=new Core.Events.EventDispatcher(this)}.$implements(Ui.IDragger).$define({addEventListener:function(e,t){return"afterdrag"===e.toLowerCase()?this.__eventDispatcher.addEventListener(e,t):this.__drag.addEventListener(e,t),this},removeEventListener:function(e,t){return"afterdrag"===e.toLowerCase()?this.__eventDispatcher.removeEventListener(e,t):this.__drag.removeEventListener(e,t),this},setDrag:function(e,t,i){return this.__isCreated||(this.__createBorder(t),this.__initTweenEvent(t)),this.__drag=new Ui.Drag(e,this.__border,i),this.__dragNode=t,this.__initDragEvent(),this},setLock:function(e){return this.__drag.isLock=!!e,this},setArea:function(e){return this.__drag.lockArea=e,this},destroy:function(){this.__drag.destroy()},__createBorder:function(){this.__border=$C("div");var e=this.__border.style;e.border="2px dashed #BCC4D0",e.position="absolute",e.display="none",e.backgroundColor="transparent",e.MozUserSelect="none",document.body.appendChild(this.__border),this.__isCreated=!0},__initDragEvent:function(){if(!this.__isBindEvent){var e=this,t=this.__border.style,i=this.__dragNode.style,n=this.__tweenX,o=this.__tweenY;this.__drag.addEventListener("beforeDrag",function(){t.zIndex=i.zIndex+1,t.position=i.position,t.width=e.__dragNode.offsetWidth-4+"px",t.height=e.__dragNode.offsetHeight-4+"px",t.left=parseInt(i.left)+"px",t.top=parseInt(i.top)+"px",t.display=""}),this.__drag.addEventListener("afterDrag",function(){$IE6?(i.left=parseInt(t.left)+"px",i.top=parseInt(t.top)+"px",t.display="none",e.__eventDispatcher.dispatchEvent("afterDrag")):(n.startValue=parseInt(i.left),n.endValue=parseInt(t.left),o.startValue=parseInt(i.top),o.endValue=parseInt(t.top),n.start(),o.start())}),this.__isBindEvent=!0}},__initTweenEvent:function(e){var t=e.style,i=this.__border.style,n=this;this.__tweenX.addEventListener("tween",function(e){t.left=e+"px"}),this.__tweenY.addEventListener("tween",function(e){t.top=e+"px"}),this.__tweenX.addEventListener("end",function(){i.display="none",n.__eventDispatcher.dispatchEvent("afterDrag")})}});var winDialog={},DialogTemplate={};!function(){var e={alert:['<table id="#{panel}" class="CP_w">','<thead id="#{titleBar}">',"<tr>",'<th class="tLeft"><span></span></th>','<th class="tMid"><div class="bLyTop"><strong id="#{titleName}">提示标题</strong><cite><a id="#{btnClose}" href="#" onclick="return false;" class="CP_w_shut" title="关闭">关闭</a></cite></div></th>','<th class="tRight"><span></span></th>',"</tr>","</thead>","<tfoot>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid"><span></span></td>','<td class="tRight"><span></span></td>',"</tr>","</tfoot>","<tbody>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid">','<div id="#{content}" class="CP_layercon1">','<div class="CP_prompt">','<img id="#{icon}" class="SG_icon SG_icon201" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="50" height="50" align="absmiddle"/>','<table class="CP_w_ttl"><tr><td id="#{text}"></td></tr></table>','<div id="#{subText}" class="CP_w_cnt SG_txtb"></div>','<p class="CP_w_btns_Mid"><a id="#{linkOk}" class="SG_aBtn SG_aBtnB" href="#" onclick="return false;"><cite id="#{btnOk}"> </cite></a></p>',"</div>","</div>","</td>",'<td class="tRight"><span></span></td>',"</tr>","</tbody>","</table>"].join(""),newAlert:['<table id="#{panel}" class="CP_w">','<thead id="#{titleBar}">',"<tr>",'<th class="tLeft"><span></span></th>','<th class="tMid"><div class="bLyTop"><strong id="#{titleName}">提示</strong><cite><a id="#{btnClose}" href="#" onclick="return false;" class="CP_w_shut" title="关闭">关闭</a></cite></div></th>','<th class="tRight"><span></span></th>',"</tr>","</thead>","<tfoot>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid"><span></span></td>','<td class="tRight"><span></span></td>',"</tr>","</tfoot>","<tbody>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid">','<div class="CP_layercon2 pop_v">','<div class="v_prompt">','<img id="#{icon}" class="SG_icon SG_icon148" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="20" height="20" align="absmiddle" />','<div id="#{text}" class="v_cnt SG_txtb"></div>','<div id="#{subText}"></div>','<p class="v_btns">','<a id="#{linkOk}" class="SG_aBtn SG_aBtnB" href="#"><cite id="#{btnOk}">确定</cite></a>',"</p>","</div>","</div>","</td>",'<td class="tRight"><span></span></td>',"</tr>","</tbody>","</table>"].join(""),confirm:['<table id="#{panel}" class="CP_w">','<thead id="#{titleBar}">',"<tr>",'<th class="tLeft"><span></span></th>','<th class="tMid"><div class="bLyTop"><strong id="#{titleName}">提示标题</strong><cite><a id="#{btnClose}" href="#" onclick="return false;" class="CP_w_shut" title="关闭">关闭</a></cite></div></th>','<th class="tRight"><span></span></th>',"</tr>","</thead>","<tfoot>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid"><span></span></td>','<td class="tRight"><span></span></td>',"</tr>","</tfoot>","<tbody>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid">','<div id="#{content}" class="CP_layercon1">','<div class="CP_prompt">','<img id="#{icon}" class="SG_icon SG_icon201" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="50" height="50" align="absmiddle"/>','<table class="CP_w_ttl"><tr><td id="#{text}"></td></tr></table>','<div id="#{subText}" class="CP_w_cnt SG_txtb"></div>','<p class="CP_w_btns">','<a  id="#{linkOk}" class="SG_aBtn SG_aBtnB" href="#" onclick="return false;"><cite id="#{btnOk}"></cite></a>','<a style="margin-left:5px;" id="#{linkCancel}" class="SG_aBtn SG_aBtnB" href="#" onclick="return false;"><cite id="#{btnCancel}"> <span id="#{cancel}"></span> </cite></a></p>',"</div>","</div>","</td>",'<td class="tRight"><span></span></td>',"</tr>","</tbody>","</table>"].join(""),newConfirm:['<table id="#{panel}" class="CP_w">','<thead id="#{titleBar}">',"<tr>",'<th class="tLeft"><span></span></th>','<th class="tMid"><div class="bLyTop"><strong id="#{titleName}">提示</strong><cite><a id="#{btnClose}" href="#" onclick="return false;" class="CP_w_shut" title="关闭">关闭</a></cite></div></th>','<th class="tRight"><span></span></th>',"</tr>","</thead>","<tfoot>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid"><span></span></td>','<td class="tRight"><span></span></td>',"</tr>","</tfoot>","<tbody>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid">','<div class="CP_layercon2 pop_v">','<div class="v_prompt">','<img id="#{icon}" class="SG_icon SG_icon148" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="20" height="20" align="absmiddle" />','<div id="#{text}" class="v_cnt SG_txtb"></div>','<div id="#{subText}"></div>','<p class="v_btns">','<a id="#{linkOk}" class="SG_aBtn SG_aBtnB" href="#"><cite id="#{btnOk}">确定</cite></a>&nbsp;&nbsp;','<a id="#{linkCancel}" class="SG_aBtn SG_aBtnB SG_aBtn_g" href="#"><cite id="#{btnCancel}">取消</cite></a>',"</p>","</div>","</div>","</td>",'<td class="tRight"><span></span></td>',"</tr>","</tbody>","</table>"].join(""),customs:['<table id="#{panel}" class="CP_w">','<thead id="#{titleBar}">',"<tr>",'<th class="tLeft"><span></span></th>','<th class="tMid">','<div class="bLyTop">','<strong id="#{titleName}">提示标题</strong>','<cite><a id="#{btnClose}" href="#" onclick="return false;" class="CP_w_shut" title="关闭">关闭</a></cite>',"</div>","</th>",'<th class="tRight"><span></span></th>',"</tr>","</thead>","<tfoot>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid"><span></span></td>','<td class="tRight"><span></span></td>',"</tr>","</tfoot>","<tbody>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid" id="#{content}">',"</td>",'<td class="tRight"><span></span></td>',"</tr>","</tbody>","</table>"].join("")},t={"01":{"class":"SG_icon SG_icon201",alt:"警告"},"02":{"class":"SG_icon SG_icon202",alt:"失败"},"03":{"class":"SG_icon SG_icon203",alt:"成功"},"04":{"class":"SG_icon SG_icon204",alt:"询问"},"05":{"class":"SG_icon SG_bigLoading",alt:"正在加载"},"06":{"class":"SG_icon SG_icon148",alt:"警告"}},i={},n=new Ui.ModuleDialog(e,t,{renderer:Ui.OpacityRenderer,dragger:Ui.BorderDragger,isAdamant:$IE6});winDialog.create=winDialog.createCustomsDialog=function(e,t){return t&&"string"==typeof t?(i[t]=n.create(e),i[t]):n.create(e)},winDialog.alert=function(e,t,o){return o&&"string"==typeof o?(i[o]=n.alert(e,t),i[o]):n.alert(e,t)},winDialog.newAlert=function(e,t,o){return o&&"string"==typeof o?(i[o]=n.newAlert(e,t),i[o]):n.newAlert(e,t)},winDialog.confirm=function(e,t,o){return o&&"string"==typeof o?(i[o]=n.confirm(e,t),i[o]):n.confirm(e,t)},winDialog.newConfirm=function(e,t,o){return o&&"string"==typeof o?(i[o]=n.newConfirm(e,t),i[o]):n.newConfirm(e,t)},winDialog.getDialog=function(e){return e&&"string"==typeof e?i[e]:void 0},DialogTemplate=e}(),$SYSMSG.extend({A00001:"操作失败，可能系统繁忙或系统遇到未知错误，请稍后再试。也可联系新浪客服：致电4006900000。",A00002:"很抱歉，您的IP出现异常，请稍后再试",A00003:"无权限进行此操作，请重新登录。",A00004:"无权限进行此操作，请重新登录。",A00005:"操作失败，可能系统繁忙或系统遇到未知错误，请稍后再试。也可联系新浪客服：致电4006900000。",A00006:"操作成功",A00007:"无权限进行此操作，请重新登录。",A00009:"网络繁忙，请稍后再试",A00010:"无升级权限",A11007:"你还未开通新浪博客，请先<a href='http://login.sina.com.cn/hd/reg_sec.php?entry=blog'> 开通博客</a>",A00800:"对不起，您短时间点击喜欢过多，请多休息，注意身体！感谢您对新浪博客的支持和关注！"}),$SYSMSG.extend({A33001:"对方已经被你加为关注了！<br/>请不要重复添加。",A33002:"对方拒绝了你的关注请求！",A33003:"关注已达上限，不能再添加新的关注了！<br/>可以到<a href='http://control.blog.sina.com.cn/blogprofile/attention.php' target='_blank'>关注的人</a>去取消关注一些人，再回来关注吧。",A33004:"关注成功！",A33005:"你不能添加自己为关注！",A33008:"取消关注失败",A33009:"移除关注成功，加黑名单失败",A33010:"对不起，您短时间添加关注过多，请多休息，注意身体！感谢您对新浪博客的支持和关注！",A20013:"您已经发送多条相似内容了哦，请先休息一下吧~",A20014:"已经有很多博主发过相似评论了，换个内容会更精彩~"}),Utils.Cookie.setCookie=function(e,t,i,n,o,s){var a=[];if(a.push(e+"="+escape(t)),i){var r=new Date,l=r.getTime()+36e5*i;r.setTime(l),a.push("expires="+r.toGMTString())}n&&a.push("path="+n),o&&a.push("domain="+o),s&&a.push(s),document.cookie=a.join(";")},String.prototype.format=function(){var e=(arguments[0]&&"undefined"!=typeof arguments[0]?arguments[0].toString():"",/(.*?)({(\d+)(:([0-9a-z]+))?})/gi),t=this.match(e);if(t){for(var i=0,n=t.length;n>i;i++)switch(t[i]=t[i].replace(e,function(){return RegExp.$1}),t[i]=RegExp.$1,typeof arguments[parseInt(RegExp.$3)]){case"undefined":t[i]+=RegExp.$2;break;case"number":t[i]+=isNaN(RegExp.$5)||""==RegExp.$5?arguments[parseInt(RegExp.$3)]:arguments[parseInt(RegExp.$3)].toString(Math.max(Math.min(Math.round(RegExp.$5),36),2));break;default:t[i]+=arguments[parseInt(RegExp.$3)]}return t.push(this.replace(e,"")),t.join("")}return this},Sina.pkg("Core.Math"),Core.Math.getUniqueId=function(){return parseInt(1e4*Math.random()).toString()+(new Date).getTime().toString()},Lib.pkg("Login"),Lib.Login.info=function(){var e;return window.sinaSSOController&&(e=sinaSSOController.getLoginInfo())?e:{}},Lib.Login.LoginPost=Core.Class.create(),Lib.Login.LoginPost.prototype={url:"http://i.sso.sina.com.cn/js/ssologin.js",callback:null,initialize:function(e,t,i){window.sinaSSOConfig=new function(){i&&(this.from=i),this.pageCharset="utf-8",this.noActiveTime=14400,this.setDomain=!0,this.entry="boke",this.customInit=function(){},this.customLoginCallBack=e,this.customLogoutCallBack=function(){},this.useIframe=!0}},login:function(e,t,i){function n(){"undefined"==typeof i?sinaSSOController.login(e,t):sinaSSOController.login(e,t,i)}"undefined"!=typeof sinaSSOController&&sinaSSOController?(trace("has sso"),sinaSSOController.init(),"function"==typeof sinaSSOController.setLoginType&&sinaSSOController.setLoginType(2),"function"==typeof sinaSSOController.getServerTime&&sinaSSOController.getServerTime(e),trace("init ok"),n()):(trace("no sso"),Utils.Io.JsLoad.request(this.url,{onComplete:function(){n()},onException:function(){},timeout:3e4,isRemove:!1}))},parse:function(e){this.callback.call(e)}},Core.System.getScrollPos=function(e){e=e||document;var t=e.documentElement,i=e.body;return[Math.max(t.scrollTop,i.scrollTop),Math.max(t.scrollLeft,i.scrollLeft),Math.max(t.scrollWidth,i.scrollWidth),Math.max(t.scrollHeight,i.scrollHeight)]},Core.Dom.getStyle=function(e,t){switch(t){case"opacity":var i=100;try{i=e.filters["DXImageTransform.Microsoft.Alpha"].opacity}catch(n){try{i=e.filters("alpha").opacity}catch(n){}}return i/100;case"float":t="styleFloat";default:var o=e.currentStyle?e.currentStyle[t]:null;return e.style[t]||o}},(!$IE||$IE>8)&&(Core.Dom.getStyle=function(e,t){"float"==t&&(t="cssFloat");try{var i=document.defaultView.getComputedStyle(e,"")}catch(n){traceError(n)}return e.style[t]||i?i[t]:null}),Core.Dom.getXY=function(e){if((null==e.parentNode||null==e.offsetParent||"none"==Core.Dom.getStyle(e,"display"))&&e!=document.body)return!1;{var t;e.ownerDocument}t=e.getBoundingClientRect();var i=Core.System.getScrollPos(e.ownerDocument);return[t.left+i[1],t.top+i[0]]},$IE||(Core.Dom.getXY=function(e){if((null==e.parentNode||null==e.offsetParent||"none"==Core.Dom.getStyle(e,"display"))&&e!=document.body)return!1;{var t=null,i=[];e.ownerDocument}i=[e.offsetLeft,e.offsetTop],t=e.offsetParent;var n="absolute"==Core.Dom.getStyle(e,"position");if(t!=e)for(;t;)i[0]+=t.offsetLeft,i[1]+=t.offsetTop,$SAFARI&&!n&&"absolute"==Core.Dom.getStyle(t,"position")&&(n=!0),t=t.offsetParent;for($SAFARI&&n&&(i[0]-=e.ownerDocument.body.offsetLeft,i[1]-=e.ownerDocument.body.offsetTop),t=e.parentNode;t.tagName&&!/^body|html$/i.test(t.tagName);)Core.Dom.getStyle(t,"display").search(/^inline|table-row.*$/i)&&(i[0]-=t.scrollLeft,i[1]-=t.scrollTop),t=t.parentNode;return i}),function(){var e=parseInt(100*Math.random()),t=[],i=-1,n="",o="#userPosition {padding: 0;margin: 0;border: 0;position: absolute;z-index: 999;}				#sinaNote {position: absolute;z-index: 999999;width: auto;overflow: hidden;padding: 0;margin: 0;				border: 1px solid #CCCCCC;background: #ffffff;text-align:left;}				#sinaNote li {font-size: 12px;list-style: none;margin: 0 1px;height: 20px;padding: 0 5px;clear: both;				line-height: 20px;cursor: pointer;color: #999999;}				#sinaNote li.note {text-align: left;color: #999999;}",s=window,a={overfcolor:"#999",overbgcolor:"#e8f4fc",outfcolor:"#000000",outbgcolor:"",menuStatus:{"sina.com":!0,"sina.cn":!0,"vip.sina.com":!0,"qq.com":!0,"163.com":!0,"126.com":!0,"hotmail.com":!0,"yahoo.com.cn":!0,"gmail.com":!0}};a.createNode=function(){var e=s.document,t=e.createElement("div");t.innerHTML='<ul id="sinaNote" style="display:none;"></ul>';var i=e.createElement("style");i.setAttribute("type","text/css");try{$IE?i.styleSheet.cssText=o:i.innerHTML=o}catch(n){trace(n.message)}var a=e.createElement("div");a.appendChild(t),a.appendChild(i),e.body.appendChild(a)},a.arrowKey=function(e){38==e&&(0>=i&&(i=t.length),i--,a.selectLi(i)),40==e&&(i>=t.length-1&&(i=-1),i++,a.selectLi(i))},a.showList=function(o){n="";var r=Core.Events.getEvent().keyCode;if(38==r||40==r)return a.arrowKey(r),!1;$E("sinaNote")||a.createNode();var l=$E(o).value,c=l.indexOf("@"),d="",h="";c>-1&&(d=l.substr(c+1),h=l.substr(0,c)),t=[],i=0,t[t.length]="sinaNote_MenuItem_Title_"+e;for(var p in this.menuStatus)this.menuStatus[p]=!0,""!=d&&d!=p.substr(0,d.length)?this.menuStatus[p]=!1:t[t.length]="sinaNote_MenuItem_"+p+"_"+e;var u='<li class="note">请选择登录类型</li>';u+='<li id="sinaNote_MenuItem_Title_'+e+'">'+l+"</li>";var g;for(var m in this.menuStatus)1==this.menuStatus[m]&&(g=""==h?l+"@"+m:h+"@"+m,u+='<li id="sinaNote_MenuItem_'+m+"_"+e+'" title="'+g+'">'+g+"</li>");$E("sinaNote").innerHTML=u;for(var f=0;f<l.length;f++)l.charCodeAt(f)<160?($E("sinaNote").style.display="",this.selectList(o)):this.hideList();var v,_=$E(o),y=$E("sinaNote"),b=0,w=0;s!=window&&(v=Core.Dom.getXY(window.frameElement),b=v[0],w=v[1]);var E=_.offsetWidth;200>E&&(E=200),y.style.width=E-2+"px";var C=Core.Dom.getXY(_);y.style.left=C[0]-($IE?2:-1)+b+"px",y.style.top=C[1]+_.offsetHeight-($IE?2:-1)+w+"px"},a.selectList=function(e){for(var t=$E("sinaNote").getElementsByTagName("li"),i=1;i<t.length;i++)t[1].style.backgroundColor=a.overbgcolor,t[1].style.color=a.outfcolor,t[i].onmousedown=function(){var t=this.innerHTML;if(t.indexOf("非新浪邮箱")>-1){var i=t.split("@");$E(e).value=i[0]}else $E(e).value=this.innerHTML;null!=Core.Events.getEvent()&&Core.Events.stopEvent()},t[i].onmouseover=function(){1!=i&&(t[1].style.backgroundColor=a.outbgcolor,t[1].style.color=a.overfcolor),this.style.backgroundColor=a.overbgcolor,this.style.color=a.outfcolor},t[i].onmouseout=function(){this.style.backgroundColor=a.outbgcolor,this.style.color=a.overfcolor,t[1].style.backgroundColor=a.overbgcolor,t[1].style.color=a.outfcolor}},a.selectLi=function(i){var o;$E("sinaNote_MenuItem_Title_"+e).style.backgroundColor=a.outbgcolor,$E("sinaNote_MenuItem_Title_"+e).style.color=a.overfcolor;for(var s=0;s<t.length;s++)o=$E(t[s]),o.style.backgroundColor=a.outbgcolor,o.style.color=a.overfcolor;$E(t[i]).style.backgroundColor=a.overbgcolor,$E(t[i]).style.color=a.outfcolor,n=$E(t[i]).innerHTML},a.hideList=function(){$E("sinaNote")||a.createNode(),$E("sinaNote").style.display="none"},a.init=function(e,t,i,o){o=o||window,null==o.document.body&&setTimeout(Core.Function.bind3(function(){this.init(e,t,i,o)},this),100);for(var r in t)this[r]=t[r];Core.Events.addEvent(document,a.hideList,"click"),Core.Events.addEvent(e,a.hideList,"blur"),Core.Events.addEvent(e,Core.Function.bind3(a.showList,this,[e]),"keyup"),Core.Events.addEvent(e,function(){var t,o=Core.Events.getEvent().keyCode;if(13==o||9==o){if(""!=n){var s=n;if(s.indexOf("非新浪邮箱")>-1){var a=s.split("@");e.value=a[0]+"@",t=!1}else e.value=n,t=!0}t?null!=i&&setTimeout(function(){i.focus()},0):e&&e.focus()}},"keydown"),o&&(s=o)},Lib.passcardOBJ=a}(),Lib.Login.Ui=Core.Class.create();var msnRefreshTimer=0;Lib.Login.Ui.prototype={dialog:null,isInit:!1,request:null,callback:null,initialize:function(){},login:function(e,t,i){this.callback=e||null,this.clearDomain=t||!1,this.from=i||null,this.initDom(),this.initEvent(),this.dialog.show(),this.dialog.setAreaLocked(!0),this.reloadName(),this.onShow(),this.focus(),"blogMove"===scope.$pageid&&($E("login_move_tip").style.display=""),$IE6&&this.initAD(),Lib.passcardOBJ.init($E("login_name_d"),{overfcolor:"#999",overbgcolor:"#e8f4fc",outfcolor:"#000000",outbgcolor:""},$E("login_pass_d"))},reloadName:function(){var e=Lib.Login.info(),t=e.ln;t&&($E("login_name_d").value=t);var i=Utils.Cookie.getCookie("ALF");""!=i&&$E("login_save")&&($E("login_save").checked=!0,$E("login_save_tips").style.display="none"),i=Utils.Cookie.getCookie("LiRe"),""!=i&&$E("login_save")&&($E("login_save").checked=!0,$E("login_save_tips").style.display="none")},initDom:function(){var e=this;this.dialog=winDialog.createCustomsDialog({tpl:e.tpl}),this.dialog.addEventListener("hidden",function(){this.destroy()}),this.dialog.setContent(this.struc),this.dialog.setTitle("登录新浪博客"),this.dialog.setMiddle()},initEvent:function(){var e=this.parse.bind2(this);this.request=new Lib.Login.LoginPost(e,this.clearDomain,this.from),Core.Events.addEvent("login_button",this.doLogin.bind2(this)),Core.Events.addEvent("login_name_d",function(e){var t=e.keyCode;13==t&&this.doLogin()}.bind2(this),"keydown"),Core.Events.addEvent("login_pass_d",function(e){var t=e.keyCode;13==t&&this.doLogin()}.bind2(this),"keydown");var t=1;Core.Events.addEvent("login_save",function(){if($E("login_save_tips").style.display=$E("login_save").checked?"":"none",t){var e="http://control.blog.sina.com.cn/blog_rebuild/riaapi/padblog/padInfo.php?ck_login=A00001&rnd="+Math.random();Utils.Io.JsLoad.request(e,{onComplete:function(){},onException:function(){}}),t=null}})},doLogin:function(){Core.Events.stopEvent();var e=$E("login_name_d").value,t=$E("login_pass_d").value;if(e=Core.String.trim(e),t=t,""==e)return this.error("请输入登录名"),!1;if(""==t)return this.error("请输入密码"),!1;if("undefined"!=typeof sinaSSOController&&"undefined"!=typeof sinaSSOController.loginExtraQuery&&"undefined"!=typeof sinaSSOController.loginExtraQuery.door){var i=$E("login_vcode").value;sinaSSOController.loginExtraQuery.door=i||1}return $E("login_save").checked?(v7sendLog("48_01_38_1"),this.request.login(e,t,60)):(v7sendLog("48_01_38_0"),this.request.login(e,t)),!1},parse:function(e){function t(){if(this.callback){try{$tray.renderLogin()}catch(e){}this.callback.call()}else window.location=window.location.toString().replace(/#.*/,"")}if(e.result){Lib.checkAuthor(),$E("login_save").checked?Utils.Cookie.setCookie("LiRe",!0,2400,"/",".blog.sina.com.cn"):Utils.Cookie.setCookie("LiRe","",2400,"/",".blog.sina.com.cn");var i=new Date,n=i.getFullYear(),o=i.getMonth(),s=i.getDate(),a=new Date(n,o,s,24).getTime();Utils.Cookie.setCookie("onceloggedonblog",a,720,"/",".blog.sina.com.cn");var r=this,l=!1;Utils.Io.JsLoad.request("http://login.sina.com.cn/bindmail/checkmailuser.php?entry=blog&name="+encodeURIComponent($E("login_name_d").value)+"&utf82gbk=1&callback=scope.$bindEmailAlert",{noreturn:!0,timeout:5e3,onException:function(){l||t.call(r)}}),scope.$bindEmailAlert=function(e){if(l=!0,"y"!=e.ret&&"not_verify"!=e.errcode||1==Utils.Cookie.getCookie("sbr_noTBE"))t.call(r);else{var i=winDialog.createCustomsDialog({content:['<div id="#{entityID} style="width:358px;height:144px" class="CP_layercon2 unilayer">','<div id="#{contentID}" class="CP_prompt">','<img height="50" align="absmiddle" width="50" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" class="SG_icon SG_icon201">','<table class="CP_w_ttl"><tbody><tr><td>经检测您的帐号存在一定的安全隐患！<br>建议绑定邮箱</td></tr></tbody></table>','<p class="CP_w_btns_Mid"><a href="javascript:;" class="SG_aBtn SG_aBtnB" id="#{bindit}" target="_blank"><cite> 绑定 </cite></a>&nbsp;&nbsp;<a href="javascript:;" class="SG_aBtn SG_aBtnB" id="#{nobind}"><cite> 暂不绑定 </cite></a></p>',"</div>",'<div class="unilayerB SG_j_linedot1">','<p class="SG_txtb"><input type="checkbox" id="#{noalertbind}"><label for="#{noalertbind}">一周内不提醒</label></p>',"</div>","</div>"].join(""),shadow:1},"bindEmail");i.setMiddle(),i.show(),i.nodes.btnClose.onclick=function(){t.call(r),i.hidden()},i.nodes.nobind.onclick=function(){setTimeout(function(){t.call(r),i.hidden()},100)},i.nodes.bindit.href="http://login.sina.com.cn/bindmail/bindmail.php?entry=blog",i.nodes.bindit.onclick=function(){t.call(r)},i.nodes.noalertbind.onclick=function(){this.checked?Utils.Cookie.setCookie("sbr_noTBE","1",168,"/",".blog.sina.com.cn"):Utils.Cookie.setCookie("sbr_noTBE","",0,"/",".blog.sina.com.cn")}}},this.dialog.hidden()}else{if("4049"===e.errno)return sinaSSOController.loginExtraQuery={door:0},$E("login_ckimg").style.display="",$E("login_vcode").value="",$E("checkImg").src="http://login.sina.com.cn/cgi/pin.php?r="+Core.Math.getUniqueId()+"&s=0",Core.Events.addEvent($E("reloadCode"),function(){$E("checkImg").src="http://login.sina.com.cn/cgi/pin.php?r="+Core.Math.getUniqueId()+"&s=0",$E("login_vcode").value="",$E("login_div_error").innerHTML=""}),void this.error("");if("2070"===e.errno)return Core.Events.fireEvent($E("reloadCode"),"click"),void this.error(e.reason);if("4047"==e.errno)return void this.error(e.reason);if("4057"==e.errno)return void this.error(e.reason);if("4040"==e.errno)return void this.error(e.reason);this.error("登录名或密码错误"),$E("checkImg").src="http://login.sina.com.cn/cgi/pin.php?r="+Core.Math.getUniqueId()+"&s=0",$E("login_vcode").value=""}},friendlyTip:function(e){var t=e,i=$E("login_name_d"),n=i.value;if(!/[\u0391-\uFFE5]+/.test(n)&&!/^\d+$/.test(n)&&!/^@/.test(n)){var o="你的登录名可能是 ",s='<a href="#" class="underline" onclick="$_RENAME(/@.*/, \'{1}\');return false">{0}{1}</a>',a=["@sina.com","@sina.cn"],r="";r=/@sina\.cn$/.test(n)?s.format("{0}",a[0]):/@sina\.com$/.test(n)?s.format("{0}",a[1]):s.format("{0}",a[0])+" 或 "+s.format("{0}",a[1]),t=(o+r).format(n.replace(/@.*/,""))}return t},rename:function(){return window.$_RENAME=function(e,t){var i=$E("login_name_d");i.value=i.value.replace(e,"")+t,$E("login_pass_d").focus(),$E("login_div_error").innerHTML=""},window.$_RENAME}(),focus:function(){var e=$E("login_name_d");""==e.value?e.focus():$E("login_pass_d").focus()},initAD:function(){$E("login_ad").src="http://blog.sina.com.cn/lm/iframe/71/2008/0731/21.html"},onShow:function(){},error:function(e){$E("login_div_error").innerHTML=e,$E("login_pass_d").value="",this.focus()},tpl:['<table id="#{panel}" class="CP_w">','<thead id="#{titleBar}">',"<tr>",'<th class="tLeft"><span></span></th>','<th class="tMid">','<div class="bLyTop">','<strong id="#{titleName}">提示标题</strong>','<cite><a id="#{btnClose}" href="#" onclick="return false;" class="CP_w_shut" title="关闭">关闭</a></cite>',"</div>","</th>",'<th class="tRight"><span></span></th>',"</tr>","</thead>","<tfoot>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid"><span></span></td>','<td class="tRight"><span></span></td>',"</tr>","</tfoot>","<tbody>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid" id="#{content}">',"</td>",'<td class="tRight"><span></span></td>',"</tr>","</tbody>","</table>"].join(""),struc:'		<div class="CP_layercon2 passLoginItem">			<div>				<div id="login_move_tip" style="display:none;margin-bottom:12px">可以使用新浪微博、邮箱、通行证的帐号进行登录</div>				<div class="boxA">登录名：					<input tabIndex="201" type="text" class="fm1" style="width:215px;" name="login_name" id="login_name_d" tabIndex=1/>  <a style="font-size: 12px;" href="http://login.sina.com.cn/signup/signupmail.php?entry=blog&srcuid='+scope.$uid+'&src=blogicp" target="_blank">立即注册</a>				</div>				<div class="boxA">密　码：					<input tabIndex="202" type="password" class="fm1" style="width:215px;" name="login_pass" maxlength="16" id="login_pass_d" tabIndex=2/>  <a style="font-size: 12px;" href="http://login.sina.com.cn/getpass.html" target="_blank">找回密码</a>				</div>				<div id="login_ckimg" class="boxA" style="display:none"> <p class="p_img">验证码：                  	<input type="text" id="login_vcode" name="login_vcode" class="fm1" size="10" maxlength="5" />                  	<img width="100" align="absmiddle" id="checkImg" src="http://login.sina.com.cn/cgi/pin.php?r='+Core.Math.getUniqueId()+'&s=0" /> <a href="javascript:;" onclick="return false;" style="font-size: 12px;"><span id="reloadCode">换一换</span></a></p> 			    </div>				<div class="ErrTips" id="login_div_error"></div>				<div class="boxB"><p><input tabIndex="203" type="checkbox" value="" id="login_save" checked="checked" /><label for="login_save"> 记住登录状态</label></p><p id="login_save_tips" style="color:#999;display:none;">建议在网吧/公用电脑上取消该选项</p><p style="margin-top: 8px;"><a id="login_button" class="SG_aBtn SG_aBtnB SG_aBtn_sub" href="javascript:;" tabIndex=204><cite>登录<input type="text"/></cite></a> </p></div>			</div>			<div class="connect_msn" id="connect_msn" style="position:relative;">				<span>使用 MSN 帐号登录博客</span>				<a href="#" onclick="Lib.checkAuthor();v7sendLog(\'48_01_36\'); window.open(\'https://login.live.com/oauth20_authorize.srf?client_id=0000000040046F08&redirect_uri=http%3A%2F%2Fcontrol.blog.sina.com.cn%2Fblog_rebuild%2Fmsn%2FmsnLoginCallBack.php&response_type=code&scope=wl.basic%20wl.signin%20wl.offline_access%20wl.share%20wl.emails\',\'neww\',\'left='+(screen.width-440)/2+",top="+(screen.height-400)/2+',height=400,width=440\');msnrefreshWindow();" style="background:transparent url(http://simg.sinajs.cn/blog7style/images/msn_login01.gif) no-repeat left top; width:70px; height:22px; line-height:22px; display:inline-block; text-align:left; text-indent:2em; text-decoration:none; color:white; font-weight:bold; font-size:14px;">登录</a>			</div>			<a href="http://blog.sina.com.cn/s/blog_4b0f52990100miil.html" target="_blank"style="left:308px;position:relative;top:-24px;">如何登录？</a>			<div class="CP_lg_ad SG_j_linedot1">				<iframe id="login_ad" src="http://blog.sina.com.cn/lm/iframe/71/2008/0731/21.html" frameborder="0" scrolling="no" height="25" width="auto"></iframe>			</div>		</div>'},Core.System.winSize=function(e){var t,i;return target=e?e.document:document,self.innerHeight?(target=e?e.self:self,t=target.innerWidth,i=target.innerHeight):target.documentElement&&target.documentElement.clientHeight?(t=target.documentElement.clientWidth,i=target.documentElement.clientHeight):target.body&&(t=target.body.clientWidth,i=target.body.clientHeight),{width:t,height:i}},Core.System.pageSize=function(e){target=e?e.document:document;var t,i,n="CSS1Compat"==target.compatMode?target.documentElement:target.body;window.innerHeight&&window.scrollMaxY?(t=n.scrollWidth,i=window.innerHeight+window.scrollMaxY):n.scrollHeight>n.offsetHeight?(t=n.scrollWidth,i=n.scrollHeight):(t=n.offsetWidth,i=n.offsetHeight);var o=Core.System.winSize(e);return pageHeight=i<o.height?o.height:i,pageWidth=t<o.width?o.width:t,[pageWidth,pageHeight,o.width,o.height]},function(){function e(e,t){this.node=e,this.config=t;for(var i in this.defaultConfig)this.config[i]=this.defaultConfig[i];return this.initialize(),this}e.prototype={defaultConfig:{preloadPixel:500},initialize:function(){this.viewableHeight=t.getViewableHeight(),t.enrol(this)},callback:function(e){if(0!=this.node.length){this.viewableHeight=e||this.viewableHeight;for(var t=[],i=0,n=this.node.length;n>i;i++)this.node[i]&&null==this.node[i].dom&&Core.Dom.getXY(this.node[i])[1]<this.viewableHeight+this.config.preloadPixel?(this.config.callback(this.node[i]),this.node[i]=null):this.node[i]&&this.node[i].dom&&Core.Dom.getXY(this.node[i].dom)[1]<this.viewableHeight+this.config.preloadPixel?(this.node[i].callback(this.node[i].dom),this.node[i]=null):t.push(this.node[i]);
this.node=t}}};var t={_isInit:null,_binder:null,_isWindow:null,_member:[],initialize:function(){var e=window,t=e==window||e==document||!e.tagName||/^(?:body|html)$/i.test(e.tagName);if(t){var i=e.document;e="CSS1Compat"==i.compatMode&&($IE||$FF||$OPERA)?i.documentElement:i.body}this._container=e,this._binder=t?window:e,this._isWindow=t,this._isInit=!0,this.delayResize(),this.bindEvent()},getViewableHeight:function(){var e=t._container.scrollTop+Core.System.winSize().height;return this.eyeableHeight=e,e},bindEvent:function(){return this._isInit?(Core.Events.addEvent(this._binder,t.delayLoad,"scroll"),this._isWindow&&Core.Events.addEvent(this._binder,t.delayResize,"resize"),void(this.binded=!0)):void this.initialize()},unbindEvent:function(){Core.Events.removeEvent(t._binder,t.delayLoad,"scroll"),this._isWindow&&Core.Events.removeEvent(t._binder,t.delayResize,"resize"),this.binded=!1},delayLoad:function(){t.scrollWatch&&clearTimeout(t.scrollWatch),t.scrollWatch=setTimeout(function(){t.callback(),clearTimeout(t.scrollWatch),t.scrollWatch=null},100)},delayResize:function(){t.resizeWatch&&clearTimeout(t.resizeWatch),t.resizeWatch=setTimeout(function(){t.callback(),clearTimeout(t.resizeWatch),t.resizeWatch=null},100)},enrol:function(e){t._member.push(e)},callback:function(){if(t.getViewableHeight(),t._member.length>0)for(var e=0,i=t._member.length;i>e;e++)t._member[e].callback(t.eyeableHeight);t.eyeableHeight==Core.System.pageSize()[1]&&t.unbindEvent()}};Lib.LazyLoad=function(i,n){1!=t.binded&&t.bindEvent(i,n),new e(i,n)}}();var Layer=function(e){this.entity=null,this.ifm=null;var t=this,i={width:0,height:0,x:0,y:0,isFixed:!1,uniqueID:"",entityID:"",contentID:"",template:e,templateString:"",nodes:{}};this.getProperty=function(){return i},function(){var e=t.getProperty();e.uniqueID="_"+t.getUniqueID(),e.entityID=e.uniqueID+"_entity",e.contentID=e.uniqueID+"_content",t.setTemplate(e.template),e.width=parseInt(t.entity.style.width),$IE6&&t.addIframe(),document.body.appendChild(t.entity),t.hidden()}(),this._ie6Fixed=function(){t.entity.style.left=document.documentElement.scrollLeft+t.getProperty().x+"px",t.entity.style.top=document.documentElement.scrollTop+t.getProperty().y+"px",t.ifm&&(t.ifm.style.left=document.documentElement.scrollLeft+t.getProperty().x+"px",t.ifm.style.top=document.documentElement.scrollTop+t.getProperty().y+"px")}};Layer.prototype={setTemplate:function(e){var t=this.getProperty();if(this.entity&&(this.entity.parentNode.removeChild(this.entity),this.entity=null),"object"==typeof e){if(t.nodes=e,this.entity&&(this.entity.parentNode.removeChild(this.entity),this.entity=null),this.entity=t.nodes.entity,document.body.appendChild(this.entity),!t.nodes.entity||!t.nodes.content)throw new Error("[layer.js] missing entity or content in layer nodes");return this.entity.style.position="absolute",this.entity.style.zIndex="1024",this.entity.style.left=t.x+"px",this.entity.style.top=t.y+"px",void 0}var i=/[^\{\}]+(?=\})/g;t.template=e,t.templateString=t.template.match(i),this.entity=$C("div");var n=$C("div"),o=new Ui.Template(t.template);if(n.innerHTML=o.evaluate(this.getNodes("i")),document.body.appendChild(n),!$E(t.entityID)||!$E(t.contentID))throw new Error("[layer.js] there missing #{entityID} or #{contentID} in layer template");this.entity=$E(t.entityID),this.entity.style.position="absolute",this.entity.style.zIndex="1024",this.entity.style.left=t.x+"px",this.entity.style.top=t.y+"px",document.body.replaceChild(this.entity,n),n=null,t.nodes=this.getNodes()},setSize:function(e){var t=this.getProperty();Core.System.parseParam(t,e),e.width&&(t.nodes.content.style.width=t.width+"px"),e.height&&(t.nodes.content.style.height=t.height+"px"),this.updateIfmSize()},setPosition:function(e){var t=this.getProperty();Core.System.parseParam(t,e),this.entity.style.left=t.x+"px",this.entity.style.top=t.y+"px",$IE6&&t.isFixed&&(this.entity.style.left=t.x+document.documentElement.scrollLeft+"px",this.entity.style.top=t.y+document.documentElement.scrollTop+"px"),this.ifm&&(this.ifm.style.left=this.entity.style.left,this.ifm.style.top=this.entity.style.top)},getWidth:function(){var e=this.entity.style.display,t=this.entity.style.visibility;return this.entity.style.visibility="hidden",this.entity.style.display="",w=this.entity.offsetWidth,this.entity.style.display=e,this.entity.style.visibility=t,w},getHeight:function(){var e=this.entity.style.display,t=this.entity.style.visibility;return this.entity.style.visibility="hidden",this.entity.style.display="",h=this.entity.offsetHeight,this.entity.style.display=e,this.entity.style.visibility=t,h},getX:function(){return parseInt(this.entity.style.left)},getY:function(){return parseInt(this.entity.style.top)},updateIfmSize:function(){if(this.ifm){var e=this;e.ifm.style.width=e.entity.offsetWidth+"px",e.ifm.style.height=e.entity.offsetHeight+"px"}},setFixed:function(e){var t=this.getProperty();t.isFixed=e;var i=this;return $IE6?(i.entity.style.position="absolute",void(t.isFixed?(i._ie6Fixed(),Core.Events.addEvent(window,i._ie6Fixed,"scroll")):Core.Events.removeEvent(window,i._ie6Fixed,"scroll"))):t.isFixed&&$FF2?void i.updateFixed():void(this.entity.style.position=t.isFixed?"fixed":"absolute")},updateFixed:function(){var e=this.getProperty();if(e.isFixed&&$FF2){var t=this,i=e.x,n=e.y;t.entity.style.position="absolute",t.setPosition({x:e.x+document.documentElement.scrollLeft,y:e.y+document.documentElement.scrollTop}),t.entity.style.position="fixed",t.setPosition({x:i,y:n})}},show:function(){this.entity.style.display="",this.ifm&&(this.ifm.style.display="",this.updateIfmSize())},hidden:function(){this.entity.style.display="none",this.ifm&&(this.ifm.style.display="none")},addIframe:function(){this.ifm=$C("iframe"),this.ifm.style.position="absolute",this.ifm.style.zIndex="1024",this.ifm.style.left=this.entity.style.left,this.ifm.style.top=this.entity.style.top,document.body.appendChild(this.ifm),Core.Dom.setStyle(this.ifm,"opacity",0)},getNodes:function(e){var t,i=this.getProperty(),n=e||"o",o={},s=i.templateString;if(s)for(t=0;t<s.length;t++){var a=s[t];switch(n){case"o":o[a]=$E(i.uniqueID+"_"+a);break;case"i":o[a]=i.uniqueID+"_"+a}}return"entity"in o?o:i.nodes},getUniqueID:function(){return parseInt(1e4*Math.random()).toString()+(new Date).getTime().toString()},setContent:function(e){var t=this.getProperty();e&&(t.nodes.content.innerHTML=e)}},function(){function e(e){try{var t=e.constructor.toString().toLowerCase();return t.slice(t.indexOf("function")+9,t.indexOf("()"))}finally{t=null}}function t(e,t){var i,n,o=[];for(n=t.length,i=0;n>i;i++)o[o.length]=parseFloat(Core.Dom.getStyle(e,t[i]));return o}function i(t){return"array"!=e(t)?[t]:t}function n(t,i){try{var n,s,a,r=e(t),l=[],c=[];if("array"!=r)a=o(t),a[1]="opacity"==i?"":a[1],l=[a[0]],c=[a[1]];else for(s=t.length,n=0;s>n;n++)a=o(t[n]),a[1]="opacity"==i[n]?"":a[1],l[l.length]=a[0],c[c.length]=a[1];return[l,c]}finally{r=l=c=n=s=a=null}}function o(e){try{var t=/(-?\d.?\d*)([a-z%]*)/i.exec(e);return[t[1],t[2]?t[2]:"px"]}finally{t=null}}function s(e){try{var t,i=c(e);return 1!=d[i]?(t=new a,h[i]={node:e,func:t},d[i]=!0,t):h[i].func}finally{i=t=null}}function a(){this._timer=null}function r(e){var t=s(e);t.start.apply(t,arguments)}var l={simple:function(e,t,i,n){return i*e/n+t},backEaseIn:function(e,t,i,n){var o=1.70158;return i*(e/=n)*e*((o+1)*e-o)+t},backEaseOut:function(e,t,i,n){var o=1.70158;return i*((e=e/n-1)*e*((o+1)*e+o)+1)+t},backEaseInOut:function(e,t,i,n){var o=1.70158;return(e/=n/2)<1?i/2*e*e*(((o*=1.525)+1)*e-o)+t:i/2*((e-=2)*e*(((o*=1.525)+1)*e+o)+2)+t},bounceEaseOut:function(e,t,i,n){return(e/=n)<1/2.75?7.5625*i*e*e+t:2/2.75>e?i*(7.5625*(e-=1.5/2.75)*e+.75)+t:2.5/2.75>e?i*(7.5625*(e-=2.25/2.75)*e+.9375)+t:i*(7.5625*(e-=2.625/2.75)*e+.984375)+t},bounceEaseIn:function(e,t,i,n){return i-l.bounceEaseOut(n-e,0,i,n)+t},bounceEaseInOut:function(e,t,i,n){return n/2>e?.5*l.bounceEaseIn(2*e,0,i,n)+t:.5*l.bounceEaseOut(2*e-n,0,i,n)+.5*i+t},strongEaseInOut:function(e,t,i,n){return i*(e/=n)*e*e*e*e+t},regularEaseIn:function(e,t,i,n){return i*(e/=n)*e+t},regularEaseOut:function(e,t,i,n){return-i*(e/=n)*(e-2)+t},regularEaseInOut:function(e,t,i,n){return(e/=n/2)<1?i/2*e*e+t:-i/2*(--e*(e-2)-1)+t},strongEaseIn:function(e,t,i,n){return i*(e/=n)*e*e*e*e+t},strongEaseOut:function(e,t,i,n){return i*((e=e/n-1)*e*e*e*e+1)+t},strongEaseInOut:function(e,t,i,n){return(e/=n/2)<1?i/2*e*e*e*e*e+t:i/2*((e-=2)*e*e*e*e+2)+t},elasticEaseIn:function(e,t,i,n,o,s){if(0==e)return t;if(1==(e/=n))return t+i;if(s||(s=.3*n),!o||o<Math.abs(i)){o=i;var a=s/4}else var a=s/(2*Math.PI)*Math.asin(i/o);return-(o*Math.pow(2,10*(e-=1))*Math.sin(2*(e*n-a)*Math.PI/s))+t},elasticEaseOut:function(e,t,i,n,o,s){if(0==e)return t;if(1==(e/=n))return t+i;if(s||(s=.3*n),!o||o<Math.abs(i)){o=i;var a=s/4}else var a=s/(2*Math.PI)*Math.asin(i/o);return o*Math.pow(2,-10*e)*Math.sin(2*(e*n-a)*Math.PI/s)+i+t},elasticEaseInOut:function(e,t,i,n,o,s){if(0==e)return t;if(2==(e/=n/2))return t+i;if(!s)var s=.3*n*1.5;if(!o||o<Math.abs(i))var o=i,a=s/4;else var a=s/(2*Math.PI)*Math.asin(i/o);return 1>e?-.5*o*Math.pow(2,10*(e-=1))*Math.sin(2*(e*n-a)*Math.PI/s)+t:o*Math.pow(2,-10*(e-=1))*Math.sin(2*(e*n-a)*Math.PI/s)*.5+i+t}},c=function(e){return e.uniqueID};$IE||(c=function(e){try{var t;return null==e.getAttribute("uniqueID")?(t="moz__id"+parseInt(100*Math.random())+"_"+(new Date).getTime(),e.setAttribute("uniqueID",t),t):e.getAttribute("uniqueID")}finally{t=null}});var d={},h={};a.prototype.start=function(e,o,s,a,r,c){this.reset(),c=c||{},c.before&&(this._func.before=c.before),c.end&&(this._func.end=c.end),c.tween&&(this._func.tween=c.tween);var d=i(o),h=t(e,d),p=n(s,d);this._node=e,this._property=d,this._endingvalue=p[0],this._suffixvalue=p[1],this._startvalue=h,this._end=!1,this._fps=0,null!=a&&(this._seconds=a),null!=l[r]&&(this._animation=l[r]),this._starttime=(new Date).getTime(),this._func.before(),this._timer=setInterval(Core.Function.bind3(this.play,this),10)},a.prototype.play=function(){var e,t,i=((new Date).getTime()-this._starttime)/1e3,n=this._property.length;for(i>this._seconds&&(i=this._seconds),e=0;n>e;e++)t=this._animation(i,this._startvalue[e],this._endingvalue[e]-this._startvalue[e],this._seconds),Core.Dom.setStyle(this._node,this._property[e],t+this._suffixvalue[e]);this._fps++,this._func.tween(),i==this._seconds&&this.stop()},a.prototype.stop=function(){clearInterval(this._timer),this._end=!0,this._func.end()},a.prototype.reset=function(){clearInterval(this._timer),this._end=!1,this._node=null,this._property=[],this._startvalue=[],this._endingvalue=[],this._suffixvalue=[],this._fps=0,this._seconds=.5,this._animation=l.simple,this._func={end:function(){},tween:function(){},before:function(){}}},r.stop=function(e){s(e).stop()},r.isTween=function(e){return!s(e)._end},Ui.tween=r}();var DialogDisplaySet={alpha1:{show:function(e,t,i){var n=0,o=0,s=parseInt(e.style.top)-t;e.style.top=s,Core.Dom.setStyle(e,"opacity",n),e.style.display="";var a=window.setInterval(function(){1>=n&&Core.Dom.setStyle(e,"opacity",n),s+t>=o&&(e.style.top=s+o+"px"),o+=1.5,n+=.05,n>.9&&parseInt(e.style.top)>=s+t&&(window.clearInterval(a),i&&i())},10)},hidden:function(e,t,i){var n=1,o=parseInt(e.style.top),s=o-t,a=o,r=window.setInterval(function(){n>=0&&Core.Dom.setStyle(e,"opacity",n),a>=s&&(e.style.top=a+"px"),a-=1.5,n-=.05,0>=n&&s>a&&(window.clearInterval(r),i&&i())},10)}},alpha:{show:function(e,t,i){Core.Dom.setStyle(e,"opacity",.3),e.style.display="",e.style.top=parseInt(e.style.top)-t+"px";var n=parseInt(e.style.top)+t;Ui.tween(e,["top","opacity"],[n,.9],.4,"simple",{end:i})},hidden:function(e,t,i){var n=parseInt(e.style.top)-t;Ui.tween(e,["top","opacity"],[n,0],.2,"simple",{end:i})}},fallDown:{show:function(e,t,i,n){e.style.display="",e.style.top=t+"px",Ui.tween(e,"top",i,.6,"bounceEaseOut",{end:n})},hidden:function(e,t,i,n){e.style.display="",e.style.top=t+"px",Ui.tween(e,"top",i,.6,"strongEaseIn",{end:n})}}};Core.Events.fixEvent=function(e){return"undefined"==typeof e&&(e=window.event),e.target||(e.target=e.srcElement,e.pageX=e.x,e.pageY=e.y),"undefined"==typeof e.layerX&&(e.layerX=e.offsetX),"undefined"==typeof e.layerY&&(e.layerY=e.offsetY),e};var Drag3=function(e,t,i){var n=this;this.beDragObj=e,this.movedObjs=t||this.beDragObj,this.dragMode=i||"normal",this.canDrag=!0,this.isLock=!1,this.lockArea={left:0,right:0,top:0,bottom:0},this.dragSet={normal:function(){n.normalDrag()},border:function(){n.borderDrag()},opacity:function(){n.opacityDrag()}},this.dragObjsFunc=function(){n.onDrag(),n.dragObjs()},function(){n.beDragObj.style.MozUserSelect="none",Core.Events.addEvent(n.beDragObj,function(){return!1},"selectstart"),Core.Events.addEvent(n.beDragObj,function(){return!1},"drag");for(var e=0;e<n.movedObjs.length;e++)n.movedObjs[e]!=n.beDragObj&&(n.movedObjs[e].style.position="absolute",n.movedObjs[e].style.left||(n.movedObjs[e].style.left=n.movedObjs[e].offsetLeft+"px"),n.movedObjs[e].style.top||(n.movedObjs[e].style.top=n.movedObjs[e].offsetTop+"px"));Core.Events.addEvent(n.beDragObj,n.dragSet[n.dragMode],"mousedown"),$IE?Core.Events.addEvent(n.beDragObj,function(){Core.Events.removeEvent(n.beDragObj,n.dragObjsFunc,"mousemove"),n.beDragObj.releaseCapture(),n.onDragEnd()},"mouseup"):Core.Events.addEvent(document,function(){Core.Events.removeEvent(document,n.dragObjsFunc,"mousemove"),n.onDragEnd()},"mouseup")}()};Drag3.prototype={capture:function(){this.canDrag=!0},release:function(){this.canDrag=!1},onDragStart:function(){},onDrag:function(){},onDragEnd:function(){},dragObjs:function(){e=Core.Events.getEvent();for(var t=0;t<this.movedObjs.length;t++)this.isLock?(this.movedObjs[t].style.left=e.clientX-this.movedObjs[t].deltaX<this.lockArea.left?this.lockArea.left+"px":e.clientX-this.movedObjs[t].deltaX>this.lockArea.right-this.movedObjs[t].offsetWidth?this.lockArea.right-this.movedObjs[t].offsetWidth+"px":e.clientX-this.movedObjs[t].deltaX+"px",this.movedObjs[t].style.top=e.clientY-this.movedObjs[t].deltaY<this.lockArea.top?this.lockArea.top+"px":e.clientY-this.movedObjs[t].deltaY>this.lockArea.bottom-this.movedObjs[t].offsetHeight?this.lockArea.bottom-this.movedObjs[t].offsetHeight+"px":e.clientY-this.movedObjs[t].deltaY+"px"):(this.movedObjs[t].style.left=e.clientX-this.movedObjs[t].deltaX+"px",this.movedObjs[t].style.top=e.clientY-this.movedObjs[t].deltaY+"px")},normalDrag:function(){var t=this;e=Core.Events.getEvent();for(var i=0;i<t.movedObjs.length;i++)t.movedObjs[i].deltaX=e.clientX-parseInt(t.movedObjs[i].style.left),t.movedObjs[i].deltaY=e.clientY-parseInt(t.movedObjs[i].style.top);t.canDrag&&($IE?(t.beDragObj.setCapture(),Core.Events.addEvent(t.beDragObj,t.dragObjsFunc,"mousemove")):Core.Events.addEvent(document,t.dragObjsFunc,"mousemove")),t.onDragStart()},borderDrag:function(){},opacityDrag:function(){}},Ui.Drag3=Drag3;var Dialog=function(e){var t=this;t.entity=null,t.ifm=null;var i={id:"",x:0,y:0,width:0,height:0,isFixed:!1,layer:new Layer(e),template:e,canDrag:!1,dragEntity:null,name:"",uniqueID:"",isShow:!1,nodes:{},focusNode:null,displayMode:"normal",_modeDisplayRuning:!1,enabled:!0};this.getProperty=function(){return i},function(){var e=t.getProperty();e.uniqueID=e.layer.getProperty().uniqueID,e.id=e.uniqueID+"_dialog",e.nodes=t.getNodes(),t.entity=e.layer.entity,t.ifm=e.layer.ifm,e.width=parseInt(t.entity.style.width),e.nodes.titleBar&&(e.dragEntity=new Ui.Drag3(e.nodes.titleBar,t.ifm?[t.ifm,t.entity]:[t.entity]),e.nodes.titleBar.style.cursor="move",Core.Events.addEvent(e.nodes.titleBar,function(){return!1},"selectstart"),e.dragEntity.onDrag=function(){t.onDrag()}),Core.Events.addEvent(window,function(){if(e.isShow&&e.isFixed){var i=Core.System.winSize(),n=i.width/2-t.getWidth()/2,o=i.height/2-t.getHeight()/2;n=0>n?0:n,o=0>o?0:o,t.setPosition({x:n,y:o})}},"resize")}()};Dialog.prototype={setPosition:function(e){var t=this.getProperty();Core.System.parseParam(t,e),this.getProperty().layer.setPosition(e)},setSize:function(e){var t=this.getProperty();Core.System.parseParam(t,e),t.layer.setSize(e)},setFixed:function(e){var t=this.getProperty();t.isFixed=e,this.getProperty().layer.setFixed(t.isFixed)},setContent:function(e){this.getProperty();this.getProperty().layer.setContent(e)},setTemplate:function(e){var t=this.getProperty();t.template=e,t.layer.setTemplate(t.template)},setDrag:function(e){var t=this.getProperty();t.canDrag=e,t.canDrag?t.dragEntity.capture():t.dragEntity.release()},getWidth:function(){return this.getProperty().layer.getWidth()},getHeight:function(){return this.getProperty().layer.getHeight()},getX:function(){return this.getProperty().layer.getX()},getY:function(){return this.getProperty().layer.getY()},show:function(e){var t=this.getProperty(),i=this;t.isShow=!0,this.ifm&&(this.ifm.style.display=""),this.onShow(),"normal"==t.displayMode||"normal"==e?this.entity.style.display="":(t._modeDisplayRuning=!0,t.enabled=!1,this._showWithMode(function(){t._modeDisplayRuning=!1,t.enabled=!0,i.onDisplaied&&i.onDisplaied()}))},close:function(e){var t=this,i=this.getProperty();"normal"==i.displayMode||"normal"==e?(i.isShow=!1,i.layer.hidden(),this.destroy(),this.onClose(),t.onDisplayFinished&&t.onDisplayFinished()):i._modeDisplayRuning||(i._modeDisplayRuning=!0,i.enabled=!1,this._hiddenWithMode(function(){i.isShow=!1,i.layer.hidden(),i._modeDisplayRuning=!1,i.enabled=!0,t.destroy(),t.onClose(),t.onDisplayFinished&&t.onDisplayFinished()}))},hidden:function(e){var t=this,i=this.getProperty();"normal"==i.displayMode||"normal"==e?(i.isShow=!1,i.layer.hidden(),this.onHidden(),t.onDisplayFinished&&t.onDisplayFinished()):i._modeDisplayRuning||(i._modeDisplayRuning=!0,i.enabled=!1,this._hiddenWithMode(function(){i.isShow=!1,i.layer.hidden(),t.onHidden(),i._modeDisplayRuning=!1,i.enabled=!0,t.onDisplayFinished&&t.onDisplayFinished()}))},_showWithMode:function(e){{var t=this.getProperty();Core.System.winSize()}switch(t.displayMode){case"alpha":DialogDisplaySet.alpha.show(this.entity,20,e)}},_hiddenWithMode:function(e){{var t=this.getProperty();Core.System.winSize()}switch(t.displayMode){case"alpha":DialogDisplaySet.alpha.hidden(this.entity,20,e)}},destroy:function(){try{this.getProperty().nodes.iframe&&(this.getProperty().nodes.iframe.src="")}catch(e){}this.entity&&this.entity.parentNode.removeChild(this.entity),this.entity=null,this.ifm&&(this.ifm.parentNode.removeChild(this.ifm),this.ifm=null)},onShow:function(){},onClose:function(){},onHidden:function(){},onDrag:function(){},onDisplaied:function(){},onDisplayFinished:function(){},setAreaLocked:function(e){var t=this.getProperty();t.dragEntity.isLock=e;var i=this;e&&(i._updateLockArea(),Core.Events.addEvent(window,function(){i._updateLockArea()},"resize"))},_updateLockArea:function(){var e=this.getProperty(),t=Core.System.winSize();e.isFixed?$IE6?(e.dragEntity.lockArea={left:document.documentElement.scrollLeft,right:document.documentElement.scrollLeft+t.width,top:document.documentElement.scrollTop,bottom:document.documentElement.scrollTop+t.height},Core.Events.addEvent(window,function(){e.dragEntity.lockArea={left:document.documentElement.scrollLeft,right:document.documentElement.scrollLeft+t.width,top:document.documentElement.scrollTop,bottom:document.documentElement.scrollTop+t.height}},"scroll"),Core.Events.addEvent(window,function(){e.dragEntity.lockArea={left:document.documentElement.scrollLeft,right:document.documentElement.scrollLeft+t.width,top:document.documentElement.scrollTop,bottom:document.documentElement.scrollTop+t.height}},"resize")):e.dragEntity.lockArea={left:0,right:t.width,top:0,bottom:t.height}:e.dragEntity.lockArea={left:0,right:document.documentElement.scrollWidth,top:0,bottom:document.documentElement.scrollHeight}},updateFixed:function(){this.getProperty().layer.updateFixed()},getNodes:function(e){return this.getProperty().layer.getNodes(e)},setFocus:function(){var e=this.getProperty();if(e.focusNode&&"none"!=e.focusNode.style.display)try{e.focusNode.focus()}catch(t){}else"none"!=this.entity.style.display&&this.entity.focus()},getUniqueID:function(){return this.getProperty().layer.getUniqueID()}},Core.String.byteLength=function(e){if("undefined"==typeof e)return 0;var t=e.match(/[^\x00-\x80]/g);return e.length+(t?t.length:0)},Lib.register("util.LS",function(){var e=function(e){return e.localStorage?e.localStorage:e.sessionStorage?e.sessionStorage:e.globalStorage?e.globalStorage:function(){var e={},t="data-userdata",i=document,n=i.body,o=function(e,i,o,s){n.load(t),o=n.getAttribute(t)||"",s=RegExp("\\b"+e+"\\b,?","i");var a=s.test(o)?1:0;o=i?o.replace(s,""):a?o:""===o?e:o.split(",").concat(e).join(","),n.setAttribute(t,o),n.save(t)};return n.addBehavior("#default#userData"),e.getItem=function(e){return n.load(e),n.getAttribute(e)},e.setItem=function(e,t){n.setAttribute(e,t),n.save(e),o(e)},e.removeItem=function(e){n.removeAttribute(e),n.save(e),o(e,1)},e.clear=function(){n.load(t);var e=n.getAttribute(t).split(","),i=e.length;if(""!==e[0]){for(var o=0;i>o;o++)n.removeAttribute(e[o]),n.save(e[o]);n.setAttribute(t,""),n.save(t)}},e}()}(window);return e}),$SYSMSG.extend({A00001:"系统繁忙，请稍候再试。",A00007:"未登录。",A00004:"系统繁忙，请稍候再试。",A00112:"博客名称超长。",A00113:"您已开通博客，请点击<a href='http://control.blog.sina.com.cn/blogprofile/index.php'>个人中心</a>进入。",A00116:"不能包含 sina 等有特殊含义的字符。",A11003:"此账户已完成博客快速设置，点击确定，直接进入博客。",A44001:"博客个性地址不能为空。",A44002:"地址格式不对。",A44003:"抱歉，此地址已被占用。",A44005:"抱歉，请按照正确格式填写博客地址。"}),function(){function e(){for(var e=$nick,t=Core.String.byteLength(e);t>18;)e=e.substring(0,e.length-1),t=Core.String.byteLength(e);return e+"的博客"}function t(e,t,i,n){e.onfocus=function(){e.className="ipt focus",s(i,""),n.style.display=""},e.onblur=function(){e.className="ipt",a(e,t,n),s(i,"none")},e.onkeyup=function(){a(e,t,n)}}function i(e){if(i.requestComplete!==!1){if(e.nameErrorEle.innerHTML)return n(e.nameErrorEle.parentNode),void setTimeout(function(){n(e.nameErrorEle.parentNode)},442);i.requestComplete=!1;var t="floatingLayer"===e.from?"openBlogOkBtn_t":"openBlogOkBtn";$E(t).className="loading";var s={loginName:o(),blogName:e.openName};new Interface(c,"jsload").request({GET:{uid:$UID,loginname:s.loginName,blogname:s.blogName,version:7,src:"layer",isprivate:e.isprivate},onSuccess:function(n){i.requestComplete=!0,$E(t).className="btn",e.okCallback(n,s),s=null},onError:function(n){var o=$E("blogNameError"),s=$E("blogNameIcon"),a=$E("blogNameError_t"),l=$E("blogNameIcon_t");switch(n.code){case"A11008":o&&s&&r(o,"输入内容有误，请修改",s),a&&l&&r(a,"输入内容有误，请修改",l);break;case"A11010":o&&s&&r(o,"输入内容有误，请修改",s),a&&l&&r(a,"输入内容有误，请修改",l);break;default:r(e.errorEle,"系统繁忙，请稍后再试。")}i.requestComplete=!0,$E(t).className="btn"}})}}function n(e){for(var t=1;55>=t;t++)!function(t){setTimeout(function(){e.style.backgroundColor="rgb(255, "+ +(200+t)+", "+(200+t)+")"},8*t)}(t)}function o(){var e=decodeURIComponent(Utils.Cookie.getCookie("SUP"));return e=e.split("&name=")[1],e=decodeURIComponent(e.split("&")[0])}function s(e,t){for(var i=0;e[i];i++)e[i].style.display=t}function a(e,t,i){var n=e.value;if(/^(?:\s|[　])+|(?:\s|[　])+$/.test(n)&&(e.value=Core.String.trim(n),n=e.value),n){var o=Core.String.byteLength(n);o>24?r(t,"博客名称超长",i):l(t,i)}else r(t,"博客名称不能为空",i)}function r(e,t,i){e.innerHTML=t,e.style.display="block",e.id.indexOf("ErrTips")>=0&&(e.style.visibility="visible"),i&&(i.className="SG_icon SG_icon48 tips")}function l(e,t){e.innerHTML="",e.style.display="none",t&&(t.className="SG_icon SG_icon49 tips")}if(scope.blogOpener)return void(scope.addBlogOpenerEvent=function(){});var c="http://control.blog.sina.com.cn/riaapi/reg/open_blog.php",d=function(){this._hasInit=!1};d.prototype={getCon:function(){return['<div class="CP_layercon8"><div class="nowOpenBlog"><strong>您的博客尚未开通,仅一步操作就能开通您的个人博客</strong><div class="boxA"><label>博客名称：</label><input id="blogNameInput_t" type="text" class="ipt" /><img style="display:none" id="blogNameIcon_t" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" class="SG_icon SG_icon49 tips"><p id="blogNameError_t" class="tip">名称不能为空</p></div><div  class="boxA"> <p>隐私设置：<input type="radio" name="isPrivate_t" checked id="openAll1_t" class="rd" /><label for="openAll1_t">对所有人开放</label><input type="radio" name="isPrivate_t" id="openMe1_t" class="rd" /><label for="openMe1_t">仅对自己开放，私密博客</label></p></div><div id="ErrTips_t" class="ErrTips">系统繁忙，请稍后再试</div><div class="boxB"><p><a id="openBlogOkBtn_t" class="btn" href="javascript:void(0)">完成开通</a><a id="openBlogCancel" href="javascript:void(0)">取消</a></p></div></div></div>'].join("")},_initDialog:function(){Lib.checkAuthor(),this.key=o(),this._dialog=winDialog.createCustomsDialog({content:this.getCon()},"openblog"),this.bindEvent(),t($E("blogNameInput_t"),$E("blogNameError_t"),[],$E("blogNameIcon_t"))},showDialog:function(e,t,i){t=t||!1,this._hasInit||(this._initDialog(),this._hasInit=!0);var n=this;if(scope.whenOpenBlogCallback=e,scope.hasOpenBlog)trace("这是已登陆的用户"),"open"==scope.hasOpenBlog?(trace("并且他开通的博客"),scope.whenOpenBlogCallback&&scope.whenOpenBlogCallback()):($E("openblogcss")||Utils.Io.loadCss({id:"openblogcss",url:$_GLOBAL.cssBasicURL+"module/layer/re_nowopen.css"}),trace("他们没有开通博客"),this._showDialog(t));else{trace("这是一位后登陆的用户");var o=0,s=setInterval(function(){trace("呀，怎么还没有出结果啊--"+o),scope.hasOpenBlog&&(clearInterval(s),"open"==scope.hasOpenBlog?(trace("并且他开通的博客"),scope.whenOpenBlogCallback&&scope.whenOpenBlogCallback()):(trace("他们没有开通博客"),n._showDialog(t))),o++,10==o&&(Lib.checkAuthor(),trace("等不及了，自己发吧。。。"),clearInterval(s),new Interface("http://control.blog.sina.com.cn/riaapi/profile/unread.php","jsload").request({GET:{uid:$UID,product:"blog"},onSuccess:function(e){scope.hasOpenBlog=1==e.isbloguser?"open":"no",trace("~~~~~~~~~~~~~~~~~~~"+scope.hasOpenBlog),"open"==scope.hasOpenBlog?(trace("并且他开通的博客"),scope.whenOpenBlogCallback&&scope.whenOpenBlogCallback()):($E("openblogcss")||Utils.Io.loadCss({id:"openblogcss",url:$_GLOBAL.cssBasicURL+"module/layer/re_nowopen.css"}),trace("他们没有开通博客"),n._showDialog(t))}}))},10)}i&&($E("openBlogCancel").style.display="none",this._dialog.getNodes().btnClose.style.display="none")},_showDialog:function(){$E("blogNameInput_t").value=e(),l($E("blogNameError_t"),$E("blogNameIcon_t")),$E("ErrTips_t").style.visibility="hidden",$E("blogNameIcon_t").style.display="none",this._dialog.show(),this._dialog.setAreaLocked(!0),this._dialog.setMiddle()},bindEvent:function(){var t=this;Core.Events.addEvent($E("openBlogCancel"),function(){return t.closeDialog(),!1}),Core.Events.addEvent($E("openBlogOkBtn_t"),function(){return i({nameErrorEle:$E("blogNameError_t"),nameOkIcon:$E("blogNameIcon_t"),openName:$E("blogNameInput_t").value||e(),isprivate:$E("openAll1_t").checked?0:1,errorEle:$E("ErrTips_t"),from:"floatingLayer",okCallback:function(e,i){scope.whenOpenBlogCallback&&scope.whenOpenBlogCallback(e,i),$E("openedBlogTray")&&"none"==$E("openedBlogTray").style.display&&($E("outOfOpenBlogTray").style.display="none",$E("noOpenedBlogTray").style.display="none",$E("openedBlogTray").style.display=""),$E("noOpendBlogSearchTip")&&"block"==$E("noOpendBlogSearchTip").style.display&&($E("noOpendBlogSearchTip").style.display="none",$E("opendBlogSearchTip").style.display="block"),scope.hasOpenBlog="open",t.closeDialog(),scope.whenOpenBlogCallback=function(){}}}),!1})},closeDialog:function(){this._dialog.hidden()}},scope.openBlogGetShotName=e,scope.openBlogNameEvent=t,scope.openBlogWhenOpenBlog=i,scope.blogOpener=new d,scope.addBlogOpenerEvent=function(e){Core.Events.addEvent(e,function(){scope.blogOpener.showDialog(function(e,t){if(Lib.LocalDB.clearCache(1,"uid_"+$UID+"unread"),Lib.util.LS.removeItem("uid"+$UID),"fakeIndex"==scope.$pageid)return void(window.location.href="http://i.blog.sina.com.cn/blogprofile/index.php?atten=1");if($E("openedBlogTray"))$E("openedBlogTray").style.display="",$E("noOpenedBlogTray").style.display="none",$E("outOfOpenBlogTray").style.display="none",t&&($E("loginBarAppMenuLabel").innerHTML=t.loginNick);else{var i=window;i.$tray&&i.$tray.renderLogin()}var n=function(){scope.___importV&&(scope.___importV(),scope.___openBlogFlag=1)},o={subText:scope.___importV?"":['<div class="CP_w_cnt SG_txtb">欢迎您在新浪博客安家！除了写博客，看博客外，您还可以进入个人中心完善您的个人资料，更有很多有趣的应用等着您哦。</div>','<ul class="CP_w_part CP_w_aLine">','<li><a href="http://control.blog.sina.com.cn/blogprofile/index.php" onclick="winDialog.getDialog(\'unregister\').hidden();" target="_blank">到博客个人中心&gt;&gt;</a></li>',"</ul>"].join(""),icon:"03",funcOk:n,funcClose:n,width:300};winDialog.alert("开通博客成功",o,"unregister");var s=$E("commentNick");if(s){for(var a=s.firstChild;a;)s.removeChild(a),a=s.firstChild;s.innerHTML=t.loginNick+":"}},!0)},"click")}}(),function(){var e=function(e,t,i){Lib.checkAuthor();var n=new Interface("http://control.blog.sina.com.cn/riaapi/profile/attention_add.php","ijax");n.request({POST:{uid:e||$UID,aid:t||scope.$uid},onSuccess:function(){},onError:function(e){var t="";switch(e.code){case"A11007":t=$SYSMSG.A11007.replace("#{linkNewBlog}","http://login.sina.com.cn/hd/reg_sec.php?entry=blog"),winDialog.alert(t,{funcOk:function(){window.open("http://login.sina.com.cn/hd/reg_sec.php?entry=blog","_blank","")}});break;case"A33003":t=$SYSMSG.A33003.replace("#{UID}",$UID),winDialog.alert(t);break;case"A33004":var n={subText:['<div class="CP_w_cnt SG_txtb">以后对方的动态（发博文，图片，投票等），都可以在<span style="color:red">个人中心</span>查看啦！</div>','<ul class="CP_w_part CP_w_aLine">','<li><a href="http://control.blog.sina.com.cn/blogprofile/index.php?type=3&from=attention" onclick="winDialog.getDialog(\'attention\').hidden();" target="_blank">到个人中心查看关注动态&gt;&gt;</a></li>',"</ul>"].join(""),icon:"03",width:300};try{var o=$E("module_901_attention");o.className="SG_aBtn SG_aBtn_dis",o.innerHTML="<cite onclick=\"Lib.Component.isAttentioned('"+$UID+"', '"+scope.$uid+"');\">已关注</cite>"}catch(s){}t=$SYSMSG.A33004,n.subText=n.subText.replace(/#{UID}/g,$UID),winDialog.alert(t,n,"attention");break;default:showError(e.code)}i(e.code)},onFail:function(){showError($SYSMSG.A00001)}})};Lib.Component.Attention=function(t,i,n){Lib.checkAuthor();if(n=n||function(){},$isLogin)scope.blogOpener.showDialog(function(){e(t,i,n)});else{var o=new Lib.Login.Ui;o.login(function(){scope.blogOpener.showDialog(function(){Core.Function.bind3(e,null,[t,i,n])()})},!1,"referer:"+location.hostname+location.pathname+",func:0004")}},Lib.Component.deleteAttention=function(){winDialog.getDialog("attention").close(),winDialog.confirm("是否要取消关注？",{funcOk:function(){new Interface("http://control.blog.sina.com.cn/riaapi/profile/attention_del.php","jsload").request({GET:{uid:$UID,aid:scope.$uid},onSuccess:function(){var e=$E("module_901_attention");e.className="SG_aBtn",e.innerHTML="<cite onclick=\"Lib.Component.Attention('"+$UID+"', '"+scope.$uid+"');\">加关注</cite>"},onError:function(){winDialog.alert("取消失败！请重试。")},onFail:function(){winDialog.alert("取消失败！请重试。")}})},funcCancel:function(){Lib.Component.isAttentioned()},textOk:"是",textCancel:"否"})},Lib.Component.isAttentioned=function(){winDialog.alert("已关注此人！",{subText:['<ul class="CP_w_part CP_w_aLine">','<li><a href="http://control.blog.sina.com.cn/blogprofile/index.php?type=3&from=attention2" onclick="winDialog.getDialog(\'attention\').close();" target="_blank">到个人中心查看关注动态&gt;&gt;</a></li>',"</ul>"].join(""),icon:"03"},"attention")}}(),$SetPV=function(e){e=window.parseInt(e),Lib.checkAuthor(),$E("comp_901_pv").innerHTML=$isAdmin?'<strong><a title="您的访问统计" href="http://i.blog.sina.com.cn/blogprofile/profilevisitanaly.php" target="_blank">'+Core.String.formatNumber(e)+"</a></strong>":"<strong>"+Core.String.formatNumber(e)+"</strong>";var t=0,i=[0,50,100,150,200,300,500,800,1500,3e3,5e3,1e4,15e3,25e3,4e4,7e4,1e5,15e4,2e5,5e5,1e6,2e6,5e6,1e7,2e7,5e7,1e8,15e7,2e8,25e7,3e8,35e7,4e8,45e7,5e8,55e7];e>=5e7?t=Math.floor(e/5e7)+24:(t=-1,i=i.join(",").replace(/(\d+)/g,function(i,n){window.parseInt(n)<=e&&t++})),("article"===scope.$pageid||"articleM"===scope.$pageid||"articletj"===scope.$pageid)&&(scope.$rank=t),t=t.toString().replace(/(\d)/g,function(e,t){return'<img src="http://simg.sinajs.cn/blog7style/images/common/number/'+t+'.gif"/>'
}),$E("comp_901_grade").innerHTML=t},Sina.pkg("Utils.Form"),Core.String.leftB=function(e,t){var i=e.replace(/\*/g," ").replace(/[^\x00-\xff]/g,"**");return e=e.slice(0,i.slice(0,t).replace(/\*\*/g," ").replace(/\*/g,"").length),Core.String.byteLength(e)>t&&(e=e.slice(0,e.length-1)),e},Utils.Form.limitMaxLen=function(e,t){var i,n=function(){i=e.value;var n=Core.String.byteLength(i);n>t&&(e.value=Core.String.leftB(i,t))};Core.Events.addEvent(e,Core.Function.bind3(n,e),"keyup"),Core.Events.addEvent(e,Core.Function.bind3(n,e),"blur"),Core.Events.addEvent(e,Core.Function.bind3(n,e),"focus")},Lib.invite_tpl=['<table id="#{entity}" class="CP_w">','<thead id="#{titleBar}">',"<tr>",'<th class="tLeft"><span></span></th>','<th class="tMid">','<div class="bLyTop">','<strong id="#{titleName}">提示标题</strong>','<cite><a id="#{btnClose}" href="javascript:void(0)" class="CP_w_shut" title="关闭">关闭</a></cite>',"</div>","</th>",'<th class="tRight"><span></span></th>',"</tr>","</thead>","<tfoot>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid"><span></span></td>','<td class="tRight"><span></span></td>',"</tr>","</tfoot>","<tbody>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid" id="#{content}">',"</td>",'<td class="tRight"><span></span></td>',"</tr>","</tbody>","</table>"].join(""),$SYSMSG.extend({A00001:"系统繁忙，请稍候再试。",A00007:"请先登录。",A20101:"内容超长。",A20102:"请输入正确的登录名或密码。",A20103:"请输入正确的验证码。",A20104:"请把对方在黑名单中解除，再加为好友。",A20105:"你的好友数量达到上限，不能添加新好友。",A20106:"博主已设置为拒绝接受好友邀请，请不要打扰哦。",A20107:"不能加自己为好友。",A20108:"你们已经是好友。",A20109:"不能包含sina等特殊含义字符。",A23002:"您已被对方加入黑名单。",A20121:"参数格式不正确。",A20000:"参数格式不正确。",A20001:"内容超长。",A20002:"请输入正确的登录名或密码。",A20003:"请输入正确的验证码。",A20004:"不能包含sina等特殊含义字符。",A20005:"纸条内容不能为空。",A20006:"不能自己给自己发纸条",A20007:"请把对方在黑名单中解除，再发送纸条。",A20020:"给#{nick}的纸条发送失败！",A20008:"对不起，您短时间发表的纸条过多，请多休息会，注意身体！感谢您对新浪博客的支持和关注!",A20999:"对不起，您短时间发送的好友请求过多，请多休息会，注意身体！感谢您对新浪博客的支持和关注!",A20009:"博主已设置为拒绝接收所有纸条，请不要打扰哦。",A20013:"您已经发送多条相似内容了哦，请先休息一下吧~",A20014:"已经有很多博主发过相似评论了，换个内容会更精彩~",A20015:"发生错误，请稍作休息~",A30006:"该博主只接收来自好友的纸条，您还不是Ta的好友哦。",A10006:"对不起，您已被博主列入黑名单，无法发送小纸条。"}),Lib.register("blogv.getVHTML",function(){return function(e,t){var i,n;e=isNaN(e)?-1:parseInt(e,10),0==e?(i="新浪个人认证",n=" SG_icon146"):e>0&&8>e&&(i="新浪机构认证",n=" SG_icon147");var o;return!1!==t&&(t=!0),o=i?'<img class="SG_icon '+n+'" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" title="'+i+'" alt="'+i+'" align="absmiddle" />':"",o&&t&&(o='<a target="_blank" href="http://blog.sina.com.cn/v/verify">'+o+"</a>"),o}}),Lib.Invite_Base=Core.Class.create(),Lib.Invite_Base.prototype={html:['<div class="CP_layercon2 addFriendItem">','<div class="toWho">#{head_image}<span>#{nickname}</span></div>','<div class="formTowho">','<div class="row1" style="display:#{login};">登录名：','<input id="invite_loginname" type="text" class="fm1" style="width:80px;"/>&nbsp;&nbsp;&nbsp;','密码：<input id="invite_password" type="password" class="fm1" style="width:73px;" maxlength="16"/>','&nbsp;&nbsp;<a target="_blank" href="http://login.sina.com.cn/getpass.html">找回密码</a><em class="SG_txtc">','|</em><a target="_blank" href="http://login.sina.com.cn/signup/signupmail.php?entry=blog&srcuid='+scope.$uid+'&src=blogicp">注册</a>','<input id="saveOnline_invite" type="checkbox" checked value="" style="display:inline-block;margin-top:3px;"/><label for="saveOnline_invite" style="margin-top:10px; display:inline-block;">记住登录状态</label>','<span id="saveCaution_invite" style="color:#999; margin-left:10px; display:none;">建议在网吧/公用电脑上取消该选项</span>','</div><p id="invite_user_error" class="ErrTips" style="display:none;">请输入正确的登录名或密码</p>','<div class="row2"><textarea id="invite_content"></textarea></div>','<div class="row1"><span id="invite_limit" class="SG_floatR SG_txtc">您还可以输入#{content_length}个汉字</span>','验证码：<input type="text" id="invite_checkcode" maxlength="4"',' style="width:60px" class="fm1" name="input"/>&nbsp;','<img height="16" width="51" id="invite_checkimage" src="#{checkImage}" align="absmiddle" />&nbsp;','<a id="invite_checklink" href="#" onclick="return false;">换一下</a>','<p id="invite_code_error" class="ErrTips" style="display:none;"></p></div>','<div class="btn">','<a id="invite_submit" class="SG_aBtn SG_aBtnB" href="#" onclick="return false;"><cite>',"#{dialogTitle}</cite></a>&nbsp;&nbsp;",'<a id="invite_cancel" class="SG_aBtn SG_aBtnB" href="#" onclick="return false;"><cite>取消</cite></a>',"</div>","</div>","</div>"].join(""),dialogName:"invite",initialize:function(e,t){if(this.uid=e,this.onlineTime=t||15,Lib.checkAuthor(),this.isAllowSend()){var i={head_image:null!=this.headImage?this.headImage:'<img src="'+("http://portrait"+(this.uid%8+1)+".sinaimg.cn/"+this.uid+"/blog/50")+'" align="absmiddle" alt="'+scope.owenerNickName+'" title="'+scope.owenerNickName+'" />',nickname:this.title(),login:$isLogin?"none":"",checkImage:"http://interface.blog.sina.com.cn/riaapi/checkwd_image.php?"+Math.random(),content_length:this.contentLength/2,dialogTitle:this.dialogTitle},n=new Ui.Template(this.html).evaluate(i);null==this.dialog&&(window.$inviteDialog=this.dialog=winDialog.createCustomsDialog({content:"",title:this.dialogTitle,tpl:Lib.invite_tpl}),this.dialog.addEventListener("hidden",function(){this.destroy()})),this.dialog.setContent(n),this.dialog.setMiddle(),this.dialog.show(),this.dialog.setAreaLocked(!0),Utils.Form.limitMaxLen($E("invite_content"),this.contentLength),Core.Events.addEvent("invite_submit",Core.Function.bind2(this.checkData,this)),Core.Events.addEvent("invite_cancel",Core.Function.bind2(this.closeDailog,this));var o=function(){$E("invite_checkimage").src="http://interface.blog.sina.com.cn/riaapi/checkwd_image.php?"+Math.random()};Core.Events.addEvent("invite_checkimage",o),Core.Events.addEvent("invite_checklink",o),Core.Events.addEvent("invite_content",Core.Function.bind2(function(){clearInterval(this.check),this.check=setInterval(Core.Function.bind2(function(){var e=Core.String.byteLength($E("invite_content").value),t=Math.max(0,Math.floor((this.contentLength-e)/2));$E("invite_limit").innerHTML="您还可以输入"+t+"个汉字"},this),500)},this),"focus"),Core.Events.addEvent("invite_content",Core.Function.bind2(function(){clearInterval(this.check),this.check=null},this),"blur"),this.initSaveCaution(),this.reloadName()}},isAllowSend:function(){return!0},initSaveCaution:function(){function e(){if(i.style.display=t.checked?"inline-block":"none",n){var e="http://control.blog.sina.com.cn/blog_rebuild/riaapi/padblog/padInfo.php?ck_login=A00002&rnd="+Math.random();Utils.Io.JsLoad.request(e,{onComplete:function(){},onException:function(){}}),n=null}}var t=$E("saveOnline_invite"),i=$E("saveCaution_invite");$isLogin||(t[$IE?"onclick":"onchange"]=e);var n=1},reloadName:function(){var e=Lib.Login.info(),t=e.ln;t&&($E("invite_loginname").value=t)},checkData:function(){if(!$isLogin){if(this.username=Core.String.trim($E("invite_loginname").value),this.password=Core.String.trim($E("invite_password").value),""==this.username||""==this.password)return void($E("invite_user_error").style.display="");$E("invite_user_error").style.display="none"}if(this.checkcode=Core.String.trim($E("invite_checkcode").value),""==this.checkcode||this.checkcode.length<4)return $E("invite_code_error").innerHTML="请输入正确的验证码",void($E("invite_code_error").style.display="");if($E("invite_code_error").style.display="none",$isLogin){var e=this;scope.blogOpener.showDialog(function(){e.postContent()})}else v7sendLog($E("saveOnline_invite").checked?"48_01_39_1":"48_01_39_0"),this.login()},login:function(){this.request=new Lib.Login.LoginPost(Core.Function.bind2(function(e){if(e.result){if(this.postContent){Lib.checkAuthor(),$tray.renderLogin();var t=this;scope.blogOpener.showDialog(function(){t.postContent()})}}else trace("登陆失败 ："+e.reason),$E("invite_user_error").style.display=""},this),!1,"referer:"+location.hostname+location.pathname+",func:000"+(/messagesend/.test(this.Interface.url.url)?"2":"3")),this.request.login(this.username,this.password,$E("saveOnline_invite").checked?this.onlineTime:null)},resultHTML:new Ui.Template(['<div class="CP_layercon1">','<div class="CP_prompt">','<img class="SG_icon #{icon}" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif"',' width="50" height="50" align="absmiddle" />','<table class="CP_w_ttl"><tr><td>#{content}</td></tr></table>','<p class="CP_w_btns_Mid"><a class="SG_aBtn SG_aBtnB" href="#" ','onclick="window.$inviteDialog && window.$inviteDialog.hidden();return false;"><cite> 确定 </cite></a></p>',"</div>","</div>"].join("")),postContent:function(){$tray.renderLogin();var e=this.Interface,t={tuid:this.uid,fuid:$UID,authcode:Core.String.trim($E("invite_checkcode").value),content:$E("invite_content").value,varname:"addFriendRequest",version:7,rnd:(new Date).valueOf()};e.request({GET:t,onSuccess:Core.Function.bind2(function(){v7sendLog("45_01_13_"+scope.$uid);var e={icon:"SG_icon203",content:this.successMSG()};this.dialog.setContent(this.resultHTML.evaluate(e)),null!=this.afterSubmit&&this.afterSubmit()},this),onError:Core.Function.bind2(function(e){if("A20109"==e.code||"A20004"==e.code)$E("invite_user_error").innerHTML=$SYSMSG[e.code],$E("invite_user_error").style.display="";else if("A20003"==e.code||"A20103"==e.code)$E("invite_code_error").innerHTML=$SYSMSG[e.code],$E("invite_code_error").style.display="",$E("invite_checkimage").src="http://interface.blog.sina.com.cn/riaapi/checkwd_image.php?"+Math.random(),$E("invite_checkcode").value="";else if("A11007"==e.code){var t=$SYSMSG.A11007.replace("#{linkNewBlog}","http://blog.sina.com.cn/u/"+$UID);winDialog.alert(t)}else{var i={icon:"SG_icon202",content:$SYSMSG[e.code].replace(/#{nick}/,scope.owenerNickName)};this.dialog.setContent(this.resultHTML.evaluate(i))}null!=this.afterSubmit&&this.afterSubmit()},this),onFail:Core.Function.bind2(function(){var e={icon:"SG_icon202",content:$SYSMSG.A00001};this.dialog.setContent(this.resultHTML.evaluate(e))},this)})},closeDailog:function(){this.dialog.hidden()}},Lib.Invite=Core.Class.define(Lib.Invite_Base.prototype.initialize,Lib.Invite_Base,{dialogTitle:"加好友",contentLength:200,title:function(){var e=isNaN(scope.owenerWType)?-1:parseInt(scope.owenerWType),t=Lib.blogv.getVHTML(e);return'加"'+scope.owenerNickName+t+'"为好友'},successMSG:function(){return["邀请发送成功，请等待对方确认。",'<div class="CP_w_cnt SG_txtb" style="font-size:12px;font-weight:normal;">以后对方的动态（发博文，图片，投票等），都可以在<span style="color: red;">个人中心</span>查看啦！</div>','<ul class="CP_w_part CP_w_aLine">','<li><a style="font-weight:normal;font-size:12px;" href="http://control.blog.sina.com.cn/blogprofile/index.php?type=3&from=addfiend" target="_blank">到个人中心查看其他好友动态&gt;&gt;</a></li>',"</ul>"].join("")},Interface:new Interface("http://control.blog.sina.com.cn/riaapi/profile/invitesend.php","jsload"),isAllowSend:function(){if(!scope||!scope.$private)return!0;var e=scope.$private.invitationset||0;return 0===e?!0:(winDialog.alert($SYSMSG.A20106),!1)}}),Lib.invite=function(e){new Lib.Invite(e)},Lib.invite3=function(e,t){scope.owenerNickName=t,new Lib.Invite(e)},Lib.Scrip=Core.Class.define(Lib.Invite_Base.prototype.initialize,Lib.Invite_Base,{dialogTitle:"发纸条",headImage:"",contentLength:300,title:function(){return"发纸条给："+scope.owenerNickName},successMSG:function(){return"给"+scope.owenerNickName+"的纸条发送成功！"},Interface:new Interface("http://control.blog.sina.com.cn/riaapi/profile/messagesend.php","jsload"),afterSubmit:function(){},isAllowSend:function(){if(!scope||!scope.$private)return!0;var e=scope.$private.pageset||0;if(1===e)return this._showMsg("A20009"),!1;if($isLogin){var t=-1!=$E("comp901_btn_invite").innerHTML.indexOf("已是好友");if(2===e&&!t)return this._showMsg("A30006"),!1}return!0},_showMsg:function(e){winDialog.alert($SYSMSG[e])}}),Lib.scrip=function(e){new Lib.Scrip(e)},"undefined"==typeof SinaEx&&(SinaEx={}),SinaEx.findNode=function(e,t,i){for(var n=e[i];n;n=n[t])if(1==n.nodeType)return n;return null},SinaEx.prev=function(e){return SinaEx.findNode(e,"previousSibling","previousSibling")},SinaEx.next=function(e){return SinaEx.findNode(e,"nextSibling","nextSibling")},SinaEx.firstChild=function(e){return SinaEx.findNode(e,"nextSibling","firstChild")},SinaEx.parent=function(e,t){for(t=t.toLowerCase();e;){if(e.nodeName.toLowerCase()===t)return e;e=e.parentNode}return null},SinaEx.createNode=function(e){var t=document.createElement("div");return t.innerHTML=e,t.firstChild},SinaEx.addClass=function(e,t){var i=e.className;-1===(" "+i+" ").indexOf(" "+t+" ")&&(e.className=t+" "+i)},SinaEx.removeClass=function(e,t){var i=(" "+e.className+" ").replace(" "+t+" "," ");e.className=i.replace(/^\s+/,"").replace(/\s+$/,"")},SinaEx.contains=document.documentElement.contains?function(e,t){return e.contains?e.contains(t):!0}:document.documentElement.compareDocumentPosition?function(e,t){return e===t||!!(16&e.compareDocumentPosition(t))}:function(e,t){for(;t;){if(e===t)return!0;t=t.parentNode}return!1},$registComp(901,{baseHTML:['<div class="info"><div class="info_img" id="comp_901_head"><img src="http://portrait'+(1*scope.$uid%8+1)+".sinaimg.cn/"+scope.$uid+'/blog/180" id="comp_901_head_image" width="180" height="180" alt="" /></div><div class="info_txt"><div class="info_nm"><img id="comp_901_online_icon" style="display:none;" class="SG_icon SG_icon1" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" align="absmiddle" /><span class="SG_txtb"><strong id="comp_901_nickname">&nbsp;</strong></span><span class="info_into"><a class="SG_linka" href="http://space.sina.com.cn/u/1406758883"><img class="SG_icon SG_icon41" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" title="空间" align="absmiddle" />进入我的空间</a></span><div class="clearit"></div></div><div class="info_btn1"><a href="http://you.video.sina.com.cn/'+scope.$uhost+'" class="SG_aBtn SG_aBtn_ico" target="_blank"><cite><img class="SG_icon SG_icon16" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" align="absmiddle" />播客</cite></a><a href="http://weibo.com/'+scope.$uid+'?source=blog" class="SG_aBtn SG_aBtn_ico"><cite><img class="SG_icon SG_icon51" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" align="absmiddle" />微博</cite></a><div class="clearit"></div></div><div class="SG_j_linedot"></div><div class="info_list"><ul class="info_list1"><li><span class="SG_txtc">博客等级：</span><span id="comp_901_grade">读取中…</span></li><li><span class="SG_txtc">博客积分：</span><span id="comp_901_score">读取中…</span></li></ul><ul class="info_list2"><li><span class="SG_txtc">博客访问：</span><span id="comp_901_pv">读取中…</span></li><li><span class="SG_txtc">关注人气：</span><span id="comp_901_attention">读取中…</span></li></ul></div><div class="clearit"></div></div><div class="clearit"></div></div>'].join(""),load:function(){if(Lib.checkAuthor(),null==$E("comp_901_head")&&this.setContent(this.baseHTML),0==$isAdmin&&$isLogin?this.loadIsFriend():0!=$isAdmin||$isLogin?this.isOnline=!0:(this.isFriend=!1,this.loadOnline()),"fakeIndex"!=scope.$pageid&&Lib.Uic.getNickName([scope.$uid],function(e){var t=Core.String.trim,i=$E("ownernick"),n=t(i.textContent||i.innerText),o=t(i.innerHTML);if(Core.String.byteLength(e[scope.$uid])>20)var s=e[scope.$uid].replace(/(.{10})/g,"$1<br/>");else var s=e[scope.$uid];if(n||n==o)if(n&&n!=o)try{var a=i.getElementsByTagName("a"),r=a&&a[0].innerHTML;i.innerHTML=s+'&nbsp;<a href="http://blog.sina.com.cn/v/verify" target="_blank">'+r+"</a>"}catch(l){}else i.innerHTML=s;else i.innerHTML=s+"&nbsp;"+o}),$E("comp_901_nickname"))this.loadNickname();else{this.renderHead();var e,t=$E("ownernick"),i=Core.String.trim,n=Core.String.byteLength;if(t){e=i(t.textContent||t.innerText).replace(/(\r|\n)/g,"");{n(e)}scope.owenerNickName=e}}this.loadOtherInfo(),"pageSetM"==scope.$pageid&&this.setManage&&0==scope.$private.ad&&0==scope.$private.adver&&0==scope.$private.p4p&&this.setManage()},fixNick:function(e){var t,i=Core.String.byteLength,n=Core.String.leftB,o=Core.String.trim,s=i(e);return e=o(e),s>22&&(t=n(e,20),e=t+"<br>"+e.replace(t,"")),e},showOnlineInfo:function(){!$isAdmin&&this.isOnline&&(Core.Dom.setStyle($E("comp_901_online_icon"),"display",""),$E("comp_901_online_icon").alt="在线",$E("comp_901_online_icon").title="在线")},showNickName:function(e){var t=e[scope.$uid]||"";t=Core.String.encodeHTML(t);var i=$E("comp_901_nickname");i.innerHTML=t,scope.owenerNickName=i.textContent||i.innerText,this.renderHead(t)},renderHead:function(e){$isAdmin?$E("comp_901_head").innerHTML='<a href="http://control.blog.sina.com.cn/blogprofile/nick.php" title="点击上传头像" target="_blank"><img id="comp_901_head_image" width="180" height="180" alt="点击上传头像" src="http://portrait'+(1*scope.$uid%8+1)+".sinaimg.cn/"+scope.$uid+'/blog/180" /></a>':e&&($E("comp_901_head_image").title=e)},loadOtherInfo:function(){this.loadPv(),this.loadAttention(),("index"==scope.$pageid||"indexM"==scope.$pageid||"pageSetM"==scope.$pageid)&&this.loadAdManage(),this.load5YearsIcon(),this.load7YearsIcon()},loadNewIcon:function(){var e=$C("a");e.href="http://move.blog.sina.com.cn/",e.target="_blank",e.position="absolute";var t=$C("img");t.src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif",t.className="fiveyearsIcon",$IE6?t.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='http://simg.sinajs.cn/blog7style/images/special/move/move_hz.png',sizingMethod='image')":t.style.backgroundImage="url(http://simg.sinajs.cn/blog7style/images/special/move/move_hz.png)",t.alt="邀请MSN好友获得朋友徽章",t.title="邀请MSN好友获得朋友徽章",t.style.border="none",e.appendChild(t),$E("comp_901_head").appendChild(e),e.onclick=function(){Utils.Io.JsLoad.request("http://control.blog.sina.com.cn/blog_rebuild/msn/api/msnGuideCount.php?type=hitMedal")},e=null},loadPv:function(){var e="0"==document.referrer?"":encodeURIComponent(document.referrer);if(scope.totalPv&&!isNaN(scope.totalPv))$SetPV(scope.totalPv);else{var t="";if(scope.$articleid)t="http://hits.blog.sina.com.cn/hits?act=4&aid="+scope.$articleid+"&ref="+e;else{var i="00000000"+(1*scope.$uid).toString(16);i=i.substr(i.length-8,8),t="http://hits.blog.sina.com.cn/hits?act=3&uid="+i+"&ref="+e}Utils.Io.JsLoad.request(t,{onComplete:function(e){e&&"undefined"!=typeof e.pv&&(scope.totalPv=e.pv,$SetPV(e.pv))},onException:function(){$SetPV(0)}})}},loadScore:function(){setTimeout(function(){Utils.Io.JsLoad.request("http://blogcnfv5.sinajs.cn/blogscr?uid="+scope.$uid+"&varname=blogScore&.js",{onComplete:function(){if("undefined"!=typeof blogScore||null==$E("comp_901_score")){var e=blogScore.coefficient.a,t=blogScore.coefficient.b,i=blogScore.coefficient.c,n=blogScore.coefficient.d,o=blogScore.x,s=blogScore.y,a=blogScore.z,r=blogScore.w,l=o*e+s*t+a*i+r*n;$E("comp_901_score").innerHTML="<strong>"+Core.String.formatNumber(l)+"</strong>"}},noreturn:!0})},1)},loadAttention:function(){var e=this,t=new Interface("http://blogtj.sinajs.cn/api/get_attention_num.php","jsload"),i={uid:scope.$uid,suid:$isLogin?$UID:"0",attention:"suid",userpointuid:scope.$uid,s:"1"};if(this.mashAddFriend){var n=scope.$uid,o=$UID;n&&o?(i.friendattuid=n,i.friendattsuid=o):this.mashAddFriend=!1}t.request({GET:i,onSuccess:Core.Function.bind2(function(e){if(Lib.checkAuthor(),$E("comp_901_attention")){var t=Core.String.formatNumber(e.num[scope.$uid]);$E("comp_901_attention").innerHTML="<strong>"+(0>t?0:t)+"</strong>"}if(e.is_attention&&1==e.is_attention[scope.$uid]&&(this.isAttentioned=!0,$E("module_901_attention")&&($E("module_901_attention").innerHTML="已关注")),"undefined"!=typeof e.userpoint&&$E("comp_901_score")&&($E("comp_901_score").innerHTML="<strong>"+e.userpoint+"</strong>"),this.mashAddFriend){var i=[{uid:scope.$uid,status:e.friendattr}];this.friendSuccessCallback(i)}e.svr_time&&(scope.$svr_time=e.svr_time)},this),onError:function(){$E("comp_901_attention")&&($E("comp_901_attention").innerHTML="<strong>0</strong>"),e.mashAddFriend&&e.friendErrorCallback()},onFail:function(){$E("comp_901_attention")&&($E("comp_901_attention").innerHTML="<strong>0</strong>"),e.mashAddFriend&&e.friendErrorCallback()}})},loadWorldCupIcon:function(){if(1==scope.$isWorldcupUser){var e=$C("a");e.href="http://blog.2010.sina.com.cn/yunying/2010worldcup/",e.target="_blanks";var t=$C("img");t.id="comp_901_wcIcon",t.src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif",t.className="worldcup_icon worldcup_icon_l",t.alt="记录激动时刻，赢取超级大奖！快一起参加吧！",t.title="记录激动时刻，赢取超级大奖！快一起参加吧！",e.appendChild(t),$E("comp_901_head").appendChild(e)}},load7YearsIcon:function(){var e=($E("comp_901_head"),{medal0:"http://simg.sinajs.cn/blog7style/images/activity/blog7year/icon_wmm.png",medal1:"http://simg.sinajs.cn/blog7style/images/activity/blog7year/icon_xx.png",medal2:"http://simg.sinajs.cn/blog7style/images/activity/blog7year/icon_xr.png",medal3:"http://simg.sinajs.cn/blog7style/images/activity/blog7year/icon_xf.png",medal4:"http://simg.sinajs.cn/blog7style/images/activity/blog7year/icon_jy.png",medal5:"http://simg.sinajs.cn/blog7style/images/activity/blog7year/icon_fy.png?v20120917",medal6:"http://simg.sinajs.cn/blog7style/images/activity/blog7year/icon_zs.png",medal7:"http://simg.sinajs.cn/blog7style/images/activity/blog7year/icon_yl.png"}),t=scope.$private.medal7;if(t=t>7?7:t){var i=$C("a");i.setAttribute("target","_blank"),i.setAttribute("href","http://control.blog.sina.com.cn/blog_7years/index.php");var n=$C("img");n.src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif",n.className="sevenyearsIcon",$IE6?n.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+e["medal"+t]+"',sizingMethod='image')":n.style.backgroundImage="url("+e["medal"+t]+")",n.style.border="none",i.appendChild(n),$E("comp_901_head").appendChild(i)}else if(!scope.$private.medal&&$UID==scope.$uid){var i=$C("a");i.setAttribute("target","_blank"),i.setAttribute("href","http://control.blog.sina.com.cn/blog_7years/index.php");var n=$C("img");n.src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif",n.className="sevenyearsIcon",$IE6?n.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+e.medal0+"',sizingMethod='image')":n.style.backgroundImage="url("+e.medal0+")",n.style.border="none",i.appendChild(n),$E("comp_901_head").appendChild(i)}},load5YearsIcon:function(){if(!scope.$private.medal7){trace("【活动】显示用户勋章。");try{var e=["纪念勋章","一","二","三","四","五"],t=scope.$private.medal;if(t>0||0===t){var n=$C("a");n.setAttribute("target","_blank"),n.setAttribute("href","http://control.blog.sina.com.cn/blog_7years/index.php");var o=$C("img");if(o.src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif",o.className="fiveyearsIcon",$IE6?o.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='http://simg.sinajs.cn/blog7style/images/special/fiveyears/at/"+t+"y.png',sizingMethod='image')":o.style.backgroundImage="url(http://simg.sinajs.cn/blog7style/images/special/fiveyears/at/"+t+"y.png)",o.alt=t>0?e[t]+"周年勋章":e[0],o.title=t>0?e[t]+"周年勋章":e[0],o.style.border="none",n.appendChild(o),$E("comp_901_head").appendChild(n),$UID==scope.$uid){var s=$C("span"),a="updateIcon_1",r="updateIcon_2";s.className=a,n.appendChild(s);var l=0;setInterval(function(){l%2==1?(s.className=a,i=0):s.className=r,l++},500)}trace("【活动】显示用户勋章完成。")}else trace("【活动】用户还没有获得勋章。")}catch(c){trace("【活动】显示用户勋章发生异常。")}}},loadPhotoCount:function(){},loadVideoCount:function(){},loadAdManage:function(){if($isAdmin&&null!=scope.$private&&null!=scope.$private.ad&&0!=scope.$private.ad&&null==$E("comp_901_adlink")){Debug.info("添加广告共享计划管理链接");var e=['<div class="info_locate2"><div class="SG_j_linedot"/></div><div id="comp_901_adlink" class="info_AD"><a href="http://share.sass.sina.com.cn/widget_ad/widget_ad_index.php" target="_blank">管理广告共享计划</a></div>'].join(""),t=Core.Dom.getElementsByClass(this.getContent(),"div","info_txt");t&&(t=t[0].lastChild,Core.Dom.insertHTML(t,e,"BeforeBegin"))}},showVisitButton:function(){if(!$isAdmin){if($E("info_locate_id")){var e=$E("comp901_btn_invite");return e&&(e.href="javascript:void(0)",0==this.isFriend?(e.innerHTML="<cite>加好友</cite>",e.onclick=function(){return $isLogin||v7sendLog("48_01_28"),Lib.invite(scope.$uid),!1}):e.innerHTML="<cite>已是好友</cite>"),e=$E("comp901_btn_sendpaper"),e&&(e.href="javascript:void(0)",e.onclick=function(){return $isLogin||v7sendLog("48_01_27"),Lib.scrip(scope.$uid),!1}),e=$E("comp901_btn_msninfo"),e&&(e.onclick=function(){$isLogin||v7sendLog("48_01_29")},e.href="http://blog.sina.com.cn/s/profile_"+scope.$uid+".html#write"),e=$E("comp901_btn_follow"),void(e&&(this.isAttentioned?(e.innerHTML="<cite>已关注</cite>",e.onclick=function(){return Lib.Component.isAttentioned(),!1}):(e.innerHTML="<cite>加关注</cite>",e.onclick=function(){return $isLogin||v7sendLog("48_01_30"),Lib.Component.Attention(),this.innerHTML="<cite>已关注</cite>",!1})))}var t,i="";0==this.isFriend?i="Lib.invite("+scope.$uid+');return false;" class="SG_aBtn"><cite>加好友':i+="><cite>已是好友";var n=['<div id="info_locate_id" class="info_locate"><div class="SG_j_linedot"></div>','<div class="info_btn2">','<p><a href="#" onclick="'+i,"</cite></a>",'<a href="#" onclick="Lib.scrip('+scope.$uid+');return false;" class="SG_aBtn">',"<cite>发纸条</cite></a></p>",'<p><a href="http://blog.sina.com.cn/s/profile_'+scope.$uid+'.html#write" class="SG_aBtn" target="_blank">',"<cite>写留言</cite></a>",'<a id="module_901_attention" href="#" onclick="return false;" class="SG_aBtn'+(this.isAttentioned?" SG_aBtn_dis":"")+'">','<cite onclick="Lib.Component.'+(this.isAttentioned?" isAttentioned":"Attention")+'();">'+(this.isAttentioned?"已":"加")+"关注</cite></a></p>",'<div class="clearit"></div>',"</div></div>"].join("");210==this.size?(t=Core.Dom.getElementsByClass(this.getContent(),"div","info_btn1"),t&&(t=t[0],Core.Dom.insertHTML(t,n,"AfterEnd"))):(t=Core.Dom.getElementsByClass(this.getContent(),"div","info_txt"),t&&(t=t[0],Core.Dom.insertHTML(t,n,"BeforeEnd")))}}},901),$registComp(903,{load:function(){$E("atcPicList")?this.loadPicture_new():this.loadArticle()},loadArticle:function(){var e="undefined"!=typeof $tag_code?$tag_code:"";Utils.Io.Ijax.request("http://tag.blog.sina.com.cn/tag/tag_walist_v7.php",{GET:{blog_id:scope.$articleid,tag:encodeURI($tag),tag_code:e},onComplete:function(e){this.loadPicture('<div class="atcTitList relaList">'+e+"</div>")}.bind2(this),onException:function(){}})},loadPicture:function(e){var t="http://blog.sina.com.cn/lm/iframe/article/sort_"+this.articleCate[scope.$sort_id]+"_"+Math.ceil(3*Math.random())+"_v7.html";Utils.Io.Ajax.request(t,{onComplete:function(t){var i=/<ul>\s+<\/ul>/i.test(t);this.getContent().innerHTML=e.replace(/<!-- relative_pic_blog-->/,i?"":t)}.bind2(this),onException:function(){}})},loadPicture_new:function(){var e="http://blog.sina.com.cn/lm/iframe/article/sort_"+this.articleCate[scope.$sort_id]+"_"+Math.ceil(3*Math.random())+"_v7.html";Utils.Io.Ajax.request(e,{onComplete:function(e){var t=$E("atcPicList");t.innerHTML=e}.bind2(this),onException:function(){}})},articleCate:{105:"105",102:"117",104:"104",149:"149",113:"113",153:"117",111:"117",152:"122",122:"122",131:"131",127:"108",134:"149",145:"108",108:"108",130:"130",116:"116",129:"129",136:"129",125:"125",141:"108",118:"118",117:"117"}},"dymanic"),$registComp(904,{load:function(){if(Core.Dom.byClz(this.getContent(),"div","wdtLoading").length>0){var e="http://blog.sina.com.cn/main/top_new/article_sort/"+scope.$sort_id+"_day.v7.html";Utils.Io.Ajax.request(e,{onComplete:function(e){e='<div class="atcTitList relaList">'+e+"</div>",this.setContent(e)}.bind2(this),onException:function(){this.showError()}.bind2(this)})}}},"dymanic"),Core.String.shorten=function(e,t,i){return Core.String.byteLength(e)<=t?e:(i=""!=i?i||"...":"",Core.String.leftB(e,t)+i)},$registComp(909,{load:function(){$E("tj_id")&&this.showTJList($E("tj_id"))},showTJList:function(e){Utils.Io.JsLoad.request("http://blogtj.sinajs.cn/api/tj/get_tj_article_info.php",{GET:{uid:scope.$uid},onComplete:function(t){var i='<li><p><span class="SG_dot"></span><a href="#{href}" target="_blank">#{content}</a></p><div class="w_list SG_txtc"><a href="#{srcHref}" target="_blank">#{src}</a></div></li>',n="",o=t.data,s=t.data.length>5?5:t.data.length;if(0===s)return void(e.innerHTML='<li class="no_text">暂无被推荐博文</li>');for(var a=0;s>a;a++){var r={};r.href="http://blog.sina.com.cn/s/blog_"+o[a].blog_id+".html?tj=1",r.content=Core.String.byteLength(o[a].blog_title)>26?Core.String.shorten(o[a].blog_title,26,"…"):o[a].blog_title,r.content=Core.String.encodeHTML(r.content),r.srcHref=o[a].tj_chanel_id_url,r.src=o[a].tj_chanel_id_str;var l=new Ui.Template(i).evaluate(r);n+=l}e.innerHTML=n}.bind2(this),onException:function(){this.showError()}.bind2(this)})}},"dymanic"),Core.String.toInt=function(e,t){return parseInt(e,t)},Core.String.a2u=function(e){return e.replace(/\\u[\da-fA-F]{4}/gi,function(e){return e=Core.String.toInt(e.substr(2),16),String.fromCharCode(e)})},Lib.register("util.cutNickName",function(){return function(e,t,i){var n=Core.String.byteLength,o=Core.String.leftB;return i=i||6,t>=0&&8>t?n(e)>i?o(e,i-2)+"…":o(e,i):n(e)>i+2?o(e,i)+"…":o(e,i+2)}}),$registComp("12",{Interface:new Interface("http://footprint.cws.api.sina.com.cn/list.php","jsload"),PromoteUserBlogInterface:new Interface("http://control.blog.sina.com.cn/riaapi/profile/AdTaskTools.php","jsload"),isDisabled:function(){var e=$_GLOBAL.disableVisitor;return e&&e.indexOf("|"+this.requestParam.uid+"|")>-1?(this.showDisabled(),!0):!1},_getMessage:function(e){e||(e={});var t=Lib.blogv.getVHTML,i=Lib.util.cutNickName;this.Interface.request({GET:this.requestParam,onSuccess:Core.Function.bind2(function(n){Core.Array.foreach(n.record,Core.Function.bind2(function(o){o.vString=this.formatTime(o.vtime,n.stime);var s=Core.String.a2u(o.name);isNaN(o.wtype)&&(o.wtype=-1),o.wtype=parseInt(o.wtype,10),o.shortName=i(s,o.wtype),e[o.uid]&&(o.isPromote=!0),o.userV=t(o.wtype),o.shortName=Core.String.encodeHTML(o.shortName)},this)),this.cacheData=n.record,this.total=n.total,this["render_"+this.size](this.cacheData),e=null},this),onError:Core.Function.bind2(function(e){this.showError($SYSMSG[e.code])},this),onFail:Core.Function.bind2(function(){this.showError($SYSMSG.A80101)},this)})},load:function(){if(null==this.requestParam)this.show("请提供访客组件的接口参数");else{if(Lib.checkAuthor(),$isLogin||(this.requestParam.varname="requestId_visitor_list"),scope.unreadMsg&&0==scope.unreadMsg.foot&&(this.requestParam.add=1),this.isDisabled())return;var e=this;e._getMessage({1259295385:!0})}},formatTime:function(e,t){var i="",n=new Date(1e3*t),o=new Date(1e3*e);if(n.getFullYear()==o.getFullYear()&&n.getMonth()==o.getMonth()&&n.getDate()==o.getDate()){var s=Math.max(0,t-e);if(Debug.warning("diffTime : "+s),3600>s)i=Math.ceil(s/60)+"分钟前";else{var a=new Date(1e3*e);i=("今天0"+a.getHours()+":0"+a.getMinutes()).replace(/(\d{3,3})/g,function(e,t){return t.substr(1)})}}else{var r=new Date(1e3*e);i=r.getMonth()+1+"月"+r.getDate()+"日"}return i},reload:function(e,t,i){var n=null==e||e&&(210==e||510==e||730==e);return n?(this.size=e||this.size,this.getContent().innerHTML='<div class="wdtLoading"><img src="http://simg.sinajs.cn/blog7style/images/common/loading.gif" />加载中…</div>',void(1==i||null==this.cacheData?this.load():this["render_"+this.size]())):void Debug.error("请检查传入的组件尺寸是否正确。"+e)}},"dynamic"),Lib.deleteVisitByUid=function(e,t,i,n){if(Lib.checkAuthor(),!$isLogin){var o=new Lib.Login.Ui;return void o.login(Core.Function.bind3(Lib.deleteWallByMsgid,null,arguments))}Debug.log("删除访客："+e);var s="";if($isAdmin)s=$SYSMSG.A80203;else{if(!$isLogin)return!0;s=$SYSMSG.A80201}winDialog.confirm(s,{funcOk:function(){var o=new Interface("http://footprint.cws.api.sina.com.cn/del.php","jsload"),s={pid:t,uid:scope.$uid,deleteuid:e};null!=n&&(s.subid=n),$E("comp_12_deleteToBlack")&&1==$E("comp_12_deleteToBlack").checked&&(s.inblack=1),o.request({GET:s,onSuccess:function(){i?i(null,null,!0):(Debug.log("Reload page"),window.location.reload())}})},subText:$isAdmin?$SYSMSG.A80204:$SYSMSG.A80202,textOk:"是",textCancel:"否",icon:"04"})
},$SYSMSG.extend({B80001:"暂无访客",B80002:"暂无留言",B80003:"暂无博客评论",B80004:"暂无好友",B80005:"暂无图片专辑",B80006:"暂无视频",B80007:"暂无归档博文",B80101:"你确定删除此评论吗？<br/>删除后不可恢复",B80102:"你确定删除此留言吗？<br/>删除后不可恢复",B80103:['<ul class="CP_w_part SG_txtb"><li><input type="checkbox" id="comp_2_deleteToBlack" class="CP_w_fm1" /><label for="comp_2_deleteToBlack" >将此人加入黑名单</label></li></ul>'].join(""),A00101:'<div class="SG_nodata">留言板非公开</div>',B36023:"对不起，黑名单已达到上限"}),scope.getPromoteURL=function(e){var t="http://blog.sina.com.cn/u/"+e.uid,i="http://sina.allyes.com/main/adfclick?db=sina&bid=204720,290418,295665&cid=0,0,0&sid=288937&advid=358&camid=37389&show=ignore";if(e.isPromote&&(t=i+($UID?"&kv={0}|99999&url={1}".format($UID,t):"&url={0}".format(t))),1259295385==e.uid){var n="http://blog.sina.com.cn/u/"+e.uid;t="http://sina.allyes.com/main/adfclick?db=sina&bid=204720,256856,261931&cid=0,0,0&sid=253209&advid=358&camid=37389&show=ignore&url="+n}return t},$registComp(12,{requestParam:{uid:scope.$uid,pagesize:"18",pid:1},html:['<div class="ptCell">','<p class="pt_img"><a id="linkVisited_#{uid}" href="#{uhref}" target="_blank" ',"onmouseover=\"if(this.parentNode.lastChild.className=='del'){this.parentNode.lastChild.style.display='';}\" ","onmouseout=\"if(this.parentNode.lastChild.className=='del'){this.parentNode.lastChild.style.display='none';}\" ><img",' src="#{icon}" width="50" height="50" alt="#{name}" title="#{name}" /></a>',"#{update}#{manage}</p>",'<p class="pt_nm"><a href="#{uhref}"" target="_blank" title="#{name}">#{shortName}</a>#{userV}</p>','<p class="pt_tm SG_txtc">#{vString}</p>',"</div>"].join(""),render_210:function(e){e=e||this.cacheData,e=e.slice(0,12),this.parseToHTML(e)},render_510:function(e){e=e||this.cacheData,e=e.slice(0,12),this.parseToHTML(e)},render_730:function(e){e=e||this.cacheData,this.parseToHTML(e)},parseToHTML:function(e){if(0==e.length)this.showEmpty();else{Lib.checkAuthor(),Core.Array.foreach(e,Core.Function.bind2(function(e){e.manage=$isAdmin||$isLogin&&e.uid==$UID?'<span class="del" style="display: none;" onmouseover="this.style.display = \'\';" onmouseout="this.style.display = \'none\';"><img class="SG_icon SG_icon6" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" title="删除访问记录" onclick="Lib.deleteVisitByUid(\''+e.uid+"', 1, Core.Function.bind2(Lib.Component.instances["+this.compId+"].reload, Lib.Component.instances["+this.compId+"])"+(null==scope.$articleid?"":",'"+scope.$articleid+"'")+');return false;" align="absmiddle" /></span>':"",e.update=1==e.utime?'<span class="new"><img class="SG_icon SG_icon7" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" title="有内容更新，赶快去看一下" align="absmiddle" /></span>':"",e.uhref=scope.getPromoteURL(e)},this));var t=new Ui.Template(this.html),i='<div class="ptList visitorList">'+t.evaluateMulti(e)+"</div>";i+="indexM"!=scope.$pageid&&"pageSetM"!=scope.$pageid||1!=$isAdmin||!(this.size<730&&this.total>12||730==this.size&&this.total>18)?'<div class="moreLink" style="padding-top:0;"></div>':'<div class="moreLink SG_j_linedot1"><span class="SG_more"><a href="http://control.blog.sina.com.cn/blogprofile/visitor.php?showtype=1" target="_blank">更多</a>&gt;&gt;</span></div>',this.show(i);var n="1062753310",o=$E("linkVisited_"+n);o&&(o.href="http://sina.allyes.com/main/adfclick?db=sina&bid=204720,256856,261931&cid=0,0,0&sid=253209&advid=358&camid=37389&show=ignore&url=http://blog.sina.com.cn/u/"+n)}"pageSetM"==scope.$pageid&&this.setManage&&this.setManage()},showEmpty:function(){this.setContent('<div class="SG_nodata">'+$SYSMSG.B80001+"</div>")},showDisabled:function(){var e="尊敬的用户您好，为了给大家提供更好的服务，近期访客组件进行升级维护，维护过程中将影响部分用户无法正常浏览，给您带来不便敬请谅解！感谢您对新浪博客一直以来的支持！";this.setContent('<div class="SG_nodata" style="padding-left:1.5em; padding-right:1.5em; text-indent:2em; text-align:left">'+e+"</div>")},setManage:function(){$isAdmin&&this.getManage()&&(this.getManage().innerHTML='<span class="move"><a href="#" onclick="funcMoveUpDown.up('+this.compId+');return false;">↑</a><a href="#" onclick="funcMoveUpDown.down('+this.compId+');return false;">↓</a></span><a href="#" onclick="hiddenComponents(\''+this.compId+'\');return false;" class="CP_a_fuc">[<cite>隐藏</cite>]</a>')}},12),$registComp(47,{requestParam:{uid:scope.$uid,pagesize:"12",pid:1,subid:scope.$articleid}},12),$registComp(102,{load:function(){trace("comp_1023"),this.loadArticle()},loadArticle:function(){Utils.Io.JsLoad.request("http://control.blog.sina.com.cn/riaapi/photoblog/get_hotblog_list.php",{GET:{uid:scope.$uid,version:7},onComplete:function(e){trace("---------------code:"+e.code);for(var t=['<div class="photoBlog">'],i=e,n=i.data,o=0,s=n.length;s>o;o++){var a=n[o].tj?n[o].tj:"";t.push('<div class="photoBlog_cell"><div class="photoBlog_view"><table><tr><td><a href="'),t.push(n[o].blogurl),t.push('" target="_blank"><img class="borderc" src="'),t.push(n[o].picurl),t.push('" alt="'),t.push(n[o].title),t.push('" title="'),t.push(n[o].title),t.push('"/></a></td></tr></table></div><p class="photoBlog_nm">'),t.push(a),t.push('<a href="'),t.push(n[o].blogurl),t.push('" target="_blank">'),t.push(n[o].title),t.push("</a></p><p>阅读("),t.push(n[o].hitsnum),t.push(") 评论("),t.push(n[o].commentnum),t.push(")</p></div>")}t.push("</div>"),this.getContent().innerHTML=t.join("")}.bind2(this),onException:function(){trace("connect error")}})},tpl:'<div class="photoBlog_cell"><div class="photoBlog_view"><table><tr><td><a href="{0}" target="_blank"><img class="borderc" src="{5}" alt="{7}" title="{7}"/></a></td></tr></table></div><p class="photoBlog_nm">{6}<a href="{0}" target="_blank">{1}</a> <span class="count">({2}张)</span></p><p>阅读({3}) 评论({4})</p></div>'},"dymanic");var DialogManager={dialogs:[],activeDialog:{},backShadow:null,create:function(e,t){var i=this,n=new Dialog(e);return this.dialogs.push(n),this.activeDialog=n,n.name=t||n.getUniqueID(),n.entity.style.zIndex=1024,n.onDrag=function(){$IE6?this.getProperty().isFixed&&this.setPosition({x:parseInt(this.entity.style.left)-document.documentElement.scrollLeft,y:parseInt(this.entity.style.top)-document.documentElement.scrollTop}):this.getProperty().isFixed&&this.setPosition({x:parseInt(this.entity.style.left),y:parseInt(this.entity.style.top)})},n.onClose=function(){i.removeDialog(this.name),i.updateActiveDialog(),i.updateShadow(),i.activeDialog&&i.activeDialog.setFocus()},n.onHidden=function(){this.isHidden=!0,this==i.activeDialog&&(i.activeDialog=null),i.updateActiveDialog(),i.updateShadow(),i.activeDialog&&i.activeDialog.setFocus()},n.onShow=function(){if(this.isHidden){this.isHidden=!1;var e,t=i.dialogs.length;for(e=0;t>e;e++)i.dialogs[e]==this&&(document.body.appendChild(i.dialogs[e].entity),i.dialogs.push(i.dialogs[e]),i.dialogs.splice(e,1));i.activeDialog=this,i.backShadow.show(),i.updateShadow()}},this.backShadow.isShow?this.updateShadow():this.backShadow.show(),n.hidden(),n},getDialog:function(e){var t=0,i=this.dialogs.length;for(t=0;i>t;t++)if(this.dialogs[t].name==e)return this.dialogs[t]},removeDialog:function(e){var t=0,i=this.dialogs.length;for(t=i-1;t>=0;t--)if(this.dialogs[t].name==e){this.dialogs.splice(t,1),this.activeDialog=this.dialogs[this.dialogs.length-1];break}},updateActiveDialog:function(){var e,t=this.dialogs.length;for(e=t-1;e>=0;e--)if(!this.dialogs[e].isHidden){this.activeDialog=this.dialogs[e];break}},updateShadow:function(){this.activeDialog&&!this.activeDialog.isHidden?(this.backShadow.insertBefore(this.activeDialog.entity),this.activeDialog.updateFixed()):this.backShadow.hidden()},close:function(e){if(!e)return void(this.activeDialog&&this.activeDialog.close());var t,i=this.dialogs.length;for(t=i-1;t>=0;t--)if(this.dialogs[t].name==e){this.dialogs[t].close();break}}},BackShadow=function(e){this.entity=null,this.isShow=!1,this._ie6Fixed=function(){t.entity&&(t.entity.style.top=document.documentElement.scrollTop+"px",t.entity.style.left=document.documentElement.scrollLeft+"px",t.ifm&&(t.ifm.style.top=t.entity.style.top,t.ifm.style.left=t.entity.style.left),t.updateSize())};var t=this;!function(){t.entity=$C("div"),t.entity.style.position="absolute",t.entity.style.width=t.getAreaWidth()+"px",t.entity.style.height=t.getAreaHeight()+"px",t.entity.style.left="0px",t.entity.style.top="0px",t.entity.style.zIndex=1024,t.entity.style.backgroundColor="black",document.body.appendChild(t.entity),t._setOpacity(t.entity,isNaN(e)?.5:e),$IE6&&(t.entity.style.top=document.documentElement.scrollTop+"px",t.addIframe()),Core.Events.addEvent(window,function(){t.entity&&($IE6&&t.isShow&&(document.documentElement.scrollLeft=0,t._ie6Fixed()),setTimeout(function(){t.updateSize()},1))},"resize"),t.setFixed(!0),t.hidden()}()};BackShadow.prototype={show:function(){this.entity.style.display="",this.ifm&&(this.ifm.style.display=""),this.isShow=!0,this.onShow()},hidden:function(){this.entity.style.display="none",this.ifm&&(this.ifm.style.display="none"),this.isShow=!1,this.onHidden()},close:function(){this.hidden(),this.destroy()},destroy:function(){Core.Events.removeEvent(window,this._ie6Fixed,"scroll"),this.entity.parentNode.removeChild(this.entity),this.entity=null,this.ifm&&(this.ifm.parentNode.removeChild(this.ifm),this.ifm=null)},addIframe:function(){this.ifm=$C("iframe"),this._setOpacity(this.ifm,0),this.ifm.style.position="absolute",this.ifm.style.zIndex=this.entity.style.zIndex,this.ifm.style.left=this.entity.style.left,this.ifm.style.top=this.entity.style.top,this.ifm.style.width=this.entity.style.width,this.ifm.style.height=this.entity.style.height,document.body.insertBefore(this.ifm,this.entity)},insertBefore:function(e){document.body.insertBefore(this.entity,e),this.ifm&&document.body.insertBefore(this.ifm,this.entity)},updateSize:function(){this.entity.style.width=this.getAreaWidth()+"px",this.entity.style.height=this.getAreaHeight()+"px",this.ifm&&(this.ifm.style.width=this.getAreaWidth()+"px",this.ifm.style.height=this.getAreaHeight()+"px")},getAreaHeight:function(){return document.documentElement.clientHeight},getAreaWidth:function(){return document.documentElement.clientWidth},setFixed:function(e){if($IE6){var t=this;e?(t._ie6Fixed(),Core.Events.addEvent(window,t._ie6Fixed,"scroll")):Core.Events.removeEvent(window,t._ie6Fixed,"scroll")}else this.entity.style.position=e?"fixed":"absolute"},_setOpacity:function(e,t){$IE&&9>=$IE?e.style.filter="alpha(opacity="+100*t+")":e.style.opacity=t},onShow:function(){},onHidden:function(){}},CustomsDialog.prototype={isSetMiddle:!1,setContent:function(e){var t=e;this.templateString=t.match(this.nodesPattern);var i=new Ui.Template(t);this.nodes.content.innerHTML=i.evaluate(this.getContentNodes("i")),this.updateNodes()},setTitle:function(e){this.nodes.titleName&&(this.nodes.titleName.innerHTML=e)},setHelp:function(e){this.nodes.btnHelp&&(e?this.nodes.btnHelp.href=e:this.nodes.btnHelp.innerHTML="")},setClose:function(e){var t=this;if(t.nodes.btnClose)switch(e=e||"hidden"){case"hidden":Core.Events.addEvent(t.nodes.btnClose,t._hiddenDialog,"click");break;case"close":Core.Events.addEvent(t.nodes.btnClose,t._closeDialog,"click")}},setPosition:function(e,t){this._dialog.setPosition({x:e,y:t})},setMiddle:function(){var e,t,i=Core.System.winSize(),n=this._dialog.entity.style.display;this._dialog.setPosition({x:-1e4}),this._dialog.entity.style.display="";var o=this.nodes.titleBar?this.nodes.titleBar.offsetHeight:0,s=i.height-this.nodes.content.offsetHeight-o,a=(Math.sqrt(5)-1)/2,r=1,l=s*a/(a+r);e=i.width/2-this.nodes.content.offsetWidth/2,e=0>e?0:e,t=0>l?0:l,this._dialog.getProperty().isFixed||(e+=Math.max(document.documentElement.scrollLeft,document.body.scrollLeft),t+=Math.max(document.documentElement.scrollTop,document.body.scrollTop)),this._dialog.entity.style.display=n,this._dialog.setPosition({x:e,y:t}),this.isSetMiddle=!0},setSize:function(e,t){this._dialog.setSize({width:e,height:t})},setFixed:function(e){this._dialog.setFixed(e)},setAreaLocked:function(e){this._dialog.setAreaLocked(e)},setFocusNode:function(e){this._dialog.getProperty().focusNode=e},setDisplayMode:function(e){this._dialog.getProperty().displayMode=e||"normal"},getWidth:function(){return this._dialog.getProperty().width},getHeight:function(){return this._dialog.getProperty().height},getX:function(){return this._dialog.getProperty().x},getY:function(){return this._dialog.getProperty().y},show:function(){this.isSetMiddle&&this.setMiddle(),this._dialog.show(),this.onShow()},hidden:function(){this._dialog.hidden(),this.onHidden()},close:function(){var e=this;e._dialog.close(),e.onClose(),e.nodes.btnClose&&(Core.Events.removeEvent(e.nodes.btnClose,e._hiddenDialog,"click"),Core.Events.removeEvent(e.nodes.btnClose,e._CloseDialog,"click"))},updateNodes:function(){this.nodes=this._dialog.getNodes();var e=this.getContentNodes();for(k in e)this.nodes[k]=e[k]},getContentNodes:function(e){var t,i=e||"o",n={},o=this.templateString;if(o)for(t=0;t<o.length;t++){var s=o[t];switch(i){case"o":n[s]=$E(this.nodes.content.id+"_"+s);break;case"i":n[s]=this.nodes.content.id+"_"+s}}return n},setOnDisplaied:function(e){this._dialog.onDisplaied=e},setOnDisplayFinished:function(e){this._dialog.onDisplayFinished=e},onDrag:function(){},onShow:function(){},onHidden:function(){},onClose:function(){}};var LayerTemplate={alert:'<table id="#{entity}"  class="gModLy"><thead id="#{titleBar}"><tr><td class="tbgleft"><div></div></td><td class="tdmain"><div class="gModLyHeader"><div class="gFl"><div class="gML_tit"><strong id="#{titleName}"></strong></div></div><div class="gFr"><ul><li><a href="javascript:;" id="#{btnClose}" class="iconClose"></a></li><li><a href="#" class="help" >帮助</a></li></ul></div></div></td><td class="tbgright"><div></div></td></tr></thead><tfoot><tr><td class="tbgleft"><div></div></td><td class="tdmain"></td><td class="tbgright"><div></div></td></tr></tfoot><tbody><tr><td class="tbgleft"><div></div></td><td class="tdmain" id="layer_2"><div id="#{content}" class="gModLyCont"><!-- 内容区域 --><div class="gDialogDoc"><div class="diaBd"><div class="gDiaC1"><img id="#{icon}" width="50" height="50" class="" src="http://simg.sinajs.cn/tiezi/images/icon/icon.gif" alt=""/></div><div class="gDiaC2"><h5 id="#{text}"></h5><div id="#{subText}"></div><p/></div></div><div class="btnRow"><a class="gBtnb gBtnbClr" id="#{linkOk}" href="javascript:;"><cite id="#{btnOk}"><em id="#{ok}"></em></cite></a></div></div><!-- 内容区域 --></div></td><td class="tbgright"><div></div></td></tr></tbody></table>',confirm:'<table id="#{entity}"  class="gModLy"><thead id="#{titleBar}"><tr><td class="tbgleft"><div></div></td><td class="tdmain"><div class="gModLyHeader"><div class="gFl"><div class="gML_tit"><strong id="#{titleName}"></strong></div></div><div class="gFr"><ul><li><a href="javascript:;" id="#{btnClose}" class="iconClose"></a></li><li><a href="#" class="help" >帮助</a></li></ul></div></div></td><td class="tbgright"><div></div></td></tr></thead><tfoot><tr><td class="tbgleft"><div></div></td><td class="tdmain"></td><td class="tbgright"><div></div></td></tr></tfoot><tbody><tr><td class="tbgleft"><div></div></td><td class="tdmain" id="layer_2"><div id="#{content}" class="gModLyCont"><!-- 内容开始 --><div class="gDialogDoc"><div class="diaBd"><div class="gDiaC1"><img id="#{icon}" width="50" height="50" class="" src="http://simg.sinajs.cn/tiezi/images/icon/icon.gif" alt=""/></div><div class="gDiaC2"><h5 id="#{text}"></h5><div id="#{subText}"></div><p/></div></div><div class="btnRow"><a class="gBtnb gBtnbClr" id="#{linkOk}" href="javascript:;"><cite id="#{btnOk}"><em id="#{ok}"></em></cite></a><a class="gBtnb gBtnbClr" id="#{linkCancel}" href="javascript:;"><cite id="#{btnCancel}"><em id="#{cancel}"></em></cite></a></div></div><!-- 内容结束 --></div></td><td class="tbgright"><div></div></td></tr></tbody></table>',iframe:'<table id="#{entity}"  class="gModLy"><thead id="#{titleBar}"><tr><td class="tbgleft"><div></div></td><td class="tdmain"><div class="gModLyHeader"><div class="gFl"><div class="gML_tit"><strong id="#{titleName}"></strong></div></div><div class="gFr"><ul><li><a href="javascript:;" id="#{btnClose}" class="iconClose"></a></li><li><a href="#" class="help" >帮助</a></li></ul></div></div></td><td class="tbgright"><div></div></td></tr></thead><tfoot><tr><td class="tbgleft"><div></div></td><td class="tdmain"></td><td class="tbgright"><div></div></td></tr></tfoot><tbody><tr><td class="tbgleft"><div></div></td><td class="tdmain" id="layer_2"><div id="#{content}" class="gModLyCont"><div id="#{loadState}">Loading...</div><iframe style="width:100%;height:500px;" id="#{iframe}" src="#{iframeURL}"></iframe></div></td><td class="tbgright"><div></div></td></tr></tbody></table>',customs:'<table id="#{entity}"  class="gModLy"><thead id="#{titleBar}"><tr><td class="tbgleft"><div></div></td><td class="tdmain"><div class="gModLyHeader"><div class="gFl"><div class="gML_tit"><strong id="#{titleName}"></strong></div></div><div class="gFr"><ul><li><a href="javascript:;" id="#{btnClose}" class="iconClose"></a></li><li><a href="#" class="help" >帮助</a></li></ul></div></div></td><td class="tbgright"><div></div></td></tr></thead><tfoot><tr><td class="tbgleft"><div></div></td><td class="tdmain"></td><td class="tbgright"><div></div></td></tr></tfoot><tbody><tr><td class="tbgleft"><div></div></td><td class="tdmain" id="layer_2"><div id="#{content}" class="gModLyCont"><!-- 内容区域 --><!-- 内容区域 --></div></td><td class="tbgright"><div></div></td></tr></tbody></table>'};!function(){var e=function(e,t){this.template=t||{},DialogManager.backShadow=e};e.prototype={iconSet:{"01":{"class":"SG_icon SG_icon201",alt:"警告"},"02":{"class":"SG_icon SG_icon202",alt:"失败"},"03":{"class":"SG_icon SG_icon203",alt:"成功"},"04":{"class":"SG_icon SG_icon204",alt:"询问"},"06":{"class":"SG_icon SG_icon148",alt:"警告"}},alert:function(e,t,i){t=t||{};var n=DialogManager.create(t.template||this.template.alert||LayerTemplate.alert,i),o=(Core.System.winSize(),n.getNodes());n.onDisplaied=t.funcDisplaied,n.onDisplayFinished=t.funcDisplayFinished,n.setSize({width:t.width,height:t.height}),n.setFixed(!0),this._setDialogMiddle(n),n.show(),n.setAreaLocked(!0),o.linkOk.focus(),o.text.innerHTML=e,o.titleName&&(o.titleName.innerHTML=t.title||"提示"),o.icon&&(o.icon.className=t.icon?this.iconSet[t.icon]["class"]:this.iconSet["01"]["class"],o.icon.alt=t.icon?this.iconSet[t.icon].alt:this.iconSet["01"].alt),o.ok.innerHTML=t.textOk||"确定",o.subText&&(o.subText.innerHTML=t.subText||""),n.getProperty().focusNode=o.linkOk,Core.Events.addEvent(o.btnOk,function(){return t.funcOk&&n.getProperty().enabled&&(t.funcOk(),Core.Events.stopEvent()),n.close(),!1},"click"),Core.Events.addEvent(o.linkOk,function(){var e=Core.Events.getEvent();"13"==e.keyCode&&(t.funcOk&&n.getProperty().enabled&&t.funcOk(),n.close())},"keydown"),Core.Events.addEvent(o.btnClose,function(){t.funcClose&&n.getProperty().enabled&&t.funcClose(),n.close()},"click"),Core.Events.addEvent(o.btnClose,function(){var e=Core.Events.getEvent();e.cancelBubble=!0},"mousedown")},newAlert:function(e,t,i){t.template=this.template.newAlert,this.alert(e,t,i)},confirm:function(e,t,i){t=t||{};var n=DialogManager.create(t.template||this.template.confirm||LayerTemplate.confirm,i),o=(Core.System.winSize(),n.getNodes());n.onDisplaied=t.funcDisplaied,n.onDisplayFinished=t.funcDisplayFinished,n.setSize({width:t.width,height:t.height}),n.setFixed(!0),this._setDialogMiddle(n),n.show(),n.setAreaLocked(!0),0==t.defaultButton?(o.linkCancel.focus(),n.getProperty().focusNode=o.linkCancel):(o.linkOk.focus(),n.getProperty().focusNode=o.linkOk),o.text.innerHTML=e,o.titleName&&(o.titleName.innerHTML=t.title||"提示"),o.icon&&(o.icon.className=t.icon?this.iconSet[t.icon]["class"]:this.iconSet["04"]["class"],o.icon.alt=t.icon?this.iconSet[t.icon].alt:this.iconSet["04"].alt),o.ok.innerHTML=t.textOk||"确定",o.cancel.innerHTML=t.textCancel||"取消",o.subText&&(o.subText.innerHTML=t.subText||""),Core.Events.addEvent(o.btnOk,function(){return t.funcOk&&n.getProperty().enabled&&(t.funcOk(),Core.Events.stopEvent()),n.close(),!1},"click"),Core.Events.addEvent(o.linkOk,function(){var e=Core.Events.getEvent();"13"==e.keyCode&&(t.funcOk&&n.getProperty().enabled&&t.funcOk(),n.close())},"keydown"),Core.Events.addEvent(o.btnCancel,function(){return t.funcCancel&&n.getProperty().enabled&&(t.funcCancel(),Core.Events.stopEvent()),n.close(),!1},"click"),Core.Events.addEvent(o.linkCancel,function(){var e=Core.Events.getEvent();"13"==e.keyCode&&(t.funcCancel&&n.getProperty().enabled&&t.funcCancel(),n.close())},"keydown"),Core.Events.addEvent(o.btnClose,function(){return t.funcClose&&n.getProperty().enabled&&(t.funcClose(),Core.Events.stopEvent()),n.close(),!1},"click"),Core.Events.addEvent(o.btnClose,function(){var e=Core.Events.getEvent();e.cancelBubble=!0},"mousedown")},newConform:function(e,t,i){t.template=this.template.newConfirm,this.confirm(e,t,i)},showIframe:function(e,t){e=e||{};var i=DialogManager.create(this.template.iframe||LayerTemplate.iframe,t),n=Core.System.winSize(),o=i.getNodes();i.setSize({width:e.width||320,height:e.height||150});var s=n.width/2-i.getProperty().width/2<0?0:n.width/2-i.getProperty().width/2,a=n.height/2-i.getProperty().height/2<0?0:n.height/2-i.getProperty().height/2;i.setPosition(e.fixed?{x:s,y:a}:{x:s+document.documentElement.scrollLeft,y:a+document.documentElement.scrollTop}),$IE6||(i.getProperty().displayMode="alpha"),i.setFixed(!!e.fixed),i.show(),i.setAreaLocked(!0),o.titleName.innerHTML=e.title||"",o.iframe.src=e.url||"about:blank",Core.Events.addEvent(o.iframe,function(){o.iframe.style.display="",o.loadState.style.display="none"},"load"),Core.Events.addEvent(o.btnClose,function(){i.close()},"click"),Core.Events.addEvent(o.btnClose,function(){var e=Core.Events.getEvent();e.cancelBubble=!0},"mousedown")},createCustomsDialog:function(e,t){e=e||{};var i=new CustomsDialog(e.tpl||this.template.customs||LayerTemplate.customs,t);return e.content&&i.setContent(e.content),i.setTitle(e.title||"提示"),i.setHelp(e.help||""),i.setClose("hidden"),i.setOnDisplaied(e.funcDisplaied),i.setOnDisplayFinished(e.funcDisplayFinished),i},getDialog:function(e){return DialogManager.getDialog(e)},close:function(e){DialogManager.close(e)},_setDialogMiddle:function(e){var t,i,n=Core.System.winSize(),o=e.getNodes(),s=e.entity.style.display;e.setPosition({x:-1e4}),e.entity.style.display="";var a=o.titleBar?o.titleBar.offsetHeight:0,r=n.height-o.content.offsetHeight-a,l=(Math.sqrt(5)-1)/2,c=1,d=r*l/(l+c);t=n.width/2-o.content.offsetWidth/2,t=0>t?0:t,i=0>d?0:d,e.getProperty().isFixed||(t+=document.documentElement.scrollLeft,i+=document.documentElement.scrollTop),e.entity.style.display=s,e.setPosition({x:t,y:i})}},Sina.Ui.WindowDialog=e}(),Core.String.expand=function(e){var t=e.replace(/([\u00ff-\ufffe])/gi,"￿$1");return t},Core.String.collapse=function(e){return e.replace(/\uffff/gi,"")},scope.searchFilm=function(e){var t=$E("loginBarSearchForm"),i=t.action,n=$E("loginBarSearchT"),o=$E("loginBarSearchS"),s=($E("loginBarSearchTS"),$E("loginBarSearchType")),a=$E("loginBarSearchSType"),r=$E("loginBarSearchInput"),l={url:i,loginBarSearchT:n.value,loginBarSearchS:o.value,loginBarSearchS:o.value,loginBarSearchType:s.value,loginBarSearchSType:a.value,loginBarSearchInput:r.value};r.value="影评 "+e,n.value="blog",a.value="tag",t.action="http://uni.sina.com.cn/c.php",t.submit(),t.action=l.url,n.value=l.loginBarSearchT,o.value=l.loginBarSearchS,o.value=l.loginBarSearchS,s.value=l.loginBarSearchType,a.value=l.loginBarSearchSType,r.value=l.loginBarSearchInput},$registComp(122,{getLatestComm:new Interface("http://control.blog.sina.com.cn/riaapi/film/get_latest_filmcomment.php","jsload"),load:function(){this.getLatestComm.request({onSuccess:Core.Function.bind2(function(e){trace("---------ok----------"),this.cacheData=e,this.toHTML(this.cacheData)},this),onError:Core.Function.bind2(function(e){trace("---------error----------"),this.showError(e.code)},this),onFail:Core.Function.bind2(function(){this.showError($SYSMSG.A80101)},this)})},toHTML:function(e){function t(e,t){var i=Core.String.expand(e);return i.length>t&&(i=i.substr(0,t)),i=Core.String.collapse(i)}if(0==e.length)return void this.handleEmpty();for(var i=12,n=0,o=e.length;o>n;n++){var s=e[n].filmname;e[n].filmname_limit=s;for(var a=0,r=e[n].comment.length;r>a;a++)e[n].comment[a].title_limit=t(e[n].comment[a].title,i);e[n].num=Core.String.formatNumber(e[n].num)}for(var l="",c=0,d=e.length;d>c;c++){var h=2==e[c].type?"movie":"tv",p="http://data.ent.sina.com.cn/"+h+"/"+e[c].filmid+".html",s=e[c].filmname,u=(e[c].filmname_limit,e[c].imgurl),g=e[c].num;l+=['<li class="cur">','<a href="'+p+'" target="_blank" title="'+s+'"><img alt="'+s+'" src="'+u+'"></a>','<p>共<strong><a href="javascript:void(0);" onclick="scope.searchFilm(\''+s+"')\">"+g+"</a></strong>篇</p>","<ul>"].join("");for(var m=0,f=e[c].comment.length;f>m;m++)l+='<li><a title="'+e[c].comment[m].title+'" href="'+e[c].comment[m].url+'" target="_blank">'+e[c].comment[m].title_limit+"</a></li>";var v=c==d-1?"":'<div class="SG_j_linedot"></div>';l+=["</ul>",v,'<div class="clearit"></div>',"</li>"].join("")}var _=['<div class="hotmovies">',"<ul>",l,"</ul>",'</div><div class="clearit"></div>'].join("");this.setContent(_)},handleEmpty:function(){trace("没有最新影评数据");var e=['<div class="SG_nodata">',"<p>还没有影评。</p>","</div>"].join("");this.setContent(e)}},"dynamic"),Lib.Component.renderByList=function(e){Core.Array.foreach(e,function(e){try{if(null!=$E("module_"+e)){var t=Lib.Component.instances[e]||new Lib.Component["Comp_"+e](e);if(null!=t.size&&null!=t.load){t.size=Lib.Component.compSize[e];try{t.load()}catch(i){}Debug.log("组件："+e+" 初始化成功")}else Debug.error("组件："+e+" 初始化失败，组件尺寸信息不存在")}else Debug.error("组件："+e+" 初始化失败，页面内缺少组件的HTML节点")}catch(i){Debug.error(i.message||"组件："+e+" 初始化失败，请确认该组件类是否定义过")}finally{}})},Lib.Component.lazyRenderByList=function(e){var t=[];Core.Array.foreach(e,function(e){try{if(null!=$E("module_"+e)){var i=Lib.Component.instances[e]||new Lib.Component["Comp_"+e](e);if(null!=i.size&&null!=i.load){i.size=Lib.Component.compSize[e];try{t.push({dom:$E("module_"+e),callback:Lib.Component.instances[e].load.bind2(Lib.Component.instances[e])})}catch(n){}Debug.log("组件："+e+" 初始化成功")}else Debug.error("组件："+e+" 初始化失败，组件尺寸信息不存在")}else Debug.error("组件："+e+" 初始化失败，页面内缺少组件的HTML节点")}catch(n){Debug.error(n.message||"组件："+e+" 初始化失败，请确认该组件类是否定义过")}finally{}}),Lib.LazyLoad(t,{})},$registJob("articleComp1",function(){var e=[901,102,122];return null==Lib.Component.getInitCompSize()?void Debug.error("无法获得页面内组件的尺寸，请检查页面内输出的组件配置信息是否存在。。。"):(trace("文章页组件渲染列表: "+e.toString()),void Lib.Component.renderByList(e))}),$registJob("articleComp2",function(){var e=[903,904,909,47];return null==Lib.Component.getInitCompSize()?void Debug.error("无法获得页面内组件的尺寸，请检查页面内输出的组件配置信息是否存在。。。"):(trace("文章页组件渲染列表: "+e.toString()),void Lib.Component.lazyRenderByList(e))}),Ui.Pagination={config:{pageNode:null,nodeClassNamePrefix:"CP",curPage:1,maxPage:1,minPage:1,pageTpl:"@page@.html",type:1,showPrevNext:!0,viewSize:5,dotIsPage:!1,dotRate:5,showGoto:!1,countTpl:"",language:"zh-cn",theme:1,showLastPage:!0,showTotal:!1},_list:{},_resource:{"en-us":["Pages (@data@): ","Go to First Page","Go to Previous Page (@data@)","Go to Page @data@","Go to Next Page (@data@)","Go to Last Page","Current Page in View"],"zh-cn":["共 @data@ 页","跳转至第一页","跳转至前 @data@ 页","跳转至第 @data@ 页","跳转至后 @data@ 页","跳转至最后一页","当前所在页"]},_template:'<li class="#{class}" title="#{title}">#{link}</li>',init:function(e){var t=$E(e.pageNode);if(null==t)return void trace("分页指定的父容器不存在");Ui.Pagination._list[t.id]={};var i=Ui.Pagination._list[t.id];for(var n in this.config)i[n]=void 0===e[n]?this.config[n]:e[n];return 2==i.type&&(i.viewSize=4),i.minPage=1*Math.min(i.minPage,i.maxPage),i.maxPage=1*Math.max(i.minPage,i.maxPage),i.curPage=i.curPage>i.maxPage?i.minPage:i.curPage,i.curPage=1*i.curPage,i.curPage+i.viewSize>=100&&(i.viewSize=3),this._cache_node=i,this},show:function(e,t){t=1*t;var i=this._cache_node;null!=e&&(this._cache_node=i=Ui.Pagination._list[e.id],i.curPage=t);var n=[];2*i.viewSize+1>=i.maxPage?(n[1]=i.minPage,n[2]=i.maxPage):i.curPage<=i.minPage+i.viewSize?(n[1]=i.minPage,n[2]=i.minPage+(2*i.viewSize-1),n[3]=i.maxPage):i.curPage>=i.maxPage-i.viewSize?(n[0]=i.minPage,n[1]=i.maxPage-(2*i.viewSize-1),n[2]=i.maxPage):(n[0]=i.minPage,n[1]=i.curPage-(i.viewSize-1),n[2]=i.curPage+(i.viewSize-1),n[3]=i.maxPage);var o=[];if(null!=i.countTpl&&o.push(this._createPage("","","","",i.countTpl)),2!=i.type&&i.curPage!=i.minPage&&o.push(3==i.type?this._createPage(i.nodeClassNamePrefix+"_s_pgprev",i.curPage-1,3,i.curPage-1,"上页"):this._createPage(i.nodeClassNamePrefix+"_pgprev",i.curPage-1,3,i.curPage-1,"< 上一页")),3!=i.type){if(null!=n[0]){var s=n[0]==i.curPage?this._createPage(i.nodeClassNamePrefix+"_pgon",1,6,"",n[0]):this._createPage("",1,1,n[0],n[0]);o.push(s)}1==i.type&&null!=n[0]&&o.push(this._createPage(i.nodeClassNamePrefix+"_pgelip","","","","..."));for(var a=n[1];a<=n[2];a++)if(a==n[1]&&a!=i.minPage&&2==i.type){var r=i.curPage-i.dotRate;r=r<i.minPage?i.minPage:r,o.push(this._createPage(i.nodeClassNamePrefix+"_pgelip",i.viewSize+1,2,i.curPage-i.viewSize-1,"..."))}else if(a==n[2]&&a!=i.maxPage&&2==i.type){var l=i.curPage+i.dotRate;l=l>i.maxPage?i.maxPage:l,o.push(this._createPage(i.nodeClassNamePrefix+"_pgelip",i.viewSize+1,4,i.curPage+i.viewSize+1,"..."))}else s=a==i.curPage?this._createPage(i.nodeClassNamePrefix+"_pgon",1,6,"",a):this._createPage("",a,3,a,a),o.push(s);1==i.type&&null!=n[3]&&o.push(this._createPage(i.nodeClassNamePrefix+"_pgelip","","","","...")),null!=n[3]&&i.showLastPage&&(s=n[3]==i.curPage?this._createPage(i.nodeClassNamePrefix+"_pgon",i.curPage-1,3,"",n[3]):this._createPage("",1,5,n[3],n[3]),o.push(s))}else o.push(this._createPage(i.nodeClassNamePrefix+"_s_pgnum","","","","<strong>"+i.curPage+"</strong>/"+i.maxPage));2!=i.type&&i.curPage!=i.maxPage&&o.push(3==i.type?this._createPage(i.nodeClassNamePrefix+"_s_pgnext",i.curPage+1,3,i.curPage+1,"下页"):this._createPage(i.nodeClassNamePrefix+"_pgnext",i.curPage+1,3,i.curPage+1,"下一页 >")),1==i.showTotal&&o.push(this._createPage(i.nodeClassNamePrefix+"_pgttl","","","","共"+i.maxPage+"页")),$E(i.pageNode).innerHTML='<ul class="'+i.nodeClassNamePrefix+'_pages">'+o.join("")+"</ul>"},_createPage:function(e,t,i,n,o){if(""==o)return"";var s=""===t||""==i?"":this._getTips(t,i),a=""!==n?"<a "+this._getUrl(n)+">"+o+"</a>":o;return this._template.replace(/(#\{\w+\})/g,function(t,i){switch(i){case"#{class}":return e;case"#{title}":return s;case"#{link}":return a}})},showPage:function(e,t){this._cache_node=Ui.Pagination._list[e];var i=this._cache_node.pageTpl(t);0!=i&&Ui.Pagination.show($E(e),t)},_getUrl:function(e){return"string"==typeof this._cache_node.pageTpl?'href="'+this._cache_node.pageTpl.replace(/@page@/,e)+'"':"href=\"javascript:Ui.Pagination.showPage('"+this._cache_node.pageNode+"',"+e+');"'},_getTips:function(e,t){return this._resource[this._cache_node.language][t].replace(/@data@/g,e)}};var CommentV2={};Utils.Json={eval:function(str){return eval("("+str+")")},flatten:function(e){var t=Utils.Json;return null==e?null:e.constructor.toString()==String?t.str2json(e):e.constructor.toString()==Array?t.arr2json(e):e.constructor.toString()==Object?t.obj2json(e):e.constructor.toString()==Boolean?t.bool2json(e):e.constructor.toString()==Number?t.num2json(e):e.constructor.toString()==Date?t.date2json(e):null},arr2json:function(e){for(var t,i=Utils.Json,n=[],o=e.length,s=0;o>s;++s)t=i.flatten(e[s]),t&&n.push(t);return"["+n.join(",")+"]"},obj2json:function(e){var t,i=Utils.Json,n=[];for(var o in e)t=i.flatten(e[o]),t&&n.push(i.flatten(o)+":"+t);return"{"+n.join(",")+"}"},date2json:function(e){function t(e){return 10>e?"0"+e:e}return'"'+e.getFullYear()+"-"+t(e.getMonth()+1)+"-"+t(e.getDate())+"T"+t(e.getHours())+":"+t(e.getMinutes())+":"+t(e.getSeconds())+'"'},num2json:function(e){return e?String(e):"0"},bool2json:function(e){return String(e)},str2json:function(e){var t={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};return/["\\\x00-\x1f]/.test(e)?'"'+e.replace(/([\x00-\x1f\\"])/g,function(e,i){var n=t[i];
return n?n:(n=i.charCodeAt(),"\\u00"+Math.floor(n/16).toString(16)+(n%16).toString(16))})+'"':'"'+e+'"'}},$SYSMSG.extend({B36001:"操作失败，此博文不存在或被删除。",B36002:"验证码错误，请重新输入。",B36003:"请输入昵称。",B36004:"登录名或密码错误。",B36005:"呢称不能使用此类特殊词汇，请重新输入。",B36006:"昵称必须是8个中文或16个字符以内，且不能为纯数字，请重新输入。",B36007:"呢称不能使用此类特殊词汇，请重新输入。",B36008:"不能3秒内连续发评论，请梢后再试。",B36009:"不能发内容重复的评论。",B36020:"暂无评论。",B36021:"暂无评论。",B36022:"评论内容必须是1000中文或2000字符以内，请重新输入。",B36023:"对不起，黑名单已达到上限",B36024:"对方拒绝了你的评论。",B36031:"操作失败，此评论不存在或被删除。",B36032:"操作失败，此评论不存在或被删除。",B36033:"操作失败，此评论不存在或被删除。",B36041:"请输入回复内容。",B36042:"回复内容必须是1000中文或2000字符以内，请重新输入。",B36043:"操作失败，自己不能回复自己的评论。",B36101:"操作失败，此博文不存在或被删除。",B36102:"评论发布失败，此博文设置不允许评论。",B36103:"操作失败，此评论不存在或被删除。",B36104:"评论已发布，需要审核后才能显示，请稍候…",B36113:"博主已关闭匿名评论，请登录后再评论",B36105:"请输入评论内容。",B36106:"请输入验证码。",B36107:"请输入登录名。",B36108:"请输入密码。",B36109:"读取中，请稍候…",B36110:"读取失败，请刷新。",B36111:"确定要删除此评论吗？删除后不可恢复。",B36112:"确定要删除此回复吗？删除后不可恢复。",B36201:"确定要删除此评论吗？删除后不可恢复。",B36202:"确定要删除此回复吗？删除后不可恢复。",B36203:"请选择要删除的内容。",B36204:"已回复该评论，请勿重复提交。",B36998:"系统维护中，服务暂不可用",B36999:"对不起，您短时间发表的评论过多，请多休息会，注意身体！感谢您对新浪博客的支持和关注！",36999:"对不起，您短时间发表的评论过多，请多休息会，注意身体！感谢您对新浪博客的支持和关注！",A20013:"您已经发送多条相似内容了哦，请先休息一下吧~",A20014:"已经有很多博主发过相似评论了，换个内容会更精彩~",B36205:"请登录后在回复评论",B36206:"对不起，您已被对方列入黑名单，无法发评论。",B36207:"请登录后在删除评论",B36208:"评论内容必须是140中文或280字符以内，请重新输入",B36209:"此条评论已被原博主删除",B36210:"博主已关闭评论功能",B36211:"此博文已被博主设为私密",A00004:"此评论不存在或已被博主删除",A00011:"请登录后再进行评论"}),CommentV2.List=function(e){this.containerNode="",this.type="",this.operation="",this.data="",this.page=1,this.total=0,this.url="",this.trim=Core.String.trim,this.jsonUtil=Utils.Json,this.init(e)}.$define({init:function(e){trace("super init"),this.__merge(e),this.load(this.page)},__merge:function(e){for(var t in e)this[t]=e[t]},load:function(){},render:function(){},bindEvent:function(){var e=this;scope.commentlistIsBind||(this.addEvent(this.containerNode,e.delegate.bind2(e),"click"),this.onListener()),scope.commentlistIsBind=!0},delegate:function(e){trace("CommentV2.CommentList.delegate"),e=e||window.event;var t,i,n,o,s,a=e.target||e.srcElement;if(t=this.getTarget(a,this.containerNode),t&&(i=this.getType(t)))if(n=i.split("_")[0],o=i.split("_")[1],s=this.str2obj(this.getData(t)),"comment"==n){var r=$E("comment_"+s.commentid);this[o]({type:n,operation:o,articleid:scope.$articleid,data:s,containerNode:r,node:t})}else{var r=$E("reply_"+s.replyid);this.replyList[s.commentid][o]({type:n,operation:o,articleid:scope.$articleid,data:s,containerNode:r,node:t})}},onListener:function(){Lib.Listener.on({name:"commentlist-commentadd",callBack:this.add,scope:this})},removeEvent:function(){trace("CommentV2.CommentList.removeEvent"),this.removeEvent(this.containerNode,this.delegate,"click")},toggle:function(){this.isDisplay()?this.hide():this.show()},show:function(){this.containerNode.style.display=""},hide:function(){this.containerNode.style.display="none"},isDisplay:function(){return this.containerNode?"none"!==this.containerNode.style.display:!1},error:function(e){this.containerNode.innerHTML='<li class="CP_litem"><div class="CP_cmt_none">'+$SYSMSG[e]+"</div></li>"},paging:function(){},add:function(){},del:function(){},report:function(){},reply:function(){},share:function(){},obj2str:function(e){return encodeURIComponent(this.jsonUtil.flatten(e))},str2obj:function(e){return this.jsonUtil.eval(decodeURIComponent(e))},getTarget:function(e,t){for(;e&&e!==t;){if("a"==e.tagName.toLowerCase())return e;e=e.parentNode}return null},getType:function(e){return e&&e.getAttribute("action-type")},getData:function(e){return e&&e.getAttribute("action-data")}}),Core.Dom.getElementsByAttr=function(e,t,i){for(var n=[],o=0,s=e.childNodes.length;s>o;o++)1==e.childNodes[o].nodeType&&(e.childNodes[o].getAttribute(t)==i&&n.push(e.childNodes[o]),e.childNodes[o].childNodes.length>0&&(n=n.concat(arguments.callee.call(null,e.childNodes[o],t,i))));return n},function(){var e={},t=document.selection;e.selectionStart=function(e){if(!t)try{return e.selectionStart}catch(i){return 0}var n=t.createRange(),o=0,s=document.body.createTextRange();try{s.moveToElementText(e)}catch(i){}for(o;s.compareEndPoints("StartToStart",n)<0;o++)s.moveStart("character",1);return o},e.selectionBefore=function(t){return t.value.slice(0,e.selectionStart(t))},e.selectText=function(e,i,n){if(e.focus(),!t)return void e.setSelectionRange(i,n);var o=e.createTextRange();o.collapse(1),o.moveStart("character",i),o.moveEnd("character",n-i),o.select()},e.insertText=function(i,n,o,s){if(i.focus(),s=s||0,!t){var a=i.value,r=o-s,l=r+n.length;return i.value=a.slice(0,r)+n+a.slice(o,a.length),void e.selectText(i,l,l)}var c=t.createRange();c.moveStart("character",-s),c.text=n},e.replaceText=function(i,n){i.focus();var o=i.value,s=e.getSelectedText(i),a=s.length;if(0==s.length)e.insertText(i,n,e.getCursorPos(i));else{var r=e.getCursorPos(i);if(!t){{r+s.length}return i.value=o.slice(0,r)+n+o.slice(r+a,o.length),void e.setCursor(i,r+n.length)}var l=t.createRange();l.text=n,e.setCursor(i,r+n.length)}},e.getCursorPos=function(e){var i=0;if($IE){e.focus();var n=null;n=t.createRange();var o=n.duplicate();o.moveToElementText(e),o.setEndPoint("EndToEnd",n),e.selectionStartIE=o.text.length-n.text.length,e.selectionEndIE=e.selectionStartIE+n.text.length,i=e.selectionStartIE}else(e.selectionStart||"0"==e.selectionStart)&&(i=e.selectionStart);return i},e.getSelectedText=function(e){var i="",n=function(e){return void 0!=e.selectionStart&&void 0!=e.selectionEnd?e.value.substring(e.selectionStart,e.selectionEnd):""};return i=window.getSelection?n(e):t.createRange().text},e.setCursor=function(e,t,i){if(t=null==t?e.value.length:t,i=null==i?0:i,e.focus(),e.createTextRange){var n=e.createTextRange();n.move("character",t),n.moveEnd("character",i),n.select()}else e.setSelectionRange(t,t+i)},e.unCoverInsertText=function(e,t,i){i=null==i?{}:i,i.rcs=null==i.rcs?e.value.length:1*i.rcs,i.rccl=null==i.rccl?0:1*i.rccl;var n=e.value,o=n.slice(0,i.rcs),s=n.slice(i.rcs+i.rccl,""==n?0:n.length);e.value=o+t+s,this.setCursor(e,i.rcs+(null==t?0:t.length))},CommentV2.TextAreaUtils=e}(),window.WEIBOFACEDATA=[{phrase:"[草泥马]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/7a/shenshou_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/7a/shenshou_thumb.gif",value:"[草泥马]",picid:""},{phrase:"[神马]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/60/horse2_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/60/horse2_thumb.gif",value:"[神马]",picid:""},{phrase:"[浮云]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/bc/fuyun_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/bc/fuyun_thumb.gif",value:"[浮云]",picid:""},{phrase:"[给力]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/c9/geili_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/c9/geili_thumb.gif",value:"[给力]",picid:""},{phrase:"[围观]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/f2/wg_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/f2/wg_thumb.gif",value:"[围观]",picid:""},{phrase:"[威武]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/70/vw_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/70/vw_thumb.gif",value:"[威武]",picid:""},{phrase:"[熊猫]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/6e/panda_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/6e/panda_thumb.gif",value:"[熊猫]",picid:""},{phrase:"[兔子]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/81/rabbit_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/81/rabbit_thumb.gif",value:"[兔子]",picid:""},{phrase:"[奥特曼]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/bc/otm_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/bc/otm_thumb.gif",value:"[奥特曼]",picid:""},{phrase:"[囧]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/15/j_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/15/j_thumb.gif",value:"[囧]",picid:""},{phrase:"[互粉]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/89/hufen_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/89/hufen_thumb.gif",value:"[互粉]",picid:""},{phrase:"[礼物]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/c4/liwu_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/c4/liwu_thumb.gif",value:"[礼物]",picid:""},{phrase:"[呵呵]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/ac/smilea_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/ac/smilea_thumb.gif",value:"[呵呵]",picid:""},{phrase:"[嘻嘻]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/0b/tootha_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/0b/tootha_thumb.gif",value:"[嘻嘻]",picid:""},{phrase:"[哈哈]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/6a/laugh.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/6a/laugh.gif",value:"[哈哈]",picid:""},{phrase:"[可爱]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/14/tza_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/14/tza_thumb.gif",value:"[可爱]",picid:""},{phrase:"[可怜]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/af/kl_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/af/kl_thumb.gif",value:"[可怜]",picid:""},{phrase:"[挖鼻屎]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/a0/kbsa_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/a0/kbsa_thumb.gif",value:"[挖鼻屎]",picid:""},{phrase:"[吃惊]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/f4/cj_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/f4/cj_thumb.gif",value:"[吃惊]",picid:""},{phrase:"[害羞]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/6e/shamea_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/6e/shamea_thumb.gif",value:"[害羞]",picid:""},{phrase:"[挤眼]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/c3/zy_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/c3/zy_thumb.gif",value:"[挤眼]",picid:""},{phrase:"[闭嘴]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/29/bz_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/29/bz_thumb.gif",value:"[闭嘴]",picid:""},{phrase:"[鄙视]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/71/bs2_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/71/bs2_thumb.gif",value:"[鄙视]",picid:""},{phrase:"[爱你]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/6d/lovea_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/6d/lovea_thumb.gif",value:"[爱你]",picid:""},{phrase:"[泪]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/9d/sada_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/9d/sada_thumb.gif",value:"[泪]",picid:""},{phrase:"[偷笑]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/19/heia_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/19/heia_thumb.gif",value:"[偷笑]",picid:""},{phrase:"[亲亲]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/8f/qq_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/8f/qq_thumb.gif",value:"[亲亲]",picid:""},{phrase:"[生病]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/b6/sb_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/b6/sb_thumb.gif",value:"[生病]",picid:""},{phrase:"[太开心]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/58/mb_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/58/mb_thumb.gif",value:"[太开心]",picid:""},{phrase:"[懒得理你]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/17/ldln_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/17/ldln_thumb.gif",value:"[懒得理你]",picid:""},{phrase:"[右哼哼]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/98/yhh_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/98/yhh_thumb.gif",value:"[右哼哼]",picid:""},{phrase:"[左哼哼]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/6d/zhh_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/6d/zhh_thumb.gif",value:"[左哼哼]",picid:""},{phrase:"[嘘]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/a6/x_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/a6/x_thumb.gif",value:"[嘘]",picid:""},{phrase:"[衰]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/af/cry.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/af/cry.gif",value:"[衰]",picid:""},{phrase:"[委屈]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/73/wq_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/73/wq_thumb.gif",value:"[委屈]",picid:""},{phrase:"[吐]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/9e/t_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/9e/t_thumb.gif",value:"[吐]",picid:""},{phrase:"[打哈欠]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/f3/k_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/f3/k_thumb.gif",value:"[打哈欠]",picid:""},{phrase:"[抱抱]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/27/bba_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/27/bba_thumb.gif",value:"[抱抱]",picid:""},{phrase:"[怒]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/7c/angrya_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/7c/angrya_thumb.gif",value:"[怒]",picid:""},{phrase:"[疑问]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/5c/yw_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/5c/yw_thumb.gif",value:"[疑问]",picid:""},{phrase:"[馋嘴]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/a5/cza_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/a5/cza_thumb.gif",value:"[馋嘴]",picid:""},{phrase:"[拜拜]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/70/88_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/70/88_thumb.gif",value:"[拜拜]",picid:""},{phrase:"[思考]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/e9/sk_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/e9/sk_thumb.gif",value:"[思考]",picid:""},{phrase:"[汗]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/24/sweata_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/24/sweata_thumb.gif",value:"[汗]",picid:""},{phrase:"[困]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/7f/sleepya_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/7f/sleepya_thumb.gif",value:"[困]",picid:""},{phrase:"[睡觉]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/6b/sleepa_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/6b/sleepa_thumb.gif",value:"[睡觉]",picid:""},{phrase:"[钱]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/90/money_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/90/money_thumb.gif",value:"[钱]",picid:""},{phrase:"[失望]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/0c/sw_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/0c/sw_thumb.gif",value:"[失望]",picid:""},{phrase:"[酷]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/40/cool_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/40/cool_thumb.gif",value:"[酷]",picid:""},{phrase:"[花心]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/8c/hsa_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/8c/hsa_thumb.gif",value:"[花心]",picid:""},{phrase:"[哼]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/49/hatea_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/49/hatea_thumb.gif",value:"[哼]",picid:""},{phrase:"[鼓掌]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/36/gza_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/36/gza_thumb.gif",value:"[鼓掌]",picid:""},{phrase:"[晕]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/d9/dizzya_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/d9/dizzya_thumb.gif",value:"[晕]",picid:""},{phrase:"[悲伤]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/1a/bs_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/1a/bs_thumb.gif",value:"[悲伤]",picid:""},{phrase:"[抓狂]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/62/crazya_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/62/crazya_thumb.gif",value:"[抓狂]",picid:""},{phrase:"[黑线]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/91/h_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/91/h_thumb.gif",value:"[黑线]",picid:""},{phrase:"[阴险]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/6d/yx_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/6d/yx_thumb.gif",value:"[阴险]",picid:""},{phrase:"[怒骂]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/89/nm_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/89/nm_thumb.gif",value:"[怒骂]",picid:""},{phrase:"[心]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/40/hearta_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/40/hearta_thumb.gif",value:"[心]",picid:""},{phrase:"[伤心]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/ea/unheart.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/ea/unheart.gif",value:"[伤心]",picid:""},{phrase:"[猪头]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/58/pig.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/58/pig.gif",value:"[猪头]",picid:""},{phrase:"[ok]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/d6/ok_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/d6/ok_thumb.gif",value:"[ok]",picid:""},{phrase:"[耶]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/d9/ye_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/d9/ye_thumb.gif",value:"[耶]",picid:""},{phrase:"[good]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/d8/good_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/d8/good_thumb.gif",value:"[good]",picid:""},{phrase:"[不要]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/c7/no_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/c7/no_thumb.gif",value:"[不要]",picid:""},{phrase:"[赞]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/d0/z2_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/d0/z2_thumb.gif",value:"[赞]",picid:""},{phrase:"[来]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/40/come_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/40/come_thumb.gif",value:"[来]",picid:""},{phrase:"[弱]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/d8/sad_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/d8/sad_thumb.gif",value:"[弱]",picid:""},{phrase:"[蜡烛]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/91/lazu_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/91/lazu_thumb.gif",value:"[蜡烛]",picid:""},{phrase:"[钟]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/d3/clock_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/d3/clock_thumb.gif",value:"[钟]",picid:""},{phrase:"[话筒]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/1b/m_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/1b/m_thumb.gif",value:"[话筒]",picid:""},{phrase:"[蛋糕]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/6a/cake.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/6a/cake.gif",value:"[蛋糕]",picid:""},{phrase:"[微博益起来]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/95/yiqilai_org.gif",hot:!0,common:!1,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/95/yiqilai_thumb.gif",value:"[微博益起来]",picid:""},{phrase:"[微公益爱心]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/11/lxhgongyi_org.gif",hot:!0,common:!1,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/11/lxhgongyi_thumb.gif",value:"[微公益爱心]",picid:""},{phrase:"[笑哈哈]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/32/lxhwahaha_org.gif",hot:!0,common:!1,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/32/lxhwahaha_thumb.gif",value:"[笑哈哈]",picid:""},{phrase:"[转发]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/02/lxhzhuanfa_org.gif",hot:!0,common:!1,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/02/lxhzhuanfa_thumb.gif",value:"[转发]",picid:""},{phrase:"[得意地笑]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/d4/lxhdeyidixiao_org.gif",hot:!0,common:!1,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/d4/lxhdeyidixiao_thumb.gif",value:"[得意地笑]",picid:""},{phrase:"[moc转发]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/cb/moczhuanfa_org.gif",hot:!0,common:!1,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/cb/moczhuanfa_thumb.gif",value:"[moc转发]",picid:""},{phrase:"[劲能样]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/f4/jingnengyang_org.gif",hot:!0,common:!1,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/f4/jingnengyang_thumb.gif",value:"[劲能样]",picid:""},{phrase:"[bm可爱]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/95/bmkeai_org.gif",hot:!0,common:!1,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/95/bmkeai_thumb.gif",value:"[bm可爱]",picid:""},{phrase:"[xkl转圈]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/f4/xklzhuanquan_org.gif",hot:!0,common:!1,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/f4/xklzhuanquan_thumb.gif",value:"[xkl转圈]",picid:""},{phrase:"[ppb鼓掌]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/7e/ppbguzhang_org.gif",hot:!0,common:!1,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/7e/ppbguzhang_thumb.gif",value:"[ppb鼓掌]",picid:""},{phrase:"[din推撞]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/dd/dintuizhuang_org.gif",hot:!0,common:!1,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/dd/dintuizhuang_thumb.gif",value:"[din推撞]",picid:""},{phrase:"[xb压力]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/e0/xbyali_org.gif",hot:!0,common:!1,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/e0/xbyali_thumb.gif",value:"[xb压力]",picid:""},{phrase:"[放假啦]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/37/lxhfangjiale_org.gif",hot:!0,common:!1,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/37/lxhfangjiale_thumb.gif",value:"[放假啦]",picid:""},{phrase:"[国旗]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/dc/flag_org.gif",hot:!0,common:!1,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/dc/flag_thumb.gif",value:"[国旗]",picid:""},{phrase:"[带着微博去旅行]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/f5/weitripballoon_org.gif",hot:!0,common:!1,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/f5/weitripballoon_thumb.gif",value:"[带着微博去旅行]",picid:""},{phrase:"[玩去啦]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/92/weitrip_org.gif",hot:!0,common:!1,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/92/weitrip_thumb.gif",value:"[玩去啦]",picid:""},{phrase:"[ali哇]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/de/aliwanew_org.gif",hot:!0,common:!1,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/de/aliwanew_thumb.gif",value:"[ali哇]",picid:""},{phrase:"[酷库熊顽皮]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/46/kxwanpi_org.gif",hot:!0,common:!1,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/46/kxwanpi_thumb.gif",value:"[酷库熊顽皮]",picid:""},{phrase:"[BOBO爱你]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/74/boaini_org.gif",hot:!0,common:!1,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/74/boaini_thumb.gif",value:"[BOBO爱你]",picid:""},{phrase:"[偷乐]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/fa/lxhtouxiao_org.gif",hot:!0,common:!1,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/fa/lxhtouxiao_thumb.gif",value:"[偷乐]",picid:""},{phrase:"[泪流满面]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/64/lxhtongku_org.gif",hot:!0,common:!1,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/64/lxhtongku_thumb.gif",value:"[泪流满面]",picid:""},{phrase:"[lt切克闹]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/73/ltqiekenao_org.gif",hot:!0,common:!1,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/73/ltqiekenao_thumb.gif",value:"[lt切克闹]",picid:""},{phrase:"[江南style]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/67/gangnamstyle_org.gif",hot:!0,common:!1,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/67/gangnamstyle_thumb.gif",value:"[江南style]",picid:""}],Core.Dom.contains=document.documentElement.contains?function(e,t){return e.contains?e.contains(t):!0}:document.documentElement.compareDocumentPosition?function(e,t){return e===t||!!(16&e.compareDocumentPosition(t))}:function(e,t){for(;t;){if(e===t)return!0;t=t.parentNode}return!1};var Tabs=Core.Class.create();Tabs.prototype={initialize:function(e,t){t=t||{};var i=t.className||"";this.tabsArr=[],this.htmlEle=$C("ul"),this.htmlEle.className=i,e.appendChild(this.htmlEle)},add:function(e){this.tabsArr.push(e),this.htmlEle.appendChild(e.element),Core.Events.addEvent(e.element,Core.Function.bind3(this.swapTags,this,[e]))},swapTags:function(e){if(0==e.isFocus){for(var t=0;t<this.tabsArr.length;t++)this.tabsArr[t].setAbort();e.setFocus()}}};var Tab=Core.Class.create();if(Tab.prototype={isShow:!0,initialize:function(e,t){this.id=Core.Math.getUniqueId(),this.option=t||{};var i=t.isFocus||!1;this.className=t.className||"",this.focus=t.onfocus?[t.onfocus]:[],this.abotrts=t.onabort?[t.onabort]:[],this.element=$C("li"),t.cls&&(this.element.className=t.cls),i?this.setFocus():this.setAbort(),this.element.innerHTML=e},setAbort:function(){0!=this.isFocus&&(this.element.className=this.option.cls?this.option.cls:"",this.isFocus=!1,this.onabort())},setFocus:function(){this.element.className=this.className,this.isFocus=!0,this.onfocus()},onabort:function(){for(var e=0;e<this.abotrts.length;e++)this.abotrts[e]()},onfocus:function(){for(var e=0;e<this.focus.length;e++)this.focus[e]()},addOnAbort:function(e){this.abotrts.push(e)},addOnFocus:function(e){this.focus.push(e)},hidden:function(){this.element.style.display="none"},hidden:function(){this.element.style.display="none",this.isShow=!1},show:function(){this.element.style.display="block",this.isShow=!0}},Lib.register("util.JSON",function(){var e=function(e){if(e.JSON)return e.JSON;var t={parse:function(e){return new Function("return "+e)()},stringify:function(e){if(e instanceof Object){var t="";if(e.constructor===Array){for(var i=0;i<e.length;t+=this.stringify(e[i])+",",i++);return"["+t.substr(0,t.length-1)+"]"}if(e.toString!==Object.prototype.toString)return'"'+e.toString().replace(/"/g,"\\$&")+'"';for(var n in e)t+='"'+n.replace(/"/g,"\\$&")+'":'+this.stringify(e[n])+",";return"{"+t.substr(0,t.length-1)+"}"}return"string"==typeof e?'"'+e.replace(/"/g,"\\$&")+'"':String(e)}};return t}(window);return e}),CommentV2.FaceDialog=Core.Class.create(),CommentV2.FaceDialog.prototype={initialize:function(e,t){this._src=e,this._tarea=t,this._json=Lib.util.JSON,this.dialog=new Dialog(this._tpl),this.dialogNodes=this.dialog.getNodes();var i=this.getSrcPos(e);this.faceDatas={},this.generaFaces=[],this.hotFaces=[],this.dialog.setPosition(i),this.dialog.show(),this.initTab(),this._bindEvents()},_tpl:['<table class="CP_w" id="#{entity}">',"<thead>","<tr>",'<th class="tLeft"><span></span></th>','<th class="tMid"><div class="bLyTop"><strong>插入表情</strong><cite><a href="#" id="#{close}"class="CP_w_shut" title="关闭">关闭</a></cite></div></th>','<th class="tRight"><span></span></th>',"</tr>","</thead>","<tfoot>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid"><span></span></td>','<td class="tRight"><span></span></td>',"</tr>","</tfoot>","<tbody>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid" id="#{content}">','<div class="faceItemList" id="#{facelistbox}">','<div class="CP_w_tag" id="#{facetabs}" style="display:none"></div>','<div id="#{general}">','<div class="tab_subsort" id="#{generaltabs}" style="display:none"></div>','<div class="details">','<ul class="face_tp face_lt" id="#{hotFace}"></ul>','<ul class="face_tp" id="#{inner}"></ul>','<div class="SG_page" id="#{page}"><ul id="#{pagelist}" class="SG_pages"></ul></div>',"</div>","</div>","</div>","</td>",'<td class="tRight"><span></span></td>',"</tr>","</tbody>","</table>"].join(""),_bindEvents:function(){var e=this;
Core.Events.addEvent(this.dialogNodes.close,function(t){var t=Core.Events.getEvent();Core.Events.stopEvent(t),e.dialog.hidden()},"click"),Core.Events.addEvent(document.body,function(t){var t=Core.Events.getEvent(),i=t.target||t.srcElement;Core.Dom.contains(e.dialogNodes.entity,i)||i==e._src||e.dialog.hidden()},"click"),this.bindDelegateAction()},getSrcPos:function(){var e=this._src,t=Core.Dom.getXY(e),i=e.offsetHeight,n={};return n.x=t[0],n.y=t[1]+i+5,n},show:function(){this.dialog.show()},initTab:function(){this.tab=new Tabs(this.dialogNodes.facetabs,{}),highTab=new Tab("<div><em>常用表情</em></div>",{isFocus:!0,className:"cur"}),highTab.addOnFocus(Core.Function.bind3(this.initGeneralFace,this)),this.tab.add(highTab),this.initGeneralFace()},getFaceData:function(e){if(!this.faceDatas.face){var t=this;if(window.WEIBOFACEDATA)this.faceDatas.face=t.formartFaceData(window.WEIBOFACEDATA),e();else{var i="http://i2.api.weibo.com/2/emotions.json?source=1617465124&type=face&language=cnname&callback=jsonpfacedata";window.jsonpfacedata=function(i){1==i.code&&i.data&&(window.WEIBOFACEDATA=i.data,t.faceDatas.face=t.formartFaceData(i.data),e())},Utils.Io.JsLoad.request(i,{onComplete:function(){}.bind2(this),charset:"UTF-8"})}}},formartFaceData:function(e){for(var t={},i=0,n=e.length;n>i;i++){var o=e[i];o.category||(o.category="默认"),o.hot?this.hotFaces.push(o):t[o.category]?t[o.category].push(o):(t[o.category]=[],this.generaFaces.push(o.category),t[o.category].push(o))}return t},initGeneralFace:function(){this.getFaceData(this.initGeneralTab.bind2(this))},initGeneralTab:function(){var e=this.initGeneralTabList();this.initGeneralTabPage(e)},initGeneralTabList:function(){var e=new Tabs(this.dialogNodes.generaltabs,{});e.add=function(e){this.tabsArr.push(e),this.htmlEle.appendChild(e.element);var t=this;Core.Events.addEvent(e.element,function(i){var i=Core.Events.getEvent();Core.Events.stopEvent(i),t.swapTags(e)})}.bind2(e);for(var t=0,i=this.generaFaces.length;i>t;t++){var n=this.generaFaces[t],o=!1;0==t&&(o=!0);var s=new Tab('<a href="#">'+n+"</a>",{isFocus:o,className:"cur"});s.addOnFocus(Core.Function.bind3(this.showGeneralFaces,this,[n])),t>4&&s.hidden(),e.add(s),0==t&&this.showGeneralFaces(n)}return e},initGeneralTabPage:function(e){function t(){r=l,l=e.tabsArr.length>=s*a-1?e.tabsArr.slice((s-1)*a,s*a):e.tabsArr.slice((s-1)*a);for(var t=r.length-1;t>=0;--t){var i=r[t];i.hidden()}for(var n=l.length-1;n>=0;--n){var o=l[n];o.show()}}var i='<div class="btn_func" ><a href="#" node-type="generalTabPagePre" class="arrow_preview"></a><a href="#" node-type="generalTabPageNext" class="arrow_next"></a></div>';Core.Dom.insertHTML(this.dialogNodes.generaltabs,i,"BeforeEnd");var n=Core.Dom.getElementsByAttr(this.dialogNodes.generaltabs,"node-type","generalTabPagePre")[0],o=Core.Dom.getElementsByAttr(this.dialogNodes.generaltabs,"node-type","generalTabPageNext")[0],s=1,a=5,r=[],l=e.tabsArr.slice(s-1,a),c=this.generaFaces.length,d=c%a,h=d>0?(c-d)/a+1:c/a;Core.Events.addEvent(n,function(e){var e=Core.Events.getEvent();return Core.Events.stopEvent(e),1>=s?void(s=1):(s--,void t())}),Core.Events.addEvent(o,function(e){var e=Core.Events.getEvent();return Core.Events.stopEvent(e),s>=h?void(s=h):(s++,void t())})},showTheHotFace:function(){if(this.hotFaces){var e=this.hotFaces.slice(0,12);this.setHotFaceList(e)}},memoryFocusTab:function(e){this.dialogNodes.generaltabs.setAttribute("data-focustab",e)},showGeneralFaces:function(e){if(this.memoryFocusTab(e),this.faceDatas.face&&this.faceDatas.face[e]){this.dialogNodes.hotFace.style.display="默认"==e?"block":"none";var t=this.faceDatas.face[e];this.setGeneralFaceList(t)}},setHotFaceList:function(e){var t=this.getFaceItemsTpl(e);this.dialogNodes.hotFace.innerHTML=t},setGeneralFaceList:function(e){var t=this.getFaceListPageData(e);this.initFaceListPage(t),this.updateGeneralFaceList(e,t)},updateGeneralFaceList:function(e,t){var e=this.getFaceListData(e,t),i=this.getFaceItemsTpl(e);this.dialogNodes.inner.innerHTML=i},getFaceItemsTpl:function(e){for(var t=[],i=0,n=e.length;n>i;i++){var o=e[i];t.push('<li action-type="insert" action-data="'+o.phrase+'"><img src="'+o.icon+'" alt="'+o.phrase+'" title="'+o.phrase+'"></li>')}return t.join("")},getFaceListPageData:function(e){var t={};return t.step=72,t.focus=1,t.total=e.length,t.totalpage=t.total>t.step?t.total%t.step>0?(t.total-t.total%t.step)/t.step+1:t.total/t.step:1,this.dialogNodes.page.setAttribute("data-page",this._json.stringify(t)),t},initFaceListPage:function(e){var t=[];if(e.totalpage>1){this.dialogNodes.page.style.display="block";for(var i=1;i<=e.totalpage;i++)t.push(i==e.focus?'<li class="SG_pgon">'+i+"</li>":'<li><a href="#" action-type="facePageNums">'+i+"</a></li>");this.dialogNodes.pagelist.innerHTML=t.join("")}else this.dialogNodes.page.style.display="none"},getFaceListData:function(e,t){var i=t.step,n=t.total,o=t.totalpage,s=t.focus;1>s&&(s=1),s>o&&(s=o);var a=n>i?e.slice((s-1)*i,s*i):e;return a},bindDelegateAction:function(){function e(e){var t=Lib.util.getActionData(e,"facePageNums");if(t){Core.Events.stopEvent(e);var i=t.targetEl.innerHTML,n=o._json.parse(o.dialogNodes.page.getAttribute("data-page"));n.focus=i-0,o.dialogNodes.page.setAttribute("data-page",o._json.stringify(n)),o.initFaceListPage(n);var s=o.dialogNodes.generaltabs.getAttribute("data-focustab"),a=o.faceDatas.face[s];o.updateGeneralFaceList(a,n)}}function t(e){var t=Lib.util.getActionData(e,"insert");if(t){var i=t.data,n=CommentV2.TextAreaUtils.selectionStart(o._tarea);CommentV2.TextAreaUtils.insertText(o._tarea,i,n),o.dialog.hidden()}}function i(e){var t=Lib.util.getActionData(e,"insert");t&&(t.targetEl.className="hover")}function n(e){var t=Lib.util.getActionData(e,"insert");t&&(t.targetEl.className="")}Core.Events.addEvent(this.dialogNodes.facelistbox,function(i){t(i),e(i)});var o=this;Core.Events.addEvent(this.dialogNodes.facelistbox,function(e){i(e)},"mouseover"),Core.Events.addEvent(this.dialogNodes.facelistbox,function(e){n(e)},"mouseout")}},CommentV2.autoHeightTextArea=function(e){function t(e){var t;if(e.defaultHeight||(e.defaultHeight=parseInt(n(e,"height"),10)||parseInt(e.offsetHeight,10)||20),$IE){var i=parseInt(n(e,"paddingTop"),10)+parseInt(n(e,"paddingBottom"),10);t=Math.max(e.scrollHeight-i,e.defaultHeight)}else{var i=$MOZ?0:parseInt(n(e,"paddingTop"),10)+parseInt(n(e,"paddingBottom"),10),o=$E("_____textarea_____");if(o||(o=$C("textarea"),o.id="_____textarea_____",document.body.appendChild(o)),o.currentTarget!=e){var s=[];s.push("width:"+n(e,"width")),s.push("font-size:"+n(e,"fontSize")),s.push("font-family:"+n(e,"fontFamily")),s.push("line-height:"+n(e,"lineHeight")),s.push("padding-left:"+n(e,"paddingLeft")),s.push("padding-right:"+n(e,"paddingRight")),s.push("padding-top:"+n(e,"paddingTop")),s.push("padding-bottom:"+n(e,"paddingBottom")),s.push("top:-1000px"),s.push("height:0px"),s.push("position:absolute"),s.push("overflow:hidden"),s.push(""),s=s.join(";"),o.style.cssText=s}o.value=e.value,t=Math.max(o.scrollHeight-i,e.defaultHeight),o.currentTarget=e}return t}var i,n=Core.Dom.getStyle,o=Core.Events.addEvent,s=e.textArea,a=e.maxHeight,r=e.inputListener,l=s.style;(i=function(){"function"==typeof r&&r(),setTimeout(function(){var e,i=t(s)||0;a=a||i;var n=i>a;e=n?a:i,l.overflowY=n?"auto":"hidden",l.height=Math.min(a,i)+"px"},0)})(),s.binded||(o(s,i,"keyup"),o(s,i,"focus"),o(s,i,"blur"),s.binded=!0,s.style.overflow="hidden")},CommentV2.CommentArea=Core.Class.create(),CommentV2.CommentArea.prototype={initialize:function(e){this._container=e.container,this._place=e.place||"BeforeEnd",this._maxtext=2*(e.maxtext||140),this._sid=e.sid||(new Date).getTime(),e.shownum=e.shownum||"yes",this._shownum="yes"==e.shownum?1:0,e.autolineheight=e.autolineheight||"no",this._autolineheight="no"==e.autolineheight?0:1,e.alertnotice=e.alertnotice||"yes",this._alertnotice="yes"==e.alertnotice?1:0,this._maxheight=e.maxheight||100,this._okhandler=e.okhandler||function(){},this._initTareBox(),this._initDom(),this._bindEvent(),this._clock=null},setReplyData:function(e,t){this._plugs=e,this._replaydata=t},setValues:function(e){var t=e.comment,i=CommentV2.TextAreaUtils.selectionStart(this._tarea);this._tarea.value="",CommentV2.TextAreaUtils.insertText(this._tarea,t,i),CommentV2.TextAreaUtils.setCursor(this._tarea,0),this._checkNum()},getValue:function(){return this._tarea.value},_setTpl:function(){this.tpl=['<div id="tare'+this._sid+'">','<div class="count" node-type="num">您还能输入'+this._maxtext/2+"字</div>",'<textarea  node-type="textEl"></textarea>','<div class="func"> <a href="#" class="fico" node-type="faceBtn"></a>','<div class="fr">',"<label>",'<input node-type="shareIpt" type="checkbox">',"将评论分享到微博 </label>",'<a href="#" class="SG_aBtn btn_reply" node-type="subtnEl"><cite>回复</cite></a></div>',"</div>","</div>"].join("")},_initTareBox:function(){this._setTpl(),Core.Dom.insertHTML(this._container,this.tpl,this._place),this._selfcontainer=$E("tare"+this._sid)},_initDom:function(){var e=this._selfcontainer;e&&(this._tarea=Core.Dom.getElementsByAttr(e,"node-type","textEl")[0],this._num=Core.Dom.getElementsByAttr(e,"node-type","num")[0],this._subtn=Core.Dom.getElementsByAttr(e,"node-type","subtnEl")[0],this._facebtn=Core.Dom.getElementsByAttr(e,"node-type","faceBtn")[0],this._shareitp=Core.Dom.getElementsByAttr(e,"node-type","shareIpt")[0],this._shareitp.checked="1"==Utils.Cookie.getCookie("acp_bb")?!1:!0,this._shownum||(this._num.style.display="none"))},_bindEvent:function(){var e=this;Core.Events.addEvent(this._shareitp,function(){"blog7"==scope.$PRODUCT_NAME&&v7sendLog("32_01_09"),"blog7icp"==scope.$PRODUCT_NAME&&v7sendLog("32_01_13")},"click"),Core.Events.addEvent(this._tarea,this._checkNum.bind2(this),"keydown"),Core.Events.addEvent(this._tarea,function(t){e._checkNum();{var t=Core.Events.getEvent();t.target||t.srcElement}e._checkValue()},"keyup"),Core.Events.addEvent(this._tarea,this._bindKeyEvent.bind2(this),"keydown"),Core.Events.addEvent(this._subtn,function(t){var t=Core.Events.getEvent();t.preventDefault?t.preventDefault():t.returnValue=!1,e._submitForm()},"click"),Core.Events.addEvent(this._facebtn,function(t){"blog7"==scope.$PRODUCT_NAME&&v7sendLog("32_01_11"),"blog7icp"==scope.$PRODUCT_NAME&&v7sendLog("32_01_15");var t=Core.Events.getEvent();t.preventDefault?t.preventDefault():t.returnValue=!1,e._showFacePanel()},"click"),this._autolineheight&&CommentV2.autoHeightTextArea({textArea:this._tarea,maxHeight:this._maxheight,inputListener:function(){trace("--autoHeightTextArea--")}})},_checkValue:function(){},_checkNum:function(){var e=this._getUnoccupiedNum();if(this._shownum){var t=e>=0?"还可以输入"+e+"字":'<em class="red">已超出'+-e+"字</em>";this._num.innerHTML=t}},_jsOverflow:function(){var e=this._getUnoccupiedNum();return 0>e?!0:!1},_getUnoccupiedNum:function(){var e=this._tarea.value,t=this._getLen(e),i=this._maxtext,n=(i-t)%2==0?(i-t)/2:(i-t-1)/2;return n},_getLen:function(e){if(!e)return 0;var t=e.match(/[^\x00-\xff]/g);return e.length+(t?t.length:0)},_bindKeyEvent:function(e){13==e.keyCode&&e.ctrlKey&&this._submitForm()},_validate:function(){var e=this;return""==Core.String.trim(this._tarea.value)?(winDialog.alert($SYSMSG.B36041,{icon:"01",funcOk:function(){e._tarea.focus()}}),!1):this._jsOverflow()?(winDialog.alert($SYSMSG.B36208,{icon:"01",funcOk:function(){e._tarea.focus()}}),!1):!0},_submitForm:function(){"blog7"==scope.$PRODUCT_NAME&&v7sendLog("32_01_10"),"blog7icp"==scope.$PRODUCT_NAME&&v7sendLog("32_01_14"),this._validate()&&this._plugs&&(this._replaydata.reply_content=Core.String.trim(this._tarea.value),this._replaydata.is_t=this._shareitp.checked?1:0,this._setShareWbSign(),this._plugs.add(this._replaydata,this.successFun.bind2(this),this.errorFun.bind2(this)))},_setShareWbSign:function(){this._shareitp&&(this._shareitp.checked?($E("bb")&&($E("bb").checked=!0),"1"==Utils.Cookie.getCookie("acp_bb")&&Utils.Cookie.setCookie("acp_bb","",-1,"/",".blog.sina.com.cn")):($E("bb")&&($E("bb").checked=!1),"1"!=Utils.Cookie.getCookie("acp_bb")&&Utils.Cookie.setCookie("acp_bb","1",2400,"/",".blog.sina.com.cn")))},successFun:function(){this._tarea.value="",this._checkNum();var e=this;this._alertnotice&&winDialog.alert("发布成功",{icon:"03",funcOk:function(){e._plugs.sucOkFun&&e._plugs.sucOkFun()}}),this._okhandler()},errorFun:function(e){"blog7"==scope.$PRODUCT_NAME&&v7sendLog("32_01_12"),"blog7icp"==scope.$PRODUCT_NAME&&v7sendLog("32_01_16");var t=e?$SYSMSG[e.code]:"发布失败，请稍后再试";winDialog.alert(t,{icon:"01",funcOk:function(){_this._plugs.errOkFun&&_this._plugs.errOkFun()}})},_showFacePanel:function(){this.facedialog?this.facedialog.show():this.facedialog=new CommentV2.FaceDialog(this._facebtn,this._tarea)}},Lib.HtmlTemplate=function(e,t){this.uniqueID=t}.$extends(Ui.Template).$define({getHtmlString:function(){return this._htmlStr||(this._htmlStr=this.evaluate(this.getNodeIds())),this._htmlStr},getNodeIds:function(){if(!this._nodes){var e,t,i,n=/\{[^\}]+(?=\})/g,o={},s=this._getUniqueID();if(this.__templateNodesIDs=this.tmpl.match(n),t=this.__templateNodesIDs)for(e=t.length;e--;)i=t[e].replace("{",""),o[i]="_"+s+"_"+i;this._nodes=o}return this._nodes},getNodeId:function(e){return this._nodes||this.getNodeIds(),this._nodes[e]},getNode:function(e){var t=this.getNodeId(e);return t?$E(t):null},_getUniqueID:function(){return this.uniqueID||(this.uniqueID=parseInt(1e3*Math.random()).toString()+(new Date).getTime().toString()),this.uniqueID}}),CommentV2.Add=function(e){var e=e||{};this.tpl=e.tpl||"",this.url=e.url||"",this.type=e.type||"comment",this.data=e.data||"",this.jsonUtil=Utils.Json,this.leftB=Core.String.leftB,this.loader=new Interface(this.url,"ijax"),this.init()}.$define({init:function(){trace("CommentV2.Add.Init"),this.tpl||(this.tpl=this.getTpl()),Lib.checkAuthor()},post:function(e,t,i){var n=this;return $isLogin?(trace("CommentV2.Add.Post"),trace(e),void this.loader.request({POST:e,returnType:"json",onSuccess:function(i){trace("reply_add_succ");var o=i.comment_reply_data[0];o.action_data=n.obj2str({articleid:scope.$articleid,commentid:o.stair_cms_id,replyid:o.id,comm_uid:o.comm_uid,uname:o.uname,source_uid:o.source_uid,cms_body:o.cms_body,ulink:o.ria_index_url,source_ulink:o.source_ria_index_url,src_uid:o.src_uid});var s=n.render(o,-1,e.cms_reply_num);n.appendItem(s,o.stair_cms_id),t&&"function"==typeof t&&t(i)},onError:function(e){trace("reply_add_error"),i&&"function"==typeof i&&i(e)},onFail:function(e){trace("reply_add_fail"),i&&"function"==typeof i&&i(e)}})):void(new Lib.Login.Ui).login(function(){scope.blogOpener.showDialog(function(){e.uid=$UID,e.login_name=scope.$loginNick||$nick,n.post(e,t,i)})})},render:function(e,t,i){var n=$C("li");if(n.className="SG_j_linedot1",e.cms_body=decodeURIComponent(e.cms_body),e.vimg=e.vimg?e.vimg:"",e.source_vimg=e.source_vimg?e.source_vimg:"",e.from="","weibo"==e.fromProduct){var o='<img height="15" align="absmiddle" width="15" class="SG_icon SG_icon51" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif">';e.user_from_weibo='来自<a target="_blank" href="'+e.ulink+'">'+o+e.weibo_uname+"</a>的评论"}if(e.cms_reply_num=e.cms_reply_num?"("+e.cms_reply_num+")":"",e.show_more="none",e.moreInfo="","comment"===this.type){if(n.id="cmt_"+e.id,0===t&&(n.className=""),0==e.comm_uid?(e.user_image_place='<img src="'+e.user_image+'">',e.user_nick_place=e.uname):(e.user_image_place='<a href="'+e.ria_index_url+'" target="_blank"><img src="'+e.user_image+'"></a>',e.user_nick_place='<a href="'+e.ria_index_url+'">'+e.uname+"</a>"),"blog"===e.fromProduct){var s=/<img\s(?:src=[\S]*)?\s(?:style=[\S]*)?\s(?:onclick=[\S]*)?\s(?:border=[\S]*)?\stitle=[\]["]([\S]*)[\]["]\s?[/]>/gi,a=/<img\s\S*\salt=[']([\S]*)[']\s?[/]>/gi,r=/<img\s(?:height=[\S]*)?\s(?:width=[\S]*)?\s(?:border=[\S]*)?\stitle=[\]["]([\S]*)[\]["]\s(?:onclick=[\S]*)?[\S\s]*[/]>/gi;e.temp_cms_body=e.cms_body.replace(s,"[$1]"),e.temp_cms_body=e.temp_cms_body.replace(a,"$1"),e.temp_cms_body=e.temp_cms_body.replace(r,"[$1]");var l=this.__getLen(e.temp_cms_body);l>280&&(e.show_more="",e.moreInfo='<div class="SG_revert_Inner SG_txtb" id="body_cmt_full_'+e.id+'" style="display:none;">'+e.cms_body+'<a href="javascript:void(0);" class="btn_artsq" style="display:"";" action-type="comment_more" action-data="'+e.action_data+'"></a></div>',e.cms_body=this.leftB(e.temp_cms_body,280))}}else"reply"===this.type&&(n.id="reply_"+e.id,i>=1&&t===i-1&&(n.className=""),0==i&&-1==t&&(n.className=""),e.soure_user_info=0==e.source_uid?"&nbsp;"+e.source_uname+"&nbsp;：":'&nbsp;<a href="'+e.source_ria_index_url+'" target="_blank">'+e.source_uname+"</a>"+e.source_vimg+"：");e.show_del=!$UID||e.comm_uid!=$UID&&e.src_uid!=$UID?"none":"",e.show_report="qing"!=e.fromProduct?"":"none";var c=new Date,d=new Date(e.cms_pubdate.replace(/-/g,"/"));e.cms_pubdate=this.dateFormat(c,d);var h=new Lib.HtmlTemplate(this.tpl).evaluate(e);return n.innerHTML=h,n},appendItem:function(e,t){var i=$E("comment_"+t+"_replylist");i.insertBefore(e,i.firstChild),i.style.display=""},getTpl:function(){return"comment"===this.type?'<div class="SG_revert_Left">#{user_image_place}</div><div class="SG_revert_Cont"><p><span class="SG_revert_Tit">#{user_nick_place}</span>#{vimg}</p><div class="SG_revert_Inner SG_txtb" id="body_cmt_#{id}">#{cms_body}<a href="javascript:void(0);" class="btn_artzk" style="display:#{show_more}" action-type="comment_more" action-data="#{action_data}"></a></div>#{moreInfo}<p class="myReFrom"><em class="SG_txtc">#{cms_pubdate}</em>#{user_from_weibo}<span class="SG_revert_Func"><a href="javascript:void(0);" class="SG_a_fuc" action-type="comment_report" action-data="#{action_data}" style="display:#{show_report}"><cite>举报</cite></a><a href="javascript:void(0);" class="SG_a_fuc" action-type="comment_del" action-data="#{action_data}" style="display:#{show_del}">删除</a><a href="javascript:void(0);" class="SG_a_fuc" action-type="comment_share" action-data="#{action_data}" style="display:#{show_share}"><cite>分享</cite></a><a href="javascript:void(0);" class="SG_a_fucs" action-type="comment_reply" action-data="#{action_data}" style="display:#{show_reply}"><cite>回复#{cms_reply_num}</cite></a></span></p><div class="SG_reply" id="comment_#{id}" style="display:none;"></div></div>':'<div class="img"><a href="#{ria_index_url}" target="_blank"><img src="#{user_image}"></a></div><div class="txt"><p><a href="#{ria_index_url}" target="_blank">#{uname}</a>#{vimg}&nbsp;回复#{soure_user_info}#{cms_body}(#{cms_pubdate})</p></div><div class="links"><a href="javascript:void(0);" action-type="reply_report" action-data="#{action_data}" style="display:#{show_report}">举报</a><a href="javascript:void(0);" action-type="reply_del" action-data="#{action_data}" style="display:#{show_del}">删除</a><a href="javascript:void(0);" action-type="reply_share" action-data="#{action_data}" style="display:#{show_share}">分享</a><a href="javascript:void(0);" class="links_s" action-type="reply_reply" action-data="#{action_data}" style="display:#{show_reply}">回复</a></div>'},__getLen:function(e){if(!e)return 0;var t=e.match(/[^\x00-\xff]/g);return e.length+(t?t.length:0)},obj2str:function(e){return encodeURIComponent(this.jsonUtil.flatten(e))},str2obj:function(e){return this.jsonUtil.eval(decodeURIComponent(e))},dateFormat:function(e,t){var i="月",n="日",o="今天",s="秒前",a="分钟前",r=e.getFullYear(),l=t.getFullYear(),c=e.getMonth()+1,d=t.getMonth()+1,h=e.getDate(),p=t.getDate(),u=e.getHours(),g=t.getHours();10>g&&(g="0"+g),g="&nbsp;"+g;var m=t.getMinutes();10>m&&(m="0"+m);var f=e-t;return f=f>0?f:0,f/=1e3,r!=l?l+"-"+d+"-"+p+" "+g+":"+m:c!=d||h!=p?d+i+p+n+g+":"+m:u!=g&&f>3600?o+g+":"+m:51>f?(f=1>f?1:f,Math.floor((f-1)/10)+1+"0"+s):Math.floor(f/60+1)+a}}),Core.Dom.opacity=function(e,t){e="string"==typeof e?$E(e):e,e.style.filter="alpha(opacity="+t+")",e.style.opacity=t/100},Core.Dom.insertAfter=function(e,t){var i=t.parentNode;return i.lastChild==t?i.appendChild(e):i.insertBefore(e,t.nextSibling),e},Core.Dom.wrap=function(e,t){var i=$C(t);return Core.Dom.insertAfter(i,e),i.appendChild(e),i},Ui.Slide=Core.Class.create(),Ui.Slide.prototype={node:null,container:null,status:"show",offset:0,onSlideIn:new Function,onSlideOut:new Function,initialize:function(e,t){var t=t||{};this.node=$E(e),this.container=Core.Dom.wrap(this.node,"div"),this.container.style.overflow="hidden",this.offset=this.node.offsetHeight,this.opacity=!0,this.animation=t.animation||"strongEaseOut",this.duration=t.duration||1,this.container.style.height=this.offset+"px",this.node.style.marginTop="0px"},slideIn:function(e){e=e||{},this.opacity&&new Ui.tween(this.node,"opacity",1,this.duration,this.animation,{}),new Ui.tween(this.container,"height",this.offset,this.duration,this.animation,e),new Ui.tween(this.node,"marginTop",0,this.duration,this.animation,{tween:function(){}.bind2(this),end:this.onSlideIn})},slideOut:function(e){e=e||{},this.opacity&&new Ui.tween(this.node,"opacity",0,this.duration,this.animation,{}),new Ui.tween(this.container,"height",0,this.duration,this.animation,e),new Ui.tween(this.node,"marginTop",-this.offset,this.duration,this.animation,{end:this.onSlideOut})},show:function(){this.opacity,this.container.style.height=this.offset+"px",this.node.style.marginTop="0px"},hide:function(){this.opacity,this.container.style.height="0px",this.node.style.marginTop=-this.offset+"px"}},CommentV2.Delete=function(){Lib.checkAuthor()}.$define({deleteComment:function(e,t){trace("CommentV2.CommentDel.deleteComment");var i=this,n=e.data,o="",s="",a="确认需要删除此条评论？<br/>删除后不可恢复。";($UID==n.comm_uid||0==n.comm_uid)&&(o=' style="display:none" '),"qing"!==n.fromProduct&&(s="<div "+o+'><input id="cbAddToBlock_'+n.commentid+'" type="checkbox"/><label for="cbAddToBlock_'+n.commentid+'">将此人加入黑名单</label></div>'),this.del_url=new Interface("http://control.blog.sina.com.cn/admin/comment_new/cms_del_post.php",$IE6?"ijax":"jsload"),winDialog.confirm(a,{subText:s,textOk:"删除",funcOk:function(){var e={GET:{article_id:n.articleid,cms_id:n.commentid,cms_uid:n.comm_uid,login_uid:$UID,inblack:$E("cbAddToBlock_"+n.commentid).checked?1:0},onSuccess:function(e){var i=$E("body_cmt_"+n.commentid).parentNode.parentNode,o=new Ui.Slide(i);o.onSlideOut=function(){Core.Dom.removeNode(i)},o.slideOut(),t&&"function"==typeof t&&t(e)},onError:function(e){i.showError(e)},onFail:function(e){i.showError(e)}};i.del_url.request(e)}})},deleteReply:function(e,t){trace("CommentV2.CommentDel.deleteReply");var i=this,n=e.data,o="",s="",a="确认需要删除此条回复？<br/>删除后不可恢复。";$UID==n.comm_uid&&(o=' style="display:none" '),"qing"!==n.fromProduct&&(s="<div "+o+'><input id="cbAddToBlock_'+n.commentid+'" type="checkbox"/><label for="cbAddToBlock_'+n.commentid+'">将此人加入黑名单</label></div>'),this.del_url=new Interface("http://control.blog.sina.com.cn/admin/comment_new/cms_del_usereply_post.php",$IE6?"ijax":"jsload"),winDialog.confirm(a,{subText:s,textOk:"删除",funcOk:function(){var e={GET:{article_id:n.articleid,cms_id:n.replyid,cms_uid:n.comm_uid,login_uid:$UID,source_uid:n.source_uid,stair_cmsid:n.commentid,inblack:$E("cbAddToBlock_"+n.commentid).checked?"1":"0"},onSuccess:function(e){var i=$E("reply_"+n.replyid),o=new Ui.Slide(i);o.onSlideOut=function(){Core.Dom.removeNode(i)},o.slideOut(),t&&"function"==typeof t&&t(e)},onError:function(e){i.showError(e)},onFail:function(e){i.showError(e)}};i.del_url.request(e)}})},showError:function(e){"B00006"!=e.code&&winDialog.alert($SYSMSG[e.code]||"删除失败，请重试",{icon:"02"})}}),Core.String.decodeHTML=function(e){var t=document.createElement("div");return t.innerHTML=e,void 0==t.innerText?t.textContent:t.innerText},Utils.Form.Radio={},Utils.Form.Radio.get=function(e){if(!e)return"";var t=e.length;if(void 0==t)return e.checked?e.value:"";for(var i=0;t>i;i++)if(e[i].checked)return e[i].value;return""},Utils.Form.Radio.set=function(e,t){if(e){var i=e.length;if(void 0==i)return void(e.checked=e.value==t.toString());for(var n=0;i>n;n++)e[n].checked=!1,e[n].value==t.toString()&&(e[n].checked=!0)}},scope.reportMainTpl=['<div id="#{panel}" class="blog_report">','<div id="#{titleBar}" class="BRpt_topTit">','<a href="#" onclick="return false;" id="#{btnClose}" title=""><img src="http://simg.sinajs.cn/blog7style/images/common/report/icon_clo.gif" /></a>',"</div>",'<div id="#{content}" class="BRpt_mid">',"</div>","</div>"].join(""),scope.reportStartTpl=['<div class="BRpt_Mtop">',"<p>新浪博客愿和您一起共同打造健康和谐的网络信息交流平台。并有7×24小时的值班服务，及时有效的处理您的举报。</p>","</div>",'<div class="Brpt_RtConn">','<p id="#{resumeInfo}" class="Brpt_RtInf"></p>','<textarea id="#{resumeContent}" readonly="readonly" class="Brpt_RtTxt"></textarea>','<p class="Brpt_Rhost"><input type="checkbox" id="#{cbBlogHost}" /><label for="#{cbBlogHost}">同时举报博主</label></p>','<div class="clear"></div>','<div class="Brpt_choCla">','<p class="claTit">请选择您举报类别（<span class="cho">必选</span>）：</p>','<p class="cla_conn">','<input id="ero" value="1" type="radio" name="chocla" /><label for="ero">色情</label>','<input id="pol" value="2" type="radio" name="chocla" /><label for="pol">政治</label>','<input id="tor" value="3" type="radio" name="chocla" /><label for="tor">侵权</label>','<input id="adv" value="5" type="radio" name="chocla" /><label for="adv">广告</label>','<input id="oth" value="4" type="radio" name="chocla" /><label for="oth">其他</label>',"</p>","</div>",'<p class="Brpt_othInt">您可以填写更多举例说明：</p>','<textarea id="#{reportReason}" class="Brpt_RtTxt"></textarea>',"</div>",'<div class="Brpt_RCBtn">','<a class="BRpt_btnGy" href="#" onclick="return false;" id="#{btnOk}" title=""><span>确认</span></a>','<a class="BRpt_btn" href="#" onclick="return false;" id="#{btnCancel}" title=""><span>取消</span></a>','<div class="clearit"></div>',"</div>"].join(""),scope.reportBadTpl=['<div class="BRpt_Mtop">',"<p>新浪博客愿和您一起共同打造健康和谐的网络信息交流平台。并有7×24小时的值班服务，及时有效的处理您的举报。</p>","</div>",'<div class="Brpt_exclt">','<p class="Brpt_extP1">您已经成功举报了该信息，工作人员会尽快处理。</p>','<p class="Brpt_extP2">再次感谢您对新浪博客的支持！</p>','<div class="Brpt_extBtn"><a class="BRpt_btn" href="#" onclick="return false;" id="#{btnOk}" title=""><span>确认</span></a><div class="clear"></div></div>',"</div>"].join(""),scope.reportSuccessTpl=['<div class="BRpt_Mtop">',"<p>新浪博客愿和您一起共同打造健康和谐的网络信息交流平台。并有7×24小时的值班服务，及时有效的处理您的举报。</p>","</div>",'<div class="Brpt_extRst">','<p class="Brpt_eRTit">举报完成！感谢您对我们工作的支持，我们将在24小时内处理。</p>','<div class="Brpt_eRmtd">','<p class="tit">您还可以：</p>','<div class="conn">','<p class="mtd">','<input type="checkbox" id="#{cbCustom}"/>','<label for="#{cbCustom}">我是新浪博客用户，我要接收处理结果</label><span id="#{guestText}">(您还没有登录)</span>',"</p>","</div>",'<div class="conn2">','<p class="mtd"><input type="checkbox" id="#{cbOtherMethod}" /><label for="#{cbOtherMethod}">我要通过其他方式接收处理结果</label></p>','<div id="#{userForm}" style="display:none;">','<p class="perInf"><span>您的姓名：</span><input id="#{userName}" type="text" /></p>','<p class="perInf"><span>您的邮箱：</span><input id="#{userEmail}" type="text" /></p>','<p class="perInf"><span>您的电话：</span><input id="#{userTel}" type="text" /></p>',"</div>","</div>","</div>",'<div class="Brpt_eRBtn"><a class="BRpt_btnGy" href="#" onclick="return false;" id="#{btnOk}" title=""><span>确认</span></a><div class="clear"></div></div>'].join(""),scope.reportFinishedTpl=['<div class="BRpt_Mtop">',"<p>新浪博客愿和您一起共同打造健康和谐的网络信息交流平台。并有7×24小时的值班服务，及时有效的处理您的举报。</p>","</div>",'<div class="Brpt_thx">',"<p>再次感谢您对新浪博客举报的大力支持！</p>",'<div class="Brpt_thxBtn"><a class="BRpt_btnGy" href="#" onclick="return false;" id="#{btnCancel}" title=""><span>关闭</span></a></div>',"</div>"].join(""),scope.GeneralReport=Core.Class.create(),scope.GeneralReport.prototype={type:"",_hashType:{comment:{"class":"2",initFunction:null},blog:{"class":"1",initFunction:null},guestBook:{"class":"3",initFunction:null},friend:{"class":"4",initFunction:null},photoComment:{"class":"5",initFunction:null},paperlist:{"class":"6",initFunction:null}},dataInterface:null,canSubmit:!0,bodyID:"",reportUID:"",userNameInfo1:"",userNameInfo2:"",titleInfo:"",nickName:"",contentInfo:"",tUID:"",_isInitDialog:!1,_dialog:null,initialize:function(){this.dataInterface=new Interface("http://control.blog.sina.com.cn/admin/advice/impeach_post_content.php?version=7","ijax"),this._hashType.comment.initFunction=this._commentInit,this._hashType.blog.initFunction=this._blogInit,this._hashType.guestBook.initFunction=this._guestBookInit,this._hashType.friend.initFunction=this._friendInit,this._hashType.photoComment.initFunction=this._photoCommentInit,this._hashType.paperlist.initFunction=this._paperlistInit},show:function(){!this._isInitDialog&&this._initDialog(),this._dialog.setAreaLocked(!0),this._dialog.setMiddle(),this._dialog.show(),this._isInitDialog=!0,this._hashType[this.type].initFunction.call(this)},hidden:function(){this._dialog.hidden()},clear:function(){var e=this._dialog.nodes;e.resumeInfo.innerHTML="",e.resumeContent.value="",e.cbBlogHost.checked=!1,Utils.Form.Radio.set($N("chocla"),""),e.reportReason.value=""},submit:function(){var e=this;this.dataInterface.request({POST:{body_id:e.bodyID,"class":e._hashType[e.type]["class"],type:Utils.Form.Radio.get($N("chocla")),fnickname:e.nickName,fuid:e.reportUID,tuid:e.tUID,reason:e._dialog.nodes.reportReason.value,is_report:e._dialog.nodes.cbBlogHost.checked},onSuccess:function(t){e.canSubmit=!0,e.onSuccessed(t)},onError:function(t){e.canSubmit=!0,e.onError(t)},onFail:function(){e.canSubmit=!0}})},_initDialog:function(){this._dialog=winDialog.createCustomsDialog({tpl:scope.reportMainTpl,content:scope.reportStartTpl});var e=this,t=this._dialog.nodes;this._dialog.addEventListener("hidden",function(){e.clear()}),Core.Events.addEvent(t.btnOk,function(){e.canSubmit&&(e.canSubmit=!1,e.submit())},"click"),Core.Events.addEvent(t.btnCancel,function(){e._dialog.hidden()},"click"),Utils.Form.limitMaxLen(t.reportReason,400)},_commentInit:function(){this._dialog.nodes.resumeInfo.innerHTML="您要举报的是"+this.userNameInfo1+"在博文"+this.titleInfo+"中发表的评论，摘要如下：",this._dialog.nodes.resumeContent.value=this.contentInfo,this._dialog.nodes.cbBlogHost.checked=!1},_blogInit:function(){this._dialog.nodes.resumeInfo.innerHTML="您要举报的是"+this.userNameInfo1+"发表的"+this.titleInfo+"，摘要如下：",this._dialog.nodes.resumeContent.value=this.contentInfo,this._dialog.nodes.cbBlogHost.checked=!1},_guestBookInit:function(){this._dialog.nodes.resumeInfo.innerHTML="您要举报的是"+this.userNameInfo1+"在"+this.userNameInfo2+"博客的留言，摘要如下：",this._dialog.nodes.resumeContent.value=this.contentInfo,this._dialog.nodes.cbBlogHost.checked=!1},_friendInit:function(){this._dialog.nodes.resumeInfo.innerHTML="您要举报的是"+this.userNameInfo1+"给您发的好友申请，摘要如下：",this._dialog.nodes.resumeContent.value=this.contentInfo,this._dialog.nodes.cbBlogHost.checked=!0},_photoCommentInit:function(){this._dialog.nodes.resumeInfo.innerHTML="您要举报的是"+this.userNameInfo1+"在图片"+this.titleInfo+"中发表的评论，摘要如下：",this._dialog.nodes.resumeContent.value=this.contentInfo,this._dialog.nodes.cbBlogHost.checked=!1},_paperlistInit:function(){this._dialog.nodes.resumeInfo.innerHTML="您要举报的是"+this.userNameInfo1+"给您发送的纸条，摘要如下：",this._dialog.nodes.resumeContent.value=this.contentInfo,this._dialog.nodes.cbBlogHost.checked=!1},onSuccessed:function(){},onError:function(){}},Utils.Form.inputListen=function(e,t,i){if(e=$E(e),"undefined"!=typeof t&&(t=isNaN(t)?null:1*t),null==e||null==t||1!=e.nodeType)return!1;i=i||{};var n=i.limitRe,o=i.doubleByte;o=null==o?!0:o;var s=function(){try{var t=Core.Events.getEvent();if(t){var i=t.which||t.keyCode;if(37==i||39==i)return!1}}catch(s){}for(var a=e.max;null!=n&&n.test(e.value);)e.value=e.value.replace(n,"");if(1==o)if(Core.String.byteLength(e.value)>a){for(var r=e.value.substr(0,a);Core.String.byteLength(r)>a;)r=r.replace(/.$/,"");e.value=r,e.maxLength=r.length}else e.maxLength=a-e.value.replace(/[\x00-\xff]/g,"").length;else e.maxLength=a;a<e.value&&(e.value=e.value.substr(0,a))},a=function(){null!=n&&n.test(e.value)&&(e.value=e.value.replace(n,""))};e.max=t,e.maxLength=t,s(),null==e.beWatched&&(e.beWatched=!0,$IE?(Core.Events.addEvent(e,s,"keyup"),Core.Events.addEvent(e,s,"keypress"),Core.Events.addEvent(e,s,"mouseout")):Core.Events.addEvent(e,s,"input"),Core.Events.addEvent(e,a,"blur"))
},scope.SuccessedReport=Core.Class.create(),scope.SuccessedReport.prototype={loginUI:null,_isInitDialog:!1,canSubmit:!0,dataInterface:null,dataID:"",bodyID:"",userInfo:{nickName:""},initialize:function(){this.dataInterface=new Interface("http://control.blog.sina.com.cn/admin/advice/impeach_post_userinfo.php?version=7","ijax"),this.loginUI=new Lib.Login.Ui},show:function(){!this._isInitDialog&&this._initDialog(),this._dialog.setAreaLocked(!0),this._dialog.setMiddle(),this._dialog.show(),this._isInitDialog=!0},displayUserInfo:function(e){this._dialog.nodes.userForm.style.display=e===!1?"none":""},login:function(){var e=this;this.loginUI.login(function(){e.submit()})},clear:function(){var e=this._dialog.nodes;e.cbCustom.checked=!1,e.cbOtherMethod.checked=!1,e.userForm.style.display="none",e.userName.value="",e.userEmail.value="",e.userTel.value=""},hidden:function(){this._dialog.hidden()},submit:function(){var e=this,t=this._dialog.nodes;Lib.checkAuthor(),e.canSubmit=!1,this.dataInterface.request({POST:{id:e.dataID,body_id:e.bodyID,nickname:"undefined"==typeof $nick?"":$nick,name:t.userName.value,email:t.userEmail.value,phone:t.userTel.value,uid:$UID,is_login:t.cbCustom.checked?"1":"0"},onSuccess:function(t){e.canSubmit=!0,e.onSuccessed(t)},onError:function(t){e.canSubmit=!0,e.onError(t)},onFail:function(){e.canSubmit=!0}})},_initDialog:function(){this._dialog=winDialog.createCustomsDialog({tpl:scope.reportMainTpl,content:scope.reportSuccessTpl});var e=this,t=this._dialog.nodes;this._dialog.addEventListener("hidden",function(){e.clear()}),Lib.checkAuthor(),t.guestText.style.display=$isLogin?"none":"",Core.Events.addEvent(t.btnOk,function(){e.canSubmit&&(Lib.checkAuthor(),!$isLogin&&t.cbCustom.checked?e.login():e.submit())},"click"),Core.Events.addEvent(t.cbOtherMethod,function(){e.displayUserInfo(t.cbOtherMethod.checked)},"click"),Utils.Form.inputListen(t.userName,100),Utils.Form.inputListen(t.userEmail,200),Utils.Form.inputListen(t.userTel,100)},onSuccessed:function(){},onError:function(){}},$SYSMSG.extend({B04102:"您输入的电子邮件格式错误，请重新输入",B04105:"很抱歉，您输入的内容过多，请删减后重新提交",B04107:"您要举报的内容已经不存在，感谢您的支持",B04108:"举报分类错误",B04109:"您还没有选择举报类别，请选择后继续操作",B04110:"您的昵称为空，请输入后继续操作",B04111:"系统繁忙，请稍后再试",B04112:"您已经举报过该用户，再次感谢您的支持",B04113:"系统繁忙，请稍后再试",B04114:"系统繁忙，请稍后再试",B04115:"系统繁忙，请稍后再试",B04116:"系统繁忙，请稍后再试"}),Lib.BlogReport=Core.Class.create(),Lib.BlogReport.prototype={generalReport:null,successedReport:null,badReport:null,finishedReport:null,isBRInit:!1,isFRInit:!1,initialize:function(){this.generalReport=new scope.GeneralReport,this.successedReport=new scope.SuccessedReport},start:function(e,t,i,n,o,s,a,r,l){var c=this,d=this.generalReport;r=Core.String.decodeHTML(r),d.nickName=t,d.type=e,d.reportUID=n,d.userNameInfo1=o,d.userNameInfo2=s,d.titleInfo=a,d.contentInfo=Core.String.byteLength(r)>800?Core.String.shorten(r,800):r,d.bodyID=i,d.tUID=l?l:"",d.onSuccessed=function(e){c.reportSuccess(t,i,e.dataID),this.hidden()},d.onError=function(e){"B04112"===e.code?(c.showBad(),this.hidden()):winDialog.alert($SYSMSG[e.code])},d.show()},showBad:function(){var e=this;this.isBRInit||(this.badReport=winDialog.createCustomsDialog({tpl:scope.reportMainTpl,content:scope.reportBadTpl}),Core.Events.addEvent(this.badReport.nodes.btnOk,function(){e.badReport.hidden()},"click")),this.badReport.setAreaLocked(!0),this.badReport.setMiddle(),this.badReport.show()},reportSuccess:function(e,t,i){var n=this,o=this.successedReport;o.bodyID=t,o.dataID=i,o.userInfo.nickName=e,o.onSuccessed=function(){n.finished(),this.hidden()},o.onError=function(e){winDialog.alert($SYSMSG[e.code])},o.show()},finished:function(){var e=this;this.isFRInit||(this.finishedReport=winDialog.createCustomsDialog({tpl:scope.reportMainTpl,content:scope.reportFinishedTpl}),Core.Events.addEvent(this.finishedReport.nodes.btnCancel,function(){e.finishedReport.hidden()},"click")),this.finishedReport.setAreaLocked(!0),this.finishedReport.setMiddle(),this.finishedReport.show()}},CommentV2.Report=function(){this.BR=new Lib.BlogReport,this.getInterface=new Interface("http://control.blog.sina.com.cn/blog_rebuild/riaapi/profile/note/getCms.php","jsload")}.$define({commentReport:function(e){trace("CommentV2.Report.commentReport");var t={cms_id:e.commentid,uid:e.src_uid};this.setReport(e,t)},replyReport:function(e){trace("CommentV2.Report.replyReport");var t={cms_id:e.replyid,uid:e.src_uid};this.setReport(e,t)},setReport:function(e,t){var i=this,n=scope.$articleid,o=e.commentid,s=n+"_"+o,a=e.uname,r=e.comm_uid,l="",c="",d='<a target="_blank" href="http://blog.sina.com.cn/s/blog_'+n+'.html">'+$E("t_"+n).innerHTML+"</a>";e.ulink=e.ulink?e.ulink:"http://blog.sina.com.cn/u/"+e.comm_uid,l=0!=e.comm_uid?'<a href="'+e.ulink+'" target="_blank">'+a+"</a>":"<strong>"+a+"</strong>",this.getInterface.request({GET:t,onSuccess:function(e){var t=e.cms_body;i.BR.start("comment",a,s,r,l,c,d,t)},onError:function(){},onFail:function(){}})}}),CommentV2.Share=function(){trace("CommentV2.Share"),this.shorten=Core.String.shorten,this.getInterface=new Interface("http://control.blog.sina.com.cn/blog_rebuild/riaapi/profile/note/getCms.php","jsload"),this.getWeiboNameInterface=new Interface("http://i2.api.weibo.com/2/users/show.json","jsload")}.$define({commentShare:function(e){this.data=e||{},this.__commentShare()},replyShare:function(e){this.data=e||{},this.type="reply";var t=this.data.replyid,i=this.data.src_uid;this.__getCmsBody(t,i)},__getCmsBody:function(e,t){var i=this,n={cms_id:e,uid:t,origin:1};this.getInterface.request({GET:n,onSuccess:i.__getWeiboName.bind2(i),onError:function(){},onFail:function(){}})},__getWeiboName:function(e){var t=this;this.body=e.cms_body,this.uid=e.uid,this.src_title=e.src_title,window.jsonpweiboname=function(e){t.name=1==e.code&&e.data?encodeURIComponent("@"+e.data.name):encodeURIComponent(" "+t.data.uname)||"",t.__share()};var i={uid:this.uid,source:"1617465124",callback:"jsonpweiboname"};this.getWeiboNameInterface.request({GET:i,onSuccess:function(){},onError:function(){},onFail:function(){}})},__share:function(){var e=this.body;if("comment"===this.type)if("blog"===this.data.fromProduct){var t=/\[emoticons=(E___\w*)\]([^[]*)\[\/emoticons\]/gi,i=/\[magicemoticons=([E|W]___\w*)\&nbsp\;swfname=(\w+\.swf)\]([^[]*)\[\/magicemoticons\]/gi;e=e.replace(t,"[$2]"),e=e.replace(i,"[$3]")}else{var n=/<img\s[\S]*\salt=[\]["][^-]*[-]?([\S]*)[\]["]\s?[\][/]>/gi;e=e.replace(n,"[$1]")}e=encodeURIComponent(this.shorten(e,100));var o=(encodeURIComponent(location.href),encodeURIComponent(this.src_title)||encodeURIComponent($E("t_"+scope.$articleid).innerHTML)),s="分享"+this.name+" 对博文【"+o+"】的评论："+e+" 查看原文：",a=encodeURIComponent(s),r="新浪-博客",l="http://blog.sina.com.cn",c="http://v.t.sina.com.cn/share/share.php?searchPic=false&title="+a+"&url="+encodeURIComponent(document.location)+"&source="+r+"&sourceUrl="+encodeURIComponent(l)+"&content=utf-8&appkey=1617465124";window.open(c,"selectionshare","toolbar=0,status=0,resizable=1,width=440,height=430,left="+(screen.width-440)/2+",top="+(screen.height-430)/2)},__commentShare:function(){var e=$E("t_"+scope.$articleid).innerHTML;e=e.replace(/\&nbsp\;/g," ");var t,i,n=this.data.commentid,o=$E("body_cmt_"+n);if(t="string"==typeof o.innerText?o.innerText:o.textContent,"blog"===this.data.fromProduct){var s=/\[emoticons=(E___\w*)\]([^[]*)\[\/emoticons\]/gi,a=/\[magicemoticons=([E|W]___\w*)\&nbsp\;swfname=(\w+\.swf)\]([^[]*)\[\/magicemoticons\]/gi;t=t.replace(s,"[$2]"),t=t.replace(a,"[$3]"),i=" "+this.data.uname}else{var r=/<img\s[\S]*\salt=[\]["][^-]*[-]?([\S]*)[\]["]\s?[\][/]>/gi;t=t.replace(r,"[$1]"),i="@"+this.data.uname}t=this.shorten(t,100),e=this.shorten(e,60);var l="分享"+i+" 对博文【"+e+"】的评论："+t+" 查看原文：",c=encodeURIComponent(l),d="新浪-博客",h="http://blog.sina.com.cn",p="http://v.t.sina.com.cn/share/share.php?searchPic=false&title="+c+"&url="+encodeURIComponent(document.location)+"&source="+d+"&sourceUrl="+encodeURIComponent(h)+"&content=utf-8&appkey=1617465124";window.open(p,"selectionshare","toolbar=0,status=0,resizable=1,width=440,height=430,left="+(screen.width-440)/2+",top="+(screen.height-430)/2)}}),CommentV2.ReplyList=function(e){this.type="reply",this.cmtAdd=new CommentV2.Add({type:this.type,url:"http://control.blog.sina.com.cn/admin/comment_new/cms_usereply_post.php?domain=2",tpl:e.replyTpl||""}),this.ownerNickName=e.data.ownerNickName||"",this.cmtDel=new CommentV2.Delete,this.cmtReport=new CommentV2.Report,this.cmtShare=new CommentV2.Share,this._openAreas={}}.$extends(CommentV2.List).$define({load:function(e){var t=this;if(this.initContainerAndTextArea(),this.show(),0!=this.data.cms_reply_num){this.showLoading(),this.page=e;var i={article_id:this.articleid,comment_id:this.data.commentid,page:this.page};this.url="http://control.blog.sina.com.cn/admin/comment_new/cms_usereply_list.php?domain=2",this.loader=new Interface(this.url,"ijax"),this.loader.request({POST:i,returnType:"json",onSuccess:t.render.bind2(t),onError:function(e){trace("reply list onerror"),this.error(e.code)}.bind2(t),onFail:function(e){trace("reply list onfail"),this.error(e.code)}.bind2(t)})}},render:function(e){this.renderList(e),this.paging()},initContainerAndTextArea:function(){if(!this.containerIsReady){var e='<div class="SG_reply_con borderc"><div class="bd"><div id="comment_'+this.data.commentid+'_textarea"></div><div class="reply_list"><ul id="comment_'+this.data.commentid+'_replylist" style="display:none;"></ul></div><div class="rp2" id="loading_'+this.data.commentid+'" style="display:none"><div class="SG_reply_con"><div class="bd"><div class="loading"><span class="ico_loading"></span><p>正在加载，请稍后...</p></div></div></div></div><div class="SG_page" style="display:none;"><ul class="SG_pages" id="comment_'+this.data.commentid+'_pages"></ul></div></div></div>';this.containerNode.innerHTML=e,this.renderTextArea(),this.containerIsReady=1}},renderTextArea:function(){var e=new CommentV2.CommentArea({container:$E("comment_"+this.data.commentid+"_textarea")}),t=this.data,i=$E("ownernick"),n=i?this.trim(i.innerHTML):"";e.setReplyData(this,{article_id:this.articleid,reply_cmsid:t.commentid,stair_cmsid:t.commentid,src_uname:this.data.ownerNickName||n,blog_title:$E("t_"+this.articleid)?this.trim($E("t_"+this.articleid).innerHTML):"",uid:$UID,source_uid:t.comm_uid,source_uname:t.uname,login_name:scope.$loginNick,is_t:0,source_ulink:t.ulink})},renderList:function(e){if(Lib.checkAuthor(),""==e)this.error($isAdmin?"B36021":"B36020");else{var t,i=document.createDocumentFragment();if(this.total=e&&e.cms_usereply_totalnum,this.total=parseInt(this.total,10),this.hideLoading(),0==this.total)return void this.show();for(var n=e.comment_reply_data,o=n.length,s=e.blog_id,a=0;o>a;a++){var r=n[a];r.action_data=this.obj2str({articleid:s,commentid:r.stair_cms_id,replyid:r.id,comm_uid:r.comm_uid,uname:r.uname,source_uid:r.source_uid,ulink:r.ria_index_url,source_ulink:r.ulink,src_uid:r.src_uid}),t=this.cmtAdd.render(r,a,o),i.appendChild(t)}$E("comment_"+this.data.commentid+"_replylist").appendChild(i),$E("comment_"+this.data.commentid+"_replylist").style.display="",location.hash="cmt_"+this.data.commentid}},show:function(){CommentV2.ReplyList.$super.show.call(this),v7sendLog("32_01_01");var e=this.node.innerHTML;e=e.replace(/回复|取消回复/,"取消回复"),this.node.innerHTML=e},hide:function(){CommentV2.ReplyList.$super.hide.call(this),v7sendLog("32_01_02");var e=this.node.innerHTML;e=e.replace("取消",""),this.node.innerHTML=e},showLoading:function(){$E("comment_"+this.data.commentid+"_replylist").innerHTML="",$E("loading_"+this.data.commentid).style.display=""},hideLoading:function(){$E("loading_"+this.data.commentid).style.display="none"},paging:function(){var e=this,t=$E("comment_"+this.data.commentid+"_pages");if(t){var i=20,n=0;n=this.total%i==0?Math.ceil(this.total/i):Math.floor(this.total/i)+1,this.total>i?(t.parentNode.style.display="block",t.style.display="block",Ui.Pagination.init({pageNode:"comment_"+e.data.commentid+"_pages",nodeClassNamePrefix:"SG",curPage:this.page,maxPage:n,pageTpl:function(t){e.load(t),location.hash=""}}).show()):t.parentNode.style.display="none"}},setSrcComment:function(e,t,i){var n={cms_id:e,uid:t,origin:1},o=new Interface("http://control.blog.sina.com.cn/blog_rebuild/riaapi/profile/note/getCms.php","jsload");o.request({GET:n,onSuccess:function(e){var t=e.cms_body,n=e.nick_name,o=e.source_uname;if(t){var s="//@"+n+" 回复 @"+o+" :"+t;i.setValues({comment:s})}}.bind2(this),onError:function(e){e&&e.code&&winDialog.alert($SYSMSG[e.code],{funcOk:function(){}})},onFail:function(e){e&&e.code&&winDialog.alert($SYSMSG[e.code],{funcOk:function(){}})}})},reply:function(e){var t=this;if(e.containerNode.isInited){var i=$E("reply_"+e.data.replyid+"_textcon");"none"==i.style.display?(v7sendLog("32_01_05"),i.style.display="",""==this._openAreas[e.data.replyid].getValue()&&this.setSrcComment(e.data.replyid,e.data.src_uid,this._openAreas[e.data.replyid]),e.node.innerHTML="<cite>取消回复</cite>"):(i.style.display="none",e.node.innerHTML="<cite>回复</cite>")}else{v7sendLog("32_01_05"),e.node.innerHTML="<cite>取消回复</cite>";var n='<div class="SG_reply_con"><div class="bd" id="reply_'+e.data.replyid+'_textarea"></div></div>',o=document.createElement("div");o.className="SG_reply borderc rp2",o.innerHTML=n,o.id="reply_"+e.data.replyid+"_textcon",e.containerNode.appendChild(o),e.containerNode.isInited=!0;var s=$E("reply_"+e.data.replyid+"_textarea"),a=e.data;this._openAreas[e.data.replyid]=new CommentV2.CommentArea({container:s,autolineheight:"yes",sid:(new Date).getTime(),shownum:"no",okhandler:function(){var t=$E("reply_"+e.data.replyid+"_textcon");t&&(t.style.display="none",e.node.innerHTML="<cite>回复</cite>")}}),this._openAreas[e.data.replyid].setReplyData(t,{article_id:e.articleid,reply_cmsid:a.replyid,stair_cmsid:a.commentid,src_uname:this.ownerNickName,blog_title:$E("t_"+e.articleid).innerHTML,uid:$UID,source_uid:a.comm_uid,source_uname:a.uname,login_name:scope.$loginNick,is_t:0,source_ulink:a.source_ulink}),this.setSrcComment(a.replyid,a.src_uid,this._openAreas[e.data.replyid])}},add:function(e,t,i){trace("CommentV2.ReplyList.add"),trace(e),e.cms_reply_num=this.total,this.cmtAdd.post(e,function(){this.total++;var e=this.node.innerHTML;this.node.innerHTML=e.replace(/(\d+)/,this.total);var e=$E("c_"+this.articleid).innerHTML,i=parseInt(/(\d+)/.exec(e)[0],10);i++,$E("c_"+this.articleid).innerHTML="("+i+")",t()}.bind2(this),i)},share:function(e){trace("CommentV2.ReplyList.share"),v7sendLog("32_01_06"),this.cmtShare.replyShare(e.data)},del:function(e){trace("CommentV2.ReplyList.del"),v7sendLog("32_01_08"),this.cmtDel.deleteReply(e,this.delSucc.bind2(this))},delSucc:function(){this.total=this.total--?this.total:0;var e=this.node.innerHTML;this.node.innerHTML=e.replace(/(\d+)/,this.total);var e=$E("c_"+this.articleid).innerHTML,t=parseInt(/(\d+)/.exec(e)[0],10);t=t--?t:0,$E("c_"+this.articleid).innerHTML="("+t+")",0==this.total&&($E("comment_"+this.data.commentid+"_replylist").style.display="none")},report:function(e){trace("CommentV2.ReplyList.report"),v7sendLog("32_01_07"),this.cmtReport.replyReport(e.data)}}),CommentV2.CommentList=function(e){this.ownerNickName="",this.type="comment",this.defaultAnchor="#comment",this.replyList={},this.addEvent=Core.Events.addEvent,this.removeEvent=Core.Events.removeEvent,this.cmtAdd=new CommentV2.Add({type:this.type,tpl:e.commentTpl||""}),this.cmtDel=new CommentV2.Delete,this.cmtReport=new CommentV2.Report,this.cmtShare=new CommentV2.Share,this.bindEvent()}.$extends(CommentV2.List).$define({load:function(e){var t=this;this.page=e,this.url=this.purl+"_"+this.page+".html?comment_v=articlenew",this.loader=new Interface(this.url,"ajax"),this.loader.request({GET:{url_random:0},returnType:"json",onSuccess:t.render.bind2(t),onError:function(e){switch(e.code){case"B36020":case"B36021":case"A00001":this.error(e.code);break;default:this.showError(e.code),this.error("B36110")}}.bind2(this),onFail:function(){this.error("B36110")}.bind2(this)})},render:function(e){if(Lib.checkAuthor(),this.containerNode.innerHTML="",""==e)return void this.error($isAdmin?"B36021":"B36020");var t,i,n=document.createDocumentFragment();this.total=e.comment_total_num,0==this.total&&this.renderNoComment();for(var o=0,s=e.comment_data.length;s>o;o++)i=e.comment_data[o],i.action_data=this.obj2str({commentid:i.id,articleid:scope.$articleid,fromProduct:i.fromProduct,comm_uid:i.comm_uid,uname:i.uname,ulink:i.ulink,src_uid:i.src_uid,cms_reply_num:i.cms_reply_num}),t=this.cmtAdd.render(i,o),n.appendChild(t);this.containerNode.appendChild(n),this.anchor(),this.paging(),this.sendEvents(e)},sendEvents:function(e){Lib.Listener.notify("commentlist-isready",e),scope.$commentlistIsReady=1},renderNoComment:function(){this.containerNode.innerHTML='<li><div class="noCommdate"><span class="SG_txtb">做第一个评论者吧！ <img class="SG_icon SG_icon134" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="18" height="18" title="" align="absmiddle"><a href="#post">抢沙发&gt;&gt;</a></span></div></li>'},add:function(e){var t=(e.item,e.fun),i=this.cmtAdd.render(e.item);t(i)},del:function(e){trace("CommentV2.CommentList.del"),this.cmtDel.deleteComment(e,this.delSucc.bind2(this))},delSucc:function(e){this.total=e&&e.staircms_total_num;var t=$E("c_"+scope.$articleid).innerHTML,i=parseInt(/(\d+)/.exec(t)[0],10);i=i--?i:0,$E("c_"+scope.$articleid).innerHTML="("+i+")",0==this.total?this.renderNoComment():0==this.containerNode.getElementsByTagName("li").length&&(this.page--,this.load(this.page))},reply:function(e){trace("CommentV2.CommentList.reply");var t=this;Lib.Uic.getNickName([scope.$uid],function(i){t.ownerNickName=i[scope.$uid]||"",e.replyTpl=t.replyTpl||"",e.data.ownerNickName=t.ownerNickName;var n=e.data.commentid;t.replyList[n]?t.replyList[n].toggle():t.replyList[n]=new CommentV2.ReplyList(e)})},report:function(e){trace("CommentV2.CommentList.report"),this.cmtReport.commentReport(e.data)},share:function(e){trace("CommentV2.CommentList.share"),this.cmtShare.commentShare(e.data)},more:function(e){trace("CommentV2.CommentList.more");var t=e.data.commentid,i=$E("body_cmt_"+t),n=$E("body_cmt_full_"+t);"btn_artzk"==e.node.className?(v7sendLog("32_01_03"),i&&(i.style.display="none"),n&&(n.style.display="")):"btn_artsq"==e.node.className&&(v7sendLog("32_01_04"),i&&(i.style.display=""),n&&(n.style.display="none"))},paging:function(){var e=this,t=$E("commentPaging");if(t){var i=50,n=0;n=this.total%i==0?Math.ceil(this.total/i):Math.floor(this.total/i)+1,this.total>i?(t.parentNode.style.display="block",$E("commentPaging").style.display="block",Ui.Pagination.init({pageNode:"commentPaging",nodeClassNamePrefix:"SG",curPage:this.page,maxPage:n,pageTpl:function(t){e.load(t)}}).show(),t.onclick=this.sudaClick):t.parentNode.style.display="none"}},sudaClick:function(e){var t=e&&e.target||window.event&&window.event.srcElement;t&&t.tagName&&"a"==t.tagName.toLowerCase()&&Lib.sendSuda(function(){try{SUDA.log("","blog_blogcomment_page")}catch(e){}})},anchor:function(){var e=window.location.href,t="#comment",i=new RegExp("("+t+")\\d*");-1!=e.indexOf(t)?window.location.href=e.replace(i,"$1"+this.page):this.page>1&&(window.location.href=t+this.page)},showError:function(){winDialog.alert($SYSMSG[code],{icon:"02"})}}),Sina.pkg("Utils.Flash"),"undefined"==typeof deconcept)var deconcept=new Object;"undefined"==typeof deconcept.util&&(deconcept.util=new Object),"undefined"==typeof deconcept.SWFObjectUtil&&(deconcept.SWFObjectUtil=new Object),deconcept.SWFObject=function(e,t,i,n,o,s,a,r,l,c){if(document.getElementById){this.DETECT_KEY=c?c:"detectflash",this.skipDetect=deconcept.util.getRequestParameter(this.DETECT_KEY),this.params=new Object,this.variables=new Object,this.attributes=new Array,e&&this.setAttribute("swf",e),t&&this.setAttribute("id",t),i&&this.setAttribute("width",i),n&&this.setAttribute("height",n),o&&this.setAttribute("version",new deconcept.PlayerVersion(o.toString().split("."))),this.installedVer=deconcept.SWFObjectUtil.getPlayerVersion(),!window.opera&&document.all&&this.installedVer.major>7&&(deconcept.SWFObject.doPrepUnload=!0),s&&this.addParam("bgcolor",s);var d=a?a:"high";this.addParam("quality",d),this.setAttribute("useExpressInstall",!1),this.setAttribute("doExpressInstall",!1);var h=r?r:window.location;this.setAttribute("xiRedirectUrl",h),this.setAttribute("redirectUrl",""),l&&this.setAttribute("redirectUrl",l)}},deconcept.SWFObject.prototype={useExpressInstall:function(e){this.xiSWFPath=e?e:"expressinstall.swf",this.setAttribute("useExpressInstall",!0)},setAttribute:function(e,t){this.attributes[e]=t},getAttribute:function(e){return this.attributes[e]},addParam:function(e,t){this.params[e]=t},getParams:function(){return this.params},addVariable:function(e,t){this.variables[e]=t},getVariable:function(e){return this.variables[e]},getVariables:function(){return this.variables},getVariablePairs:function(){var e,t=new Array,i=this.getVariables();for(e in i)t[t.length]=e+"="+i[e];return t},getSWFHTML:function(){var e="";if(navigator.plugins&&navigator.mimeTypes&&navigator.mimeTypes.length){this.getAttribute("doExpressInstall")&&(this.addVariable("MMplayerType","PlugIn"),this.setAttribute("swf",this.xiSWFPath)),e='<embed pluginspage="http://www.macromedia.com/go/getflashplayer" type="application/x-shockwave-flash" src="'+this.getAttribute("swf")+'" width="'+this.getAttribute("width")+'" height="'+this.getAttribute("height")+'" style="'+this.getAttribute("style")+'"',e+=' id="'+this.getAttribute("id")+'" name="'+this.getAttribute("id")+'" ';var t=this.getParams();for(var i in t)e+=[i]+'="'+t[i]+'" ';var n=this.getVariablePairs().join("&");n.length>0&&(e+="flashvars="+n+'&realfull=1&moz=1"'),e+="/>"}else{this.getAttribute("doExpressInstall")&&(this.addVariable("MMplayerType","ActiveX"),this.setAttribute("swf",this.xiSWFPath)),e='<object id="'+this.getAttribute("id")+'" classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" codebase="http://fpdownload.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=9,0,28,0" width="'+this.getAttribute("width")+'" height="'+this.getAttribute("height")+'" style="'+this.getAttribute("style")+'">',e+='<param name="movie" value="'+this.getAttribute("swf")+'" />';var t=this.getParams();for(var i in t)e+='<param name="'+i+'" value="'+t[i]+'" />';var n=this.getVariablePairs().join("&");n.length>0&&(e+='<param name="flashvars" value="'+n+'" />'),e+="</object>"}return e},write:function(e){if(this.getAttribute("useExpressInstall")){var t=new deconcept.PlayerVersion([6,0,65]);this.installedVer.versionIsValid(t)&&!this.installedVer.versionIsValid(this.getAttribute("version"))&&(this.setAttribute("doExpressInstall",!0),this.addVariable("MMredirectURL",escape(this.getAttribute("xiRedirectUrl"))),document.title=document.title.slice(0,47)+" - Flash Player Installation",this.addVariable("MMdoctitle",document.title))}this.skipDetect||this.getAttribute("doExpressInstall")||this.installedVer.versionIsValid(this.getAttribute("version"))||""!=this.getAttribute("redirectUrl")&&document.location.replace(this.getAttribute("redirectUrl"));var i="string"==typeof e?document.getElementById(e):e,n=document.title;return i.innerHTML=this.getSWFHTML(),n!==document.title&&(document.title=n),!0}},deconcept.SWFObjectUtil.getPlayerVersion=function(){var e=new deconcept.PlayerVersion([0,0,0]);if(navigator.plugins&&navigator.mimeTypes.length){var t=navigator.plugins["Shockwave Flash"];t&&t.description&&(e=new deconcept.PlayerVersion(t.description.replace(/([a-zA-Z]|\s)+/,"").replace(/(\s+r|\s+b[0-9]+)/,".").split(".")))}else if(navigator.userAgent&&navigator.userAgent.indexOf("Windows CE")>=0)for(var i=1,n=3;i;)try{n++,i=new ActiveXObject("ShockwaveFlash.ShockwaveFlash."+n),e=new deconcept.PlayerVersion([n,0,0])}catch(o){i=null}else{try{var i=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7")}catch(o){try{var i=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6");e=new deconcept.PlayerVersion([6,0,21]),i.AllowScriptAccess="always"}catch(o){if(6==e.major)return e}try{i=new ActiveXObject("ShockwaveFlash.ShockwaveFlash")}catch(o){}}null!=i&&(e=new deconcept.PlayerVersion(i.GetVariable("$version").split(" ")[1].split(",")))}return e},deconcept.PlayerVersion=function(e){this.major=null!=e[0]?parseInt(e[0]):0,this.minor=null!=e[1]?parseInt(e[1]):0,this.rev=null!=e[2]?parseInt(e[2]):0},deconcept.PlayerVersion.prototype.versionIsValid=function(e){return this.major<e.major?!1:this.major>e.major?!0:this.minor<e.minor?!1:this.minor>e.minor?!0:this.rev<e.rev?!1:!0},deconcept.util={getRequestParameter:function(e){var t=document.location.search||document.location.hash;if(null==e)return t;if(t)for(var i=t.substring(1).split("&"),n=0;n<i.length;n++)if(i[n].substring(0,i[n].indexOf("="))==e)return i[n].substring(i[n].indexOf("=")+1);return""}},deconcept.SWFObjectUtil.cleanupSWFs=function(){for(var e=document.getElementsByTagName("OBJECT"),t=e.length-1;t>=0;t--){e[t].style.display="none";for(var i in e[t])"function"==typeof e[t][i]&&(e[t][i]=function(){})}},deconcept.SWFObject.doPrepUnload&&(deconcept.unloadSet||(deconcept.SWFObjectUtil.prepUnload=function(){__flash_unloadHandler=function(){},__flash_savedUnloadHandler=function(){},window.attachEvent("onunload",deconcept.SWFObjectUtil.cleanupSWFs)},window.attachEvent("onbeforeunload",deconcept.SWFObjectUtil.prepUnload),deconcept.unloadSet=!0)),!document.getElementById&&document.all&&(document.getElementById=function(e){return document.all[e]});var getQueryParamValue=deconcept.util.getRequestParameter,FlashObject=deconcept.SWFObject;Utils.Flash.swfObject=deconcept.SWFObject,Core.Dom.getTop=function(e){var t=0,i=$E(e);if("unknown"!=typeof i.offsetParent)for(;i.offsetParent;)t+=i.offsetTop,i=i.offsetParent;else i.y&&(t+=i.y);return t},Core.Dom.getLeft=function(e){var t=0,i=$E(e);if("unknown"!=typeof i.offsetParent)for(;i.offsetParent;)t+=i.offsetLeft,i=i.offsetParent;else i.x&&(t+=i.x);return t},Lib.applyIf=function(e,t,i){if(i&&Lib.applyIf(e,i),e&&t&&"object"==typeof e)for(var n in t)e[n]||(e[n]=t[n]);return e},Lib.apply=function(e,t,i){if(i&&Lib.applyIf(e,i),e&&t&&"object"==typeof e)for(var n in t)e[n]=t[n];return e},Lib.Panel=Core.Class.create(),Lib.Panel.prototype={noIframe:!1,isPostion:!0,appendTo:null,entity:null,backIframe:null,uniqueID:null,isFixed:!1,isShow:!1,isHidden:!0,x:0,y:0,template:"",initialize:function(e){Lib.apply(this,e);var t=this;this.uniqueID=this._getUniqueID(),this._ie6Fixed=function(){t.entity&&(t.entity.style.left=document.documentElement.scrollLeft+t.x+"px",t.entity.style.top=document.documentElement.scrollTop+t.y+"px"),t.backIframe&&(t.backIframe.style.left=t.entity.style.left,t.backIframe.style.top=t.entity.style.top)}},getNode:function(e){return this.tpl.getNode(e)},setTemplate:function(e){this.template=e,this.entity&&this.entity.parentNode&&(this.entity.parentNode.removeChild(this.entity),this.backIframe&&this.backIframe.parentNode.removeChild(this.backIframe)),this.entity=$C("div");var t=$C("div"),i=new Lib.HtmlTemplate(this.template,this.uniqueID);this.tpl=i,t.innerHTML=i.getHtmlString(),t.style.display="none",this.appendTo?$E(this.appendTo).appendChild(t):document.body.appendChild(t),this.entity=$E("_"+this.uniqueID+"_panel"),this.isPostion&&(this.entity.style.position="absolute"),this.entity.style.display="none",this.appendTo?$E(this.appendTo).replaceChild(this.entity,t):document.body.replaceChild(this.entity,t),t=null,this.noIframe||(this.backIframe=$C("iframe"),this.backIframe.style.display="none",this.backIframe.style.border="none",this.backIframe.style.zIndex=this.entity.style.zIndex-1,document.body.appendChild(this.backIframe),this._updateBackIframe())},setPosition:function(e,t){this.x=e,this.y=t,this.entity.style.left=e+"px",this.entity.style.top=t+"px",$IE6&&this.isFixed&&(this.entity.style.left=e+document.documentElement.scrollLeft+"px",this.entity.style.top=t+document.documentElement.scrollTop+"px"),this.backIframe&&(this.backIframe.style.left=this.entity.style.left,this.backIframe.style.top=this.entity.style.top)},setFixed:function(e){if(this.isFixed=e,$IE6){var t=this;return this.entity.style.position="absolute",void(this.isFixed?(t._ie6Fixed(),Core.Events.addEvent(window,t._ie6Fixed,"scroll")):Core.Events.removeEvent(window,t._ie6Fixed,"scroll"))}this.entity.style.position=this.isFixed?"fixed":"absolute",this.backIframe&&(this.backIframe.style.position=this.entity.style.position)},show:function(){this.entity.style.display="",this.isHidden=!1,this.isShow=!0,this.backIframe&&(this._updateBackIframe(),this.backIframe.style.display="")},hidden:function(){this.hide()},hide:function(){this.entity.style.display="none",this.isHidden=!0,this.isShow=!1,this.backIframe&&(this.backIframe.style.display="none")},close:function(){this.hidden(),this.destroy()},destroy:function(){Core.Events.removeEvent(window,this._ie6Fixed,"scroll"),this.entity.parentNode.removeChild(this.entity),this.entity=null,this.backIframe&&(this.backIframe.parentNode.removeChild(this.backIframe),this.backIframe=null)},showWithDom:function(e,t,i){var n=Core.Dom.getLeft(e)+e.offsetWidth+t,o=Core.Dom.getTop(e)+e.offsetHeight+i;$IE6&&this.isFixed&&(n-=document.documentElement.scrollLeft,o-=document.documentElement.scrollTop),this.setPosition(n,o),this.show()},getWidth:function(){var e=this.entity.style.display,t=this.entity.style.visibility;return this.entity.style.visibility="hidden",this.entity.style.display="",w=this.entity.offsetWidth,this.entity.style.display=e,this.entity.style.visibility=t,w},getHeight:function(){var e=this.entity.style.display,t=this.entity.style.visibility;return this.entity.style.visibility="hidden",this.entity.style.display="",h=this.entity.offsetHeight,this.entity.style.display=e,this.entity.style.visibility=t,h},getX:function(){return parseInt(this.entity.style.left)},getY:function(){return parseInt(this.entity.style.top)},getNodes:function(e){var t,i=e||"o",n=/[^\{\}]+(?=\})/g,o={},s=this.template.match(n);if(s)for(t=0;t<s.length;t++){var a=s[t];switch(i){case"o":o[a]=$E("_"+this.uniqueID+"_"+a);break;case"i":o[a]="_"+this.uniqueID+"_"+a}}return o},_updateBackIframe:function(){Core.Dom.setStyle(this.backIframe,"opacity",0),this.backIframe.style.display="",this.backIframe.style.position=this.entity.style.position,this.backIframe.style.width=this.entity.offsetWidth+"px",this.backIframe.style.height=this.entity.offsetHeight+"px",this.backIframe.style.left=this.entity.style.left,this.backIframe.style.top=this.entity.style.top},_getUniqueID:function(){return parseInt(1e3*Math.random()).toString()+(new Date).getTime().toString()}};var showUpTips=function(){winDialog.alert('您可以在<a href="http://get.adobe.com/flashplayer/" target="_blank">此处下载免费的Adobe flash player installer</a>。成功安装程序后，可返回此处查看。',{icon:"01"})};if(scope.magicCfg={},window.$magicFacePlay=function(e){var t;if(scope.flashVersion||(scope.flashVersion=deconcept.SWFObjectUtil.getPlayerVersion()),t=scope.flashVersion,t.major<9)return void showUpTips();Core.Events.stopEvent();var i={alphaNodeId:"alphaNode",containerDiv:"magicFaceCon"},n=['<div id="magicFaceCon" title="" alt="" style="height:360px; width:360px;">',"</div>"].join("");scope.magicCfg.layer=new Lib.Panel,scope.magicCfg.layer.setTemplate('<div style="position:absolute;z-index:2000;" id="#{panel}" title="" alt="">'+n+"</div>"),scope.magicCfg.layer.show();var o="magicFace",s=function(){scope.magicCfg.shadow=new BackShadow(.4),scope.magicCfg.shadow.entity.setAttribute("title","点击关闭动画"),scope.magicCfg.shadow.entity.setAttribute("alt","点击关闭动画"),scope.magicCfg.shadow.entity.onclick=a,Core.Events.addEvent(document,r,"keydown"),scope.magicCfg.shadow.show();var t=Core.System.winSize(),n=Core.System.getScrollPos(document),s=t.width/2-180+n[1],l=t.height/2-180+n[0];scope.magicCfg.layer.setPosition(s,l);var c=document.createElement("div");c.id="___flashOverlay",c.style.cssText="cursor:pointer;visibility:hidden;background:white;;z-index:3000;position:absolute;width:360px;height:360px;top:"+l+"px;left:"+s+"px",document.body.appendChild(c),document.all?c.style.filter="Alpha(Opacity=0)":c.style.opacity=0,c.style.visibility="visible",Core.Events.addEvent(c,function(){window.open("http://blog.sina.com.cn/myshow2010")
}),c=null;var d=new Utils.Flash.swfObject("http://www.sinaimg.cn/uc/myshow/blog/misc/gif/"+e+"?t="+Core.Math.getUniqueId(),o,360,360,9,"#FFFFFF");d.addParam("quality","high"),d.addParam("wmode","transparent"),d.addParam("allowScriptAccess","always"),d.write(i.containerDiv)},a=function(){trace("swf remove!!!");var e=$E(i.containerDiv);e&&(e.innerHTML=""),window.clearInterval(l),Core.Events.removeEvent(document,r,"keydown");try{scope.magicCfg.shadow.close(),scope.magicCfg.layer.close(),Core.Events.stopEvent()}catch(t){}$E("___flashOverlay")&&document.body.removeChild($E("___flashOverlay"))},r=function(e){var t=e.keyCode||e.which||e.charCode;return 27===t?(a(),Core.Events.removeEvent(document,r,"keydown"),Core.Events.stopEvent(),!1):void 0};s();var l=window.setInterval(function(){trace("……追踪 进度……");var e=$E(o),t=0;if(e&&100==e.PercentLoaded()){e.onclick=function(){Core.Events.stopEvent()},trace("swf 加载完毕了………………");var i=e.parentNode,n=Core.System.getScrollPos(document),s=Core.System.winSize(),r=s.width/2-i.offsetWidth/2+n[1],c=s.height/2-i.offsetHeight/2+n[0];scope.magicCfg.layer.setPosition(r,c),scope.magicCfg.layer.show(),trace("flash size x="+i.offsetWidth+"  y="+i.offsetHeight),window.clearInterval(l),l=window.setInterval(function(){var i,n=e.CurrentFrame();try{i=e.TotalFrames()}catch(o){i=e.TotalFrames}0>n||(i>n&&n>=t?t=n:a())},80)}},100)},$registJob("articleCommentV2",function(){Lib.LazyLoad([$E("article_comment_list")],{callback:function(){if(!scope.$comment_is_load_page_1&&1!=scope.$private.cms&&1!=scope.$isCommentAllow){new CommentV2.CommentList({purl:"http://blog.sina.com.cn/s/comment_"+scope.$articleid,containerNode:$E("article_comment_list")})}}})}),"undefined"==typeof App)var App={};$ScriptLoader={callback:{},response:function(e,t){var i=(1*scope.$uid).toString(16),n=i.length;if(8>n)for(var o=0,s=8-n;s>o;o++)i="0"+i;var a={};for(var r in t)a[i+"01"+r]=t[r];this.callback[e].func(a);var l=scope.$pageid;if("article"==l||"articleM"==l||!l.indexOf("articletj")){var c=scope.useNewInterfaceToGetNum;c||(scope.useNewInterfaceToGetNum={},c=scope.useNewInterfaceToGetNum);var d=0;for(var h in t){d=t[h].d;break}if(c){var p="digg_m_"+scope.$articleid,u={};if(u[p]=d,c.onSuccess)c.onSuccess(u);else var g=0,m=setInterval(function(){return g>300?(clearInterval(m),void(c&&c.onException&&c.onException(u))):(c&&c.onSuccess&&(clearInterval(m),c.onSuccess(u)),void g++)},100)}}}},App.getArticlesDetailNumber=function(e,t,i){if(null==t||0==t.length)return{};e=e||scope.$uid;var n=(1*scope.$uid).toString(16),o=n.length;if(8>o)for(var s=0,a=8-o;a>s;s++)n="0"+n;var r=[];Core.Array.foreach(t,function(e){r.push(e.replace(n+"01",""))});for(var l=$C("script"),c=Math.ceil(1e4*Math.random());null!=$ScriptLoader.callback[c];)c=Math.ceil(1e4*Math.random());var d="aritlces_number_"+c;$ScriptLoader.callback[d]={func:i,uid:e},l.src="http://blogtj.sinajs.cn/api/num.php?uid="+n+"&aids="+r.join(",")+"&requestId="+d,l.charset="utf-8",l.onload=l.onerror=l.onreadystatechange=Core.Function.bind2(function(){l&&l.readyState&&"loaded"!=l.readyState&&"complete"!=l.readyState||(l.onload=l.onreadystatechange=l.onerror=null,l.src="",l.parentNode.removeChild(l),l=null)},this),document.getElementsByTagName("head")[0].appendChild(l)},$registJob("articleNumberV2",function(){if(Lib.checkAuthor(),"1"==scope.$pn_x_rank&&!$isAdmin)return!1;var e=scope.$uid,t=scope.$articleid;App.getArticlesDetailNumber(e,[t],function(e){var i=e[t];for(var n in i)"articletjTech"===scope.$pageid&&"c"===n&&($E("comment_tj_"+t).innerHTML="评论("+i[n]+")"),$E(n+"_"+t)&&($E(n+"_"+t).innerHTML="("+i[n]+")")})}),Core.Events.fireEvent=function(e,t){var i;e=$E(e),e.fireEvent?e.fireEvent("on"+t):(i=document.createEvent($MOBILE?"HTMLEvents":"MouseEvents"),i.initEvent(t,!0,!0),e.dispatchEvent(i))},scope.faceTemplate=['<table id="#{entity}" class="CP_w">','<thead id="#{titleBar}">',"<tr>",'<th class="tLeft"><span></span></th>','<th class="tMid">','<div class="bLyTop">','<strong id="#{titleName}">插入表情</strong>','<cite><a id="#{btnClose}" href="javascript:;" class="CP_w_shut" title="关闭">关闭</a></cite>',"</div>","</th>",'<th class="tRight"><span></span></th>',"</tr>","</thead>","<tfoot>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid"><span></span></td>','<td class="tRight"><span></span></td>',"</tr>","</tfoot>","<tbody>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid" id="#{content}">','<div class="faceItemContent">','<div class="bigface">','<div id="#{faceTab}" class="faceSidebar">',"</div>",'<div id="#{faceContent}" class="faceShowAll">',"</div>","</div>","</div>","</td>",'<td class="tRight"><span></span></td>',"</tr>","</tbody>","</table>"].join(""),Lib.Face=Core.Class.create(),Lib.Face.prototype={dialog:null,dialogNodes:null,tabs:null,faceConfig:null,template:null,txtContentArea:null,x:0,y:0,isShowed:!1,_isInitDialog:!1,insertImageFile:"",initialize:function(e,t){var i=this;this.txtContentArea=e,this.template=t,window.$insertFace=function(e,t){i.insertFace(e,t)}},load:function(){var e=this;this.dialog=new Dialog(this.template||scope.faceTemplate),this.dialogNodes=this.dialog.getNodes(),this.tabs=new Tabs(this.dialogNodes.faceTab),Core.Events.addEvent(this.dialog.entity,function(){Core.Events.stopEvent()},"mousedown"),Core.Events.addEvent(document.body,function(){e.hidden()},"mousedown"),this.initFaceConfig(function(){e.tabs.tabsArr[0]&&e.tabs.tabsArr[0].setFocus(),Core.Events.addEvent(e.dialogNodes.btnClose,function(){e.hidden()},"mousedown"),e.onInitialized()}),this._isInitDialog=!0},initFaceConfig:function(e){var t=this;Utils.Io.JsLoad.request("http://www.sinaimg.cn/uc/myshow/blog/misc/gif/smileConfig.js?varname=smileConfig&"+(new Date).getTime(),{onComplete:function(i){t.faceConfig=i,t.initFaceData(),e&&e()},charset:"gb2312"})},initFaceData:function(){var e;for(e in this.faceConfig)this.addTab(e,this.faceConfig[e].name,this.faceConfig[e].data)},onInitialized:function(){},textWatchOn:function(){var e=this.txtContentArea,t=function(){e.createTextRange&&(e.caretPos=document.selection.createRange().duplicate())};Core.Events.addEvent(e,t,"keyup"),Core.Events.addEvent(e,t,"focus"),Core.Events.addEvent(e,t,"select"),Core.Events.addEvent(e,t,"click")},addTab:function(e,t,i){var n=this,o=new Tab('<img src="http://www.sinaimg.cn/uc/myshow/blog/misc/gif/'+e+'.gif" height="20" width="20" align="absmiddle"><span><a href="#" onclick="return false;">'+t+"</a></span><em>("+i.length+")</em>",{isFocus:!1,className:"cur"});o.addOnAbort(function(){o.content.style.display="none"}),o.addOnFocus(function(){o.isShowed||(o.isShowed=!0,o.content=$C("ul"),o.content.innerHTML=n._getTabContent(e,i),n.dialogNodes.faceContent.appendChild(o.content)),o.content.style.display=""}),this.tabs.add(o)},_getTabContent:function(e,t){var i,n,o=[],s=t.length;for(n=0;s>n;n++)i=t[n].name,i=Core.String.byteLength(i)>8?Core.String.leftB(i,6)+"...":i,o.push("<li><a onclick=\"$insertFace('"+t[n].code+"','"+t[n].name+'\');return false;" href="#"><img style="width:50px;height:50px;" title="'+t[n].name+'" src="http://www.sinaimg.cn/uc/myshow/blog/misc/gif/'+t[n].code+'T.gif"/></a><span>'+i+"</span></li>");return o.join("")},insertFace:function(e,t){if(this.insertImageFile=e+"T.gif",this.onInsert(),this.txtContentArea){var i="[emoticons="+e+"]"+t+"[/emoticons]";if($IE)if(this.txtContentArea.createTextRange&&this.txtContentArea.caretPos){var n=this.txtContentArea.caretPos;n.text=" "==n.text.charAt(n.text.length-1)?i+" ":i,this.txtContentArea.focus()}else this.txtContentArea.value+=i,this.txtContentArea.focus();else if(this.txtContentArea.setSelectionRange){var o=this.txtContentArea.selectionStart,s=this.txtContentArea.selectionEnd,a=this.txtContentArea.value.substring(0,o),r=this.txtContentArea.value.substring(s);this.txtContentArea.value=a+i+r}else this.txtContentArea.value+=i;return this.hidden(),!1}},onInsert:function(){},setPosition:function(e,t){this.x=e,this.y=t,this.dialog.setPosition({x:e,y:t})},show:function(){!this._isInitDialog&&this.load(),this.dialog.show(),this.isShowed=!0},hidden:function(){this.isShowed=!1,this.dialog.hidden()}},Core.Dom.addHTML=function(e,t){e.insertAdjacentHTML("beforeend",t)},$C("div").insertAdjacentHTML||(Core.Dom.addHTML=function(e,t){var i=e.ownerDocument.createRange();i.setStartBefore(e);var n=i.createContextualFragment(t);e.appendChild(n)}),App.smilesTemplate=['<table id="#{entity}" class="CP_w faceItemContent" style="visibility: visible;">','<thead id="#{titleBar}"><tr><th class="tLeft"><span></span></th>','<th class="tMid"><div class="bLyTop"><strong id="#{titleName}">插入表情</strong><cite><a id="#{btnClose}"',' href="#" onclick="return false;" class="CP_w_shut" title="关闭">关闭</a></cite></div></th>','<th class="tRight"><span></span></th></tr></thead>','<tfoot><tr><td class="tLeft"><span></span></td><td class="tMid"><span></span></td>','<td class="tRight"><span></span></td></tr></tfoot>',"<tbody><tr>",'<td class="tLeft"><span></span></td>','<td class="tMid" id="#{content}">','<div class="insertface">','<div class="insertface_top">','<h3>热门动漫表情</h3><div class="insertface_search">','<input id="#{searchText}" type="text" class="SG_input" value="输入关键字、动漫形象"',' style="color:#9b9b9a;" maxlength="20" /><a id="#{searchBtn}" href="#" onclick="return false;" ','hidefocue="true" class="SG_aBtn SG_aBtnB"><cite>查找表情</cite></a></div>','<div class="clearit"></div>',"</div>",'<div class="insertface_hot">','<span class="insertface_keyword">热门关键字：<span id="#{hotKeyword}"></span></span>','<span class="insertface_hotslider"></span>',"</div>",'<div class="bigface">','<div class="faceSidebar">','<div id="#{keyCtrl}" class="facekeyword" style="display:none;">','<p><< <a id="#{keyCtrlBack}" href="#" onclick="return false;">返回全部关键字</a></p>','<p>关键字：<span id="#{keyWord}"></span></p></div>','<h3 id="#{allSort}" class="facetitle" style="font-weight:600;"><a href="#"',' onclick="return false;">全部</a></h3>','<div id="#{sortList}" class="facelist"></div>','<div id="#{sortCtrl}" class="facearrow"></div>',"</div>",'<div class="faceShowAll">','<div id="#{smileEmpty}" class="faceShownone" style="display:none;"><p>找不到和关键字相符的表情。','<br /><br /><a id="#{smileEmptyBack}" href="#" onclick="return false;">&lt;&lt;返回首页</a></p></div>','<ul class="faceShowAll_list" id="#{smileList}"></ul>','<div class="SG_page"><ul class="SG_pages">','<li id="#{smilePagePrev}" class="SG_s_pgprev"></li>','<li id="#{smilePageShow}" class="SG_s_pgnum"></li>','<li id="#{smilePageNext}" class="SG_s_pgnext"></li>','<li class="play" id="#{magicTip}">点击<img align="absmiddle" src="http://simg.sinajs.cn/blog7style/images/common/img_arrow_r.gif">预览动画效果</li>',"</ul></div>","</div>","</div>","</div>",'</td><td class="tRight"><span></span></td>',"</tr></tbody></table>"].join(""),App.smilesDialog2=Core.Class.create(),App.smilesDialog2.prototype={pageSize:24,defaultConfig:{sortId:"0",htmlTpl:App.smilesTemplate,callback:function(){}},initialize:function(e){this.option=e||{};for(var t in this.defaultConfig)null==this.option[t]&&(this.option[t]=this.defaultConfig[t]);if(this.dialog=new Dialog(this.option.htmlTpl),this.dialog.setAreaLocked(!0),this.dialogNodes=this.dialog.getNodes(),this.getKeyWord(),null!=scope.smilesData)this.data=scope.smilesData,this.dataSettle(),this.eventListen();else{var i=this;Utils.Io.JsLoad.request([{url:"http://www.sinaimg.cn/uc/myshow/blog/misc/gif/smileConfig8.js?varname=smileConfig"}],{onComplete:function(e){scope.smilesData=e,i.data=e,i.dataSettle(),i.eventListen()},onException:function(){}})}return this},dataSettle:function(e,t){e=e||this.data,t=t||9,this.tabsData=[],this.allData=[];for(var i in e){var n=e[i];n.sortId=i,this.tabsData.push(n);for(var o=0,s=n.data.length;s>o;o++)n.data[o].sid=i,n.data[o].sname=n.name;this.allData=this.allData.concat(n.data)}null==this.allDataBack&&(this.allDataBack=this.allData.slice(0)),this.showTab(1,t),0==this.dialogNodes.smileList.childNodes.length&&this.showAll()},children:function(e){for(var t=[],i=0;e[i];i++)1==e[i].nodeType&&t.push(e[i]);return t},showTab:function(e,t){e=e||1,t=t||9,this.dialogNodes.sortList.innerHTML="",this.dialogNodes.smileList.innerHTML="",Core.Dom.setStyle(this.dialogNodes.sortList,"height",9==t?"279px":"217px"),this.tabs=new Tabs(this.dialogNodes.sortList),this.tabsObject={};for(var i=this,n=0;t>n;n++){var o=(e-1)*t;if(null==this.tabsData[o+n])break;var s=this.tabsData[o+n].sortId,a=this.tabsData[o+n].name,r=this.tabsData[o+n].data,l=new Tab('<img src="http://www.sinaimg.cn/uc/myshow/blog/misc/gif/'+s+'.gif" height="20" width="20" align="absmiddle"><div><span><a href="#" onclick="return false;" title="'+a+'">'+a+"</a></span><em>("+r.length+")</em></div>",{isFocus:!1,className:"cur"});l.addOnAbort(Core.Function.bind3(function(){},null,[l])),l.addOnFocus(Core.Function.bind3(function(e,t,n,o){if(i.showSmile(n,1,i.pageSize),i.currentTab=e,i.dialogNodes.allSort.style.fontWeight=400,!i.isFromUp){var s=scope.$pageid;if(s){var a=scope.isFromtheCommonhzh;a&&v7sendLog($_GLOBAL.faceChooseTable[s][a]+"_16_020_"+o,s,"")}}i.isFromUp=null},null,[l,o+n,r,s])),this.tabsObject[s]=l,this.tabs.add(l)}var c=Math.ceil(this.tabsData.length/t);c>0?this.showTabPage(e||1,c,t):this.dialogNodes.sortCtrl.innerHTML=""},showSmile:function(e,t,i){i=i||this.pageSize;var n,o=this,s=e,a=s.length,r=Math.ceil(a/i),l=document.createDocumentFragment();this.dialogNodes.smileList.innerHTML="",this.dialogNodes.magicTip.style.cssText="display:none;";for(var c=0;i>c;c++){var d=s[(t-1)*i+c];if(null==d)break;var h=$C("li"),p=$C("a");p.href="#",p.onclick=function(){return!1},p.onmousedown=Core.Function.bind3(function(e,t,i){o.hide(),o.option.callback(e,t,i)},null,[d.code,d.name,d.swf||null]),p.innerHTML='<img style="width:50px;height:50px;" src="http://www.sinaimg.cn/uc/myshow/blog/misc/gif/'+d.code+'T.gif" alt="'+d.name+'" title="'+d.name+'" />',h.appendChild(p),p.setAttribute("key",d.code);var u=$C("span");if(u.title=d.name,u.innerHTML=Core.String.byteLength(d.name)>8?Core.String.leftB(d.name,6)+"…":d.name,h.appendChild(u),d.swf){var g=$C("div");g.innerHTML='<a href="#"   onclick="window.$magicFacePlay(\''+d.swf+'\');return false;"><img height="13" title="播放表情" align="absmiddle" width="14" alt="" src="http://simg.sinajs.cn/blog7style/images/common/img_arrow_r.gif"></a>',g.className="arr_r",h.appendChild(g),this.dialogNodes.magicTip.style.cssText="display:block;"}l.appendChild(h),Core.Events.addEvent(p,function(e){return function(){var t=scope.$pageid;if(t){var i=scope.isFromtheCommonhzh;i&&v7sendLog($_GLOBAL.faceChooseTable[t][i]+"_16_010_"+e.getAttribute("key"),t,"")}}}(p),"mousedown")}this.dialogNodes.smileList.appendChild(l),a>i?(1==t?this.dialogNodes.smilePagePrev.innerHTML="上一页":(this.dialogNodes.smilePagePrev.innerHTML="",n=$C("a"),n.href="#",n.onclick=function(){return!1},n.onmousedown=function(){o.showSmile(s,t-1,i)},n.innerHTML="上一页",this.dialogNodes.smilePagePrev.appendChild(n)),this.dialogNodes.smilePageShow.innerHTML=t+"/"+r,t>=r?this.dialogNodes.smilePageNext.innerHTML="下一页":(this.dialogNodes.smilePageNext.innerHTML="",n=$C("a"),n.href="#",n.onclick=function(){return!1},n.onmouseup=function(){o.showSmile(s,t+1,i)},n.innerHTML="下一页",this.dialogNodes.smilePageNext.appendChild(n))):(this.dialogNodes.smilePagePrev.innerHTML="",this.dialogNodes.smilePageShow.innerHTML="",this.dialogNodes.smilePageNext.innerHTML="")},showTabPage:function(e,t,i){this.dialogNodes.sortCtrl.innerHTML="",this.dialogNodes.smilePagePrev.innerHTML="",this.dialogNodes.smilePageShow.innerHTML="",this.dialogNodes.smilePageNext.innerHTML="";var n,o=this;1==e?e!=t&&(this.dialogNodes.sortCtrl.innerHTML='<a href="#" onclick="return false;" title="向上" class="up_off"></a>',n=$C("a"),n.href="#",n.onclick=function(){return!1},n.title="向下",n.className="down",n.onmousedown=function(){o.showTab(e+1,i),o.showAll()},this.dialogNodes.sortCtrl.appendChild(n)):t>e?(n=$C("a"),n.href="#",n.onclick=function(){return!1},n.title="向上",n.className="up",n.onmousedown=function(){o.showTab(e-1,i),o.showAll()},this.dialogNodes.sortCtrl.appendChild(n),n=$C("a"),n.href="#",n.onclick=function(){return!1},n.title="向下",n.className="down",n.onmousedown=function(){o.showTab(e+1,i),o.showAll()},this.dialogNodes.sortCtrl.appendChild(n)):(n=$C("a"),n.href="#",n.onclick=function(){return!1},n.title="向上",n.className="up",n.onmousedown=function(){o.showTab(e-1,i),o.showAll()},this.dialogNodes.sortCtrl.appendChild(n),Core.Dom.addHTML(this.dialogNodes.sortCtrl,'<a href="#" onclick="return false;" title="向下" class="down_off"></a>'))},eventListen:function(){var e=this,t=e.dialogNodes.searchText,i=e.dialogNodes.searchBtn,n=e.dialogNodes.keyCtrlBack,o=e.dialogNodes.allSort,s=e.dialogNodes.smileEmptyBack;Core.Events.addEvent(document.body,function(t){var i=Core.Events.getEvent(),n=$IE?i.srcElement:i.target;null==e.dialogNodes.entity||0!=Core.Dom.contains(e.dialogNodes.entity,n)&&1!=t||e.hide()}),Core.Events.addEvent(this.dialogNodes.btnClose,function(){e.hide()}),Core.Events.addEvent(t,function(){"输入关键字、动漫形象"==Core.String.trim(t.value)&&(t.value="",t.style.color="#000"),t.select()},"focus"),Core.Events.addEvent(t,function(){""==Core.String.trim(t.value)&&(t.value="输入关键字、动漫形象",t.style.color="#9b9b9a")},"blur"),Core.Events.addEvent(t,function(){var i=Core.Events.getEvent(),n=i.which||i.keyCode,o=Core.String.trim(t.value);13==n&&""!=o&&e.searchKey(o)},"keydown"),Utils.Form.limitMaxLen(t,20),Core.Events.addEvent(i,function(){"输入关键字、动漫形象"==t.value||""==t.value||(e.searchKey(t.value),t.focus())});var a=function(){e.dataSettle(e.data,9),e.dialogNodes.keyCtrl.style.display="none",e.dialogNodes.smileEmpty.style.display="none",e.dialogNodes.smileList.style.display="",e.dialogNodes.searchText.value="输入关键字、动漫形象",e.dialogNodes.searchText.style.color="#9b9b9a"};Core.Events.addEvent(n,a),Core.Events.addEvent(s,a),Core.Events.addEvent(o,function(){e.showAll()})},showAll:function(){this.showSmile(this.allData,1,this.pageSize),this.dialogNodes.allSort.style.fontWeight=600,null!=this.currentTab&&this.currentTab.setAbort()},setSort:function(e,t){this.isFromUp=e,this.option.sortId=e,this.option.callback=t,0==e?(this.dialogNodes.allSort.style.fontWeight=600,this.dataSettle()):(this.dataSettle(),this.tabs.swapTags(this.tabsObject[e]))},getKeyWord:function(){if(null==this.keywordData){var e=this;Utils.Io.JsLoad.request("http://www.sinaimg.cn/uc/myshow/blog/misc/gif/smileKeywordConfig.js?varname=smileKeywordConfig",{onComplete:function(t){e.keywordData=t;var i=t.E___00000000000||"顶|路过|哭|啦啦|美女",n=document.createDocumentFragment();i=i.split("|");for(var o=0,s=i.length;s>o;o++){var a=$C("a");if(a.href="#",a.onclick=function(){return!1},a.onmousedown=Core.Function.bind3(function(t){e.searchKey(t)},null,[i[o]]),a.innerHTML=i[o],"魔法表情"==i[o]){var r=$C("img");r.style.cssText="height:15px; width:15px;",r.setAttribute("align","absmiddle"),r.src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif",r.className="SG_icon SG_icon68 img_m",n.appendChild(r)}n.appendChild(a)}""==e.dialogNodes.hotKeyword.innerHTML&&e.dialogNodes.hotKeyword.appendChild(n);var l="";for(var c in t)"E___00000000000"!=c&&(l+="∑"+c+"§"+t[c]);e.keywordStr=l},onException:function(){}})}},searchKey:function(e){var t=e.replace(/([\\^$*+?{}.|])/gi,"\\$1"),i=new RegExp("∑([^§]+)§[^∑]*"+t+"[^∑]*","gi"),n=[];this.keywordStr.replace(i,function(e,t){n.push(t)}),n=n.join(",");for(var o={},s=this.allDataBack,a=s.length,r=0,l=0;a>l;l++)(-1!=n.indexOf(s[l].code)||-1!=s[l].sname.indexOf(e)||-1!=s[l].name.indexOf(e))&&(null==o[s[l].sid]&&(o[s[l].sid]={name:s[l].sname,data:[]}),o[s[l].sid].data.push(s[l]),r++);var c=scope.$pageid;if(0==r){if(this.dialogNodes.smileEmpty.style.display="",this.dialogNodes.smileList.style.display="none",c){var d=scope.isFromtheCommonhzh;d&&v7sendLog($_GLOBAL.faceChooseTable[c][d]+"_16_030_"+encodeURIComponent(e),c,"")}}else if(this.dialogNodes.smileList.style.display="",this.dialogNodes.smileEmpty.style.display="none",c){var d=scope.isFromtheCommonhzh;d&&v7sendLog($_GLOBAL.faceChooseTable[c][d]+"_16_031_"+encodeURIComponent(e),c,"")}this.dataSettle(o,7),this.dialogNodes.keyCtrl.style.display="",this.dialogNodes.keyWord.innerHTML=e.split("").join("<wbr/>"),Core.Dom.setStyle(this.dialogNodes.sortList,"height","217px")},setPosition:function(e,t){this.x=e,this.y=t,this.dialog.setPosition({x:e,y:t})},show:function(){this.dialogNodes.searchText.value="输入关键字、动漫形象",this.dialogNodes.searchText.style.color="#9b9b9a",this.dialog.show()},hide:function(){this.dialog.hidden(),this.dialogNodes.keyCtrl.style.display="none"}},scope.smilesDataV2={302:{name:"小新小浪",contract:"GY00000001",data:[{name:"灌水",code:"E___0173EN00SIG"},{name:"赞",code:"E___0480ZH00SIG"},{name:"美好",code:"E___0305EN00SIG"},{name:"顶",code:"E___0022EN00SIG"},{name:"顶",code:"E___0088EN00SIG"},{name:"顶",code:"E___0472ZH00SIG"},{name:"开心",code:"E___0092EN00SIG"},{name:"路过",code:"E___0177EN00SIG"}]}},App.insertSmilesForm2=Core.Class.create(),App.insertSmilesForm2.prototype={defalutConfig:{sortCount:6,clickCallback:function(){},recommCount:8},initialize:function(e){if(this.option=e||{},null!=this.option.sortNode){for(var t in this.defalutConfig)null==this.option[t]&&(this.option[t]=this.defalutConfig[t]);null==scope.smilesDataV2?this.getSmilesData():(this.data=scope.smilesDataV2,this.renderUI())}},getSmilesData:function(){{var e=this;Utils.Io.JsLoad.request([{url:"http://www.sinaimg.cn/uc/myshow/blog/misc/gif/smileConfig8.js?varname=smileConfig"}],{onComplete:function(t){scope.smilesData=t,e.data=t,e.renderUI()},onException:function(){}})}},renderUI:function(){var e,t=this,i=1,n=[],o=[],s=document.createDocumentFragment(),a=$C("div"),r=$C("span"),l=$C("div");if(e=this.data&&this.data[302]&&this.data[302].data,null!=$E(this.option.recommNode)){s=document.createDocumentFragment();for(var c=0;c<this.option.recommCount;c++){_title=e[c].name;var d=e[c].code,h=e[c].swf;node=$C("li"),function(e){node.onclick=Core.Function.bind3(function(i,n,o){t.option.clickCallback(i,n,o),v7sendLog("32_01_20");var s=scope.$pageid;return s&&(e+="",e=1==e.length?"0"+e:e,v7sendLog($_GLOBAL.faceCountRecommLinkTable[s]+"_"+e+"_010_"+i,s,"")),Core.Events.stopEvent(),!1},null,[d,_title,h])}(c+8),node.hideFocus=!0;var p='<a href="#"><img src="http://www.sinaimg.cn/uc/myshow/blog/misc/gif/'+d+'T.gif" alt="'+_title+'" title="'+_title+'" height="50" width="50"/></a>';h&&(p=p+'<div class="arr"><a href="#" onclick="window.$magicFacePlay(\''+h+'\');return false;" ><img src="http://simg.sinajs.cn/blog7style/images/common/img_arrow_r.gif" width="14" height="13" title="播放表情" alt="" align="absmiddle" /></a></div>'),node.innerHTML=p,s.appendChild(node)}$E(this.option.recommNode).appendChild(s)}i=n=o=e=s=a=r=_morelink=l=d=key=_title=node=null}},Lib.children=function(e){for(var t=[],i=0;e[i];i++)1==e[i].nodeType&&t.push(e[i]);return t},App.insertSmilesDialog2=function(e,t,i,n){App.insertSmilesDialog2.callback=t,null==scope.smileDialog&&(scope.smileDialog=new App.smilesDialog2),scope.smileDialog.setSort(e,t);var o=Core.Dom.getXY($E(i)),s=o[0]+n[0],a=o[1]+n[1];scope.smileDialog.setPosition(s,a),scope.smileDialog.show()},App.formInsertSmile2=function(e,t,i,n,o,s,a,r,l){var c=$E(e);l=l||{};var d=function(){c.createTextRange&&(c.caretPos=document.selection.createRange().duplicate())};scope.commEditor||(scope.commEditor=new commEditor),scope.commEditor.append(a,e,r),Core.Events.addEvent(c,d,"keyup"),Core.Events.addEvent(c,d,"focus"),Core.Events.addEvent(c,d,"select"),Core.Events.addEvent(c,d,"click");var h={sortNode:t,clickCallback:function(e,t,i){setTimeout(function(){var n='<img src="http://www.sinaimg.cn/uc/myshow/blog/misc/gif/'+e+'T.gif" alt="'+t+'" title="'+t+'"width="50" height="50" />';i&&(n='<img src="http://www.sinaimg.cn/uc/myshow/blog/misc/gif/'+e+'T.gif" alt="'+t+'" title="'+t+'" swfname="'+i+'"  width="50" height="50" />'),scope.commEditor.insertHTML(a,n)},20),n&&n()},recommNode:i,positionNode:o||t,arrPosPix:s||[0,0],sortCount:l.sortCount||6,recommCount:l.recommCount||8};new App.insertSmilesForm2(h)};var commEditor=function(){this.fids=[],this.areas={},this.wins={},this.docs={},this.intervals={},this.actions={}};commEditor.prototype={init:function(e){var t=this.docs[e];try{t.body.designMode="on"}catch(i){}t.open(),t.writeln(this.getEditorHTML("")),t.body.contentEditable=!0;var n=t.parentWindow;Lib.checkAuthor(),t.body.onkeydown=function(e){try{if(9==(e||n.event).keyCode)return $E("login_"+($isLogin?"check":"name")).focus(),!1}catch(t){}},t.close()},lazyInit:function(e){var t=this;return function(){var i=t.docs[e];i.body.getAttribute("inited")||(trace("执行一次:"+e),t.init(e),t.bindListener(e),i.body.setAttribute("inited","yes"))}},append:function(e,t,i){function n(){try{s.docs[e]=o.contentWindow.document,s.areas[e]=$E(t),$IE?s.docs[e].body.onclick=s.lazyInit(e):s.lazyInit(e)()}catch(i){setTimeout(n,150)}}i=i||{},i.interval||(i.interval={}),i.interval.before||(i.interval.before=function(){}),i.interval.after||(i.interval.after=function(){});var o=$E(e);this.wins[e]=o.contentWindow,this.actions[e]=i;var s=this;n()},frameFilter:function(e){var t=e.innerHTML;t=t.replace(/<script[\s\S]*<\/script>/gi,""),t=t.replace(/<style[\s\S]*<\/style>/gi,""),t=t.replace(/<!-{2,}[\s\S]*?-{2,}>/g,""),t=t.replace(/<([^>]+).*?>/gi,function(e,t){var i=t.split(" ")[0].toLowerCase();switch(i){case"/p":return"<br>";case"br":return e;case"img":return e.toLowerCase().indexOf("http://www.sinaimg.cn/uc/myshow/blog")>0||e.toLowerCase().indexOf("http://simg.sinajs.cn/blog7style/images/common")>0?-1==e.toLowerCase().indexOf("t.gif")&&-1==e.toLowerCase().indexOf("img_arrow_r.gif")?"":e:"";default:return""}}),t=t.replace(/\n/g,""),e.innerHTML=t},bindListener:function(e){var t=this.docs[e],i=this.areas[e],n=this.wins[e],o=this.actions[e],s=this;if($IE&&(t.onkeydown=function(){var t=n.event;if(8==t.keyCode){var i=s.getFocusElement(e);i&&"IMG"==i.tagName.toUpperCase()&&(i.parentNode.removeChild(i),t.keyCode=0,t.returnValue=!1)}}),Core.Events.addEvent(t.body,function(t){return function(){s.intervals[e]=setInterval(function(){o.interval.before(e,i),s.clearFrameHTML(t);for(var n=t.getElementsByTagName("img"),a=0;n[a];a++)n[a].removeAttribute("style"),n[a].removeAttribute("height"),n[a].removeAttribute("width");o.interval.after(e,i)},400)}}(t.body),"focus"),Core.Events.addEvent(t.body,function(){return function(){clearInterval(s.intervals[e])}}(t.body),"blur"),o.normal)for(var a in o.normal)Core.Events.addEvent(t.body,o.normal[a],a)},clearFrameHTML:function(e){for(var t=this,i=["a","input"],n=!1,o=0;i[o];o++)if(e.getElementsByTagName(i[o]).length>0){n=!0;break}if(n)t.frameFilter(e);else for(var s=e.getElementsByTagName("img"),o=0;s[o];o++){var a=s[o].src.indexOf("http://www.sinaimg.cn/uc/myshow/blog"),r=s[o].src.toLowerCase().indexOf("t.g"),l=s[o].src.indexOf("http://simg.sinajs.cn/blog7style/images/common/img_arrow_r.gif");if((-1==a||-1==r)&&-1==l){t.frameFilter(e);break}}},getFocusElement:function(e){if($IE){var t=this.docs[e].selection.createRange();return t.item?t.item(0):t.parentElement()}var i=this.win.getSelection(),t=i.getRangeAt(0),n=t.commonAncestorContainer;return n.tagName&&"body"==n.tagName.toLowerCase()?n:t.collapsed?n.parentNode:t.startContainer!=t.endContainer&&t.startContainer!=t.endContainer.parentNode||!t.startContainer.hasChildNodes()?n.parentNode:t.startContainer.childNodes[t.startOffset]},clearHTML:function(e){var t=this.docs[e];t.body.innerHTML="",t.body.setAttribute("contenteditable",!1),t.body.setAttribute("contenteditable",!0)},insertHTML:function(e,t){$IE&&this.lazyInit(e)();var i=this.wins[e],n=this.docs[e];if($IE)try{i.focus();var o=n.selection.createRange();if("control"==n.selection.type.toLowerCase()){var s=n.body.createTextRange();s.moveToElementText(o.item(0)),o=s}o.pasteHTML(t),o.collapse(!1),o.select()}catch(a){}else!$CHROME&&!$SAFARI||"%0A"!=encodeURIComponent(n.body.innerHTML)&&""!=n.body.innerHTML||n.body.focus(),this.execCommand("insertHTML",t,e),$CHROME||$SAFARI||n.body.focus()},execCommand:function(e,t,i){var n=this.wins[i],o=this.docs[i];n.focus(),o.execCommand(e,"",t),n.focus()},handleChange:function(e){var t=this.docs[e].body;this.areas[e].value=this.getHandledStr(t)},getHandledStr:function(e){var t=[];if(e.hasChildNodes()){e=e.childNodes;for(var i=0;e[i];i++)t.push(this.handleDom(e[i]))}else t.push(this.handleDom(e));return t.join("").replace(/\u00A0/gi," ")},handleDom:function(e){if(3==e.nodeType){var t=e.nodeValue;return Core.String.trim(t)?this.reEscapeHTML(t):""}if(1==e.nodeType){if(e.hasChildNodes()&&(1!=e.childNodes.length||1==e.childNodes.length&&e.childNodes[0].tagName)){var i=[];if(e.tagName){var n=e.tagName.toUpperCase();("DIV"==n||"P"==n)&&i.push("\n")}e=e.childNodes;for(var o=0;e[o];o++)i.push(this.handleDom(e[o]));return i.join("")}var n=e.tagName.toUpperCase();if("IMG"!=n){if("BR"==n)return"\n";if("DIV"==n||"P"==n){var t=e.innerHTML||"";return"\n"+this.reEscapeHTML(t)}return"SCRIPT"==n||"STYLE"==n?"":(t=e.innerHTML||e.value||"",this.reEscapeHTML(t))}if(-1==e.src.indexOf("http://www.sinaimg.cn/uc/myshow/blog"))return"";if(-1==e.src.indexOf("T.g"))return"";var s=e.src.split("T.g")[0];s=s.substring(s.lastIndexOf("/")+1,s.length);var a=e.getAttribute("title"),r=e.getAttribute("swfname");if(r||"W"!=s[0]||(r=s+"S.swf"),a)return r?"[magicemoticons="+s+" swfname="+r+"]"+a+"[/magicemoticons]":"[emoticons="+s+"]"+a+"[/emoticons]"}return""},reEscapeHTML:function(e){return e=e.replace(/\n/g,""),e=e.replace(/&nbsp;/g," "),e=e.replace(/&quot;/g,'"'),e=e.replace(/&lt;/g,"<"),e=e.replace(/&gt;/g,">"),e=e.replace(/&amp;/g,"&")},getEditorHTML:function(e){var t="";return t+="<html>",t+="<head>",t+='<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />',t+="<style>		p {			*margin:0.2em auto;		}		body {			margin: 0;			scrollbar-face-color: #ffffff;			scrollbar-highlight-color: #ffffff;			scrollbar-shadow-color: #c0c1bb;			scrollbar-3dlight-color: #c0c1bb;			scrollbar-arrow-color: #c9cbb6;			scrollbar-track-color: #f4f5f0;			scrollbar-darkshadow-color: #ffffff;			scrollbar-base-color: #ffffff;			padding: 10px;			word-wrap: break-word;			overflow: scroll;			overflow-x: auto;			height: 90%;			font-size: 14px;		}		body, td, textarea, input, br, div, span{			font-family: '', Verdana,Arial, Helvetica, sans-serif;			line-height:1.5;		}		img{			border: 0;		}		html{			height: 100%;			cursor: text;		}		pre{			white-space:normal;		}		form{margin: 0;}		body table{font-size: 14px;}		.border{ border:1px dashed #cfcfcf;}		</style>		<script>document.domain='sina.com.cn';</script>		",t+="</head>",t+="<body>",t+=e,t+="</body>",t+="</html>"}},App.smilesTemplate=['<table id="#{entity}" class="CP_w faceItemContent" style="visibility: visible;">','<thead id="#{titleBar}"><tr><th class="tLeft"><span></span></th>','<th class="tMid"><div class="bLyTop"><strong id="#{titleName}">插入表情</strong><cite><a id="#{btnClose}"',' href="#" onclick="return false;" class="CP_w_shut" title="关闭">关闭</a></cite></div></th>','<th class="tRight"><span></span></th></tr></thead>','<tfoot><tr><td class="tLeft"><span></span></td><td class="tMid"><span></span></td>','<td class="tRight"><span></span></td></tr></tfoot>',"<tbody><tr>",'<td class="tLeft"><span></span></td>','<td class="tMid" id="#{content}">','<div class="insertface">','<div class="insertface_top">','<h3>热门动漫表情</h3><div class="insertface_search">','<input id="#{searchText}" type="text" class="SG_input" value="输入关键字、动漫形象"',' style="color:#9b9b9a;" maxlength="20" /><a id="#{searchBtn}" href="#" onclick="return false;" ','hidefocue="true" class="SG_aBtn SG_aBtnB"><cite>查找表情</cite></a></div>','<div class="clearit"></div>',"</div>",'<div class="insertface_hot">','<span class="insertface_keyword">热门关键字：<span id="#{hotKeyword}"></span></span>','<span class="insertface_hotslider"></span>',"</div>",'<div class="bigface">','<div class="faceSidebar">','<div id="#{keyCtrl}" class="facekeyword" style="display:none;">','<p><< <a id="#{keyCtrlBack}" href="#" onclick="return false;">返回全部关键字</a></p>','<p>关键字：<span id="#{keyWord}"></span></p></div>','<h3 id="#{allSort}" class="facetitle" style="font-weight:600;"><a href="#"',' onclick="return false;">全部</a></h3>','<div id="#{sortList}" class="facelist"></div>','<div id="#{sortCtrl}" class="facearrow"></div>',"</div>",'<div class="faceShowAll">','<div id="#{smileEmpty}" class="faceShownone" style="display:none;"><p>找不到和关键字相符的表情。','<br /><br /><a id="#{smileEmptyBack}" href="#" onclick="return false;">&lt;&lt;返回首页</a></p></div>','<ul class="faceShowAll_list" id="#{smileList}"></ul>','<div class="SG_page"><ul class="SG_pages">','<li id="#{smilePagePrev}" class="SG_s_pgprev"></li>','<li id="#{smilePageShow}" class="SG_s_pgnum"></li>','<li id="#{smilePageNext}" class="SG_s_pgnext"></li>',"</ul></div>","</div>","</div>","</div>",'</td><td class="tRight"><span></span></td>',"</tr></tbody></table>"].join(""),App.smilesDialog=Core.Class.create(),App.smilesDialog.prototype={pageSize:24,defaultConfig:{sortId:"0",htmlTpl:App.smilesTemplate,callback:function(){}},initialize:function(e){this.option=e||{};
for(var t in this.defaultConfig)null==this.option[t]&&(this.option[t]=this.defaultConfig[t]);if(this.dialog=new Dialog(this.option.htmlTpl),this.dialogNodes=this.dialog.getNodes(),this.getKeyWord(),null!=scope.smilesData)this.data=scope.smilesData,this.dataSettle(),this.eventListen();else{var i=this;Utils.Io.JsLoad.request([{url:"http://www.sinaimg.cn/uc/myshow/blog/misc/gif/smileConfig.js?varname=smileConfig",charset:"GBK"}],{onComplete:function(e){scope.smilesData=e,i.data=e,i.dataSettle(),i.eventListen()},onException:function(){}})}return this},dataSettle:function(e,t){e=e||this.data,t=t||9,this.tabsData=[],this.allData=[];for(var i in e){var n=e[i];n.sortId=i,this.tabsData.push(n);for(var o=0,s=n.data.length;s>o;o++)n.data[o].sid=i,n.data[o].sname=n.name;this.allData=this.allData.concat(n.data)}null==this.allDataBack&&(this.allDataBack=this.allData.slice(0)),this.showTab(1,t),0==this.dialogNodes.smileList.childNodes.length&&this.showAll()},children:function(e){for(var t=[],i=0;e[i];i++)1==e[i].nodeType&&t.push(e[i]);return t},showTab:function(e,t){e=e||1,t=t||9,this.dialogNodes.sortList.innerHTML="",this.dialogNodes.smileList.innerHTML="",Core.Dom.setStyle(this.dialogNodes.sortList,"height",9==t?"279px":"217px"),this.tabs=new Tabs(this.dialogNodes.sortList),this.tabsObject={};for(var i=this,n=0;t>n;n++){var o=(e-1)*t;if(null==this.tabsData[o+n])break;var s=this.tabsData[o+n].sortId,a=this.tabsData[o+n].name,r=this.tabsData[o+n].data,l=new Tab('<img src="http://www.sinaimg.cn/uc/myshow/blog/misc/gif/'+s+'.gif" height="20" width="20" align="absmiddle"><span><a href="#" onclick="return false;">'+a+"</a></span><em>("+r.length+")</em>",{isFocus:!1,className:"cur"});l.addOnAbort(Core.Function.bind3(function(){},null,[l])),l.addOnFocus(Core.Function.bind3(function(e,t,n,o){if(i.showSmile(n,1,i.pageSize),i.currentTab=e,i.dialogNodes.allSort.style.fontWeight=400,!i.isFromUp){var s=scope.$pageid;if(s){var a=scope.isFromtheCommonhzh;a&&v7sendLog($_GLOBAL.faceChooseTable[s][a]+"_16_020_"+o,s,"")}}i.isFromUp=null},null,[l,o+n,r,s])),this.tabsObject[s]=l,this.tabs.add(l)}var c=Math.ceil(this.tabsData.length/t);c>0?this.showTabPage(e||1,c,t):this.dialogNodes.sortCtrl.innerHTML=""},showSmile:function(e,t,i){i=i||this.pageSize;var n,o=this,s=e,a=s.length,r=Math.ceil(a/i),l=document.createDocumentFragment();this.dialogNodes.smileList.innerHTML="";for(var c=0;i>c;c++){var d=s[(t-1)*i+c];if(null==d)break;var h=$C("li"),p=$C("a");p.href="#",p.onclick=function(){return!1},p.onmousedown=Core.Function.bind3(function(e,t){o.option.callback(e,t),o.hide()},null,[d.code,d.name]),p.innerHTML='<img style="width:50px;height:50px;" src="http://www.sinaimg.cn/uc/myshow/blog/misc/gif/'+d.code+'T.gif" alt="'+d.name+'" title="'+d.name+'" />',h.appendChild(p),p.setAttribute("key",d.code);var u=$C("span");u.title=d.name,u.innerHTML=Core.String.byteLength(d.name)>8?Core.String.leftB(d.name,6)+"…":d.name,h.appendChild(u),l.appendChild(h),Core.Events.addEvent(p,function(e){return function(){var t=scope.$pageid;if(t){var i=scope.isFromtheCommonhzh;i&&v7sendLog($_GLOBAL.faceChooseTable[t][i]+"_16_010_"+e.getAttribute("key"),t,"")}}}(p),"mousedown")}this.dialogNodes.smileList.appendChild(l),a>i?(1==t?this.dialogNodes.smilePagePrev.innerHTML="上一页":(this.dialogNodes.smilePagePrev.innerHTML="",n=$C("a"),n.href="#",n.onclick=function(){return!1},n.onmousedown=function(){o.showSmile(s,t-1,i)},n.innerHTML="上一页",this.dialogNodes.smilePagePrev.appendChild(n)),this.dialogNodes.smilePageShow.innerHTML=t+"/"+r,t>=r?this.dialogNodes.smilePageNext.innerHTML="下一页":(this.dialogNodes.smilePageNext.innerHTML="",n=$C("a"),n.href="#",n.onclick=function(){return!1},n.onmouseup=function(){o.showSmile(s,t+1,i)},n.innerHTML="下一页",this.dialogNodes.smilePageNext.appendChild(n))):(this.dialogNodes.smilePagePrev.innerHTML="",this.dialogNodes.smilePageShow.innerHTML="",this.dialogNodes.smilePageNext.innerHTML="")},showTabPage:function(e,t,i){this.dialogNodes.sortCtrl.innerHTML="",this.dialogNodes.smilePagePrev.innerHTML="",this.dialogNodes.smilePageShow.innerHTML="",this.dialogNodes.smilePageNext.innerHTML="";var n,o=this;1==e?e!=t&&(this.dialogNodes.sortCtrl.innerHTML='<a href="#" onclick="return false;" title="向上" class="up_off"></a>',n=$C("a"),n.href="#",n.onclick=function(){return!1},n.title="向下",n.className="down",n.onmousedown=function(){o.showTab(e+1,i),o.showAll()},this.dialogNodes.sortCtrl.appendChild(n)):t>e?(n=$C("a"),n.href="#",n.onclick=function(){return!1},n.title="向上",n.className="up",n.onmousedown=function(){o.showTab(e-1,i),o.showAll()},this.dialogNodes.sortCtrl.appendChild(n),n=$C("a"),n.href="#",n.onclick=function(){return!1},n.title="向下",n.className="down",n.onmousedown=function(){o.showTab(e+1,i),o.showAll()},this.dialogNodes.sortCtrl.appendChild(n)):(n=$C("a"),n.href="#",n.onclick=function(){return!1},n.title="向上",n.className="up",n.onmousedown=function(){o.showTab(e-1,i),o.showAll()},this.dialogNodes.sortCtrl.appendChild(n),Core.Dom.addHTML(this.dialogNodes.sortCtrl,'<a href="#" onclick="return false;" title="向下" class="down_off"></a>'))},eventListen:function(){var e=this,t=e.dialogNodes.searchText,i=e.dialogNodes.searchBtn,n=e.dialogNodes.keyCtrlBack,o=e.dialogNodes.allSort,s=e.dialogNodes.smileEmptyBack;Core.Events.addEvent(document.body,function(t){var i=Core.Events.getEvent(),n=$IE?i.srcElement:i.target;null==e.dialogNodes.entity||0!=Core.Dom.contains(e.dialogNodes.entity,n)&&1!=t||e.hide()}),Core.Events.addEvent(this.dialogNodes.btnClose,function(){e.hide()}),Core.Events.addEvent(t,function(){"输入关键字、动漫形象"==Core.String.trim(t.value)&&(t.value="",t.style.color="#000"),t.select()},"focus"),Core.Events.addEvent(t,function(){""==Core.String.trim(t.value)&&(t.value="输入关键字、动漫形象",t.style.color="#9b9b9a")},"blur"),Core.Events.addEvent(t,function(){var i=Core.Events.getEvent(),n=i.which||i.keyCode,o=Core.String.trim(t.value);13==n&&""!=o&&e.searchKey(o)},"keydown"),Utils.Form.limitMaxLen(t,20),Core.Events.addEvent(i,function(){"输入关键字、动漫形象"==t.value||""==t.value||(e.searchKey(t.value),t.focus())});var a=function(){e.dataSettle(e.data,9),e.dialogNodes.keyCtrl.style.display="none",e.dialogNodes.smileEmpty.style.display="none",e.dialogNodes.smileList.style.display="",e.dialogNodes.searchText.value="输入关键字、动漫形象",e.dialogNodes.searchText.style.color="#9b9b9a"};Core.Events.addEvent(n,a),Core.Events.addEvent(s,a),Core.Events.addEvent(o,function(){e.showAll()})},showAll:function(){this.showSmile(this.allData,1,this.pageSize),this.dialogNodes.allSort.style.fontWeight=600,null!=this.currentTab&&this.currentTab.setAbort()},setSort:function(e,t){this.isFromUp=e,this.option.sortId=e,this.option.callback=t,0==e?(this.dialogNodes.allSort.style.fontWeight=600,this.dataSettle()):(this.dataSettle(),this.tabs.swapTags(this.tabsObject[e]))},getKeyWord:function(){if(null==this.keywordData){var e=this;Utils.Io.JsLoad.request("http://www.sinaimg.cn/uc/myshow/blog/misc/gif/smileKeywordConfig.js?varname=smileKeywordConfig&rnd="+Math.random(),{onComplete:function(t){e.keywordData=t;var i=t.E___00000000000||"顶|路过|哭|啦啦|美女",n=document.createDocumentFragment();i=i.split("|");for(var o=0,s=i.length;s>o;o++){var a=$C("a");a.href="#",a.onclick=function(){return!1},a.onmousedown=Core.Function.bind3(function(t){e.searchKey(t)},null,[i[o]]),a.innerHTML=i[o],n.appendChild(a)}""==e.dialogNodes.hotKeyword.innerHTML&&e.dialogNodes.hotKeyword.appendChild(n);var r="";for(var l in t)"E___00000000000"!=l&&(r+="∑"+l+"§"+t[l]);e.keywordStr=r},onException:function(){}})}},searchKey:function(e){var t=e.replace(/([\\^$*+?{}.|])/gi,"\\$1"),i=new RegExp("∑([^§]+)§[^∑]*"+t+"[^∑]*","gi"),n=[];this.keywordStr.replace(i,function(e,t){n.push(t)}),n=n.join(",");for(var o={},s=this.allDataBack,a=s.length,r=0,l=0;a>l;l++)(-1!=n.indexOf(s[l].code)||-1!=s[l].sname.indexOf(e)||-1!=s[l].name.indexOf(e))&&(null==o[s[l].sid]&&(o[s[l].sid]={name:s[l].sname,data:[]}),o[s[l].sid].data.push(s[l]),r++);var c=scope.$pageid;if(0==r){if(this.dialogNodes.smileEmpty.style.display="",this.dialogNodes.smileList.style.display="none",c){var d=scope.isFromtheCommonhzh;d&&v7sendLog($_GLOBAL.faceChooseTable[c][d]+"_16_030_"+encodeURIComponent(e),c,"")}}else if(this.dialogNodes.smileList.style.display="",this.dialogNodes.smileEmpty.style.display="none",c){var d=scope.isFromtheCommonhzh;d&&v7sendLog($_GLOBAL.faceChooseTable[c][d]+"_16_031_"+encodeURIComponent(e),c,"")}this.dataSettle(o,7),this.dialogNodes.keyCtrl.style.display="",this.dialogNodes.keyWord.innerHTML=e.split("").join("<wbr/>"),Core.Dom.setStyle(this.dialogNodes.sortList,"height","217px")},setPosition:function(e,t){this.x=e,this.y=t,this.dialog.setPosition({x:e,y:t})},show:function(){this.dialogNodes.searchText.value="输入关键字、动漫形象",this.dialogNodes.searchText.style.color="#9b9b9a",this.dialog.show()},hide:function(){this.dialog.hidden(),this.dialogNodes.keyCtrl.style.display="none"}},App.insertSmilesForm=Core.Class.create(),App.insertSmilesForm.prototype={defalutConfig:{sortCount:6,clickCallback:function(){},recommCount:8},initialize:function(e){if(this.option=e||{},null!=this.option.sortNode){for(var t in this.defalutConfig)null==this.option[t]&&(this.option[t]=this.defalutConfig[t]);null==scope.smilesData?this.getSmilesData():(this.data=scope.smilesData,this.renderUI())}},getSmilesData:function(){{var e=this;Utils.Io.JsLoad.request([{url:"http://www.sinaimg.cn/uc/myshow/blog/misc/gif/smileConfig.js?varname=smileConfig",charset:"GBK"}],{onComplete:function(t){scope.smilesData=t,e.data=t,e.renderUI()},onException:function(){}})}},renderUI:function(){var e,t=this,i=1,n=[],o=[],s=document.createDocumentFragment(),a=$C("div"),r=$C("span"),l=$C("div");a.className="facestyle";for(var c in this.data){if(1==i&&(e=this.data[c]||{data:{}},e=e.data),!(i<=this.option.sortCount))break;var d=this.data[c].name,h=$C("a");h.href="#",h.setAttribute("key",c),h.onclick=function(){return Core.Events.stopEvent(),!1},h.onmousedown=Core.Function.bind3(function(e){App.insertSmilesDialog(e,t.option.clickCallback,t.option.positionNode,t.option.arrPosPix)},null,[c]),h.hideFocus=!0,h.innerHTML='<img src="http://www.sinaimg.cn/uc/myshow/blog/misc/gif/'+c+'-25.gif" alt="'+d+'" title="'+d+'" />',a.appendChild(h),i++}var p=(new Date).getTime();a.id="recomm_"+p,s.appendChild(a),r.className="SG_more";var u=$C("a");if(u.href="#",u.onclick=function(){return Core.Events.stopEvent(),!1},u.onmousedown=function(e){return function(){App.insertSmilesDialog(0,t.option.clickCallback,t.option.positionNode,t.option.arrPosPix);var i=scope.$pageid;if(i){var n=e.parentNode.parentNode.id.split("_")[0];n&&(scope.isFromtheCommonhzh=$_GLOBAL.faceCountMoreLinkTable[i][n][1],v7sendLog($_GLOBAL.faceCountMoreLinkTable[i][n][0]+"_07_000_000",i,""))}}}(u),u.innerHTML="更多>>",r.appendChild(u),s.appendChild(r),l.className="clearit",s.appendChild(l),$E(this.option.sortNode).appendChild(s),null!=$E(this.option.recommNode)){s=document.createDocumentFragment();for(var g=0;g<this.option.recommCount;g++){d=e[g].name;var m=e[g].code;h=$C("a"),h.href="#",function(e){h.onclick=Core.Function.bind3(function(i,n){t.option.clickCallback(i,n);var o=scope.$pageid;return o&&(e+="",e=1==e.length?"0"+e:e,v7sendLog($_GLOBAL.faceCountRecommLinkTable[o]+"_"+e+"_010_"+i,o,"")),Core.Events.stopEvent(),!1},null,[m,d])}(g+8),h.hideFocus=!0,h.innerHTML='<img src="http://www.sinaimg.cn/uc/myshow/blog/misc/gif/'+m+'T.gif" alt="'+d+'" title="'+d+'" />',s.appendChild(h)}$E(this.option.recommNode).appendChild(s)}var f=Lib.children($E("recomm_"+p).childNodes);for(g=0;f[g];g++)Core.Events.addEvent(f[g],function(e,t){return function(){var i=scope.$pageid;if(i){var n=e.parentNode.parentNode.id.split("_")[0];n&&(scope.isFromtheCommonhzh=$_GLOBAL.faceCountMoreLinkTable[i][n][1],v7sendLog($_GLOBAL.faceCountMoreLinkTable[i][n][0]+"_0"+t+"_020_"+e.getAttribute("key"),i,""))}}}(f[g],g+1),"mousedown");i=n=o=e=s=a=r=u=l=m=c=d=h=null}},Lib.children=function(e){for(var t=[],i=0;e[i];i++)1==e[i].nodeType&&t.push(e[i]);return t},App.insertSmilesDialog=function(e,t,i,n){App.insertSmilesDialog.callback=t,null==scope.smileDialog&&(scope.smileDialog=new App.smilesDialog),scope.smileDialog.setSort(e,t);var o=Core.Dom.getXY($E(i)),s=o[0]+n[0],a=o[1]+n[1];scope.smileDialog.setPosition(s,a),scope.smileDialog.show()},App.formInsertSmile=function(e,t,i,n,o,s){var a=$E(e),r=function(){a.createTextRange&&(a.caretPos=document.selection.createRange().duplicate())};Core.Events.addEvent(a,r,"keyup"),Core.Events.addEvent(a,r,"focus"),Core.Events.addEvent(a,r,"select"),Core.Events.addEvent(a,r,"click"),new App.insertSmilesForm({sortNode:t,clickCallback:function(e,t){var i="[emoticons="+e+"]"+t+"[/emoticons]";if($IE)if(a.createTextRange&&a.caretPos){var o=a.caretPos;o.text=" "==o.text.charAt(o.text.length-1)?i+" ":i,a.focus()}else a.value+=i,a.focus();else if(a.setSelectionRange){var s=a.selectionStart,r=a.selectionEnd,l=a.value.substring(0,s),c=a.value.substring(r);a.value=l+i+c}else a.value+=i;n&&n()},recommNode:i,positionNode:o||t,arrPosPix:s||[0,0]})},Core.Dom.removeParentNode=function(e){e=$E(e);var t=e.parentNode;Core.Dom.insertAfter(e,t),t.parentNode.removeChild(t)},TweenStrategyEx=function(e,t,i,n){this.startValue=e||[],this.endValue=t||[],this.duration=i||0,this.motion=n||Ui.Transition.simple,this.__eventDispatcher=new Core.Events.EventDispatcher(this)}.$define({motion:null,duration:0,startValue:0,endValue:0,_itvID:0,_isTweenning:!1,addEventListener:function(e,t){return this.__eventDispatcher.addEventListener(e,t),this},removeEventListener:function(e,t){return this.__eventDispatcher.removeEventListener(e,t),this},start:function(){if(!this._isTweenning){this._isTweenning=!0;var e,t=this,i=this.startValue,n=this.endValue,o=this.duration,s=[],a=(new Date).getTime();return this._itvID=window.setInterval(function(){e=((new Date).getTime()-a)/1e3,e>t.duration&&(e=t.duration);for(var r=0;r<i.length;r++)s[r]=t.motion(e,i[r],n[r]-i[r],o);t.onTween&&t.onTween(s),t.__eventDispatcher.dispatchEvent("tween",s),e==t.duration&&t.stop()},25),this}},stop:function(){return window.clearInterval(this._itvID),this._isTweenning=!1,this.onEnd&&this.onEnd(),this.__eventDispatcher.dispatchEvent("end"),this},onTween:function(){},onEnd:function(){}}),Core.Events.getEventTarget=function(e){return e=e||Core.Events.getEvent(),Core.Events.fixEvent(e),e.target},Comment2TSina=Core.Class.create(),Comment2TSina.prototype={anonyous:!1,data:null,initialize:function(e,t){this.anonyous=e||!1,this.data=t||{},scope.$temp_commCtt=this.data.weibo_content,scope.$temp_commId=this.data.blog_id},writeCommTips:function(){if($E("bb")){var e=$E("writeComm_tips");if(!e){var t=$C("div");t.className="writeComm_tips_box",t.style.display="none",t.innerHTML='<span class="writeComm_tips" id="writeComm_tips"><strong></strong><cite><a href="javascript:;">关闭</a></cite></span>';var i=Core.Dom.byClz(document,"div","writeComm");if(!i)return;i[0].insertBefore(t,i[0].childNodes[0]),e=t.firstChild,Core.Events.addEvent(e.lastChild,function(){t.style.display="none"},"click"),this.bindTipsEvents(e)}var n=e.parentNode,o=e.firstChild;n.style.display="none",this.anonyous||$E("anonymity")&&$E("anonymity").checked||"no_blog"===this.data.re_weibo?(o.innerHTML='评论发表成功，<a href="javascript:void(0);">点此还可以同步到微博，分享给我的粉丝。</a>',n.style.display="block"):"success"===this.data.re_weibo?(o.innerHTML='评论成功同步到微博，<a href="http://weibo.com/'+this.data.t_sina+'/profile" target="_blank">点此查看</a>',n.style.display="block"):"no_bind"===this.data.re_weibo&&(o.innerHTML='评论分享失败，您需要先<a href="javascript:void(0);">绑定微博</a>',n.style.display="block")}},bindTipsEvents:function(e){Core.Events.addEvent(e.firstChild,function(t){if(Core.Events.stopBubble(t),"a"==Core.Events.getEventTarget(t).tagName.toLowerCase()){var i=e.firstChild.lastChild.innerHTML;"点此查看"===i?e.parentNode.style.display="none":"绑定微博"===i?($E("writeComm_tips").parentNode.style.display="none",this.bindToTSina()):1==checkUserProduct.flag?this.openStep():this.shareToT()}}.bind2(this),"click")},openStep:function(){var me=this;Utils.Io.Ijax.request("http://control.blog.sina.com.cn/riaapi/tshow/send_cms_weibo.php",{POST:{uid:$UID,blog_id:scope.$temp_commId,content:scope.$temp_commCtt,isphoto:0},onComplete:function(data){if(data=eval("("+data+")")||{},"A00006"===data.code){var tips=$E("writeComm_tips");tips.parentNode.style.display="block",tips.firstChild.innerHTML='评论成功同步到微博，<a href="http://weibo.com/'+data.data+'/profile" target="_blank">点此查看</a>'}else"B00001"===data.code?winDialog.alert("您的博客还未绑定新浪微博，现在绑定？",{icon:"04",funcOk:function(){me.bindToTSina()}}):"A00004"===data.code||"A11007"===data.code?me.shareToT():winDialog.alert("网络繁忙，请稍后再试。",{icon:"01"})},onException:function(){winDialog.alert("网络繁忙，请稍后再试。",{icon:"01"})}})},bindToTSina:function(){var e=this,t="http://control.blog.sina.com.cn/t_sina_blog/bind_weibo_form.php?from=js&domain="+document.domain;window.open(t,"mb","toolbar=0,status=0,resizable=1,width=440,height=430,left="+(screen.width-440)/2+",top="+(screen.height-430)/2),window.tOkBack=function(){trace("微博绑定回调ok函数！"),winDialog.alert("绑定微博成功",{icon:"03",funcOk:function(){e.openStep()},funcClose:function(){e.openStep()}})},window.tFailBack=function(){trace("微博绑定 fail"),winDialog.alert("网络繁忙，请稍后再试。",{icon:"01"})}},shareToT:function(){var e=scope.$temp_commCtt;if(e){var t=encodeURIComponent(e),i="新浪-博客",n="http://blog.sina.com.cn",o="http://v.t.sina.com.cn/share/share.php?searchPic=false&title="+t+"&url="+encodeURIComponent(document.location)+"&source="+i+"&sourceUrl="+encodeURIComponent(n)+"&content=utf-8&appkey=1617465124";window.open(o,"selectionshare","toolbar=0,status=0,resizable=1,width=440,height=430,left="+(screen.width-440)/2+",top="+(screen.height-430)/2)}else winDialog.alert("分享的内容不能为空",{icon:"01"});$E("writeComm_tips").parentNode.style.display="none"}};var checkUserProduct={isinit:!1,func:null,product:"",flag:!0,getReturn:function(e){switch(e){case"blog":var t="0x"+scope.userProducts&1;this.flag=0!=t?!0:!1;break;case"photo":var t="0x"+scope.userProducts&8;this.flag=0!=t?!0:!1;break;default:this.flag=!0}this.func()},check:function(e,t){if(this.product=e,this.func=t||function(){},scope.userProducts)this.getReturn(e);else{var i="http://uic.sso.sina.com.cn/uic/Query.php?UID="+$UID+"&Check=null&UserInfoTypes=[4]&ProductType=2";Utils.Io.JsLoad.request(i,{onComplete:function(e){"object"==typeof e?(scope.userProducts=e.UserInfo[0][1],this.getReturn(this.product),this.isinit=!0):(this.flag=!1,this.isinit=!0)}.bind2(this),charset:"UTF-8"})}}};CommentV2.formatTime=function(e){var t=new Date;e&&t.setTime(t);var i=t.getMonth()+1>=10?t.getMonth()+1:"0"+(t.getMonth()+1),n=t.getDate()>=10?t.getDate():"0"+t.getDate(),e=(new Date).toTimeString().split(" ")[0],o=t.getFullYear()+"-"+i+"-"+n+" "+e;return o},CommentV2.Post=Core.Class.create(),CommentV2.Post.prototype={articleid:0,totle:0,anonyous:!1,onSuccess:new Function,onError:new Function,initialize:function(){},post:function(e){try{this.data=e,this.data.article_id=this.articleid,this.data.uid=$isLogin?$UID:"",this.data.fromtype="commentadd",this.data.anonymity=this.data.anonymity||this.anonyous||!1,this.data.anonymity&&(this.data.login_name=this.data.comment_anonyous),Lib.checkAuthor(),$isLogin?(this.data.login_name=$nick,this.postComment(this.data)):this.anonyous?this.postComment(this.data):($E("login_remember")&&v7sendLog(this.data.login_remember?"48_01_37_1":"48_01_37_0"),new Lib.Login.LoginPost(function(e){if(Lib.checkAuthor(),$isLogin)this.data.login_name=$nick,this.postComment(this.data),this.renderLogin();else{if(e&&e.errno&&("4049"===e.errno||"2070"===e.errno))return void this.loginNeedSafeCode(e);winDialog.alert(e&&e.reason||"登录名或密码错误！",{icon:"02"}),this.refreshCKIMG(),$E("commentloginM").style.display="none",$E("commentlogin").style.display="block",$E("commentNick").style.display="",$E("commentNick").innerHTML="",$E("anonymity_cont")&&($E("anonymity").checked=!1,$E("anonymity_cont").style.display="none")}}.bind2(this),!1,"referer:"+location.hostname+location.pathname+",func:0001").login(e.login_name,e.login_pass,1==e.login_remember?15:0))}catch(t){trace(t)}},renderLogin:function(){$tray.renderLogin(),$E("commentlogin").style.display="none";var e=this,t=$E("commentNick"),i=function(){1==checkUserProduct.flag?scope.setNickTime=setInterval(function(){var e=Lib.blogv.getVHTML(scope.loginUserWtype);"undefined"==typeof scope.$loginNick?(Lib.Uic.getNickName([$UID],function(i){for(var n in i)scope.$loginNick=i[n],t.innerHTML=scope.$loginNick+"&nbsp;"+e+":",t.style.display=""}),clearInterval(scope.setNickTime)):t.innerHTML=scope.$loginNick+"&nbsp;"+e+":"},500):e._showOpenBlogInfo()};""==t.innerHTML&&(0==checkUserProduct.isinit?window.checkuserinterval=setInterval(function(){0==checkUserProduct.isinit?checkUserProduct.check("blog",i):clearInterval(window.checkuserinterval)},500):i()),$E("anonymity_cont")&&($E("anonymity_cont").style.display="")},_showOpenBlogInfo:function(){for(var e=$E("commentNick").firstChild;e;e=e.nextSibling)$E("commentNick").removeChild(e);$E("commentNick").style.display="",$E("commentNick").innerHTML='<div id="openblog-li" style="cursor:pointer;"><a href="javascript:void(0);"><span id="openblog-nickname"></span>您还未开通博客，点击一秒开通。</a></div>',scope.addBlogOpenerEvent($E("openblog-li")),$E("anonymity")&&($E("commentloginM").style.display="",$E("anonymity").checked=!0,$E("quote_comment_p").style.display="none");var t=setInterval(function(){scope.nickname&&($E("openblog-nickname").innerHTML=scope.nickname+"：",clearInterval(t))},500)},postComment:function(e){function t(e){if(!e){var t=(new Date).getTime();e=t-i}Utils.Io.JsLoad.request("http://control.blog.sina.com.cn/admin/article/ria_debug.php",{GET:{type:"addBlogComment",usetime:e},noreturn:!0})}v7sendLog("32_01_19");var i=(new Date).getTime(),n={POST:e,onComplete:function(i){if("string"==typeof i&&(i=i.replace(/;$/,"")),i="string"==typeof i&&/\s*{/.test(i)?Core.String.j2o(i):i,null!=i&&"undefined"==typeof i.code)return void trace("接口数据异常："+this.url,"#F00");if("A00006"==i.code){if(v7sendLog("45_01_12_"+scope.$uid),i=i.data,e.is_mobile){"N"===i.insertid.charAt(0)&&(i.insertid=i.insertid.slice(1));var n=i.t_sina;n&&"N"===n.charAt(0)&&(i.t_sina=n.slice(1))}t(),Lib.checkAuthor();var o=$E("c_"+scope.$articleid).innerHTML,s=parseInt(/(\d+)/.exec(o)[0],10);s++,$E("c_"+this.articleid).innerHTML="("+s+")",$isLogin&&this.renderLogin(),this.addNewComment(e,i);var a=new Comment2TSina(this.anonyous,i);$E("bb")&&$E("bb").checked&&v7sendLog("32_01_18"),a.writeCommTips(),this.onSuccess(),$E("comment_get_vcode")&&Lib.AudioCheck.render($E("comment_get_vcode").parentNode,Lib.AudioCheck.soundUrl+"?"+(new Date).getTime())}else if(v7sendLog("32_01_21"),t(),this.refreshCKIMG(),"B36113"==i.code?winDialog.alert("博主已关闭匿名评论，请登录后再评论",{funcOk:function(){$E("anonymity_cont")&&($E("anonymity_cont").checked=!1,$E("anonymity_cont").style.display="none"),$E("commentlogin").style.display="",$E("commentloginM").style.display="none"}}):"B36002"==i.code?winDialog.alert($SYSMSG.B36002,{funcOk:function(){$E("login_check").value="",$E("login_check").focus()}}):showError(i.code),null!=i.code){if(Lib.checkAuthor(),$isLogin)return;$E("anonymity_cont")&&($E("anonymity").checked=!1,$E("anonymity_cont").style.display="none"),1==$E("anonymity").checked?($E("commentloginM").style.display="block",$E("anonymity").checked="checked"):($E("commentloginM").style.display="none",$E("commentlogin").style.display="block"),$E("commentNick").innerHTML="",$isLogin=!1,this.anonyous=!0}}.bind2(this),onException:function(e){v7sendLog("32_01_21"),t(-1),trace("post comment error"),winDialog.alert($SYSMSG[e.code]||"发评论失败！请重试。",{icon:"02"})}.bind2(this)};Utils.Io.Ijax.request("http://control.blog.sina.com.cn/admin/comment_new/cms_post.php",n);var o=setTimeout(function(){t(-1),clearTimeout(o),o=null},3e4)},refreshCKIMG:function(){$E("comment_check_img")&&($E("comment_check_img").src="http://interface.blog.sina.com.cn/riaapi/checkwd_image.php?"+(new Date).valueOf()),$E("comment_get_vcode")&&Lib.AudioCheck.render($E("comment_get_vcode").parentNode,Lib.AudioCheck.soundUrl+"?"+(new Date).getTime())},addNewComment:function(e,t){(isNaN(scope.$comment_page)||"undefined"==typeof scope.$comment_page)&&(scope.$comment_page=1);CommentV2.count(scope.$totle_comment);Lib.checkAuthor(),this.getPostTemplet(e,t)},commentTween:function(e){var t,i=this,n=$E("article_comment_list");if(-1===scope.$pageid.indexOf("articletj"))n.appendChild(e),t=$E("postCommentIframe");else{var o=$T(n,"li")[0];o?(o.className="SG_j_linedot1",n.insertBefore(e,o)):n.appendChild(e),t=$E("postcommentid")}var s=Core.Dom.getXY(e),a=Core.Dom.getXY(t);new rockIt(e,a,s,0,300,"elasticEaseInOut",{end:function(o){o.clear(),Core.Dom.opacity(e,0),-1===scope.$pageid.indexOf("articletj")?(n.appendChild(e),t=$E("postCommentIframe")):(n.insertBefore(e,n.firstChild),t=$E("postcommentid"));var s=0,a=function(){Core.Dom.opacity(e,s),100==s&&(clearInterval(r),s=0),s+=20},r=setInterval(a,10),l=i.getScollTop(),c=Core.Dom.getXY(e)[1];if(!(c>l)){var d=Math.abs(l),h=0,p=100;100>=d?(h=d==l?1:-1,p=d):h=l/100;var u=+new Date,g=500,m=setInterval(function(){var e=window.$transitions.regularEaseOut,t=+new Date;if(g>t-u)var n=t-u;else{var n=g;clearInterval(m)}i.setScollTop(e(n,l,c-l,g))},15)}}})},getScollTop:function(){var e=0,t=0;return document.body&&(document.body.scrollLeft||document.body.scrollTop)?(t=document.body.scrollTop,e=document.body.scrollLeft):document.documentElement&&(document.documentElement.scrollLeft||document.documentElement.scrollTop)&&(t=document.documentElement.scrollTop,e=document.documentElement.scrollLeft),t},setScollTop:function(e){document.body&&(document.body.scrollLeft||document.body.scrollTop)?document.body.scrollTop=e:document.documentElement&&(document.documentElement.scrollLeft||document.documentElement.scrollTop)&&(document.documentElement.scrollTop=e)},getPostTemplet:function(e,t){var i=this,n=(t.isworldcup,t),t=n.insertid||t,o={};if(o.id=t,o.user_image=n.user_img,o.src_uid=scope.$uid,e.anonymity)o.uname=e.comment_anonyous,o.comm_uid=0;else{o.ulink="http://blog.sina.com.cn/u/"+(e.uid||$UID),o.ria_index_url=o.ulink;var s=Lib.blogv.getVHTML(scope.loginUserWtype);o.uname=scope.nickname||e.login_name,s&&(o.vimg=s),o.comm_uid=$UID}o.cms_body=this.changeToContent(e.comment),o.cms_pubdate=CommentV2.formatTime(),o.fromProduct=n.from_product,o.cms_reply_num="0",o.action_data=encodeURIComponent(Utils.Json.flatten({commentid:o.id,articleid:n.blog_id,fromProduct:n.from_product,comm_uid:o.comm_uid,uname:o.uname,ulink:o.ulink,src_uid:scope.$uid,cms_reply_num:o.cms_reply_num}));var a={};a.item=o,a.fun=function(e){i.commentTween(e)},Lib.Listener.notify("commentlist-commentadd",a);{var r=this.isNoCotent();scope&&"articletj"===scope.$pageid}r&&r.parentNode.removeChild(r)},isNoCotent:function(){for(var e=$E("article_comment_list"),t=e.getElementsByTagName("li"),i=0;t[i];i++)for(var n=t[i].getElementsByTagName("div"),o=0;n[o];o++)if(-1!=n[o].className.toUpperCase().indexOf("NOCOMMDATE"))return t[i];return null},changeToContent:function(e){var t=e.replace(/\r\n|\n/gi,"###line-return###");t=Core.String.encodeHTML(t);var i=/\[emoticons=(E___\w*)\]([^[]*)\[\/emoticons\]/gi,n='<img src="http://www.sinaimg.cn/uc/myshow/blog/misc/gif/$1T.gif" style="margin:1px;cursor:pointer;" onclick="window.open(\'http://blog.sina.com.cn/myshow2010\')" border="0" title="$2" />';t=t.replace(i,n);var o=/\[magicemoticons=([E|W]___\w*)\&nbsp\;swfname=(\w+\.swf)\]([^[]*)\[\/magicemoticons\]/gi,s=['<img src="http://www.sinaimg.cn/uc/myshow/blog/misc/gif/$1T.gif" style="margin:1px;','cursor:pointer;" onclick="window.$magicFacePlay(\'$2\');return false;"',' border="0" title="$3" width="50" height="50"/>'].join("");return t=t.replace(o,s),t=t.replace(/###line-return###/gi,"<br/>")},loginNeedSafeCode:function(e){var t=this,i=['<table id="#{entity}" class="CP_w">','<thead id="#{titleBar}">',"<tr>",'<th class="tLeft"><span></span></th>','<th class="tMid">','<div class="bLyTop">','<strong id="#{titleName}"></strong>','<cite><a title="关闭" class="CP_w_shut"  id="#{btnClose}" href="javascript:;">关闭</a></cite>',"</div>","</th>",'<th class="tRight"><span></span></th>',"</tr>","</thead>","<tfoot>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid"><span></span></td>','<td class="tRight"><span></span></td>',"</tr>","</tfoot>","<tbody>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid">','<div class="" style="width:auto;" id="#{content}">',"</div>","</td>",'<td class="tRight"><span></span></td>',"</tr>","</tbody>","</table>"].join(""),n='<div class="CP_layercon1"><div class="verifyPrompt"><p>为了保护你的账号安全，请输入验证码进行登录</p><div class="row1"><strong>验证码：</strong><input type="text" maxlength="5" id="xssSafeCodeDiag_checkword" class="fm1"><img width="100" align="absmiddle" src="http://login.sina.com.cn/cgi/pin.php?r=11681364785467546&amp;s=0" maxlength="5" id="xssSafeCodeDiag_safeimg"><a id="" href="javascript:void(0); return false;" onclick="scope.xssSafeCodeDiag.changeSafeCode();">换一换</a></div><p class="CP_w_btns"><a id="" href="javascript:void(0); return false;" class="CP_a_btn2" onclick="scope.xssSafeCodeDiag.ok();"><cite><span>登录</span></cite></a><span style="display:none" id="xssSafeCodeDiag_ErrTips" class="ErrTips"></span></p></div></div>';"undefined"==typeof scope.xssSafeCodeDiag&&(scope.xssSafeCodeDiag=winDialog.createCustomsDialog({tpl:i,title:"提示",content:n,width:282,height:180,funcDisplayFinished:function(){}},"note"),scope.xssSafeCodeDiag.changeSafeCode=function(){$E("xssSafeCodeDiag_checkword").value="",$E("xssSafeCodeDiag_safeimg").src="http://login.sina.com.cn/cgi/pin.php?r="+Core.Math.getUniqueId()+"&s=0"},scope.xssSafeCodeDiag.ok=function(){var e=$E("xssSafeCodeDiag_checkword").value;return""===e?($E("xssSafeCodeDiag_ErrTips").innerHTML="请输入验证码",void($E("xssSafeCodeDiag_ErrTips").style.display="")):("undefined"!=typeof sinaSSOController&&"undefined"!=typeof sinaSSOController.loginExtraQuery&&"undefined"!=typeof sinaSSOController.loginExtraQuery.door&&(sinaSSOController.loginExtraQuery.door=e||1),sinaSSOController.loginExtraQuery.door=e||1,t.post(t.data),void scope.xssSafeCodeDiag.hidden())},scope.xssSafeCodeDiag.displayError=function(e){"4049"!==e.errno?($E("xssSafeCodeDiag_ErrTips").innerHTML=e.reason,$E("xssSafeCodeDiag_ErrTips").style.display=""):$E("xssSafeCodeDiag_ErrTips").style.display="none"}),scope.xssSafeCodeDiag.show(),scope.xssSafeCodeDiag.setMiddle(),scope.xssSafeCodeDiag.changeSafeCode(),scope.xssSafeCodeDiag.displayError(e)}},CommentV2.commentFaceTemplate=['<table id="#{entity}" class="CP_w">','<thead id="#{titleBar}">',"<tr>",'<th class="tLeft"><span></span></th>','<th class="tMid">','<div class="bLyTop">','<strong id="#{titleName}">插入表情</strong>','<cite><a id="#{btnClose}" href="javascript:;" onclick="return false;" class="CP_w_shut" title="关闭">关闭</a></cite>',"</div>","</th>",'<th class="tRight"><span></span></th>',"</tr>","</thead>","<tfoot>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid"><span></span></td>','<td class="tRight"><span></span></td>',"</tr>","</tfoot>","<tbody>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid" id="#{content}">','<div class="faceItemContent">','<div class="bigface">','<div id="#{faceTab}" class="faceSidebar">',"</div>",'<div id="#{faceContent}" class="faceShowAll">',"</div>","</div>","</div>","</td>",'<td class="tRight"><span></span></td>',"</tr>","</tbody>","</table>"].join(""),CommentV2.count=function(e){var t=50,i=0;return i=e%t==0?Math.ceil(e/t):Math.floor(e/t)+1};var Comment={};CommentV2.insertSmile=Core.Class.create(),CommentV2.insertSmile.prototype={initialize:function(){},show:function(){this.btnShowFaceEditor=$E("article_comment_insertSmile"),this.txtComment=$E("commentArea"),this.faceEditor=new Lib.Face(this.txtComment);var e=this;e.bindFace()},bindFace:function(){var e=this;Core.Events.addEvent(this.btnShowFaceEditor,function(){if(e.faceEditor.isShowed)e.faceEditor.hidden();else{e.faceEditor.isLoad||(e.faceEditor.load(),e.initFace(),e.faceEditor.isLoad=!0);
var t=Core.Dom.getLeft(e.btnShowFaceEditor)-450,i=Core.Dom.getTop(e.btnShowFaceEditor)+e.btnShowFaceEditor.offsetHeight;e.faceEditor.setPosition(t,i),e.faceEditor.show()}Core.Events.stopEvent()},"mousedown")},initFace:function(){var e=this;Core.Events.addEvent(this.faceEditor.dialogNodes.btnClose,function(){e.faceEditor.hidden()},"mousedown"),Core.Events.addEvent(document.body,function(){e.faceEditor.hidden()},"mousedown"),Core.Events.addEvent(this.faceEditor.dialog.entity,function(){Core.Events.stopEvent()},"mousedown")}},$SYSMSG.extend({B119001:"不能转载自己的文章!",B119002:"转帖功能为新版博客专属功能，点击确认立即升级你的博客吧！<br/><span style='font-weight: 100; font-size: 12px;'><a target='_blank' href='http://blog.sina.com.cn/lm/iframe/xhtml/2010/blogspread.html'>了解新版博客详情</a></span>",B119003:"被转载文章不存在!",B119004:"请访问原文进行转载！",B119005:"对不起，博主设置不允许转载该文章",B119006:"对不起，博主设置不允许转载其文章",B119007:"很抱歉，转载失败，请稍后再试",B119008:"已经转载很多啦，看看其他的精彩文章",B119009:"您短时间转载过多，请稍后再试"}),App.getArticlesSort=function(e,t){t=t||scope.$uid;var i=$C("script");Lib.checkAuthor(),i.src="http://hits.blog.sina.com.cn/acate?varname=x&uid="+t,i.charset="utf-8",i.onload=i.onerror=i.onreadystatechange=Core.Function.bind2(function(){i&&i.readyState&&"loaded"!=i.readyState&&"complete"!=i.readyState||(App.ArticlesSort=x,null!=e&&e(App.ArticlesSort),i.onload=i.onreadystatechange=i.onerror=null,i.src="",i.parentNode.removeChild(i),i=null)},this),document.getElementsByTagName("head")[0].appendChild(i)};var cateDialog=Core.Class.create();cateDialog.prototype={uid:"",initialize:function(e){this.action=e||!1},show:function(e){this.uid=e||scope.$uid,this.initDialog(),this.dialog.show(),this.dialog.setFixed(!0),this.dialog.setAreaLocked(!0),this.dialog.setMiddle()},initDialog:function(){var e=this,t={width:492,height:0,url:"http://control.blog.sina.com.cn/admin/article/article_class_list.php?"+(this.action?"action=editor":"")};Lib.checkAuthor(),this.url="http://control.blog.sina.com.cn/admin/article/article_class_save2.php?uid="+$UID+(this.action?"&action=editor":""),this.id=Core.Math.getUniqueId(),this.manage=null,this.manage=new cateMng(this.id,this.itemTpl,this.uid),this.manage.onSuccess=function(t){e.onSuccess(t)};var i=new Ui.Template("<div style='width: #{width}px; height: #{height}px;' id='category_"+this.id+"'></div>"),n={ad:!1,drag:!0,title:"分类管理",content:i.evaluate(t),shadow:1,width:t.width,height:t.height},o={},s=winDialog.createCustomsDialog(n,o);this.dialog=s,$E("category_"+this.id).innerHTML=this.tpl.join("");var a=this;this.dialog.nodes.btnClose.href="javascript:;",this.dialog.nodes.btnClose.onclick=function(){a.manage.getEdit()?winDialog.confirm("是否保存此更改？",{funcOk:function(){a.manage.saveHandler(a.url)},funcCancel:function(){a.close()},funcClose:function(){a.dialog.show()},textOk:"是",textCancel:"否"}):a.close()},this.initEvent()},initEvent:function(){this.manage.nameEvent(),this.manage.createEvent(),this.manage.dataProvider(),this.manage.saveEvent(this.url)},hidden:function(){this.dialog.hidden()},close:function(){this.dialog.hidden(),this.dialog.destroy()},showOld:function(){this.dialog.show()},reset:function(){window.CateDialog.dialog.setCloseEvent(!0),window.CateDialog.dialog.hidden(),window.CateDialog.dialog=null,window.CateDialog.init=!1},setSize:function(e,t){var i=this.dialog.nodes.content.firstChild;this.dialog.setSize(e,t),i.style.width=e+"px",i.style.height=t+"px"},setCloseEvent:function(){},getDialog:function(){return this.dialog},getId:function(){return this.id},getDataList:function(){return this.manage.list},onSuccess:function(){},init:!1,dialog:null,tpl:['<div id="categoryBody">','<div id="categoryTitle">',"</div>",'<div id="categoryHead">',"<table>","<tr>",'<td><input type="text" maxlength="28" value="最多可输入14个中文字符" id="categoryName"/></td>','<td width="80"><a id="categoryCreate" href="javascript:void(0);" class="SG_aBtn SG_aBtnB SG_aBtn_sub"><cite>创建分类</cite></a></td>','<td><span class="SG_txtc">请用中文、英文或数字。</span></td>',"</tr>","</table>",'<div id="errTips"></div>',"</div>",'<form method="post" id="categoryForm" name="form">','<div id="categoryList">','<ul class="clearfix" id="datalist">&nbsp;</ul>','<div class="SG_j_linedot"></div>',"</div>",'<div id="categoryBottom" style="text-align:center">','<a id="categorySave" href="javascript:void(0);" class="SG_aBtn SG_aBtnB SG_aBtn_sub"><cite>保存设置<input type="button" value="保存设置"/></cite></a>',"</div>","</form>","</div>"],itemTpl:['<li class="{class}">','<span class="htit" style="color:#000000" id="cate_{index}">{cate}</span>','<input type="hidden" value="{cate}" name="typename[]" class="catName"/>','<input type="hidden" value="{id}" name="number[]"/>','<span id="ctrl_{index}" class="control">','<div class="manage">','<a class="CP_a_fuc" id="edit_{index}" href="javascript:;" onclick="javascript:window.CateDialog.manage.editCate(this);">[<cite>编辑</cite>]</a>','<a class="CP_a_fuc" id="del_{index}" index="{index}" href="javascript:;" onclick="javascript:window.CateDialog.manage.delCate(this);">[<cite>删除</cite>]</a>',"</div>",'<div class="arrow">','<a id="up_{index}" class="{up_class}" href="javascript:;" onclick="javascript:window.CateDialog.manage.upHandler(this);"/>','<a id="down_{index}" class="{down_class}" href="javascript:;" onclick="javascript:window.CateDialog.manage.downHandler(this);"/>',"</div>","</span>",'<div id="editctrl_{index}" class="writeinfo" style="display:none">','<input id="new_{index}" type="text" value="" /><a class="SG_aBtn SG_aBtnB SG_aBtn_sub" href="javascript:;"><cite>确定</cite></a><a class="SG_aBtn SG_aBtnB SG_aBtn_sub" href="javascript:;"><cite>取消</cite></a></div>',"<div/>","</li>"]};var cateMng=Core.Class.create();cateMng.prototype={list:null,orilen:0,edit:!1,uid:null,initialize:function(e,t,i){this.uid=i||scope.$uid,this.id=e,this.itemTpl=t,Array.prototype.remove=function(e){return isNaN(e)||e>this.length?!1:void this.splice(e,1)}},nameEvent:function(){var e=this;$E("categoryName").onfocus=function(){"最多可输入14个中文字符"==this.value&&(this.value="")},$E("categoryName").onblur=function(){var t=/[ ><\\\'\;\"`\|\t\r\n|\u3000]/gi;this.value=this.value.replace(t,""),""==Core.String.trim($E("categoryName").value)?(this.value="最多可输入14个中文字符",this.edit=!1):this.edit=!0,e.showTips("")},$E("categoryName").onkeyup=function(){var e=Core.String.trim(this.value);Core.String.byteLength(e)>28?this.value=Core.String.leftB(e,28):e!=this.value&&(this.value=e)},e.showTips("")},createEvent:function(){function e(){var e=Core.String.trim($E("categoryName").value);i="",""==e||"最多可输入14个中文字符"==e?i="分类名称不能为空":-1!=e.indexOf("&")||-1!=e.indexOf("＆")?i="分类名称不能包含&符号":t.list.length>=15?i="抱歉！最多可创建15条分类":Core.String.byteLength(e)>28&&(i="最多可输入14个中文字符");for(var n=0;n<t.list.length;n++)if(t.list[n].name==e){i="您已经添加过此分类";break}return""!=i?!1:!0}var t=this,i="";$E("categoryCreate").onclick=function(){if(e()&&$E("categoryName").edit){var n={id:-1,name:$E("categoryName").value};$E("categoryName").value="最多可输入14个中文字符",$E("categoryName").edit=!1,t.list.push(n),t.update()}t.showTips(i)}},saveEvent:function(e){Core.Events.stopEvent();var t=this;$E("categorySave").onclick=function(){t.saveHandler(e)}},saveHandler:function(url){var _this=this,length=_this.list.length;if(_this.orilen-length>2)return void winDialog.confirm("您本次删除的博文分类太多，确定删除？",{funcOk:function(){_this.orilen=length,$E("categorySave").onclick()}});for(var cateName=[],cateId=[],i=0;length>i;i++){var item=_this.list[i];cateName.push(item.name),cateId.push(item.id)}Utils.Io.Ijax.request(url+"&r="+Math.random(),{POST:{typename:cateName.join("|"),number:cateId.join("|")},onComplete:function(res){eval("var result = "+res);try{try{$E("module_3")&&Lib.Component.refresh(3,{width:scope.catedialogwidth||210}),$E("module_7")&&location.reload()}catch(error){trace(error)}try{window.ArticleCateFuncs.reloadCate(result.msg)}catch(error){}window.CateDialog.close()}catch(e){}var r;eval("r="+res),_this.onSuccess(r.msg)},onException:function(){}})},editCate:function(e){function t(e,t){var o=e,a="";if(Core.String.byteLength(o)>28&&(o=Core.String.leftB(o,28)),1==t)for(var r=0;r<i.list.length;r++)if(i.list[r].name==o){a="您已经添加过此分类";break}if(""!=a)$E("err_"+n)?$E("err_"+n).value=a:(Core.Dom.addHTML($E("editctrl_"+n),'<div id="err_'+n+'" class="errTips">'+a+"</div>"),s.style.height="60px");else{i.list[n].name=o;var l=i.itemTpl.join("");l=l.replace('<li class="{class}">',""),l=l.replace("</li>");var c=i.list[n];l=l.replace(/\{cate\}/gi,c.name),l=l.replace(/\{id\}/gi,c.id),l=l.replace(/\{index\}/gi,n),l=l.replace(/\{up_class\}/,0==n?"up_disabled":"up"),l=l.replace(/\{down_class\}/,n==i.list.length-1?"down_disabled":"down"),s.innerHTML=l,s.className=n%2==0?"":"cline",s.style.height="30px",1==t&&(i.edit=!0)}a=""}var i=this,n=e.id.split("_")[1],o=$E("cate_"+n).innerHTML,s=$E("cate_"+n).parentNode;$E("ctrl_"+n).className="control hide",s.className=n%2==0?"editName":"cline editName";var a='<div id="editctrl_'+n+'" class="writeinfo"><input id="new_'+n+'" type="text" value="'+o+'"><a class="SG_aBtn SG_aBtnB SG_aBtn_sub" href="javascript:;"><cite>确定</cite></a><a class="SG_aBtn SG_aBtnB SG_aBtn_sub" href="javascript:;"><cite>取消</cite></a></div>';s.innerHTML=a,$E("new_"+n).onkeyup=function(){var e=/[ >&<\\\'\,\;\"`\|\t\r\n|\u3000]/gi,t=Core.String.trim(this.value.replace(e,""));t!=this.value&&(this.value=t),$E("editctrl_"+n).childNodes[1].disabled=""==t?!0:!1},$E("new_"+n).onblur=function(){Core.String.byteLength(this.value)>=28&&(this.value=Core.String.leftB(this.value,28))},$E("editctrl_"+n).childNodes[1].onclick=function(){$E("new_"+n).value==o?t(o,2):t($E("new_"+n).value,1)},$E("editctrl_"+n).childNodes[2].onclick=function(){t(o,2)}},delCate:function(e){var t=this,i=e.id.split("_")[1];winDialog.confirm("确实要删除此分类吗？删除后不可恢复。",{funcOk:function(){t.list.remove(i),t.update()}})},upHandler:function(e){var t=e.id.split("_")[1];if(t>0){var i=this.list[t];this.list[t]=this.list[t-1],this.list[t-1]=i,this.update()}},downHandler:function(e){var t=e.id.split("_")[1];if(t<this.list.length-1){var i=1*t+1,n=this.list[i];this.list[i]=this.list[t],this.list[t]=n,this.update()}},showTips:function(e){$E("errTips").innerHTML=e},dataProvider:function(){var e=this;App.getArticlesSort(function(t){e.list=t.data,e.orilen=e.list.length,$E("datalist").innerHTML="";for(var i=0;i<e.list.length;i++){var n=e.itemTpl.join(""),o=e.list[i];n=n.replace(/\{cate\}/gi,o.name),n=n.replace(/\{class\}/gi,i%2==0?"":"cline"),n=n.replace(/\{id\}/gi,o.id),n=n.replace(/\{index\}/gi,i),n=n.replace(/\{up_class\}/,0==i?"up_disabled":"up"),n=n.replace(/\{down_class\}/,i==e.list.length-1?"down_disabled":"down"),Core.Dom.addHTML($E("datalist"),n)}},this.uid)},update:function(){$E("datalist").innerHTML="";for(var e=0;e<this.list.length;e++){var t=this.itemTpl.join(""),i=this.list[e];t=t.replace(/\{cate\}/gi,i.name),t=t.replace(/\{class\}/gi,e%2==0?"":"cline"),t=t.replace(/\{id\}/gi,i.id),t=t.replace(/\{index\}/gi,e),t=t.replace(/\{up_class\}/,0==e?"up_disabled":"up"),t=t.replace(/\{down_class\}/,e==this.list.length-1?"down_disabled":"down"),Core.Dom.addHTML($E("datalist"),t)}this.edit||(this.edit=!0)},getEdit:function(){return this.edit},onSuccess:function(){}};var QuoteSuccess=Core.Class.create();QuoteSuccess.prototype={interfaceSave:null,_isDialogInit:!1,_dialog:null,memoNullText:"说点什么...",articleID:"",_cateList:[],initialize:function(){Lib.checkAuthor(),this.interfaceSave=new Interface("http://control.blog.sina.com.cn/riaapi/article/edit_cat.php","ijax"),!window.CateDialog&&(window.CateDialog=new cateDialog)},show:function(e){!this._isDialogInit&&this._initDialog(),this.articleID=e||"",this._dialog.show(),this._dialog.setFixed(!0),this._dialog.setMiddle(),this._dialog.setAreaLocked(!0)},save:function(){var e=this,t=this._dialog.nodes;this.interfaceSave.request({POST:{new_cat:t.selCate.value,blog_id:e.articleID,reship:t.txtMemo.value===e.memoNullText?"":t.txtMemo.value},onSuccess:function(t){e.onSuccess(t),e.close()},onError:function(t){e.onError(t)},onFail:function(){}})},close:function(){this._dialog.hidden(),this.clear()},_initDialog:function(){var e=this;this._dialog=winDialog.createCustomsDialog({content:['<div class="CP_layercon6">','<div class="turnBox">','<p class="turnTxt">','<img class="SG_icon SG_icon203" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="50" height="50" align="absmiddle"/>','<span class="txt1">转载成功！</span>你还可以写评论...',"</p>","<ul>",'<li><span class="a">评论：</span><span class="b"><textarea id="#{txtMemo}" style="color:#c8c8c8;" cols="" rows="3" class="SG_textarea">'+this.memoNullText+"</textarea></span></li>","<li>",'<span class="a">分类：</span>','<span class="b"><select id="#{selCate}" name=""><option value="00">默认文章分类</option></select>&nbsp;&nbsp;<a id="#{btnShowCate}" href="#" onclick="return false;">创建分类</a></span>',"</li>","</ul>",'<div class="clearit"></div>','<div class="butt">','<a href="#" id="#{btnSave}" onclick="return false;" class="SG_aBtn SG_aBtnB"><cite>保存</cite></a>&nbsp;&nbsp;<a id="#{btnCancel}" onclick="return false;" href="#" class="SG_aBtn SG_aBtnB "><cite>关闭</cite></a>','<a style="visibility:hidden" target="_blank" href="http://blog.sina.com.cn/admin/advice/advice_list.php" class="link">改进建议</a>',"</div>","</div>",'<div class="clearit"></div>',"</div>"].join("")}),Core.Events.addEvent(this._dialog.nodes.btnSave,function(){e._dialog.nodes.txtMemo.value===e.memoNullText&&0===e._dialog.nodes.selCate.selectedIndex?e.close():e.verified()&&e.save()},"click"),Core.Events.addEvent(this._dialog.nodes.btnCancel,function(){e.close()},"click"),Core.Events.addEvent(this._dialog.nodes.btnShowCate,function(){window.CateDialog.onSuccess=function(t){e._dialog.nodes.selCate.length=1;var i,n=t||[],o=n.length;for(i=0;o>i;i++)e.addCate(n[i].value,n[i].label);e.addCate("0","私密博文")},Lib.checkAuthor(),window.CateDialog.show($UID)},"click"),this._dialog.addEventListener("hidden",function(){e.clear(),e.onClose()}),this._dialog.nodes.txtMemo.onblur=function(){""===this.value.replace(/\s/g,"")&&(this.style.color="#c8c8c8",this.value=e.memoNullText)},this._dialog.nodes.txtMemo.onfocus=function(){this.value===e.memoNullText&&(this.style.color="#000000",this.value="")},this._initCateList(),this._isDialogInit=!0},verified:function(){var e=this._dialog.nodes;return Core.String.byteLength(e.txtMemo.value)>2e3?(winDialog.alert("评论内容必须是1000中文或2000字符以内，请重新输入。"),!1):!0},_initCateList:function(){var e=this._dialog.nodes,t=this;e.selCate.length=1,Lib.checkAuthor(),App.getArticlesSort(function(){var e,i=x.data,n=i.length;for(e=0;n>e;e++)t.addCate(i[e].id,i[e].name);t.addCate("0","私密博文")},$UID)},_getFaceURL:function(e){var t=parseInt(e)%8+1;return"http://portrait"+t+".sinaimg.cn/"+e+"/blog/50"},addCate:function(e,t){var i=this._dialog.nodes.selCate,n=$C("option");n.value=e,n.innerHTML=t,i.appendChild(n)},clear:function(){var e=this._dialog.nodes;e.txtMemo.style.color="#c8c8c8",e.txtMemo.value=this.memoNullText},onSuccess:function(){},onError:function(){},onClose:function(){}};var Quote=Core.Class.create();Quote.prototype={quoteSuccess:null,saving:!1,articleID:"",initialize:function(e){this.quoteSuccess=new QuoteSuccess,this.initInterface(),this.bindEvent(e),this.articleID=scope.$articleid},bindEvent:function(e){var t=this;e&&Core.Events.addEvent($E(e),function(){t.check()})},initInterface:function(){this._interface=new Interface("http://control.blog.sina.com.cn/admin/article/article_quote.php","ijax")},check:function(e,t,i,n){this.articleID=e||scope.$articleid,n=n||function(){},Lib.checkAuthor();var o=this;if($isLogin){var o=this;scope.blogOpener.showDialog(function(){o.save(t,i),n()})}else v7sendLog("48_01_33"),(new Lib.Login.Ui).login(function(){scope.blogOpener.showDialog(function(){o.save.bind2(o)(),n()})})},save:function(e,t){var i=this;if(!this.saving){this.saving=!0;var n={version:7,blog_id:i.articleID,comment:t||"",reship:e||""};this._interface.request({POST:n,onSuccess:function(t){this.numAdd(),this.saving=!1;var i=t.url.split("/").pop().split("_")[1].split(".")[0];e||(this.quoteSuccess.onSuccess=function(){winDialog.alert("博文已成功转载！<br/><span style='font-weight: 100; font-size: 12px;'><a target='_blank' href='"+t.url+"'>查看转载博文>></a></span>",{icon:"03"})},this.quoteSuccess.show(i)),this.onSuccess(i,t.url||"")}.bind2(this),onError:function(e){return this.saving=!1,"B119007"==e.code||"B119008"==e.code?(winDialog.alert($SYSMSG[e.code],{icon:"01",funcOk:function(){window.location.href=window.location.href.replace(/#.*$/,"")}},"alert1"),Core.Events.addEvent(winDialog.getDialog("alert1").getNodes().btnClose,function(){window.location.href=window.location.href.replace(/#.*$/,"")},"click"),void this.onError()):("B119002"==e.code?winDialog.alert($SYSMSG[e.code],{icon:"01",funcOk:function(){window.location.href="http://control.blog.sina.com.cn/upgrade/upgrade_show.php?version=7"}}):(winDialog.alert($SYSMSG[e.code],{icon:"02",funcOk:function(){window.location.href=window.location.href.replace(/#.*$/,"")}},"alert1"),Core.Events.addEvent(winDialog.getDialog("alert1").getNodes().btnClose,function(){window.location.href=window.location.href.replace(/#.*$/,"")},"click")),void this.onError())}.bind2(this),onFail:function(){this.saving=!1}.bind2(this)})}},numAdd:function(){var e=$E("quote_sign")||$E("quote_sign_"+this.articleID)||$E("z_"+this.articleID);if(e){var t,i=e.innerHTML;i.replace(/(\d+)/,function(e,i){t=i}),e.innerHTML="("+(parseInt(t)+1)+")"}},onSuccess:function(){},onError:function(){}};var CommentQuote=Core.Class.create();CommentQuote.prototype={_isInitTip:!1,_tip:null,quote:null,commentText:"",articleID:"",interfaceSave:null,initialize:function(){this.interfaceSave=new Interface("http://control.blog.sina.com.cn/riaapi/article/edit_cat.php","ijax"),this._initQuote()},_initQuote:function(){var e=this;this.quote=new Quote,this.quote.onSuccess=function(t,i){e.hideTip(),winDialog.alert("博文已成功转载！<br/><span style='font-weight: 100; font-size: 12px;'><a target='_blank' href='"+i+"'>查看转载博文>></a></span>",{icon:"03"}),e.onSuccess()},this.quote.onError=function(){e.hideTip()}},showTip:function(e){var t,i=Core.System.winSize();!this._isInitTip&&this._initTip(),t=this._tip,t.getNodes().content.innerHTML=e,t.visibility="hidden",t.show(),t.setPosition(i.width/2-+t.entity.offsetWidth/2,i.height/2-+t.entity.offsetHeight/2),t.visibility="",t.setFixed(!0)},check:function(e,t){this.articleID=e,this.commentText=t,this.quote.check(e,t,"1")},hideTip:function(){this._tip&&this._tip.hidden()},_initTip:function(){this._tip=new Lib.Panel,this._tip.setTemplate(['<div id="#{panel}" style="z-index:512;border:1px solid #CC9933; background:#FFFFCC; padding:20px;">','<div id="#{content}"></div>',"</div>"].join("")),this._isInitTip=!0},onSuccess:function(){}},scope.bindEmailPanel=Core.Class.define(function(){Lib.Panel.prototype.initialize.apply(this,arguments),this.setTemplate(['<div id="#{panel}" style="z-index:512; width:200px" class="tb_layer_Y tb_layer_w5">','<div class="tb_layer_Y_main tip_layer_main">','<div class="tip_ps" style="width:auto;float:right">','<a id="closeBindEmail" title="关闭提示" class="tb_friend_inputDel" href="#" onclick="return false"></a>',"</div>",'<div style="padding:6px">为了您的账号安全，请<a id="linkBindEmail" href="#" target="_blank">绑定邮箱</a></div>',"</div>",'<div class="tb_layer_arrow tip_arrow"></div>',"</div>"].join(""))},Lib.Panel,{initUserInfo:function(){this.getNodes()}}),$registJob("articleCommentPostV2",function(){function e(){var e=$E("commentNick");if(e){for(var t=e.firstChild;t;t=t.nextSibling)e.removeChild(t);e.innerHTML='<div id="openblog-li" style="cursor:pointer;"><a href="javascript:void(0);"><span id="openblog-nickname"></span>您还未开通博客，点击一秒开通。</a></div>',scope.addBlogOpenerEvent($E("openblog-li"));var i=setInterval(function(){scope.nickname&&($E("openblog-nickname").innerHTML=scope.nickname+"：",clearInterval(i))},100)}}function t(e){Utils.Io.JsLoad.request("http://login.sina.com.cn/bindmail/checkmailuser.php?entry=blog&name="+encodeURIComponent(e)+"&utf82gbk=1&callback=scope.$bindEmailTip",{noreturn:!0})}function i(e){var t=e||"check";"img"==t?($E("comment_check_img").style.display="inline",$E("check_show").style.display="none"):($E("comment_check_img").style.display="none",$E("check_show").style.display="")}if($E("comment_check_img")){var n=new CommentQuote;if(n.onSuccess=function(){$E("cbCommentQuote")&&($E("cbCommentQuote").checked=!1)},1!=scope.$private.cms&&1!=scope.$isCommentAllow){var o=!1;$E("comment_check_img").style.display="none";var s=new CommentV2.Post,a=function(){$E("commentNick").style.display="",1==checkUserProduct.flag?scope.setNickTime=setInterval(function(){var e=Lib.blogv.getVHTML(scope.loginUserWtype);"undefined"==typeof scope.$loginNick?(Lib.Uic.getNickName([$UID],function(t){for(var i in t)scope.$loginNick=t[i],$E("commentNick").innerHTML=scope.$loginNick+"&nbsp;"+e+":"}),clearInterval(scope.setNickTime)):$E("commentNick").innerHTML=scope.$loginNick+"&nbsp;"+e+":"},500):e()};if($isLogin)0==checkUserProduct.isinit?setTimeout(function(){checkUserProduct.check("blog",a)},10):a();else{$E("commentlogin").style.display="block";var r=Utils.Cookie.getCookie("remberloginname");""!=r&&""!=r&&($E("login_name").value=unescape(unescape(r)));var l=Utils.Cookie.getCookie("ALF");""!=l&&$E("login_remember")&&($E("login_remember").checked=!0);var l=Utils.Cookie.getCookie("LiRe");""!=l&&$E("login_remember")&&($E("login_remember").checked=!0),$E("anonymity_cont")&&($E("anonymity")&&($E("anonymity").checked=!1),$E("anonymity_cont").style.display="none")}$E("bb")&&($E("bb").checked="1"==Utils.Cookie.getCookie("acp_bb")?!1:!0);var c=function(){function e(){if(i){var e="http://control.blog.sina.com.cn/blog_rebuild/riaapi/padblog/padInfo.php?ck_login=A00003&rnd="+Math.random();Utils.Io.JsLoad.request(e,{onComplete:function(){},onException:function(){}}),i=null}}Lib.checkAuthor();var t=$E("login_remember");if(t){t.checked=!0,$isLogin||(t.onclick=e);var i=1}};c(),$E("anonymity")&&$E("anonymity").checked&&(s.anonyous=!0,$E("commentlogin").style.display="none",$E("commentloginM").style.display=""),Core.Events.addEvent($E("comment_anonyous"),function(){$E("anonymity")&&$E("anonymity").checked&&"新浪网友"==Core.String.trim($E("comment_anonyous").value)&&($E("comment_anonyous").value="")},"focus"),Core.Events.addEvent($E("comment_anonyous"),function(){$E("anonymity")&&$E("anonymity").checked&&""==Core.String.trim($E("comment_anonyous").value)&&($E("comment_anonyous").value="新浪网友")},"blur");var d=new scope.bindEmailPanel;Core.Events.addEvent($E("login_name"),function(){d.hidden()},"focus"),Core.Events.addEvent($E("login_name"),function(){var e=$E("login_name").value;e&&t(e)},"blur"),scope.$bindEmailTip=function(e){if("y"==e.ret||"not_verify"==e.errcode){var t=$E("login_name");d.showWithDom(t,-150,-55),$E("linkBindEmail").href="http://login.sina.com.cn/bindmail/signin.php?entry=blog&utf82gbk=1&username="+encodeURIComponent(t.value)}else d.hidden()},Core.Events.addEvent($E("closeBindEmail"),function(){d.hidden()}),Core.Events.addEvent("postcommentid",function(){try{d.hidden()}catch(e){}});var h=function(){$E("comment_check_img").src=$IE8?"http://interface.blog.sina.com.cn/riaapi/checkwd_image_ie8.php?"+(new Date).valueOf():"http://interface.blog.sina.com.cn/riaapi/checkwd_image.php?"+(new Date).valueOf(),i("img")};s.articleid=scope.$articleid,s.onSuccess=function(){scope.commEditor&&scope.commEditor.clearHTML("postCommentIframe");var e=$E("cbCommentQuote");e&&e.checked&&n.check($r_quote_bligid,$E("commentArea").value),$E("commentArea").value="",$E("login_check").value="",p&&g&&(g.value=""),i()},s.onError=function(){h()},$E("anonymity")&&Core.Events.addEvent("anonymity",function(){var t=$E("commentNick");v7sendLog("32_01_17");var i=checkUserProduct.flag&&checkUserProduct.isinit||!1;if(i&&$isLogin&&t&&(t.style.display=""),$E("anonymity").checked)s.anonyous=!0,$E("commentlogin").style.display="none",$E("commentloginM").style.display="block",$E("cbCommentQuote")&&($E("cbCommentQuote").checked=!1),t&&(t.innerHTML="你正以匿名身份发表评论:");else{var n=Lib.blogv.getVHTML(scope.loginUserWtype);s.anonyous=!1,$E("commentlogin").style.display=$isLogin?"none":"block",$E("commentloginM").style.display="none",i?t&&(t.innerHTML=(scope.$loginNick||scope.nickname)+"&nbsp;"+n+":"):e()}$E("cbCommentQuote")&&($E("cbCommentQuote").disabled=$E("anonymity").checked),$E("quote_comment_p")&&($E("quote_comment_p").style.display=$E("anonymity").checked?"none":"")}),$E("bb")&&Core.Events.addEvent($E("bb"),function(){v7sendLog("32_01_18")}),$E("postCommentIframe")||Core.Events.addEvent("commentArea",function(){o||($E("check_show").style.display="none",h(),o=!0)},"focus"),Core.Events.addEvent("login_check",function(){o||($E("check_show").style.display="none",h(),o=!0)},"focus"),Core.Events.addEvent("check_show",function(){o||($E("check_show").style.display="none",h(),o=!0)},"click"),Core.Events.addEvent("comment_check_img",function(){h()},"mousedown");var p=/Mobile/i.test(navigator.userAgent),u=$E("mobileComment"),g=$E("mbCommentTa");if(p&&u){$E("commonComment").style.display="none",$E("faceWrap").style.display="none",u.style.display="";var m=$E("anonymity_cont");m&&(m.style.cssFloat="left")}var f=function(){if(Core.Events.getEvent()){var e=Core.Events.getEvent();if("keydown"==e.type&&13!=e.keyCode)return;"keydown"==e.type&&13==e.keyCode&&scope.commEditor&&scope.commEditor.handleChange("postCommentIframe"),Core.Events.stopEvent()}if(!$isLogin&&$E("anonymity")&&0==$E("anonymity").checked){if(""==Core.String.trim($E("login_name").value))return void showError($SYSMSG.B36107);if(""==Core.String.trim($E("login_pass").value))return void showError($SYSMSG.B36108)}if(p&&g&&($E("commentArea").value=g.value),$E("anonymity")&&1==$E("anonymity").checked&&""==Core.String.trim($E("comment_anonyous").value))showError($SYSMSG.B36003);else if(""==Core.String.trim($E("commentArea").value))showError($SYSMSG.B36105);else if(""==Core.String.trim($E("login_check").value))winDialog.alert($SYSMSG.B36106,{funcOk:function(){$E("login_check").value="",$E("login_check").focus()}});else{var t={comment:$E("commentArea").value,login_name:$E("login_name").value,login_pass:$E("login_pass").value,check:$E("login_check").value,comment_anonyous:$E("comment_anonyous").value,anonymity:$E("anonymity")&&$E("anonymity").checked,is_mobile:+p,is_t:0};$E("login_remember")&&(t.login_remember=$E("login_remember").checked,t.login_remember?Utils.Cookie.setCookie("LiRe",!0,2400,"/",".blog.sina.com.cn"):Utils.Cookie.setCookie("LiRe","",2400,"/",".blog.sina.com.cn")),$E("bb")&&(s.anonyous&&$E("anonymity")||!$E("bb").checked?(t.is_t=0,"1"!=Utils.Cookie.getCookie("acp_bb")&&Utils.Cookie.setCookie("acp_bb","1",2400,"/",".blog.sina.com.cn")):(t.is_t=1,"1"==Utils.Cookie.getCookie("acp_bb")&&Utils.Cookie.setCookie("acp_bb","",-1,"/",".blog.sina.com.cn"))),s.post(t),o=!1}};if(Core.Events.addEvent($E("commentArea"),function(){var e=Core.Events.getEvent();e.ctrlKey&&13===e.keyCode&&f()},"keydown"),Core.Events.addEvent("postcommentid",function(){scope.commEditor&&scope.commEditor.handleChange("postCommentIframe"),f()}),Core.Events.addEvent($E("postcommentid").parentNode,function(){scope.commEditor&&scope.commEditor.handleChange("postCommentIframe"),f()},"keydown"),Core.Events.addEvent($E("login_check"),f,"keydown"),null==$E("smilesSortShow")){$E("commentArea").style.width="680px";var v=new CommentV2.insertSmile;v.show()}else{var _,y=[-325,40+($IE?-2:0)];if(-1!==scope.$pageid.indexOf("articletj")&&(_={sortCount:4,recommCount:6}),$E("postCommentIframe")){var b={normal:{focus:function(){o||($E("check_show").style.display="none",h(),o=!0)}}};App.formInsertSmile2("commentArea","smilesSortShow","smilesRecommended",null,"smilesSortShow",y,"postCommentIframe",b,_)}else App.formInsertSmile("commentArea","smilesSortShow","smilesRecommended",null,"smilesSortShow",y,null,null,_)}}}}),Core.Dom.getChildrenByClass=function(e,t){for(var i=[],n=e.childNodes||e.children,t=" "+t+" ",o=n.length,s=0;o>s;++s){var a=n[s],r=" "+a.className+" ";-1!=r.indexOf(t)&&(i[i.length]=a)}return i},Lib.pkg("util"),Lib.util.hoverJq=function(e){var t={elm:document.body,mouseenter:function(){},mouseleave:function(){},delay:0};e=Lib.apply(t,e);var i=$IE?"mouseenter":"mouseover",n=$IE?"mouseleave":"mouseout";if("length"in e.elm)try{e.elm=Array.prototype.slice.call(e.elm,0)}catch(o){for(var s=[],a=0,r=e.elm.length;r>a;a++)s.push(e.elm[a]);e.elm=s}else e.elm=[e.elm];Core.Array.foreach(e.elm,function(t,o){Core.Events.removeEvent(t,i),Core.Events.removeEvent(t,n),Core.Events.addEvent(t,function(e,t,i){return function(n){n=n||window.event,$IE?t.apply(e,[n,e,i]):l(n,"mouseenter",e,i)}}(t,e[i],o),i),Core.Events.addEvent(t,function(e,t,i){return function(n){$IE?t.apply(e,[n,e,i]):l(n,"mouseleave",e,i)}}(t,e[n],o),n)});var l=function(t,i,n,o){var s=t.relatedTarget;try{if(s&&s!==document&&!s.parentNode)return;for(;s&&s!==n;)s=s.parentNode;s!==n&&e[i].apply(n,[t,n,o])}catch(a){}return!1}},Lib.register("tray.tpl.loginMemu",function(){var e=['<div class="ntopbar_menu" id="#{panel}">','<div id="#{openBlog}" style="display:none;">','<span class="link" id="#{userMenu}"><a id="#{userNick}" onclick="v7sendLog(\'40_01_21\');return false;" href="###">读取中...</a><a href="javascript:;" class="link_arrow" title=""></a></span>','<span id="#{msnHolder}" class="ico_msn" style="display:none"><a id="#{msnLink}" href="http://control.blog.sina.com.cn/blogprofile/msnbind.php?c=" target="_blank"><img height="18" width="18" align="absmiddle" class="SG_icon SG_icon136" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif"></a></span>','<span class="line_s"></span>','<span class="link"><a onclick="v7sendLog(\'40_01_27\')" href="http://i.blog.sina.com.cn/blogprofile/index.php?com=1">个人中心</a></span>','<span class="line_s"></span>','<em id="#{newFeed}" class="mtip" style="left:341px;display:none;cursor:pointer;"></em>','<span class="link" id="#{blogMenu}"><a target="_blank" onclick="v7sendLog(\'40_01_24\')" href="http://control.blog.sina.com.cn/admin/article/article_add.php">发博文</a><a id="#{addArticle}" onclick="v7sendLog(\'40_01_25\');return false;" href="###" class="link_arrow"></a></span>','<span class="line_s"></span>','<span class="link"><a onclick="v7sendLog(\'40_01_28\')" target="_blank" href="http://wanwan.sina.com.cn/bloggame/">游戏</a></span>','<span class="line_s"></span>','<span class="link" id="#{trayMsg}" msg-panel-show-state="0"><a onclick="v7sendLog(\'40_01_30\');return false;" href="###">消息</a><a href="javascript:return false;" class="link_arrow" title=""></a></span>','<em id="#{newTips}" onclick="v7sendLog(\'40_01_29\')" class="mtip" style="left:341px;display:none;cursor:pointer;"></em>',"</div>",'<div id="#{noOpenBlog}" style="display:none;">','<span class="link"><a id="#{ssoNick}" onclick="v7sendLog(\'40_01_40\');return false;" href="###">读取中...</a></span>','<span class="line_s"></span>','<span class="link"><a id="#{ssoLoginOut}" onclick="v7sendLog(\'40_01_41\');return false;" href="###">退出</a></span>','<div class="ntopbar_login" style="float:left;"><a id="#{openBlogBtn}" onclick="v7sendLog(\'40_01_42\')" class="login" href="###"><span>立即拥有一个新博客</span></a></div>',"</div>","</div>"].join("");return e}),Lib.register("tray.tpl.loginOutMemu",function(){var e=scope.$uid||"",t="http://login.sina.com.cn/signup/signupmail.php?entry=blog&srcuid="+e+"&src=";t+=2==scope.$channel?"baby":"blogicp";var i=['<div id="#{panel}" class="ntopbar_login">','<a class="login" onclick="v7sendLog(\'40_01_38\');return false;" href="###" action-type="tray-login-btn"><span>登录</span></a>','<a class="register" onclick="v7sendLog(\'40_01_39\')" target="_blank" href="',t,'">注册</a></div>'].join("");return i}),Lib.register("tray.tpl.userMenu",function(){var e=['<div id="#{panel}" class="mUserMenu">',"<ul>","<li>",'<span class="tb_ps_nm"><a id="#{linkBlog}" onclick="v7sendLog(\'40_01_22\')" href="###"><img class="SG_icon SG_icon15" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" title="博客" align="absmiddle">博客</a></span>','<span class="rlink"><a target="_blank" onclick="v7sendLog(\'40_01_22\')" id="#{linkPostBlog}" href="http://control.blog.sina.com.cn/admin/article/article_add.php">发博文</a></span>',"</li>",'<li> <span class="tb_ps_nm"><a id="#{linkPhoto}" onclick="v7sendLog(\'40_01_22\')" href="###"><img class="SG_icon SG_icon18" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" title="相册" align="absmiddle">相册</a></span> <span class="rlink"><a target="_blank" id="#{linkPostPhoto}" onclick="v7sendLog(\'40_01_22\')" href="http://photo.blog.sina.com.cn/upload/upload.php">发图片</a></span> </li>','<li> <span class="tb_ps_nm"><a target="_blank" id="#{linkVBlog}" onclick="v7sendLog(\'40_01_22\')" href="###"><img class="SG_icon SG_icon16" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" title="播客" align="absmiddle">播客</a></span> <span class="rlink"><a target="_blank" id="#{linkUpload}" onclick="v7sendLog(\'40_01_22\')" href="http://vupload.you.video.sina.com.cn/u.php?m=1">发视频</a>&nbsp;&nbsp;<a id="#{linkRecord}" onclick="v7sendLog(\'40_01_22\')" href="http://vupload.you.video.sina.com.cn/r.php" target="_blank">录视频</a></span> </li>','<li> <span class="tb_ps_nm"><a id="#{miniblog}" onclick="v7sendLog(\'40_01_22\')" href="###" target="_blank"><img class="SG_icon SG_icon110" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="17" title="微博" align="absmiddle">微博</a></span> </li>','<li> <span class="tb_ps_nm"><a id="#{qingblog}" onclick="v7sendLog && v7sendLog(\'79_01_02\',scope.$pageid,\'qingLink\');" onclick="v7sendLog(\'40_01_22\')" href="###" target="_blank"><img class="SG_icon SG_icon205" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" title="Qing" align="absmiddle">Qing</a></span> </li>','<li style="display:none;" id="#{mail}"> <span class="tb_ps_nm"><a id="#{bindEmail}" target="_blank" href="http://mail.sina.com.cn/?s=2" onclick="v7sendLog(\'40_01_22\')"><img class="SG_icon SG_icon212" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="13" title="邮件" align="absmiddle">邮件</a></span> </li>','<li> <span class="tb_ps_nm"><a id="#{mySpace}" onclick="v7sendLog(\'40_01_22\')" href="###"><img class="SG_icon SG_icon41" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" title="关于我" align="absmiddle">关于我</a></span> </li>',"</ul>",'<div class="links">','<p><a target="_blank" id="#{linkChangeFace}" onclick="v7sendLog(\'40_01_22\')" href="###">修改头像昵称&gt;&gt;</a></p>','<p><a target="_blank" id="#{linkChangePassword}" onclick="v7sendLog(\'40_01_22\')" href="###">修改登录密码&gt;&gt;</a></p>','<p><a target="_blank" id="#{linkAccountSetup}" onclick="v7sendLog(\'40_01_22\')" href="###">帐号安全设置&gt;&gt;</a></p>','<p><a id="#{loginOut}" onclick="v7sendLog(\'40_01_23\');return false;" href="#">退出&gt;&gt;</a></p>',"</div>","</div>"].join("");
return e}),Lib.register("tray.loginOut",function(e){var t=e.Listener;return function(e,i){var n=encodeURIComponent(window.location.href);new Interface("http://control.blog.sina.com.cn/blog_rebuild/msn/api/msnLoginOut.php","jsload").request({onSuccess:function(o){t.notify("global-login-out",o),e&&e(o),i&&(window.location.href="http://login.sina.com.cn/cgi/login/logout.php?r="+n)},onError:function(e){t.notify("global-login-out",e),i&&(window.location.href="http://login.sina.com.cn/cgi/login/logout.php?r="+n)},onFail:function(e){t.notify("global-login-out",e),i&&(window.location.href="http://login.sina.com.cn/cgi/login/logout.php?r="+n)}})}}),Lib.register("tray.UserMenuPanel",function(e){var t=Core.Class.define(function(){e.Panel.prototype.initialize.apply(this,arguments),this.setTemplate(e.tray.tpl.userMenu)},e.Panel,{initUserInfo:function(e){var t=this.getNodes();t.linkBlog.href="http://blog.sina.com.cn/u/"+e,t.linkPhoto.href="http://photo.blog.sina.com.cn/u/"+e,t.linkVBlog.href="http://you.video.sina.com.cn/m/"+e,t.miniblog.href="http://control.blog.sina.com.cn/t_sina_blog/tb.php?uname="+e,t.qingblog.href="http://qing.weibo.com/fancy.html",t.mySpace.href="http://blog.sina.com.cn/s/profile_"+e+".html",t.linkChangeFace.href="http://control.blog.sina.com.cn/blogprofile/nick.php",t.linkChangePassword.href="http://login.sina.com.cn/member/security/password.php",t.linkAccountSetup.href="http://login.sina.com.cn/member/security.php",this.initLoginOut(t.loginOut)},initLoginOut:function(t){t.onclick=function(){return!1},Core.Events.addEvent(t,function(){e.tray.loginOut(null,!0)})}});return t}),Lib.register("tray.tpl.blogMenu",function(){var e=['<div id="#{panel}" class="wrtBlog_sub">','<div class="wrtBlog_sub3">','<p><a target="_blank" onclick="v7sendLog(\'40_01_26\')" href="http://control.blog.sina.com.cn/admin/article/article_add.php?tag365">写365</a></p>','<p><a target="_blank" onclick="v7sendLog(\'40_01_26\')" href="http://control.blog.sina.com.cn/admin/article/changWeiBo.php">长微博</a></p>','<p><a target="_blank" onclick="v7sendLog(\'40_01_26\')" href="http://control.blog.sina.com.cn/weiyulu/weiyulu.php">微语录</a></p>','<p><a target="_blank" onclick="v7sendLog(\'40_01_26\')" href="http://control.blog.sina.com.cn/admin/article/daily.php">九宫格</a></p>','<p><a target="_blank" onclick="v7sendLog(\'40_01_26\')" href="http://photo.blog.sina.com.cn/upload/upload.php">发照片</a></p>','<p><a target="_blank" onclick="v7sendLog(\'40_01_26\')" href="http://vupload.you.video.sina.com.cn/u.php?m=1">发视频</a></p>',"</div>","</div>"].join("");return e}),Lib.register("tray.BlogMenuPanel",function(e){var t=Core.Class.define(function(){e.Panel.prototype.initialize.apply(this,arguments),this.setTemplate(e.tray.tpl.blogMenu)},e.Panel,{});return t}),Lib.register("tray.tpl.searchForm",function(){var e=['<div class="ntopbar_input" id="#{panel}">','<form id="#{searchForm}" method="get" target="_blank" action="http://search.sina.com.cn">','<input id="#{queryTxt}" class="ntopbar_txt" type="text" name="q" autocomplete="off"/>','<input id="#{submit}" type="submit" onclick="v7sendLog(\'40_01_44\')" class="ntopbar_searchBtn" value=""/>','<input type="hidden" name="ie" value="utf-8"/>','<input type="hidden" name="e" value="utf-8"/>','<input id="#{range}" type="hidden" name="range" value="article"/>','<input id="#{t}" type="hidden" name="t" value=""/>','<input id="#{s}" type="hidden" name="s" value="sup"/>','<input id="#{by}" type="hidden" name="by" value="all"/>','<input id="#{type}" type="hidden" name="type" value=""/>','<input id="#{stype}" type="hidden" name="stype" value="1"/>','<input id="#{c}" type="hidden" name="c" value="blog"/>',"</form>","</div>"].join("");return e}),Core.Dom.addClass=function(e,t){var i=Core.String.trim;if(t=i(t),!t)return e;e=$E(e);var n=i(e.className||""),o=" "+n+" ";if(!n)return e.className=i(t),e;for(var s,a=t.split(" "),r=[],l=0;l<a.length;l++)s=a[l],s&&-1===o.indexOf(" "+s+" ")&&r.push(s);return e.className=n+" "+r.join(" "),e},Core.Dom.removeClass=function(e,t){e=$E(e),e.className=e.className.replace(new RegExp("\\s*\\b"+t+"\\b"),"")},Lib.util.getActionData=function(e,t,i,n){if(!t)throw"[Lib.util.getActionData] param actionType is undefined!";e=e||window.event;var o,s,a,r,l,c,d=Core.Events.getEventTarget,i=i||"action-type",n=n||"action-data";for(o=d(e),s=e.currentTarget||document.documentElement||document.body;o&&o!=s;){a=o.getAttribute(i)||"",r=a.split(",");for(var h=0,p=r.length;p>h;h++)if(l=r[h],t===l)return c=o.getAttribute(n),{actionType:t,targetEl:o,data:c};o=o.parentNode}return null},Lib.register("tray.tpl.cateSearch",function(){var e=['<div id="#{panel}" class="mCatSearch">',"<ul>",'<li action-type="tray-search" onclick="v7sendLog(\'40_01_43\')" action-data="article" class="current">含“<span id="#{article}"></span>”的博文</li>','<li action-type="tray-search" onclick="v7sendLog(\'40_01_43\')" action-data="bloger">含“<span id="#{bloger}"></span>”的博主</li>','<li action-type="tray-search" onclick="v7sendLog(\'40_01_43\')" action-data="music">含“<span id="#{music}"></span>”的音乐</li>','<li action-type="tray-search" onclick="v7sendLog(\'40_01_43\')" action-data="video">含“<span id="#{video}"></span>”的视频</li>',"</ul>","</div>"].join("");return e}),Lib.register("tray.CateSearchPanel",function(e){var t=Core.Events.addEvent,i=Core.String.leftB,n=Core.String.byteLength,o=Core.Class.define(function(){e.Panel.prototype.initialize.apply(this,arguments),this.setTemplate(e.tray.tpl.cateSearch),this.initEvt()},e.Panel,{initEvt:function(){var i=this.getNodes(),n=$T(i.panel,"li");e.util.hoverJq({elm:n,mouseenter:function(e,t){Core.Dom.addClass(t,"current")},mouseleave:function(e,t){Core.Dom.removeClass(t,"current")},delay:50}),t(i.panel,function(t){t=t||window.event;var i=e.util.getActionData(t,"tray-search");i&&e.Listener.notify("tray-categroy-search",i.data)})},updateSearch:function(e){5<n(e)&&(e=i(e,4)+"...");var t=e.replace(/(<|>)/g,function(e){return"<"===e?"&lt;":"&gt;"}),o=this.getNodes();o.article.innerHTML=t,o.bloger.innerHTML=t,o.music.innerHTML=t,o.video.innerHTML=t}});return o}),Lib.register("tray.SearchFormPanel",function(e){var t=Core.Events.addEvent,i=Core.String.trim,n=Core.Class.define(function(){e.Panel.prototype.initialize.apply(this,arguments),this.setTemplate(e.tray.tpl.searchForm),this.initEvt(),this.catePanel=new e.tray.CateSearchPanel,this.catePanel.entity.style.zIndex=512,e.Listener.on({name:"tray-categroy-search",callBack:this.search,scope:this})},e.Panel,{initEvt:function(){var e=this,i=this.getNode("queryTxt");t(i,function(t){t=t||window.event;var i=t.target||t.srcElement,n=i.offsetWidth;e.showCateSearch(i,n,i.value)},"input"),t(i,function(t){if(console.log(t),t=t||window.event,"value"===t.propertyName){var i=t.target||t.srcElement,n=i.offsetWidth;e.showCateSearch(i,n,i.value)}},"propertychange"),t(i,function(t){t=t||window.event;var i=t.target||t.srcElement,n=i.offsetWidth;e.showCateSearch(i,n,i.value)},"focus"),t(this.getNode("searchForm"),function(t){t=t||window.event;var i=t.target||t.srcElement;e.checkValidate(i)?setTimeout(function(){e.hideCateSearch(),e.resetForm()},100):Core.Events.stopEvent(t)},"submit"),t(window,function(){if(e.catePanel.isShow){var t=i.offsetWidth;e.catePanel.showWithDom(i,-t,4)}},"resize")},checkValidate:function(e){return"q"in e&&!i(e.q.value)?!1:"k"in e&&!i(e.k.value)?!1:!0},setForm:function(t,i){var n={queryTxt:"q",ie:"utf-8",range:"",t:"",s:"",by:"",type:"",stype:"",e:"utf-8",c:""},o=this.getNode("searchForm");o.action=t,e.apply(n,i);var s=this.getNode("queryTxt");s.name=n.queryTxt,delete n.queryTxt;var a,r;for(var l in n)a=n[l],"string"==typeof a&&(r=this.getNode(l))&&(r.value=a)},resetForm:function(){this.setForm("http://search.sina.com.cn",{queryTxt:"q",range:"article",s:"sup",by:"all",stype:"1",c:"blog"})},search:function(e){var t=(this.getNode("searchForm"),"http://search.sina.com.cn"),i="http://video.sina.com.cn/search/index.php",n="http://music.sina.com.cn/yueku/search/s.php";switch(e){case"video":this.setForm(i,{queryTxt:"k",s:"sup",type:"boke",stype:"1"});break;case"bloger":this.setForm(t,{queryTxt:"q",range:"author",s:"sup",by:"all",stype:"1",c:"blog"});break;case"music":this.setForm(n,{queryTxt:"k",t:"song"});break;default:this.setForm(t,{queryTxt:"q",range:"article",s:"sup",by:"all",stype:"1",c:"blog"})}$IE?this.getNode("submit").click():Core.Events.fireEvent(this.getNode("submit"),"click")},showCateSearch:function(e,t,i){var n=this.catePanel;i&&n.isHidden?n.showWithDom(e,-t,4):i||this.hideCateSearch(),n.updateSearch(i)},hideCateSearch:function(){var e=this.catePanel;e.hide(),e.updateSearch("")}});return n}),Lib.register("tray.loadUserInfo",function(e){var t=e.util.LS,i=e.util.JSON,n=function(n,o){var s="http://interface.blog.sina.com.cn/riaapi/profile/getNickName.php";Utils.Io.JsLoad.request(s,{GET:{uid:n},onComplete:function(s){if(s&&"A00006"===s.code){var a=(s.data.nickname,{time:(new Date).getTime()/1e3});e.apply(a,s.data),t.setItem("uid"+n,i.stringify(a)),o(a)}},onException:function(){},timeout:1e4})};return function(e,o,s){var a=t.getItem("uid"+e);if(!s&&a){a=i.parse(a);var r=(new Date).getTime()/1e3,l=r-a.time;if(240>l&&a.nickname)return void o(a)}n(e,o)}}),Lib.register("tray.MsgLoader",function(e){var t,i=function(e){var t=$C("div");e.write(t),document.body.appendChild(t)},n="";(window.$Maxthon||window.$360||window.$TT)&&(n="?t="+Core.Math.getUniqueId());var o=function(o){if(e.apply(this,o),!t)try{var s=new Utils.Flash.swfObject($_GLOBAL.flashBasicURL+"blogMessageReminding.swf"+n,"__msgTipsPlayer","1px","1px","9","#00ff00");s.addParam("quality","high"),s.addParam("wmode","transparent"),s.addParam("allowScriptAccess","always"),s.addParam("freeTime",27e3),"complete"===document.readyState?(i(s),t=$E("__msgTipsPlayer")):_addEvt(window,function(){i(s),t=$E("__msgTipsPlayer")},"load")}catch(a){}}.$define({time:30,url:"http://comet.blog.sina.com.cn/notice",getFlaDom:function(){return t},play:function(){if($_GLOBAL.msgPlaySound&&t&&t.PlaySound)try{t.PlaySound()}catch(e){}},load:function(t){var i=scope.$articleid||"";t&&Utils.Io.JsLoad.request(this.url,{GET:{uid:t||"",blogid:i},onComplete:function(n){if(n&&"A00006"==n.code){var o,s;if(t&&(o=n.data[t])){var a={};a.sum=0;for(var r in o)a[r]=o[r],a.sum+=o[r];a.blogrecomment=a.blogrecomment?a.blogrecomment:0,e.Listener.notify("tray-newmsg-loaded",a)}i&&(s=n.data[i])&&e.Listener.notify("article-msg-loaded",s)}},onException:function(){},timeout:1e4})}});return o}),Lib.register("tray.tpl.notice",function(){var e=['<div id="#{panel}" class="horn">','<div id="#{tj}" class="horn_con" style="display:none;">推荐：<a id="#{noticeAd1}" target="_blank" href="#"></a><a id="#{noticeAd2}" target="_blank" href="#"></a></div>','<div id="#{announce}" class="horn_con" style="display:none;"><p id="#{announceCon}">公告：<em>请您及时更换请请请您正在使用的模版将于2周后被下线，请您及时更换</em></p></div>','<a class="close" title="关闭" id="#{close}" style="float:none;">×</a>',"</div>"].join("");return e}),Lib.register("tray.BlogNotice",function(e){var t=Core.Events.addEvent,i=Utils.Cookie.setCookie,n=scope.$pageid,o=Core.Class.define(function(){e.Panel.prototype.initialize.apply(this,arguments),this.setTemplate(e.tray.tpl.notice),this.initEvt()},e.Panel,{initEvt:function(){var n=this;t(this.getNode("close"),function(t){t=t||window.event,i("closeNotice_fzp",$UID,24,"/",".blog.sina.com.cn"),e.Listener.notify("tray-announce-close",{}),n.destroy()})},update:function(e){var t=this.getNode("tj"),i=this.getNode("announce"),o=["SLOT_58","SLOT_59","SLOT_98","SLOT_99","SLOT_100","SLOT_101","SLOT_102"],s="http://interface.blog.sina.com.cn/riaapi/pageslot/pageslot.php",a={id:o};if("undefined"!=typeof scope&&(a.blogeruid=scope.$uid),$UID&&(a.loginuid=$UID),$isLogin&&e.announce.result&&("indexM"===n||"articleM"===n||"articlelistM"===n))i.innerHTML=e.announce.announce_con,i.style.display="";else{var r=this.getNode("noticeAd1"),l=this.getNode("noticeAd2"),c=function(e){var i=0,n=e[o[0]].res,s=e[o[1]].res;(n||s)&&(n&&(i=0,n.length>1&&(i=Math.floor((n.length+1)*Math.random())),r.innerHTML=n[i].words,r.href=n[i].a_href,r.title=n[i].a_title,r.setAttribute("suda-uatrack",n[i].a_c_suda.replace("suda-uatrack=","").replace('"',"").replace('"',"")),"undefined"!=typeof SUDA&&SUDA.uaTrack(n[i].a_v_suda_key,n[i].a_v_suda_value)),s&&(i=0,s.length>1&&(i=Math.floor((s.length+1)*Math.random())),l.innerHTML=s[i].words,l.href=s[i].a_href,l.title=s[i].a_title,l.setAttribute("suda-uatrack",s[i].a_c_suda.replace("suda-uatrack=","").replace('"',"").replace('"',"")),"undefined"!=typeof SUDA&&SUDA.uaTrack(s[i].a_v_suda_key,s[i].a_v_suda_value)),t.style.display="")};"waitting"===scope.__subscribeSlot?scope.__subscribeSlotFunc=c:"object"==typeof scope.__subscribeSlot?c(scope.__subscribeSlot):(scope.__subscribeSlot="waitting",Utils.Io.JsLoad.request(s,{GET:a,onComplete:function(e){c(e),scope.__subscribeSlot=e,"function"==typeof scope.__subscribeSlotFunc&&scope.__subscribeSlotFunc(e)},onException:function(){}}))}},setTemplate:function(e){this.template=e;var t=new Lib.HtmlTemplate(this.template,this.uniqueID);this.tpl=t,Core.Dom.insertHTML($E(this.appendTo),t.getHtmlString(),"afterbegin"),this.entity=$E("_"+this.uniqueID+"_panel"),this.entity.style.display="none",tempEntity=null}});return o}),Lib.register("tray.unReadMsgPanel",function(e){var t=Core.Class.define(function(t){if(e.Panel.prototype.initialize(),"editor"!=scope.$pageid){this._lockstate=0,this._scrolling=0,this._srcPot=t;var i=['<div class="cor"></div>','<div class="bd">','<a href="#" id="j-unread-msg-close" class="close" title="关闭">×</a>','<ul id="j-unre-list">',"</ul>","</div>"].join("");this.setTemplate('<div class="messageTips" id="#{panel}" style="left:850px; top:10px;">'+i+"</div>"),this.entity.style.zIndex=500,this._bindEvent()}},e.Panel,{show:function(){this.isShow||(v7sendLog("40_02_01"),this.entity.style.display="",this._srcPot&&this._srcPot.setAttribute("unread-show-state",1),this.isHidden=!1,this.isShow=!0,this.backIframe&&(this._updateBackIframe(),this.backIframe.style.display=""),e.Listener.notify("tray-unread-panel-show",{}))},hide:function(){e.Panel.prototype.hide.call(this),this._srcPot&&this._srcPot.setAttribute("unread-show-state",0),e.Listener.notify("tray-unread-panel-hide",{})},_updatePanelIframe:function(){this.backIframe&&this._updateBackIframe()},_updateCont:function(e){var t=[];if(e.comment+e.message+e.notice+e.gbook==0)return void this.hide();if(e.comment>0&&t.push("<li>"+e.comment+'条新评论，<a onclick="v7sendLog(\'40_02_02\')" href="http://i.blog.sina.com.cn/blogprofile/profilecommlist.php?type=1">查看评论</a></li>'),e.message>0&&t.push("<li>"+e.message+'条新纸条，<a onclick="v7sendLog(\'40_02_03\')" href="http://control.blog.sina.com.cn/blogprofile/profilepaperlist.php?type=1">查看纸条</a></li>'),e.gbook>0&&t.push("<li>"+e.gbook+'条新留言，<a onclick="v7sendLog(\'40_02_04\')" href="http://i.blog.sina.com.cn/blogprofile/wall.php">查看留言</a></li>'),e.notice>0){var i={notice:"http://control.blog.sina.com.cn/blog_rebuild/profile/controllers/notelist.php?action=profilesysnote",like:"http://i.blog.sina.com.cn/profilelist/profilelikelist.php",notice_favourite:"http://i.blog.sina.com.cn/blog_rebuild/profile/controllers/notelist.php?action=profilenotice",notice_quote:"http://i.blog.sina.com.cn/blog_rebuild/profile/controllers/notelist.php?action=profilenotice",invite:"http://control.blog.sina.com.cn/blogprofile/profileinvitelist.php",unreadnotices:"http://i.blog.sina.com.cn/blog_rebuild/profile/controllers/notelist.php?action=profilenotice"},n=i.notice;for(var o in e.notices)if(e.notices[o]>0){n=i[o];break}t.push("<li>"+e.notice+'条新通知，<a onclick="v7sendLog(\'40_02_05\')" href="'+n+'">查看通知</a></li>')}$E("j-unre-list").innerHTML=t.join(""),this.show(),this._setThePos()},_setThePos:function(){var e=Core.Dom.getXY(this._srcPot),t="link"==this._srcPot.className?-2:0,i=$IE7||$IE6?this.entity.offsetWidth:this.entity.clientWidth;if(e[0]){var n=e[0]+this._srcPot.clientWidth-i+t,o=0;1==this._srcPot.getAttribute("adshow")&&0==this._scrolling&&(o=e[1]);var s=this._srcPot.clientHeight+o+10;this.setPosition(n,s)}},_bindEvent:function(){var e=this;Lib.Listener.on({name:"tray-newmsg-loaded",callBack:function(t){e._lockstate||(e._eventHandle(t),e._setThePos())}}),Lib.Listener.on({name:"tray-scrolling-fix",callBack:function(){e._scrolling=1,e._lockstate||(e.setFixed(1),e._setThePos())}}),Lib.Listener.on({name:"tray-scrolling-nofix",callBack:function(){e._scrolling=0,e._lockstate||(e.setFixed(0),e._setThePos())}}),Lib.Listener.on({name:"topad680-show-end",callBack:function(){e._srcPot.setAttribute("adshow",1),e.isShow&&e._setThePos()}}),Core.Events.addEvent($E("j-unread-msg-close"),function(t){var i=t||window.event;i.preventDefault?i.preventDefault():i.returnValue=!1,e.hide(),e._lockstate=1},"click"),Core.Events.addEvent(window,function(){e.isShow&&e._setThePos()},"resize")},_eventHandle:function(e){var t={};t.comment=e.blogcomment-0+(e.photocomment-0)+e.blogrecomment,t.notice=e.notice+e.like+e.notice_favourite+e.notice_quote+e.invite+e.unreadnotices,t.notices={notice:e.notice,like:e.like,notice_favourite:e.notice_favourite,notice_quote:e.notice_quote,invite:e.invite,unreadnotices:e.unreadnotices},t.message=e.message,t.gbook=e.gbook,this._updateCont(t)}});return t}),Lib.register("tray.msgSummaryPanel",function(e){var t=e.util.JSON,i=['<li><a onclick="v7sendLog(\'40_02_12\')" href="http://i.blog.sina.com.cn/blogprofile/profilecommlist.php?type=1"><span class="icoms_comment"></span>查看评论</a></li>','<li><a onclick="v7sendLog(\'40_02_13\')" href="http://control.blog.sina.com.cn/blogprofile/profilepaperlist.php?type=1"><span class="icoms_tips"></span>查看纸条</a></li>','<li><a onclick="v7sendLog(\'40_02_14\')" href="http://i.blog.sina.com.cn/blogprofile/wall.php"><span class="icoms_message"></span>查看留言</a></li>','<li><a onclick="v7sendLog(\'40_02_15\')" href="http://i.blog.sina.com.cn/blog_rebuild/profile/controllers/notelist.php?action=profilenotice"><span class="icoms_notice"></span>查看通知</a></li>'],n=Core.Class.define(function(t){e.Panel.prototype.initialize(),this._srcPot=t,this._lock=1,this._scrolling=0,this._requirestate=1,this._nums={};var n=['<div class="bd">','<ul id="j-summary-list">',i.join(""),"</ul>","</div>"].join("");this.setTemplate('<div class="messageBox" id="#{panel}">'+n+"</div>"),this.entity.style.zIndex=500,this._bindEvent(),this._initNums()},e.Panel,{show:function(){this._checkNumChange()?this._updateCont():this._showAction()},_showAction:function(){this.isHidden?(this._srcPot&&this._srcPot.setAttribute("msg-panel-show-state",1),this.entity.style.display="",this.isHidden=!1,this.isShow=!0,this.backIframe&&(this._updateBackIframe(),this.backIframe.style.display=""),this._setThePos()):this._setThePos()},_checkNumChange:function(){var e=this._srcPot.getAttribute("msg-count"),t=this._srcPot.getAttribute("old-msg-count");return e==t?!1:!0},hide:function(){e.Panel.prototype.hide.call(this),this._srcPot&&this._srcPot.setAttribute("msg-panel-show-state",0),e.Listener.notify("tray-msg-panel-hide",{})},_initNums:function(){var e=t.parse(this._srcPot.getAttribute("msg-count"));this._formatData(e)},_setThePos:function(){($IE6||$IE7||$IE8)&&(this.entity.style.width="auto");var e=Core.Dom.getXY(this._srcPot),t="link"==this._srcPot.className?-2:0,i=$IE7||$IE6?this.entity.offsetWidth:this.entity.clientWidth,n=e[0]+this._srcPot.clientWidth-i+t,o=0;1==this._srcPot.getAttribute("adshow")&&0==this._scrolling&&(o=$IE6||$IE7||$IE8?e[1]-2:e[1]);var s=this._srcPot.clientHeight+o+1;($IE6||$IE7||$IE8)&&(this.entity.style.width=this.entity.clientWidth+1+"px",this.entity.style.width=this.entity.clientWidth-1+"px"),this.setPosition(n,s)},_updatePanelIframe:function(){this.backIframe&&this._updateBackIframe()},_updateCont:function(){var e=[],t=this;this._lock=0,this._requirestate&&(this._getDate({},function(i){e.push(t._getComment(i)),e.push(t._getMessage(i)),e.push(t._getGbook(i)),e.push(t._getNotice(i)),$E("j-summary-list").innerHTML=e.join(""),t._srcPot.setAttribute("old-msg-count",t._srcPot.getAttribute("msg-count")),$IE6&&($E("j-summary-list").style.width="270px"),t._showAction()},function(){}),this._requirestate=0)},_getDate:function(e,t,i){t=t||function(){},i=i||function(){};Lib.checkAuthor();var n=new Interface("http://control.blog.sina.com.cn/blog_rebuild/riaapi/profile/note/notelist.php","jsload");n.request({GET:{uid:$UID},onSuccess:function(e){t(e)}.bind2(this),onError:function(){i({num:0})}.bind2(this),onFail:function(){i({num:0})}.bind2(this)})},_getUserPicUrl:function(e,t){var t=t||50,i=parseInt(e)%8+1;return"http://portrait"+i+".sinaimg.cn/"+e+"/blog/"+t},getLen:function(e){if(!e)return 0;var t=e.match(/[^\x00-\xff]/g);return e.length+(t?t.length:0)},strTruncate:function(e,t,i){return e=e||"","undefined"==typeof i&&(i="..."),this.getLen(e)>t?this.truncete(e,t)+i:e},truncete:function(e,t){var i=e.replace(/\*/g," ").replace(/[^\x00-\xff]/g,"**");return e=e.slice(0,i.slice(0,t).replace(/\*\*/g," ").replace(/\*/g,"").length),this.getLen(e)>t&&t>0&&(e=e.slice(0,e.length-1)),e},getVipIcon:function(e){if(!e)return"";var t={1:{icon:"SG_icon146",info:"新浪个人认证"},2:{icon:"SG_icon147",info:"新浪机构认证"}},e=e||1,i='<img class="SG_icon '+t[e].icon+'" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="13" title="'+t[e].info+'" alt="'+t[e].info+'" align="absmiddle" />';return i},_setNameforIE6:function(e){return $IE6?this.strTruncate(e,4):e},_getComment:function(e){var t="";if(this._nums._comment>0){var n=e.msg.cms;if(n.length>0){for(var o={1:"评论了你的博文",2:"评论了你的图片",6:"回复了你的评论"},s={1:"http://i.blog.sina.com.cn/blogprofile/profilecommlist.php?type=1",2:"http://i.blog.sina.com.cn/blogprofile/profilecommlist.php?type=2",6:"http://i.blog.sina.com.cn/blogprofile/profilereplylist.php"},a=[],r=0,l=n.length;l>r;r++){var c=n[r],d=c.nick_name||c.name;d=this._setNameforIE6(d);var h=this._getUserPicUrl(c.uid,30),p=c.msg_type;a.push(p);var u=c.user_type||0,g=c.time;t+='<li><a onclick="v7sendLog(\'40_02_06\')" href="'+s[p]+'"><img src="'+h+'"><em class="nl">'+d+"</em>"+this.getVipIcon(u)+'<em class="tm">'+g+"</em>"+o[p]+"</a></li>"}a.sort(),this._nums._comment>3&&(t+='<li class="lcount"><a onclick="v7sendLog(\'40_02_07\')" href="'+s[a[0]]+'">总共'+this._nums._comment+"条新评论</a></li>")}else t=i[0]}else t=i[0];return t},_getMessage:function(e){var t="";if(this._nums._message>0){var n=e.msg.note[0],o=n.name||n.nick_name;o=this._setNameforIE6(o);var s=this._nums._message>1?"等"+this._nums._message+"人":"",a=n.user_type||0;t+='<li class="bgc"><a onclick="v7sendLog(\'40_02_08\')" href="http://control.blog.sina.com.cn/blogprofile/profilepaperlist.php?type=1"><span class="icoms_tips"></span><em class="nl">'+o+"</em>"+this.getVipIcon(a)+s+'发来纸条<em class="nr">查看纸条</em></a></li>'}else t=i[1];return t},_getGbook:function(e){var t="";if(this._nums._gbook>0){var n=e.msg.note[1],o=n.name||n.nick_name;if(o){o=this._setNameforIE6(o);var s=this._nums._gbook>1?"等"+this._nums._gbook+"人":"给你",a=n.user_type||0;t+='<li class="bgc"><a onclick="v7sendLog(\'40_02_09\')" href="http://i.blog.sina.com.cn/blogprofile/wall.php"><span class="icoms_message"></span><em class="nl">'+o+"</em>"+this.getVipIcon(a)+s+'留言<em class="nr">查看留言</em></a></li>'}}else t=i[2];return t},_getNotice:function(e){var t="",n="http://i.blog.sina.com.cn/blog_rebuild/profile/controllers/notelist.php?action=profilenotice",o="http://control.blog.sina.com.cn/blog_rebuild/profile/controllers/notelist.php?action=profilesysnote",s={3:"http://control.blog.sina.com.cn/blogprofile/profileinvitelist.php",7:n,8:n,9:n,23:n,13:"http://i.blog.sina.com.cn/profilelist/profilelikelist.php",100:o,101:o,102:o,103:o,104:o,105:o,106:o,107:o,108:o,109:o,110:o,111:o,112:o};if(this._nums._notice>0){var a=e.msg.note[2],r=a.msg_type;t+='<li class="bgc last"><a onclick="v7sendLog(\'40_02_10\')" href="'+s[r]+'"><span class="icoms_notice"></span>'+this._nums._notice+'条新通知<em class="nr">查看通知</em></a></li>'}else t=i[3];return t},_bindEvent:function(){var e=this;Lib.Listener.on({name:"tray-newmsg-loaded",callBack:function(t){e._requirestate=1,e._eventHandle(t)}}),Lib.Listener.on({name:"tray-scrolling-nofix",callBack:function(){e._scrolling=0,e._lockstate||(e.setFixed(0),e._setThePos())}}),Lib.Listener.on({name:"tray-scrolling-fix",callBack:function(){e._scrolling=1,e._lockstate||(e.setFixed(1),e._setThePos())}}),Lib.Listener.on({name:"topad680-show-end",callBack:function(){e.isShow&&e._setThePos()}})},_eventHandle:function(e){this._formatData(e),this.isShow&&this._updateCont()},_formatData:function(e){var t={};t._comment=e.blogcomment-0+(e.photocomment-0)+e.blogrecomment,t._notice=e.notice+e.like+e.notice_favourite+e.notice_quote+e.invite+e.unreadnotices,t._message=e.message,t._gbook=e.gbook,this._cacheNums(e,t)},_cacheNums:function(e,t){for(var i in e)this._nums[i]=e[i];for(var n in t)this._nums[n]=t[n]}});return n}),Lib.register("TrayPanel",function(e){var t=Core.Events.addEvent,i=Core.Events.removeEvent,n=Utils.Cookie.getCookie,o=Core.Dom.contains,s=e.util.JSON,a=Core.Dom.getChildrenByClass,r="login_bar_logo_link_350",l="______noticeTrayHolder",c=0,d=null,h=0,p=function(e,t,i){return"string"!=typeof i?e.getAttribute(t):void e.setAttribute(t,i)},u=Core.Class.define(function(){var t=a(document.body,"nsinatopbar")[0],i=this.$main=a(t,"ntopbar_main")[0];e.Panel.prototype.initialize.call(this,{appendTo:i,isPostion:!1,noIframe:!0}),e.Listener.on({name:"tray-data-loaded",callBack:this.showPublishWare,scope:this},{name:"tray-newmsg-loaded",callBack:this.showNewMsgTips,scope:this},{name:"global-login-out",callBack:function(){clearInterval(this._msgTimer)},scope:this},{name:"tray-announce-loaed",callBack:function(e){var t=arguments,i=this;return this.notice?void this.notice.update(e):void setTimeout(function(){t.callee.call(i,e)},200)},scope:this},{name:"tray-unread-panel-hide",callBack:function(){var e=this.getNode("trayMsg"),t=s.parse(e.getAttribute("msg-count"));this.showNewMsgTips(t,1)},scope:this},{name:"tray-unread-panel-show",callBack:function(){var e=this.getNode("newTips");e.style.display="none"},scope:this},{name:"tray-msg-panel-hide",callBack:function(){var e=this.getNode("trayMsg"),t=s.parse(e.getAttribute("msg-count"));this.showNewMsgTips(t,1)},scope:this},{name:"tray-announce-close",callBack:function(){this.setTrayPosition()},scope:this},{name:"topad680-show-start",callBack:function(){this._hideActiveSub()},scope:this}),c&&c++},e.Panel,{subPanels:[],hoverTimeout:"",hoverTime:400,load:function(t){if(!c){var i=$E(r);i&&$_GLOBAL&&$_GLOBAL.platformTrayLogo&&(!$IE6&&$_GLOBAL.platformTrayLogo.imgForOtherBrs?i.children[0].src=$_GLOBAL.platformTrayLogo.imgForOtherBrs:$_GLOBAL.platformTrayLogo.imgForIE6&&(i.children[0].src=$_GLOBAL.platformTrayLogo.imgForIE6)),this.initSearch()}switch(t){case"login":/ipad/i.test(navigator.userAgent)&&v7sendLog("48_01_02");var n=(new Date,this);e.tray.loadUserInfo($UID,function(t){scope.unreadMsg=t,scope.nickname=t.full_nickname,scope.loginUserWtype=t.login_wtype,n._isRenderUser||(n.renderRight(e.tray.tpl.loginMemu),n._isRenderUser=!0);var i,o,s;if(t.isbloguser){var a=n.getNode("noOpenBlog");a.style.display="none",n.initUserMenu(),n.initBlogMenu(t),n.initNewMsgEvt(),n.initMsg(),n.initMsgLoder(),n.initHideSub(),n.initunReadMsgPanel(),i=n.getNode("userNick"),o=n.getNode("openBlog")}else i=n.getNode("ssoNick"),i.href="http://control.blog.sina.com.cn/myblog/htmlsource/blog_notopen.php?uid="+$UID+"&version=7",n.initOpenBlog(),n.initLogout(),o=n.getNode("noOpenBlog");i.innerHTML="";var r=document.createTextNode(t.nickname);i.appendChild(r),o.style.display="block";var l=Utils.Cookie.getCookie("loginFromMsn");if(l&&i){s=n.getNode("msnHolder"),s.style.display="block";var c=n.getNode("msnLink");c.href+=$UID}s&&Core.Dom.insertAfter(s,i.parentNode),n.initNotice()});break;case"logout":this.trayLogin||(this.trayLogin=new e.Login.Ui,this.renderRight(e.tray.tpl.loginOutMemu)),this.initLogin(),this.initNotice();break;case"oncelogedon":}c++},initMsgLoder:function(){if(!this.msgLoader){this.msgLoader=new e.tray.MsgLoader,this.msgLoader.load($UID);var t=this;this._msgTimer=setInterval(function(){t.msgLoader.load($UID)},3e4)}},initLogin:function(){var i=this,n=p(this._el,"login");n||(p(this._el,"login","1"),t(this._el,function(t){var n=e.util.getActionData(t,"tray-login-btn");n&&("undefined"!=typeof sinaSSOController&&(sinaSSOController.loginExtraQuery={}),i.trayLogin.login(function(){Lib.checkAuthor();var e=$UID==scope.$uid?"02":"01";v7sendLog("87_01_"+e+"_"+$UID,scope.$pageid),setTimeout(function(){window.location=window.location.toString().replace(/#.*/,"")},100)},!1,"referer:"+location.hostname+location.pathname+",func:0007"))},"click"))},initLogout:function(){var i=this.getNode("ssoLoginOut"),n=p(i,"loginout");n||(p(this._el,"login","1"),t(i,function(){e.tray.loginOut(null,!0)})),i=null},initHideSub:function(){var e=this;t(document.body,function(t){if(e._activeTab){for(var i,n=t.target||t.srcElement,s=e.subPanels,a=s.length-1;a>=0;a--){if(i=s[a],i.tab===n||o(i.tab,n))return;if(i.panel.entity===n||o(i.panel.entity,n))return}e._hideActiveSub()}},"click"),t(window,function(){var t=e._activeTab;if(t){var i=t.tab,n=t.panel,o=t.left,s=t.top,a=Core.Dom.getLeft(i)+i.offsetWidth+o,r=Core.Dom.getTop(i)+i.offsetHeight+s;$IE6&&this.isFixed&&(a-=document.documentElement.scrollLeft,r-=document.documentElement.scrollTop),n.setPosition(a,r)}},"resize")},_hideActiveSub:function(){var e=this;if(e._activeTab){var t=e._activeTab.tab,i=e._activeTab.panel;e._activeTab=null,i.hidden(),t.className=t.className.replace(/(?:[ ]*)\bcurrent\b/g,"")}},initUserMenu:function(){var t=this.getNode("userMenu"),i=p(t,"init");if(!i){p(t,"init","1");var n,o=this,s=o.getNode("userMenu"),a=o._findSub("userMenu"),r=0;Lib.util.hoverJq({elm:t,mouseenter:function(){if(clearTimeout(o.hoverTimeout),!r){r=1;var i;a?i=a.panel:(i=new e.tray.UserMenuPanel,o.addSubPanel("userMenu",i,t,s));var n=i.getNode("panel");i.initUserInfo($UID),Lib.util.hoverJq({elm:n,mouseenter:function(){clearTimeout(o.hoverTimeout),o._showPanel("userMenu",-160,0)},mouseleave:function(){o.hoverTimeout=setTimeout(function(){o._hideActiveSub()},o.hoverTime)}}),l(function(e){e&&(i.getNode("mail").style.display="")})}o._showPanel("userMenu",-160,0)},mouseleave:function(){o.hoverTimeout=setTimeout(function(){o._hideActiveSub()},o.hoverTime)}});var l=function(e){"boolean"==typeof n?e(n):Utils.Io.JsLoad.request("http://service.mail.sina.com.cn/mailproxy/mail.php",{onComplete:function(){var t=sinamailinfo.email;n=""!=t?!0:!1,e(n)},onException:function(){}})}}},initBlogMenu:function(t){var i=this.getNode("addArticle"),n=p(i,"init");if(!n){p(i,"init","1");var o=this,s=o.getNode("blogMenu"),a=0;Lib.util.hoverJq({elm:s,mouseenter:function(){if(clearTimeout(o.hoverTimeout),!a){a=1;var n,r=o._findSub("blogMenu");r||(n=new e.tray.BlogMenuPanel,o.addSubPanel("blogMenu",n,i,s),1===t.tbh_status&&(n.getNode("tbh_status").style.display=""));var l=n.getNode("panel");Lib.util.hoverJq({elm:l,mouseenter:function(){clearTimeout(o.hoverTimeout),o._showPanel("blogMenu",-74,0)},mouseleave:function(){o.hoverTimeout=setTimeout(function(){o._hideActiveSub()},o.hoverTime)}})}o._showPanel("blogMenu",-74,0)},mouseleave:function(){o.hoverTimeout=setTimeout(function(){o._hideActiveSub()},o.hoverTime)}})}},initNotice:function(){var o=scope.$PRODUCT_NAME,s=scope.$pageid;if("blog7"!==o)return void(this.noNotice=!0);if(-1===s.indexOf("article")&&-1===s.indexOf("index"))return void(this.noNotice=!0);var a=n("closeNotice_fzp"),l=$E("sinablogHead");if(Lib.checkAuthor(),a&&a===$UID||!l)return void(this.noNotice=!0);if(!this.notice){var c=new e.tray.BlogNotice({appendTo:$E(r).parentNode,isPostion:!1,noIframe:!0});this.notice=c;var d,h=this,p=l.offsetHeight+30,u=function(){var e=document,t=e.body.scrollTop+e.documentElement.scrollTop;t>p?(h.hideActive(),h.setTrayFixed(),d||(d=1,v7sendLog("48_01_11"))):setTimeout(function(){h.setTrayPosition(),c.hide()})};t(window,u,"scroll"),e.Listener.on({name:"tray-announce-close",callBack:function(){i(window,u,"scroll")}})}},initNewMsgEvt:function(){var e=(this.tpl,this.getNode("newTips")),i=p(e,"init");
if(!i){p(e,"init","1");var n=this;t(e,function(e){e=e||window.event;var t=e.target||e.srcElement;Core.Events.stopEvent(e),t.style.display="none",t.innerHTML="";var i=n.getNode("trayMsg");Core.Events.fireEvent(i,"click")},"click"),e=null}},initMsg:function(){var e=this.getNode("trayMsg"),t=p(e,"init");if(!t){p(e,"init","1");var i=this,n=0;Lib.util.hoverJq({elm:e,mouseenter:function(e){if(clearTimeout(i.hoverTimeout),!n){n=1;var t=window.event||e;t.preventDefault?t.preventDefault():t.returnValue=!1;var o,s=i.getNode("trayMsg"),a=i._findSub("msgPanel");a||(o=new Lib.tray.msgSummaryPanel(s),i.addSubPanel("msgPanel",o,s,s));var r=o.getNode("panel");Lib.util.hoverJq({elm:r,mouseenter:function(){clearTimeout(i.hoverTimeout),i._showPanel("msgPanel",-260,0)},mouseleave:function(){i.hoverTimeout=setTimeout(function(){i._hideActiveSub()},i.hoverTime)}})}i._showPanel("msgPanel",-260,0)},mouseleave:function(){i.hoverTimeout=setTimeout(function(){i._hideActiveSub()},i.hoverTime)}})}},initunReadMsgPanel:function(){var t=this.getNode("trayMsg"),i=p(t,"init-unre");i||(p(t,"init-unre","1"),new e.tray.unReadMsgPanel(t))},initSearch:function(){if(!c){var i=new e.tray.SearchFormPanel({isPostion:!1,appendTo:"traySearchBar",noIframe:!0});i.show(),t(document.body,function(e){e=e||window.event;var t=e.target||e.srcElement,n=i.getNode("queryTxt");n===t||i.entity===t||o(t,i.entity)||i.catePanel.hide()},"click")}},initOpenBlog:function(){var e=$E("openblogcss");if(!e){Utils.Io.loadCss({id:"openblogcss",url:$_GLOBAL.cssBasicURL+"module/layer/re_nowopen.css"});var t=this.getNode("openBlogBtn");scope.addBlogOpenerEvent(t)}},notifyMsgPanel:function(e){var t=e.getAttribute("msg-count");if(t)try{t=s.parse(t)}catch(i){t={}}else t=-1},renderRight:function(e){this.setTemplate(e),this._el=this.entity;var t=a(this.$main,"ntopbar_loading")[0];t.style.display="none",this.show()},addSubPanel:function(e,t,i,n){this.subPanels.push({name:e,tab:n,bind:i,panel:t})},_showPanel:function(e,t,i){var n=this._findSub(e);if(n){var o=n.panel,s=n.tab;if(o.entity.style.zIndex=512,"msgPanel"===e){var a=this.getNode("newTips");this.notifyMsgPanel(s),a.style.display="none"}var r,l;if(r=this._activeTab){if(l=r.tab,l===s)return;r.panel.hide(),l.className=l.className.replace(/(?:[ ]*)\bcurrent\b/g,"")}var c=s.className;/\bcurrent\b/.test(c)||(s.className+=" current"),this._activeTab={name:e,tab:s,panel:o,left:t,top:i};var d=o.entity;d.style.position=this.isFixed&&(!$IE||$IE>6)?"fixed":"absolute",o.showWithDom(s,t,i)}},_findSub:function(e){for(var t,i=this.subPanels.length-1;i>=0;i--)if(t=this.subPanels[i],e===t.name)return t;return null},showNewMsgTips:function(e,i){var n=e.sum-e.feed,o=this.getNode("newTips"),a=this.getNode("trayMsg");if(n){0==a.getAttribute("unread-show-state")&&0==a.getAttribute("msg-panel-show-state")&&(o.style.display="block"),"editor"==scope.$pageid&&(o.style.display="block");var r=this.entity.offsetWidth;o.style.left=r-o.offsetWidth-10+"px",o.innerHTML=10>n?n:"•••",h||(v7sendLog("40_01_49_"+$UID),h=1),a.setAttribute("msg-count",s.stringify(e)),this.startTitleTips(n)}else a.setAttribute("msg-count",s.stringify(e)),this.stopTitleTips();var l=e.feed;if(l){var c=this.getNode("newFeed");c.style.display="block",i||v7sendLog("40_02_11_"+$UID);var r=this.entity.offsetWidth;c.style.left=r-c.offsetWidth-197+"px",l=10>l?l:"•••",c.innerHTML=l,c.addEvt||(c.addEvt=1,t(c,function(){location.href="http://i.blog.sina.com.cn/blogprofile/index.php?com=1",c.style.display="none",c.innerHTML=""}))}},stopTitleTips:function(){if("editor"!=scope.$pageid){var e=document.title.replace(/\(\d+\+*\)/,"");document.title=e}},startTitleTips:function(e){if("editor"!=scope.$pageid){var t;e&&(e=e>=1e5?"99999+":e,t=/\(\d+\+*\)/.test(document.title)?document.title.replace(/\(\d+\+*\)/,"("+e+")"):"("+e+")"+document.title),document.title=t}},hideActive:function(){var e,t;(e=this._activeTab)&&(e.panel.hide(),t=e.tab,t.className=t.className.replace(/(?:[ ]*)\bcurrent\b/g,""),this._activeTab=null)},setTrayFixed:function(){var i=$E(r);this.notice.show();var n=this;setTimeout(function(){$E("traySearchBar").parentNode.style.display="none",i.style.display="none";var o=i.parentNode.parentNode;if(!$IE||$IE>6?(e.Listener.notify("tray-scrolling-fix",{}),o.style.position="fixed",o.style.top="0px"):6===$IE&&(n.__isFixie6||(t(window,function(e){if(n.isFixed){var t=document.documentElement.scrollTop;setTimeout(function(){var i=document.documentElement.scrollTop;t===i?(o.style.display="block",n._ie6fix(e)):n.isFixed&&(o.style.display="none")},50)}},"scroll"),n.__isFixie6=!0)),o.style.width="100%",!$E(l)){var s=o.offsetHeight,a=$C("div");a.style.height=s+"px",a.id=l,Core.Dom.insertAfter(a,o)}n.isFixed=!0})},_ie6fix:function(){if(this.isFixed){var t=$E(r),i=t.parentNode.parentNode;i.style.position="absolute",i.style.top=document.documentElement.scrollTop+"px";var n=this.getNode("trayMsg");n&&(n.style.display="none",n.style.display=""),e.Listener.notify("tray-scrolling-fix",{})}},setTrayPosition:function(){if($IE6){var t=this.getNode("trayMsg");t&&(t.style.display="none",t.style.display="")}e.Listener.notify("tray-scrolling-nofix",{});var i=$E(r),n=i.parentNode.parentNode;$E(l)&&n.parentNode.removeChild($E(l)),n.style.position="";var o=$E("traySearchBar");o.style.position="",o.style.top="",this.notice.hide(),n.style.display="block",i.style.display="block",$E("traySearchBar").parentNode.style.display="block",this.isFixed=!1}});return function(){return d||(d=new u),d}}),Core.System.htmlFilter=function(e){var t,i={"&":"&#038;","<":"&#060;",">":"&#062;"};for(t in i)e=e.replace(new RegExp(t,"g"),i[t]);return e},Utils.Io.loadExternalCSS=function(e,t){if("string"==typeof e){var i,n,o=document.getElementsByTagName("head")[0];$FF?(n=$C("style"),n.type="text/css",n.innerHTML="@import url("+e+")",o.appendChild(n),function(){try{n.sheet.cssRules,"function"==typeof t&&t()}catch(e){setTimeout(arguments.callee,50)}}()):(i=$C("link"),i.href=e,i.type="text/css",i.rel="stylesheet",i.media="all",o.appendChild(i),$SAFARI||$CHROME?!function(){try{i.sheet.cssRules,"function"==typeof t&&t()}catch(e){setTimeout(arguments.callee,50)}}():i.onload=function(){i.onload=null,"function"==typeof t&&t()})}},Core.Events.click=function(){var e=/mobile/i.test(navigator.userAgent);return $IE&&9>$IE?function(e){e.click()}:function(t){var i;i=document.createEvent(e?"HTMLEvents":"MouseEvents"),i.initEvent("click",!0,!0),t.dispatchEvent(i)}}(),Core.Dom.removeClassName=Core.Dom.removeClass,scope.trayPlusTemplayLogout=['<div class="topbar_menu">','<span class="link"><a target="_blank" href="http://blog.sina.com.cn">博客首页</a></span>','<span class="line_s"></span>',"</div>",'<div class="topbar_login"><a id="linkTrayLogin" class="login" href="javascript:;">登录</a><a id="linkReg" target="_blank" class="register" href="">注册</a></div>','<div id="divPopularize" class="topbar_ad"></div>','<div id="loginBarActivity" class="topbar_activity"></div>'].join(""),scope.trayPlusTemplayLogin=['<div class="topbar_menu" id="openedBlogTray">','<span id="loginBarOptApp" class="link"><a id="loginBarAppMenuLabel" href="javascript:;">读取中...</a><a href="javascript:;" class="link_arrow" title=""></a></span>','<span class="line_s"></span>','<span style="display:none;" id="loginBarMail" class="link imfor blog_to_mail"><a target="_blank" href="http://mail.sina.com.cn/?s=2">邮件</a><div id="mailpiaohong" style="display:none;" class="imforbox"></div></span>','<span class="line_s" style="display:none;" id="line"></span>','<span id="loginBarCenter" class="link"><a target="_self" href="http://i.blog.sina.com.cn/blogprofile/index.php?com=1">个人中心</a></span>','<span class="line_s"></span>','<span id="loginBarFriend" class="link"><a target="_blank" href="http://control.blog.sina.com.cn/blogprofile/profilefriendlist.php">好友</a></span>','<span class="line_s"></span>','<span id="loginBarInbox" class="link imfor"><img id="imgNewMessage" style="display:none;" class="topbar_msg" src="http://simg.sinajs.cn/blog7style/images/common/topbar/topbar_msg.gif"/><a href="#" onclick="return false;">消息</a><a href="#" onclick="return false;" class="link_arrow" title=""></a><div id="ccnotepiaohong" style="display:none;" class="imforbox"></div></span>','<span class="line_s"></span>','<span class="link" id="logOut"><a href="#">退出</a></span>',"</div>",'<div style="display:none" class="topbar_menu" id="noOpenedBlogTray">','<span class="link" style="cursor:default;"><a id="noOpenBlogName">读取中...</a></span>','<span class="line_s"></span>','<span class="link"><a href="#">退出</a></span>',"</div>",'<div class="topbar_noopen" style="display:none" id="outOfOpenBlogTray">','<a id="openBlogBtnTray" title="立即开通博客" class="nowopen" href="javascript:void(0)" onclick="return false;"></a>',"</div>",'<div id="loginBarActivity" class="topbar_activity"></div>'].join(""),scope.trayPlusTemplayOnceLoged=['<div class="topbar_menu" id="openedBlogTray">','<span id="loginBarOptApp" class="link"><a id="loginBarAppMenuLabel" href="javascript:;">读取中...</a></span>','<span class="line_s"></span>','<span id="loginBarMail" class="link imfor blog_to_mail"><a target="_blank" href="http://mail.sina.com.cn/?s=2">邮件</a><div id="mailpiaohong" style="display:none;" class="imforbox"></div></span>','<span class="line_s" id="line"></span>','<span id="loginBarCenter" class="link"><a target="_self" href="http://i.blog.sina.com.cn/blogprofile/index.php?com=1">个人中心</a></span>','<span class="line_s"></span>','<span id="loginBarFriend" class="link"><a target="_blank" href="http://control.blog.sina.com.cn/blogprofile/profilefriendlist.php">好友</a></span>','<span class="line_s"></span>','<span id="loginBarInbox" class="link imfor"><img id="imgNewMessage" style="display:none;" class="topbar_msg" src="http://simg.sinajs.cn/blog7style/images/common/topbar/topbar_msg.gif"/><a href="#" onclick="return false;">消息</a><div id="ccnotepiaohong" style="display:none;" class="imforbox"></div></span>',"</div>",'<div style="display:none" class="topbar_menu" id="noOpenedBlogTray">','<span class="link" style="cursor:default;"><a id="noOpenBlogName">读取中...</a></span>','<span class="line_s"></span>','<span class="link"><a href="#">退出</a></span>',"</div>",'<div class="topbar_noopen" style="display:none" id="outOfOpenBlogTray">','<a id="openBlogBtnTray" title="立即开通博客" class="nowopen" href="javascript:void(0)" onclick="return false;"></a>',"</div>",'<div id="divPopularize" class="topbar_ad"></div>','<div id="loginBarActivity" class="topbar_activity"></div>'].join(""),scope.newStatusTipTemplay=['<div class="tb_layer_arrow"></div>','<div class="tb_layer_Y_main tip_ps" style="width:130px;text-align:left;padding:5px 0 2px 5px;color:#000000">','<a onclick="$E(\'newStatusTip\').style.display=\'none\';return false" href="#" class="tb_friend_inputDel" title="关闭" style="margin-top: 5px;"></a>','<a href="http://i.blog.sina.com.cn/blogprofile/index.php?type=3&from=newstatus&com=2"><span id="nstFeed" style="padding:2px 2px;display:none;">你有<span style="color:red">新动态</span>可查看</span></a>','<a href="http://control.blog.sina.com.cn/blogprofile/profileremind.php?com=2"><span id="nstFavorite" style="padding:3px 2px;display:none;">你有博文被<span style="color:red">转载/收藏</span></span></a>','<img id="gbimg" class="SG_icon SG_icon83" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="17" height="15" align="absmiddle" style="display:none"/><a style="display:none" href="http://i.blog.sina.com.cn/blogprofile/index.php?com=g" id="gbmsg">官博<em>新动态</em></a>',"</div>"].join(""),scope.onceLogedStatusTipTemplay=['<div class="tb_layer_arrow"></div>','<div class="tb_layer_Y_main tip_ps" style="width:130px;text-align:left;padding:5px 0 2px 5px;color:#000000">','<a onclick="$E(\'newStatusTip\').style.display=\'none\';return false" href="#" class="tb_friend_inputDel" title="关闭" style="margin-top: 5px;"></a>','<a href="javascript:void(0);return false;"><span id="nstUnread" style="padding:3px 2px;display:none;">你有<span style="color:red">未读消息</span>可查看</span></a>','<a href="javascript:void(0);return false;"><span id="nstFeed" style="padding:2px 2px;display:none;">你有<span style="color:red">新动态</span>可查看</span></a>','<a href="javascript:void(0);return false;"><span id="nstUpdate" style="padding:3px 2px;display:none;">你最近浏览的博主<span style="color:red">有更新</span></span></a>','<a href="javascript:void(0);return false;"><span id="nstUnpub" style="padding:2px 2px;display:none;">你有<span style="color:red">尚未发表</span>的博文</span></a>',"</div>"].join(""),scope.nicknamePanelTemplate=['<div id="#{panel}" class="tb_layer_Y tb_layer_w2" style="z-index:512;">','<div class="tb_layer_arrow"></div>','<div class="tb_layer_Y_main">','<div class="tb_ps">','<div class="tb_ps_list">',"<ul>","<li>",'<span class="tb_ps_nm"><a id="#{linkBlog}" href="javascript:;"><img class="SG_icon SG_icon15" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" title="博客" align="absmiddle" /><strong>博客</strong></a></span>','<span class="tb_ps_set">[<a target="_blank" id="#{linkPostBlog}" href="http://control.blog.sina.com.cn/admin/article/article_add.php">发博文</a>]</span>',"</li>","<li>",'<span class="tb_ps_nm"><a id="#{linkPhoto}" href="javascript:;"><img class="SG_icon SG_icon18" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" title="相册" align="absmiddle" /><strong>相册</strong></a></span>','<span class="tb_ps_set">[<a target="_blank" id="#{linkPostPhoto}" href="http://photo.blog.sina.com.cn/upload/upload.php">发图片</a>]</span>',"</li>","<li>",'<span class="tb_ps_nm"><a target="_blank" id="#{linkVBlog}" href="javascript:;"><img class="SG_icon SG_icon16" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" title="播客" align="absmiddle" /><strong>播客</strong></a></span>','<span class="tb_ps_set">[<a target="_blank" id="#{linkUpload}" href="http://vupload.you.video.sina.com.cn/u.php?m=1">发视频</a>][<a id="#{linkRecord}" href="http://vupload.you.video.sina.com.cn/r.php" target="_blank">录视频</a>]</span>',"</li>","<li>",'<span class="tb_ps_nm"><a id="#{miniblog}" href="javascript:;" target="_blank"><img class="SG_icon SG_icon51" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" title="微博" align="absmiddle" /><strong>微博</strong></a></span>',"</li>","<li>",'<span class="tb_ps_nm"><a id="#{qingblog}" onclick="v7sendLog && v7sendLog(\'79_01_02\',scope.$pageid,\'qingLink\');" href="javascript:;" target="_blank"><img class="SG_icon SG_icon205" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" title="Qing" align="absmiddle" /><strong>Qing</strong></a></span>',"</li>","<li>",'<span class="tb_ps_nm"><a id="#{mySpace}" href="javascript:;"><img class="SG_icon SG_icon41" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" title="关于我" align="absmiddle" /><strong>关于我</strong></a></span>',"</li>","</ul>",'<div class="clearit"></div>',"</div>",'<div class="tb_ps_manage">','<p><a target="_blank" id="#{linkChangeFace}" href="javascript:;">修改头像昵称</a></p>','<p><a target="_blank" id="#{linkChangePassword}" href="javascript:;">修改登录密码</a></p>','<p><a target="_blank" id="#{linkAccountSetup}" href="javascript:;">账号安全设置</a></p>','<p><a target="_blank" id="#{bindEmail}" href="javascript:;">绑定邮箱</a></p>',"</div>","</div>","</div>","</div>"].join(""),scope.NicknamePanel=Core.Class.define(function(){Lib.Panel.prototype.initialize.apply(this,arguments),this.setTemplate(scope.nicknamePanelTemplate)},Lib.Panel,{initUserInfo:function(e){var t=this.getNodes();scope.$bindEmail=function(e){var i=t.bindEmail;"y"!=e.ret&&"not_verify"!=e.errcode?i.parentNode.removeChild(i):i.href="http://login.sina.com.cn/bindmail/bindmail.php?entry=blog"};try{var i=/user=([^&]+)&/g.exec(decodeURIComponent(Utils.Cookie.getCookie("SUP")))[1];Utils.Io.JsLoad.request("http://login.sina.com.cn/bindmail/checkmailuser.php?entry=blog&name="+encodeURIComponent(i)+"&utf82bgk=1&callback=scope.$bindEmail",{noreturn:!0})}catch(n){}t.linkBlog.href="http://blog.sina.com.cn/u/"+e,t.linkPhoto.href="http://photo.blog.sina.com.cn/u/"+e,t.linkVBlog.href="http://you.video.sina.com.cn/m/"+e,t.miniblog.href="http://control.blog.sina.com.cn/t_sina_blog/tb.php?uname="+e,t.qingblog.href="http://qing.blog.sina.com.cn/fancy.html",t.mySpace.href="http://blog.sina.com.cn/s/profile_"+e+".html",t.linkChangeFace.href="http://control.blog.sina.com.cn/blogprofile/nick.php",t.linkChangePassword.href="http://login.sina.com.cn/member/security/password.php",t.linkAccountSetup.href="http://login.sina.com.cn/member/security.php";for(var o=["linkBlog","linkPhoto","linkVBlog","miniblog","qingblog","mySpace","linkChangeFace","linkChangePassword","linkAccountSetup"],s=0;s<o.length;s++)t[o[s]].onclick=function(){v7sendLog("40_01_02_"+$UID)}}});var st=['<div id="#{panel}" style="z-index:512;" class="tb_layerBox">',"<ul>",'<li id="#{blog}"><a href="javascript:;" onclick="v7sendLog(\'40_01_19\')">博文</a></li>','<li id="#{bauthor}"><a href="javascript:;" onclick="v7sendLog(\'40_01_19\')">博主</a></li>','<li id="#{song}"><a href="javascript:;" onclick="v7sendLog(\'40_01_19\')">音乐</a></li>','<li id="#{video}"><a href="javascript:;" onclick="v7sendLog(\'40_01_19\')">视频</a></li>','<li id="#{vauthor}"><a href="javascript:;" onclick="v7sendLog(\'40_01_19\')">播主 </a></li>',"</ul>","</div>"];scope.searchPanelTemplate=st.join(""),scope.SearchPanel=Core.Class.define(function(){Lib.Panel.prototype.initialize.apply(this,arguments),this.setTemplate(scope.searchPanelTemplate)},Lib.Panel,{config:{blog:{text:"博文",url:"http://search.sina.com.cn/?c=blog",keyName:"q",range:"article",by:"all"},bauthor:{text:"博主",url:"http://search.sina.com.cn/?c=blog",keyName:"q",range:"author",by:"all"},song:{text:"音乐",url:"http://music.sina.com.cn/yueku/search/s.php",keyName:"k",t:"song",s:"",ts:"",type:"",stype:""},video:{text:"视频",url:"http://search.video.sina.com.cn/search.php",keyName:"k",t:"",s:"sup",ts:"",type:"boke",stype:"1"},vauthor:{text:"播主",url:"http://search.video.sina.com.cn/search.php",keyName:"k",t:"",s:"sup",ts:"",type:"boke",stype:"3"}}}),Utils.Flash.swfView={swfList:[],Add:function(e,t,i,n,o,s,a,r,l){return e&&i?(this.swfList[this.swfList.length]={sURL:e,sID:t,sPID:i,nWidth:n,nHeight:o,nVersion:s,sBGColor:a,oVar:r,oParam:l},void this.Init()):void 0},Init:function(){for(var e,t=this.swfList,i=0,n=t.length;n>i;i++){var o=t[i];if(e=new Utils.Flash.swfObject(o.sURL,o.sPID,o.nWidth,o.nHeight,o.nVersion,o.sBGColor),o.oVar)for(var s in o.oVar)e.addVariable(s,o.oVar[s]);if(o.oParam)for(var a in o.oParam)e.addParam(a,o.oParam[a]);e.write(o.sID)}t=[],o=null,e=null}},Utils.Io.loadCss=function(e,t){if(null==e)return!1;t=t||window;var i=t.document;e.id=e.id||"";var n;e.url?(n=i.createElement("link"),n.setAttribute("rel","stylesheet"),n.setAttribute("type","text/css"),n.setAttribute("href",e.url)):e.text&&(n=i.createElement("style"),n.setAttribute("type","text/css"),$IE?n.styleSheet.cssText=e.text:n.innerHTML=e.text),n.setAttribute("id",e.id),i.getElementsByTagName("head")[0].appendChild(n)};var st=['<div id="#{panel}" style="z-index:512;" class="tb_layer_Y tb_layer_w6" style="left:400px; top:700px;">','<div class="tb_layer_arrow"></div>','<div class="tb_layer_Y_main">','<div class="tb_mas" id="#{newInboxList}" style="">','<div class="tb_mas_list">','<ul id="#{changebgli1}"  style="display:none" >','<li  style="display:none" >','<span id="#{ccsysgonggao}" class="tb_friend_nm">[<strong>公告</strong>] <a href="http://control.blog.sina.com.cn/blog_rebuild/profile/controllers/notelist.php?action=profilesysnote">新浪邀你一起共度中秋活动</a></span>','<span class="tb_friend_set"><a href="http://control.blog.sina.com.cn/blog_rebuild/profile/controllers/notelist.php?action=profilesysnote">&gt;&gt;</a></span>',"</li>",'<li style="display:none">','<span id="#{ccsystongzhi}" class="tb_friend_nm">[<strong>通知</strong>] <a href="http://control.blog.sina.com.cn/blog_rebuild/profile/controllers/notelist.php?action=profilesysnote">新浪2010邀你一起共度中秋活动...</a></span>','<span class="tb_friend_set"><a href="http://control.blog.sina.com.cn/blog_rebuild/profile/controllers/notelist.php?action=profilesysnote">&gt;&gt;</a></span>',"</li>","</ul>",'<ul class="bd" id="#{changebgli2}">','<li  id="#{newInboxLoding}" style="cursor:default" ><div style="margin: 0pt; padding: 10px;text-align:center;"><img src="http://simg.sinajs.cn/blog7style/images/common/loading.gif"><div></li>','<li  id="#{nomsgli}" style="cursor:default;" >还没有消息</li>','<li style="float:none;"><span class="mas_more"><a id="#{mas_moremsg}" href="http://i.blog.sina.com.cn/blogprofile/profilelatestnote.php">全部消息</a></span></li>',"</ul>",'<div class="clearit"></div>',"</div>",'<ul class="commentslist" id="commentdata">','<li><a class="conn" href="http://i.blog.sina.com.cn/blogprofile/profilecommlist.php?type=1">评论</a><a class="num" href="http://i.blog.sina.com.cn/blogprofile/profilecommlist.php?type=1" id="#{commentRelapseCount}" ></a></li>','<li><a class="conn" href="http://i.blog.sina.com.cn/blogprofile/wall.php">留言</a><a class="num" href="http://i.blog.sina.com.cn/blogprofile/wall.php" id="#{guestBookCount}">1</a></li>','<li class="lst"><a class="conn" href="http://control.blog.sina.com.cn/blogprofile/profileinvitelist.php">好友邀请</a><a class="num" href="http://control.blog.sina.com.cn/blogprofile/profileinvitelist.php" id="#{inviteCount}" ></a></li>','<li><a class="conn" href="http://control.blog.sina.com.cn/blogprofile/profilepaperlist.php?type=1">纸条</a><a class="num" href="http://control.blog.sina.com.cn/blogprofile/profilepaperlist.php?type=1" id="#{messageCount}" ></a></li>','<li><a class="conn" target="_blank" href="http://mail.sina.com.cn" reject="1">邮箱</a><a class="num" href="http://mail.sina.com.cn" id="#{mailCount}" target="_blank" reject="1"></a></li>','<li><a class="conn" href="http://control.blog.sina.com.cn/blog_rebuild/profile/controllers/notelist.php?action=profilesysnote">系统消息</a><a class="num" href="http://control.blog.sina.com.cn/blog_rebuild/profile/controllers/notelist.php?action=profilesysnote" id="#{sysnoticeCount}" ></a></li>',"</ul>","</div>","</div>","</div>"];scope.newInboxPanelTemplate=st.join(""),Lib.LocalDB={_this:null,isFlashReady:!1,FlaDom:null,updataFun:null,loadedFun:null,regiFun:[],regiFunArgs:[],scacheReady:function(){var e=Lib.LocalDB;e.isFlashReady=!0,e.loadedFun&&e.loadedFun(e._this);for(var t=e.regiFun,i=e.regiFunArgs,n=0;n<t.length;n++)t[n].apply(null,i[n])},registerFun:function(e,t){this.regiFun.push(e);var i=t||[];this.regiFunArgs.push(i)},set:function(e,t){if(this.isFlashReady)try{return this.FlaDom.setLazyInterface(e,t),!0}catch(i){trace("set函数出错")}return!1},get:function(e,t,i){if(this.isFlashReady)try{return this.FlaDom.getLazyInterface(e,t,i)}catch(n){trace("get函数出错")}return!1},clearCache:function(e,t){if(this.isFlashReady)try{$E("scache").clearCache(e,t)}catch(i){trace("gclearCache函数出错")}return!1},loadFlash:function(e){var t="";if((window.$Maxthon||window.$360||window.$TT)&&(t="?t="+Core.Math.getUniqueId()),!this.FlaDom){var i=new Utils.Flash.swfObject($_GLOBAL.flashBasicURL+"scache.swf"+t,"scache","1","1","9","#00ff00");i.addParam("quality","high"),i.addParam("wmode","transparent"),i.addParam("allowScriptAccess","always"),i.write(e),this.FlaDom=$E("scache")}},getServer:function(){try{return this.FlaDom.isServer()}catch(e){return trace("判断是否是通信主机发生错误"),!1}},login:function(e){try{this.FlaDom.login(e)}catch(t){trace("login函数出错"),trace(e)}},sendToClient:function(e){try{this.getServer()&&this.FlaDom.sendToClient(e)}catch(t){trace("sendToClient函数出错")}},setClientJsFun:function(e){try{this.getServer()?this.FlaDom.setClientJsFun(e):trace("非主机不可以设置接收函数")}catch(t){trace("setClientJsFun函数出错")}},receive:function(e){this.updataFun(e)}},scope.msnTipsTemplate=['<div id="#{panel}" style="position: absolute; width: 369px; padding-top: 7px; font-size: 12px; z-index:511">',"<div  style=\"top: 0pt; left: 65px; position: absolute; width: 16px; height: 8px; background: url('http://simg.sinajs.cn/blog7style/images/special/move/bg_boxtop_01.png') no-repeat scroll 0pt 0pt transparent; z-index: 100;\"></div>","<div style=\"padding: 5px 6px 9px 14px; border: 1px solid rgb(181, 202, 214); background: url('http://simg.sinajs.cn/blog7style/images/special/move/bg_asiangames.jpg') no-repeat scroll left bottom rgb(255, 255, 255); z-index: 1;\">",'<p id="#{close}" class="close" style="float: right; margin: 0pt; cursor: pointer; width: 8px; height: 8px; font-size: 0pt;background:url(\'http://simg.sinajs.cn/blog7style/images/special/move/btn_close.gif\') no-repeat 0 0;"></p>','<div style="width: 342px; margin: 10px 0pt 0pt; padding: 0pt 0pt 3px;">','<a style="float: left; margin: 0pt 10px 0pt 0pt;" href="#"><img height="91" width="122" style="border: 0pt none;" alt="MSN" src="http://simg.sinajs.cn/blog7style/images/special/move/img_msnphoto.png"></a>','<h3 style="padding: 2px 0pt 5px; color: rgb(0, 0, 0); margin: 0pt; font-size: 12px;">各位拥有MSN帐号的同学注意啦!</h3>','<p style="width: 268px; display: inline; text-indent: 0pt; padding: 0pt; color: rgb(51, 51, 51); line-height: 19px;">新浪博客帐号与MSN帐号已经实现关联。您可以使用MSN帐号来登录博客，绑定后发博文、发图片可同步到Live，第一时间让您的MSN好友知晓。</p>',"</div>",'<p style="clear: both; height: 30px; margin: 12px 10px 4px 0pt; padding: 12px 0pt 0pt; border-top: 1px solid rgb(220, 213, 211); text-align: right;"><a style="float: right; color: rgb(176, 173, 172); margin-top: 10px; text-decoration: none;" href="javascript:void(0);" id="#{noMoreShow}">不再显示</a><a style="float: right; text-decoration: none; margin: 10px 14px 0pt 16px;color:#2d3186;" href="http://blog.sina.com.cn/s/blog_4b0f52990100lt3i.html">帮助</a><a id="#{setNow}"style="float: right;" href="http://control.blog.sina.com.cn/blogprofile/msnbind.php"><img height="32" width="105" style="border: medium none;" alt="立即设置" src="http://simg.sinajs.cn/blog7style/images/special/move/btn_receive01.jpg"></a></p>',"</div>","</div>"].join(""),scope.msnTips=Core.Class.define(function(){Lib.Panel.prototype.initialize.apply(this,arguments),this.setTemplate(scope.msnTipsTemplate)},Lib.Panel,{initUserInfo:function(){var e=this.getNodes();this.setFixed($E("loginBarActivity"),-230,-2);var t=this;e.close.onclick=function(){t.hidden()},e.noMoreShow.onclick=function(){t.hidden(),Utils.Cookie.setCookie("noMoreMsnTips"+$UID,1,2400,"/",".blog.sina.com.cn")},e.setNow.onclick=function(){v7sendLog("95_02_01",scope.$pageid,"")}},setFixed:function(e,t,i){var n=this;setTimeout(function(){n.showWithDom(e,t,i),n.fadeIn()},2e3),Core.Events.addEvent(window,function(){var o=Core.Dom.getLeft(e)+e.offsetWidth+t,s=Core.Dom.getTop(e)+e.offsetHeight+i;$IE6&&n.isFixed&&(o-=document.documentElement.scrollLeft,s-=document.documentElement.scrollTop),n.setPosition(o,s)},"resize")},fadeIn:function(){var e=this.entity;Core.Dom.opacity(e,0);var t=0;!function i(){Core.Dom.opacity(e,t+=5),Core.Dom.getStyle(e,"opacity")<1&&setTimeout(i,20)}()}}),scope.NewInboxPanel=Core.Class.define(function(){Lib.Panel.prototype.initialize.apply(this,arguments),this.setTemplate(scope.newInboxPanelTemplate),this.nodes=this.getNodes();var e=this,t=Lib.LocalDB;/Mobile/i.test(navigator.userAgent)?setTimeout(function(){e.requestDataInterface()},100):t.FlaDom?e.FlashLoaded(e):(t._this=e,t.loadedFun=e.FlashLoaded,t.loadFlash("trayFlashConnetion")),Core.Events.addEvent($E("loginBarInbox"),function(t){v7sendLog("40_01_09_"+$UID);var i=t&&t.target||window.event&&window.event.srcElement;i&&i.tagName&&"a"==i.tagName.toLowerCase()&&v7sendLog("45_01_10_"+$UID),e._hasOverview=!0,$E("ccnotepiaohong").style.display="none",e.requestMsgDate()},"click"),this.interfaceMessages=new Interface("http://interface.blog.sina.com.cn/riaapi/profile/unread.php","jsload")},Lib.Panel,{nodes:null,_connectSWF:null,_SWFChannelName:"inboxConnection",interfaceMessges:null,isMessageLoaded:!1,isUICServiceLoaded:!0,isHaveNewMessage:!1,_listData:null,_productIDs:{blog:1,vblog:2,group:4,photo:8,cube:16},_msgIsLoad:!1,_newnote:0,_hasOverview:!1,interfaceUICServiceURL:"http://uic.sinajs.cn/uic?type=service&uids=#{uids}&varname=service",FlashLoaded:function(e){var t=Lib.LocalDB,i=e;window.$updateData=function(e){i.updateData(e)},Lib.checkAuthor(),t.login($UID),t.setClientJsFun("$updateData"),setTimeout(function(){i.requestDataInterface()},100)},requestMsgDate:function(){this.updateView("loading");var e=this,t=0;this._hasOverview&&(t=this._newnote,this._newnote=0,this._hasOverview=!1);var i=new Interface("http://control.blog.sina.com.cn/blog_rebuild/riaapi/profile/note/notetips.php?clearnum="+t,"jsload");i.request({GET:{uid:$UID},onSuccess:function(t){if("undefined"!=typeof t.announcement&&t.announcement?(e.nodes.ccsysgonggao.innerHTML='[<strong>公告</strong>]&nbsp;<a href="http://control.blog.sina.com.cn/blog_rebuild/profile/controllers/notelist.php?action=profilesysnote">'+t.announcement+"</a>",e.nodes.ccsysgonggao.parentNode.style.display=""):e.nodes.ccsysgonggao.parentNode.style.display="none","undefined"!=typeof t.sysNote&&t.sysNote?(e.nodes.ccsystongzhi.innerHTML='[<strong>通知</strong>]&nbsp;<a href="http://control.blog.sina.com.cn/blog_rebuild/profile/controllers/notelist.php?action=profilesysnote">'+t.sysNote+"</a>",e.nodes.ccsystongzhi.parentNode.style.display=""):e.nodes.ccsystongzhi.parentNode.style.display="none",e.nodes.ccsystongzhi.parentNode.parentNode.style.display="undefined"==typeof t.sysNote&&"undefined"==typeof t.announcement?"none":"",e.nodes.nomsgli.style.display="","undefined"!=typeof t.notice&&t.notice){for(var i=t.notice;e.nodes.changebgli2.childNodes.length>2;)e.nodes.changebgli2.removeChild(e.nodes.changebgli2.childNodes[e.nodes.changebgli2.childNodes.length-3]);for(var n=i.length-1;n>=0;n--){var o=$C("li");o.innerHTML=i[n].data,o._href=i[n].url,e.nodes.changebgli2.insertBefore(o,e.nodes.changebgli2.firstChild),o.onclick=function(){v7sendLog("45_01_11_"+$UID),window.location.href=this._href},e.nodes.nomsgli.style.display="none"}}if(parseInt($E("ccnotepiaohong").innerHTML,10)>0)for(var s=parseInt($E("ccnotepiaohong").innerHTML,10),a=e.nodes.changebgli2.childNodes,r=0;r<a.length-2&&s>r;r++)Core.Dom.removeClassName(a[r],"cur"),a[r].className+=" cur";e.updateView("loaded"),e._msgIsLoad=!0,e.bindliEvent()},onError:function(){},onFail:function(){}});var n=new Interface("http://control.blog.sina.com.cn/blog_rebuild/riaapi/profile/note/unreadmail.php","jsload");n.request({onSuccess:function(t){var i=parseInt(t)||0;i>99&&(i="99+"),e.nodes.mailCount.innerHTML=i||""},onError:function(){e.nodes.mailCount.innerHTML=""}})},requestDataInterface:function(){var e=this;Lib.checkAuthor();var t=Lib.LocalDB,i=null;t.isFlashReady&&!this.checkCache&&(this.clearCache(),i=t.get("uid_"+$UID+"unread",24e4),this.checkCache=!0);var n=function(n,o){i||o||t.set("uid_"+$UID+"unread",n),0==n.isBindToMsn&&1!=Utils.Cookie.getCookie("noMoreMsnTips"+$UID),e.isMessageLoaded=!0,e.onMessageLoad(n.nickname),e._listData=n,scope.unreadMsg=n,scope.nickname=n.full_nickname,scope.loginUserWtype=n.login_wtype,n.svr_time&&(scope.$svr_time=n.svr_time),n.nfn>=1&&(v7sendLog("40_01_03_"+$UID),e.initNewStatusTip(n)),e.updateListData(n),e.isMessageLoaded&&(e.updateData({data:e._listData}),e.onLoaded()),scope.hasOpenBlog=1==n.isbloguser?"open":"no",scope.bindTrayOpenTime=1,Lib.Listener.notify("tray-data-loaded",n),"no"==scope.hasOpenBlog&&1==scope.bindTrayOpenTime&&($E("openblogcss")||Utils.Io.loadCss({id:"openblogcss",url:$_GLOBAL.cssBasicURL+"module/layer/re_nowopen.css"}),$E("openedBlogTray").style.display="none",$E("noOpenedBlogTray").style.display="",$E("outOfOpenBlogTray").style.display="",scope.addBlogOpenerEvent($E("openBlogBtnTray")),$E("noOpenBlogName").href="http://blog.sina.com.cn/u/"+$UID,scope.bindTrayOpenTime=2),scope.unreadOkExecuted=!0};i?(n(i,!0),trace("-------unread 使用缓存的数据!!!----")):(trace("-----直接调用unread接口！！！"),this.interfaceMessages.request({GET:{uid:$UID,product:"blog"},onSuccess:n,onError:function(){},onFail:function(){}}))},clearCache:function(){var e={profile_notice:"notice",profile_paperlist:"message",profile_invitelist:"invite",profile_commlist:"blogcomment",profile_replylist:"blogrecomment",profile_guestBookM:"gbook",profile_commtrash:"trashcomment",profile_commphotolist:"photocomment",profile_index:"profile_index",profile_remind:"profile_remind"},t=Lib.LocalDB,i=t.get("uid_"+$UID+"unread",24e4);
i&&e[scope.$pageid]&&void 0!=typeof i[e[scope.$pageid]]&&(trace("-----清除缓存"),t.clearCache(10,"uid_"+$UID+"unread"));var n=$UID+"_clear_flash",o=Utils.Cookie.getCookie(n);1==o&&(trace("【活动】根据cookie标记,清除Flash缓存"),t.clearCache(10,"uid_"+$UID+"unread"),Utils.Cookie.setCookie(n,"",0,"/",".sina.com.cn"))},initMsnTips:function(){Lib.checkAuthor(),(new scope.msnTips).initUserInfo($nick,$UID)},initNewStatusTip:function(e){if("profile_index"!=scope.$pageid&&"pageSetM"!=scope.$pageid&&"editor"!=scope.$pageid){var t=$E("newStatusTip");if(!t&&e){v7sendLog("45_01_07_"+$UID),t=$C("div"),t.id="newStatusTip",t.className="tb_layer_Y tb_layer_w3",t.style.width="138px",t.innerHTML=scope.newStatusTipTemplay;var i=$T($E("loginBarCenter"),"a")[0],n=Core.Dom.getXY(i);t.style.left=n[0]-(69-i.offsetWidth/2)+"px",t.style.top=n[1]+i.offsetHeight+"px",t.style.zIndex="510",-1==i.href.indexOf("?")&&(i.href+="?type=2&from="+scope.$pageid),Core.Dom.opacity(t,0),document.body.appendChild(t),e.nfn>=1&&($E("nstFeed").style.display="block",$E("nstFeed").onclick=function(){v7sendLog("45_01_09_"+$UID),v7sendLog("40_01_04_"+$UID)}),1==e.official_blog&&($E("gbimg").style.display="",$E("gbmsg").style.display="");for(var o=1;500>=o;o++)!function(e){setTimeout(function(){Core.Dom.opacity(t,2*e/10)},2*e)}(o);"editor"==scope.$pageid&&(i.target="_blank",$E("nstFeed").parentNode.target="_blank",$E("gbmsg").style.target="_blank",Core.Events.addEvent(i,this.closeTip(i),"click")),Core.Events.addEvent(window,function(){var e=$T($E("loginBarCenter"),"a")[0],i=Core.Dom.getXY(e);t.style.left=i[0]-(69-e.offsetWidth/2)+"px",t.style.top=i[1]+e.offsetHeight+"px"},"resize")}}},closeTip:function(e){return function(){$E("newStatusTip").style.display="none",e.href=e.href.split("?")[0]}},updateData:function(e){var t=Lib.LocalDB,i=this;Lib.checkAuthor();try{($UID&&$UID==e.uid||1==t.getServer())&&(i.isHaveNewMessage=!1,i.isMessageLoaded=!1,i.updateListData(e.data),i._newnote>0&&(v7sendLog("45_01_08_"+$UID),v7sendLog("40_01_08_"+$UID)),e.data.nfn>=1&&i.initNewStatusTip())}catch(n){}1==t.getServer()?(Lib.checkAuthor(),t.sendToClient({data:e.data,uid:$UID}),setTimeout(function(){i.requestUICService(),i.requestDataInterface()},24e4)):setTimeout(function(){t.getServer()&&(t.setClientJsFun("$updateData"),i.requestUICService(),i.requestDataInterface())},24e4)},initializeList:function(){this.requestUICService(),this.checkCache=!1},updateListData:function(e){try{var t=0;t+=parseInt(this._getFormatCountString(e.invite)||0),t>500&&(t="500+"),this.nodes.inviteCount.innerHTML=t?t:""}catch(i){}try{var t=0;t+=parseInt(this._getFormatCountString(e.message)||0),t>500&&(t="500+"),this.nodes.messageCount.innerHTML=t?t:""}catch(i){}try{var t=0;t+=parseInt(e.unreadnotices||0),t+=parseInt(e.notice||0),t>500&&(t="500+"),this.nodes.sysnoticeCount.innerHTML=t?t:""}catch(i){}Lib.checkAuthor();try{var t=0;t+=parseInt(this._getFormatCountString(e.gbook)||0),t+=parseInt(this._getFormatCountString(e.trashwall)||0),t>500&&(t="500+"),this.nodes.guestBookCount.innerHTML=t?t:""}catch(i){}try{var t=0;t+=parseInt(e.blogcomment||0),t+=parseInt(e.blogrecomment||0),t+=parseInt(e.photocomment||0),t+=parseInt(e.trashcomment||0),t>500&&(t="500+"),this.nodes.commentRelapseCount.innerHTML=t?t:""}catch(i){}this._newnote=parseInt(e.newnotes,10),this._newnote>0?($E("ccnotepiaohong").innerHTML=this._newnote>500?"500+":this._newnote,$E("ccnotepiaohong").style.display=""):$E("ccnotepiaohong").style.display="none";var n,o=["notice","invite","message","blogcomment","blogrecomment","photocomment","trashcomment","vblogcomment","gbook"],s=o.length;for(n=0;s>n;n++){parseInt(e[o[n]])>0&&(this.isHaveNewMessage=!0);var a;for(a in e)"version"!=a&&window.parseInt(e[a])>0&&$E("left_"+a)&&($E("left_"+a).innerHTML="("+e[a]+")")}},requestUICService:function(){Lib.checkAuthor(),this.isMessageLoaded&&(this.updateData({data:this._listData}),this.onLoaded())},_getFormatCountString:function(e){var t="";return isNaN(parseInt(e))||0==parseInt(e)||(t=parseInt(e)>500?"(<strong>500+</strong>)":e),t},updateView:function(e){this.nodes.newInboxLoding.style.display="loaded"==e?"none":"","loading"==e&&(this.nodes.nomsgli.style.display="none")},onLoaded:function(){},onMessageLoad:function(e){$E("loginBarAppMenuLabel").innerHTML=Core.System.htmlFilter(e),$E("noOpenBlogName").innerHTML=Core.System.htmlFilter(e)},bindliEvent:function(){function e(e){var t=e&&e.target||window.event&&window.event.srcElement;!t||!t.tagName||"a"!=t.tagName.toLowerCase()&&"li"!=t.tagName.toLowerCase()||t.getAttribute("reject")||(v7sendLog("40_01_10_"+$UID),v7sendLog("45_01_11_"+$UID))}for(var t=this.nodes.changebgli1.getElementsByTagName("li"),i=this.nodes.changebgli2.getElementsByTagName("li"),n=0;n<t.length;n++)t[n].style.cursor="pointer",t[n].onmouseover=function(){this._className=this.className,this.className="on"},t[n].onmouseout=function(){this.className=this._className};for(var n=0;n<i.length-1;n++)i[n]!=this.nodes.nomsgli&&(i[n].style.cursor="pointer",i[n].onmouseover=function(){this._className=this.className,this.className="on"},i[n].onmouseout=function(){this.className=this._className});var o=$E("commentdata");o&&Core.Events.addEvent(o,function(t){e(t)}),Core.Events.addEvent(this.nodes.changebgli1,function(t){e(t)}),Core.Events.addEvent(this.nodes.changebgli2,function(t){e(t)})}}),scope.addArticleTemplate=['<div id="#{panel}" class="wrtBlog_sub" style="z-index:512;">','<div class="wrtBlog_sub2">','<p><img width="15" height="16" align="absmiddle" title="写365" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" class="SG_icon SG_icon138"><a onclick="v7sendLog(\'48_01_18\');v7sendLog(\'40_01_14\');" href="http://control.blog.sina.com.cn/admin/article/article_add.php?tag365" target="_blank">写365</a></p>','<div class="SG_j_linedot"></div>','<p><img class="SG_icon SG_icon88" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" title="长微博" align="absmiddle" /><a target="_blank" onclick="v7sendLog(\'40_01_14\')" href="http://control.blog.sina.com.cn/admin/article/changWeiBo.php">长微博</a></p>','<div class="SG_j_linedot"></div>','<p><img class="SG_icon SG_icon87" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" title="微语录" align="absmiddle" /><a target="_blank" onclick="v7sendLog(\'40_01_14\')" href="http://control.blog.sina.com.cn/weiyulu/weiyulu.php">微语录</a></p>','<div class="SG_j_linedot"></div>','<p><img class="SG_icon SG_icon85" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" title="九宫格" align="absmiddle" /><a target="_blank" onclick="v7sendLog(\'40_01_14\')" href="http://control.blog.sina.com.cn/admin/article/daily.php">九宫格</a></p>','<div class="SG_j_linedot"></div>','<p><img class="SG_icon SG_icon18" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" title="发照片" align="absmiddle" /><a target="_blank" onclick="v7sendLog(\'40_01_14\')" href="http://photo.blog.sina.com.cn/upload/upload.php">发照片</a></p>','<div class="SG_j_linedot"></div>','<p><img class="SG_icon SG_icon16" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" title="发视频" align="absmiddle" /><a target="_blank" onclick="v7sendLog(\'40_01_14\')" href="http://vupload.you.video.sina.com.cn/u.php?m=1">发视频</a></p>','<div id="tray_tbh_ware_linedot" style="display:none;" class="SG_j_linedot"></div>','<p id="tray_tbh_ware_link" style="display:none;"><img class="SG_icon SG_icon150" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" title="发商品" align="absmiddle" /><a target="_blank" onclick="v7sendLog(\'40_01_14\')" href="http://control.blog.sina.com.cn/admin/article/article_add.php?tbh=1">发商品</a></p>',"</div>","</div>"].join(""),scope.addArticlePanel=Core.Class.define(function(){Lib.Panel.prototype.initialize.apply(this,arguments),this.setTemplate(scope.addArticleTemplate),this.hidden()},Lib.Panel,{}),Core.Events.stopBubble=function(e){var t=e?e:Core.Events.getEvent();null!=t&&(t.cancelBubble=!0)},(!$IE||$IE>8)&&(Core.Events.stopBubble=function(e){var t=e?e:Core.Events.getEvent();null!=t&&t.stopPropagation()}),Lib.PlatformTrayPlus=Core.Class.create(),Lib.PlatformTrayPlus.prototype={tray:null,subPanels:[],trayLogin:null,initialize:function(){},load:function(e){var t=$E("login_bar_logo_link_350");switch(t&&$_GLOBAL&&$_GLOBAL.platformTrayLogo&&(!$IE6&&$_GLOBAL.platformTrayLogo.imgForOtherBrs?t.children[0].src=$_GLOBAL.platformTrayLogo.imgForOtherBrs:$_GLOBAL.platformTrayLogo.imgForIE6&&(t.children[0].src=$_GLOBAL.platformTrayLogo.imgForIE6)),e){case"login":null!=$E("loginBarOptApp")&&$isAdmin||(this.render(scope.trayPlusTemplayLogin),trace("++++js渲染 登陆后++++++")),this.initStatic(),/ipad/i.test(navigator.userAgent)&&v7sendLog("48_01_02"),this.setNodesMouseHoverStyle(["loginBarOptApp","loginBarMail","loginBarCenter","loginBarFriend","loginBarInbox"]),this.initNicknamePanel(),this.initNewInboxPanel(),this.initActivityPanel();var i=this;if(Utils.Io.JsLoad.request("http://service.mail.sina.com.cn/mailproxy/mail.php",{onComplete:function(){var e=sinamailinfo.email;""!=e&&i.initMailRemind()},onException:function(){}}),this.initMsnLogout(),scope&&scope.$private&&scope.$private.msnfeed){var n=this;setTimeout(function(){n.displayUserGuideTips()},1e3)}break;case"logout":this.trayLogin=new Lib.Login.Ui,null===$E("phprender")?(this.render(scope.trayPlusTemplayLogout),trace("-----------js渲染---------")):trace("-----------php渲染---------"),this.initLogin(),this.initPopularize();break;case"oncelogedon":this.trayLogin=new Lib.Login.Ui,this.render(scope.trayPlusTemplayOnceLoged),this.setNodesMouseHoverStyle(["loginBarOptApp","loginBarMail","loginBarCenter","loginBarFriend","loginBarInbox"]);var o=Lib.Login.info(),s=o&&o.uid;$E("loginBarAppMenuLabel").innerHTML=o&&o.nick,this.initPopularize(),this.initOnceLogedEvent(["loginBarOptApp","loginBarMail","loginBarCenter","loginBarFriend","loginBarInbox"],s),this.initOnceLogedTips(s),this.initStatic()}this.initAddArticlePanel(),this.initSearchPanel(),this.initFilmSearch()},displayUserGuideTips:function(){if(!window.scope||"profile_index"===scope.$pageid)return void Utils.Cookie.setCookie($UID+"alreadyVisitProfileIndex","true","86400","/",".sina.com.cn")},initStatic:function(){if(!this._commetTimer){var e=function(){var e=scope.$uid,t=scope.$articleid||"";Utils.Io.JsLoad.request("http://comet.blog.sina.com.cn/notice",{GET:{uid:e||"",blogid:t},onComplete:function(){}})};this._commetTimer=setInterval(e,3e4),setTimeout(function(){e()},15)}},initFilmSearch:function(){var e=$E("loginBarSearchInput");e&&(e.value="");var t=$E("loginBarSearchSType");t&&(t.value="title")},render:function(e){$E("trayContainer").innerHTML=e},initLogin:function(){var e=this,t=Core.Dom.getElementsByClass($E("trayContainer"),"span","link")[0];t.onclick=function(){v7sendLog("40_01_15")},Core.Events.addEvent($E("linkTrayLogin"),function(){v7sendLog("40_01_16"),"undefined"!=typeof sinaSSOController&&(sinaSSOController.loginExtraQuery={}),e.trayLogin.login(function(){Lib.checkAuthor();var e=$UID==scope.$uid?"02":"01";v7sendLog("87_01_"+e+"_"+$UID,scope.$pageid),setTimeout(function(){window.location=window.location.toString().replace(/#.*/,"")},100)},!1,"referer:"+location.hostname+location.pathname+",func:0007")},"click"),$E("linkReg").href="http://login.sina.com.cn/signup/signupmail.php?entry=blog&srcuid="+scope.$uid+"&src=blogicp",$E("linkReg").onclick=function(){v7sendLog("40_01_17")},scope.$channel&&2==scope.$channel&&($E("linkReg").href="http://login.sina.com.cn/signup/signupmail.php?entry=blog&srcuid="+scope.$uid+"&src=baby")},initPopularize:function(){var e=$E("divPopularize");e&&(this.hideActiLink(e),this._loadPopularizeData(e))},_loadPopularizeData:function(e){Utils.Io.JsLoad.request("http://blog.sina.com.cn/lm/iframe/283/2012/0705/1.js",{charset:"utf-8",onComplete:function(){var t=$_GLOBAL.popularizeConfig;if(t&&!e.innerHTML){var i=t.length,n=Utils.Cookie,o=parseInt(n.getCookie("blogPopularizeIndex")||0);if(o>=i&&(o=0),n.setCookie("blogPopularizeIndex",1+o,24,"/",".blog.sina.com.cn"),e.innerHTML=t[o],$E("err_i8t9c")){var s=e.innerText||e.textContent||"";s.length>10&&(e.children[0].innerHTML=s.substr(0,9)+"...")}}}})},setNodesMouseHoverStyle:function(e){var t,i=e.length;for(t=0;i>t;t++)Core.Events.addEvent($E(e[t]),function(t){return function(){Core.Dom.removeClassName($E(e[t]),"current"),$E(e[t]).className+=" current"}}(t),"mouseover"),Core.Events.addEvent($E(e[t]),function(t){return function(){Core.Dom.removeClassName($E(e[t]),"current")}}(t),"mouseout");$E("loginBarCenter").onclick=function(){v7sendLog("40_01_05_"+$UID)},$E("loginBarFriend").onclick=function(){v7sendLog("40_01_06_"+$UID)},$E("logOut").onclick=function(){v7sendLog("40_01_11_"+$UID)}},initNicknamePanel:function(){function e(e){function t(){var t=setInterval(function(){var n=$E("loginBarAppMenuLabel").innerHTML;if("读取中..."!==n){var o=e.offsetLeft+"px";i.style.left=o,trace("刷新msn icon mask"),clearInterval(t)}},300)}var i=$C("a"),n=e.parentNode,o=n.parentNode,s=$C("img");o.style.position="relative",n.style.position="relative",s.id="msnLoginIcon",s.className="SG_icon SG_icon136",s.src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif",s.style.width="18px",s.style.height="18px",s.align="absmiddle",i.appendChild(s),i.href="http://control.blog.sina.com.cn/blogprofile/msnbind.php?c="+ +new Date,i.target="_blank",i.style.cssText="display:block; width:18px; height:18px; position:absolute; z-index:1024;",i.style.paddingTop="4px",i.title="MSN账号登录",o.insertBefore(i,o.childNodes[0]),Core.Events.addEvent(window,t,"resize"),trace("创建msn icon mask"),t(),scope.$msnRelocation=t}var t=new scope.NicknamePanel;Lib.checkAuthor(),t.initUserInfo($UID),this.addSubPanel(t,$E("loginBarOptApp"),-98,-9);if(Utils.Cookie.getCookie("loginFromMsn")&&!$E("msnLoginIcon")){var i=$C("img");i.src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif",i.style.cssFloat=i.style.styleFloat="left",i.width="18",i.height="0",i.style.padding="9px 0",i.align="absmiddle",Core.Dom.insertAfter(i,$E("loginBarAppMenuLabel")),trace("创建msn icon"),e(i)}else trace("不渲染msn icon")},initAddArticlePanel:function(){var e=new scope.addArticlePanel;this.addSubPanel(e,$E("arrowAddArticle"),-81,0),$E("arrowAddArticle").onclick=function(){v7sendLog("40_01_13_"+($UID?$UID:""))},$E("arrowAddArticle").parentNode.children[0].onclick=function(){v7sendLog("40_01_12_"+($UID?$UID:""))}},showPublishWare:function(e){if(e.tbh_status&&parseInt(e.tbh_status,10)){$E("tray_tbh_ware_linedot").style.display="";var t=$E("tray_tbh_ware_link");t.style.display="";try{var i=$T(t,"a")[0];scope&&"editor"==scope.$pageid&&(i.href="javascript:;",i.target="",i.onclick=function(){for(var e=$E("shortcut_content"),t=$T(e,"img"),i=0;i<t.length;i++)-1!=t[i].src.indexOf("element_shop")&&Core.Events.click(t[i])}),i=null,t=null}catch(n){}}Lib.Listener.off({name:"tray-data-loaded",callBack:this.showPublishWare,scope:this})},initSearchPanel:function(){function e(e){var i=$E("loginBarSearchForm");i.action=t.config[e].url,$E("loginBarSearchMenuLabel").innerHTML=n[e].getElementsByTagName("a")[0].innerHTML;var o=$E("loginBarSearchC"),s=$E("loginBarSearchT"),a=$E("loginBarSearchType"),r=$E("loginBarSearchS"),l=$E("loginBarSearchTS"),c=$E("loginBarSearchInput");switch(e){case"all":case"blog":case"bauthor":o||(o=$C("input"),o.type="hidden",o.name="c",o.id="loginBarSearchC",i.appendChild(o)),o.value="blog",s.value=t.config[e].range,s.name="range",a.value=t.config[e].by,a.name="by",c.name=t.config[e].keyName;break;case"song":case"video":case"vauthor":o&&(o.value=""),s.value=t.config[e].t,s.name="t",r.value=t.config[e].s,l.value=t.config[e].ts,a.value=t.config[e].type,a.name="type",$E("loginBarSearchSType").value=t.config[e].stype,c.name=t.config[e].keyName}}var t=new scope.SearchPanel;this.addSubPanel(t,$E("searchSelect"),-54,-4),Utils.Form.limitMaxLen($E("loginBarSearchInput"),50);var i,n=t.getNodes();for(i in t.config)!function(t){Core.Events.addEvent(n[t],function(){e(t)},"click")}(i);e("blog"),$E("searchSelect").onclick=function(){v7sendLog("40_01_18")};var o=Core.Dom.getElementsByClass($E("loginBarSearchForm"),"input","topbar_searchBtn")[0];o.onclick=function(){v7sendLog("40_01_20")},Core.Events.addEvent($E("loginBarSearchInput"),function(e){var t=e.keyCode||e.charCode;15==t&&v7sendLog("40_01_20")},"keyup")},hideActiLink:function(e){var t=scope.$pageid;"pageSetM"!==t&&"editor"!==t&&(e.style.display="none",e.setAttribute("shouldShow","1")),setTimeout(function(){return"undefined"!=typeof BLOG_AD_TIPS&&BLOG_AD_TIPS?void 0:void(e.style.display="")},3e3)},initActivityPanel:function(){if($_GLOBAL){var e=$E("loginBarActivity");e&&(this.hideActiLink(e),this._loadPopularizeData(e))}return $_GLOBAL.activityBlackList&&$_GLOBAL.activityBlackList[scope.$pageid]?void trace("【活动】当前页面在黑名单"):void 0},initMsnLogout:function(){function e(){new Interface("http://control.blog.sina.com.cn/blog_rebuild/msn/api/msnLoginOut.php","jsload").request({onSuccess:function(){window.location.href="http://login.sina.com.cn/cgi/login/logout.php?r="+r},onError:function(){window.location.href="http://login.sina.com.cn/cgi/login/logout.php?r="+r},onFail:function(){window.location.href="http://login.sina.com.cn/cgi/login/logout.php?r="+r}})}var t=$E("openedBlogTray"),i=t.getElementsByTagName("a"),n=i[i.length-1];n.href="#",n.onclick=function(){return!1};var o=$E("noOpenedBlogTray"),s=o.getElementsByTagName("a"),a=s[s.length-1];a.href="#",a.onclick=function(){return!1};var r=encodeURIComponent(window.location.href);t&&Core.Events.addEvent(n,e),o&&Core.Events.addEvent(a,e)},addSubPanel:function(e,t,i,n){function o(){Core.Events.stopEvent();var o,a=s.subPanels.length;for(o=0;a>o;o++)s.subPanels[o].hidden();e.showWithDom(t,i,n)}var s=this;this.subPanels.push(e),Core.Events.addEvent(t,function(){t===$E("loginBarOptApp")&&v7sendLog("40_01_01_"+$UID),o()},"click"),Core.Events.addEvent(document.body,function(){e.hidden()},"click"),Core.Events.addEvent(e.entity,function(){Core.Events.stopEvent()},"mousedown"),Core.Events.addEvent(window,function(){var o=Core.Dom.getLeft(t)+t.offsetWidth+i,s=Core.Dom.getTop(t)+t.offsetHeight+n;$IE6&&this.isFixed&&(o-=document.documentElement.scrollLeft,s-=document.documentElement.scrollTop),e.setPosition(o,s)},"resize")},initNewInboxPanel:function(){var e=new scope.NewInboxPanel;this.addSubPanel(e,$E("loginBarInbox"),-137,-9);try{if(!$E("ccnotepiaohong")){var t=$C("div");t.className="imforbox",t.style.display="none",t.id="ccnotepiaohong",$E("loginBarInbox").appendChild(t)}$E("loginBarInbox").className="link imfor"}catch(i){}e.onMessageLoad=function(e){$E("loginBarAppMenuLabel").innerHTML=e,$E("noOpenBlogName").innerHTML=Core.System.htmlFilter(e)}},initMailRemind:function(){function e(){var e=new Interface("http://interface.blog.sina.com.cn/riaapi/profile/unreadmail.php","jsload");e.request({onSuccess:function(e){var t=parseInt(e,10);if(t>99&&(t="99+"),0!==t&&$E("mailpiaohong")){var i=$E("mailpiaohong");i.style.display="",i.innerHTML=t}else $E("mailpiaohong").style.display="none"},onError:function(){$E("mailpiaohong").style.display="none"}})}$E("loginBarMail")&&$E("line")&&($E("loginBarMail").style.display="",$E("line").style.display=""),e();setInterval(e,3e5);Core.Events.addEvent($E("loginBarMail"),function(){v7sendLog("40_01_07_"+$UID);var e=$E("mailpiaohong"),t=!e.style.display;t&&(e.style.display="none")},"click"),Core.Events.addEvent($E("mailpiaohong"),function(){var e=$E("mailpiaohong");e.style.display="none",window.open("http://mail.sina.com.cn/?s=2")},"click")},initOnceLogedEvent:function(e,t){var i,n=e.length,o=this;for(i=0;n>i;i++)$E(e[i]).onclick=function(){switch(this.id){case"loginBarOptApp":v7sendLog("44_01_07_"+t);break;case"loginBarMail":v7sendLog("44_01_08_"+t);break;case"loginBarCenter":v7sendLog("44_01_09_"+t);break;case"loginBarFriend":v7sendLog("44_01_10_"+t);break;case"loginBarInbox":v7sendLog("44_01_11_"+t)}return"undefined"!=typeof sinaSSOController&&(sinaSSOController.loginExtraQuery={}),o.trayLogin.login(function(){setTimeout(function(){window.location=window.location.toString().replace(/#.*/,"")},100)},!1),!1}},initOnceLogedTips:function(e){var t=this,i="http://interface.blog.sina.com.cn/riaapi/profile/unread.php";Utils.Io.JsLoad.request(i,{GET:{uid:e,product:"blog"},onComplete:function(i){if("profile_index"!=scope.$pageid&&"pageSetM"!=scope.$pageid&&"editor"!=scope.$pageid){var n=$E("newStatusTip");if(!n){n=$C("div"),n.id="newStatusTip",n.className="tb_layer_Y tb_layer_w3",n.style.width="138px",n.innerHTML=scope.onceLogedStatusTipTemplay;var o=$T($E("loginBarCenter"),"a")[0],s=Core.Dom.getXY(o);n.style.left=s[0]-(69-o.offsetWidth/2)+"px",n.style.top=s[1]+o.offsetHeight+"px",n.style.zIndex="510",n.style.display="none",document.body.appendChild(n)}i.data.unreadnotes>=1?(v7sendLog("44_01_12_"+e),n.style.display="block",$E("nstUnread").style.display="block",$E("nstUnread").onclick=function(){return v7sendLog("44_01_13_"+e),"undefined"!=typeof sinaSSOController&&(sinaSSOController.loginExtraQuery={}),t.trayLogin.login(function(){setTimeout(function(){window.location="http://i.blog.sina.com.cn/blogprofile/profilelatestnote.php"},100)},!1),!1}):i.data.nfn>=1&&(v7sendLog("44_01_14_"+e),n.style.display="block",$E("nstFeed").style.display="block",$E("nstFeed").onclick=function(){return v7sendLog("44_01_15_"+e),"undefined"!=typeof sinaSSOController&&(sinaSSOController.loginExtraQuery={}),t.trayLogin.login(function(){setTimeout(function(){window.location="http://i.blog.sina.com.cn/blogprofile/index.php?type=3&from=newstatus&com=2"},100)},!1),!1}),Core.Events.addEvent(window,function(){var e=$T($E("loginBarCenter"),"a")[0],t=Core.Dom.getXY(e);n.style.left=t[0]-(69-e.offsetWidth/2)+"px",n.style.top=t[1]+e.offsetHeight+"px"},"resize")}},onException:function(){}})}},$registJob("tray",function(){Lib.Listener.add("tray-data-loaded"),Lib.checkAuthor();var e,t=$E("login_bar_logo_link_350"),i="ntopbar_main"===t.parentNode.className;e=i?Lib.TrayPanel():new Lib.PlatformTrayPlus;var n=Lib.Login.info(),o=n.uid;window.$onceLog=!1;var s=unescape(Utils.Cookie.getCookie("onceloggedonblog"));if(s&&o){time=s;var a=(new Date).getTime();time&&a>time&&($onceLog=!0)}e.load($isLogin?"login":!i&&$onceLog?"oncelogedon":"logout"),window.$tray={},window.$tray.renderLogin=function(){Lib.checkAuthor(),$isLogin&&e.load("login")},window.$tray.renderLogout=function(){e.load("logout")}}),$registJob("login",function(){var e=new Lib.Login.Ui;Core.Events.addEvent("loginbtn",function(){e.login(function(){alert("做一些，登陆之后，做的事情，呵呵！")})})}),Lib.insertMoban=function(){scope.tpl&&""!=scope.tpl&&("13"==scope.tpl.split("_")[0]||$_GLOBAL.flashtemplate[scope.tpl])&&Lib.insertMobanFunc(scope.tpl)},Lib.insertMobanFunc=function(e){var t=$E("headflash");if(t){t.innerHTML="",t.style.display="";var i="http://simg.sinajs.cn/blog7newtpl/css/"+e.split("_")[0]+"/"+e+"/top.swf",n=950,o=266;$_GLOBAL.flashtemplate[e].width&&(n=$_GLOBAL.flashtemplate[e].width),$_GLOBAL.flashtemplate[e].height&&(o=$_GLOBAL.flashtemplate[e].height),trace("flash height="+o);{Utils.Flash.swfView.Add(i,"headflash","headflash_f",n,o,"9.0.0.0","#000",{},{allowScriptAccess:"false",wmode:"transparent",allowFullScreen:"false"})}}},Lib.tplFuncArr={},Lib.tplFuncCount=0,Lib.getTplNum=function(e){if(Lib.tplFuncArr[Lib.tplFuncCount++]=e||function(){},$isAdmin&&scope.tpl&&""!=scope.tpl)for(var t in Lib.tplFuncArr)Lib.tplFuncArr[t](),Lib.tplFuncArr[t]=null,delete Lib.tplFuncArr[t];else if($IE){for(var i=document.styleSheets,n=/\S*(blog7tpl([^t]*))\S*/gi,o=/\S*(blog7newtpl\/css([^t]*))\S*/gim,s=0;s<i.length;s++)if("uid_link_css"==i[s].id){var a=n.exec(i[s].cssText),r=o.exec(i[s].cssText);(null!=a||null!=r)&&(null!=a?scope.tpl=a[2].split("/")[2]:null!=r&&(scope.tpl=r[2].split("/")[2]));break}for(var t in Lib.tplFuncArr)Lib.tplFuncArr[t](),Lib.tplFuncArr[t]=null,delete Lib.tplFuncArr[t]}else{if(!$IE&&"blog7"==scope.$PRODUCT_NAME){for(var t in Lib.tplFuncArr)Lib.tplFuncArr[t](),Lib.tplFuncArr[t]=null,delete Lib.tplFuncArr[t];return}$IE||"blog7"==scope.$PRODUCT_NANM||Utils.Io.JsLoad.request("http://blog.sina.com.cn/s/"+scope.$uid+".js",{GET:{tm:(new Date).getTime()},onComplete:function(){for(var e in Lib.tplFuncArr)Lib.tplFuncArr[e](),Lib.tplFuncArr[e]=null,delete Lib.tplFuncArr[e]}.bind2(this)})}},$registJob("getTplNum",function(){}),function(){var getImgStaticPath=function(pid,type){if(!pid)return"";var type=type||"orignal";try{var num=eval("0X"+pid.substring(pid.length-2))%16+1;return"http://s"+num+".sinaimg.cn/"+type+"/"+pid}catch(e){return trace("图片URL计算出错！PID:"+pid),""}};window.getImgStaticPath=getImgStaticPath}(),Utils.insertTemplate=function(e,t,i){var n=[],o={},s=/#{(\w+)}/g,a="_"+(new Date).getTime().toString().slice(-5)+Math.floor(1e5*Math.random());t=t.replace(s,function(e,t){return n.push(t),t+a}),Core.Dom.insertHTML(e,t,i);for(var r,l=n.length;l--;)r=n[l],o[r]=$E(r+a);return o},$registJob("articleShare",function(){function e(){var e=scope.$rank,t=scope.totalPv;e&&t&&clearInterval(a)}if(!$E("t_"+scope.$articleid))return void trace("应该是私密博文");var t="javascript:void((function(s,d,e,r,l,p,t,z,c,w){var%20f='http://v.t.sina.com.cn/share/share.php?',u=z||d.location,p=['url=',e(u),'&title=',e(t||d.title),'&source=',e(r),'&sourceUrl=',e(l),'&content=',c||'gb2312','&pic=',e(p||''),'&ralateUid=',w].join('');function%20a(){if(!window.open([f,p].join(''),'mb',['toolbar=0,status=0,resizable=1,width=440,height=430,left=',(s.width-440)/2,',top=',(s.height-430)/2].join('')))u.href=[f,p].join('');};if(/Firefox/.test(navigator.userAgent))setTimeout(a,0);else%20a();})(screen,document,encodeURIComponent,'新浪-博客','http://blog.sina.com.cn','"+(scope.$album_pic?getImgStaticPath(scope.$album_pic,"bmiddle"):"")+"','分享"+scope.owenerNickName+"的博文："+$E("t_"+scope.$articleid).innerHTML.replace(/'/g,"\\'")+" 推荐给@头条博客','http://blog.sina.com.cn/s/blog_"+scope.$articleid+".html','utf-8','1231759973'));";if(t=Core.String.decodeHTML(t),$E("shareminiblogfromblogatarticlepage")&&Lib.Uic.getNickName([scope.$uid],function(e){var i=e[scope.$uid]||"";i=Core.String.encodeHTML(i),scope.owenerNickName=i,$E("shareminiblogfromblogatarticlepage").href=t}),$_GLOBAL.diggerOpenFlag){var i=$E("sharewb"),n=$E("shareqing"),o=$E("sharemail");if(i&&(i.href=t,Core.Events.addEvent(i,function(){v7sendLog("80_01_04")})),!n&&i&&(n=$C("a"),n.href="javascript:;",n.innerHTML='<img width="18" height="18" align="absmiddle" title="分享到新浪Qing" alt="" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" class="SG_icon SG_icon205" />',i.parentNode.appendChild(n)),n&&(n.onclick=function(){var e=$E("t_"+scope.$articleid).innerHTML,t=[],i=$T($E("sina_keyword_ad_area2"),"img");e.length>120&&(e=e.substr(0,120)+"…");for(var n=0,o=Math.min(20,i.length);o>n;n++)t.push(i[n].src||i[n].real_src);var s=$_GLOBAL.qingURL+"blog/controllers/share.php?searchPics=0&content="+encodeURIComponent("分享"+scope.owenerNickName+"的博文《"+e+"》，查看原文：")+"&url="+encodeURIComponent(location.href)+"&ralateNick="+encodeURIComponent("新浪博客")+"&pics="+encodeURIComponent(t.join(","));return window.open(s,"shareQing","toolbar=0,status=0,resizable=1,width=600,height=520,left="+(screen.width-600)/2+",top="+(screen.height-520)/2),v7sendLog("80_01_01"),!1}),!o&&n){var s='<a href="javascript:;" id="sharemail"><img width="16" height="16" align="absmiddle" title="分享到新浪邮箱" alt="" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" class="SG_icon SG_icon211"></a>';Utils.insertTemplate(n,s,"AfterEnd"),o=$E("sharemail")}if(o){if(!scope.$rank||!scope.totalPv)var a=setInterval(e,300);o.onclick=function(){if($isLogin){var e="http://mail.sina.com.cn/share/mail.php?aid="+encodeURIComponent(scope.$articleid)+"&bl="+encodeURIComponent(scope.$rank)+"&ba="+encodeURIComponent(scope.totalPv);return window.open(e,"shareMail","toolbar=0,status=0,scrollbars=1,resizable=1,width=970,height=630,left="+(screen.width-970)/2+",top="+(screen.height-630)/2),!1}var t=new Lib.Login.Ui;t.login(function(){var e="http://mail.sina.com.cn/share/mail.php?aid="+encodeURIComponent(scope.$articleid)+"&bl="+encodeURIComponent(scope.$rank)+"&ba="+encodeURIComponent(scope.totalPv);return window.open(e,"shareMail","toolbar=0,status=0,scrollbars=1,resizable=1,width=970,height=630,left="+(screen.width-970)/2+",top="+(screen.height-630)/2),!1})}}$E("sharexn")&&($E("sharexn").href="javascript:u='http://share.xiaonei.com/share/buttonshare.do?link='+location.href+'&title='+encodeURIComponent(document.title);window.open(u,'xiaonei','toolbar=0,resizable=1,scrollbars=yes,status=1,width=626,height=436');void(0)",Core.Events.addEvent($E("sharexn"),function(){v7sendLog("80_01_07")})),$E("sharedb")&&($E("sharedb").href="http://www.douban.com/recommend/?url="+window.location.href+"&title="+encodeURIComponent(document.title)+";window.open(u,'douban','toolbar=0,resizable=1,scrollbars=yes,status=1,width=450,height=330');void(0)",Core.Events.addEvent($E("sharedb"),function(){v7sendLog("80_01_08")})),$E("sharekx")&&($E("sharekx").href="javascript:d=document;t=d.selection?(d.selection.type!='None'?d.selection.createRange().text:''):(d.getSelection?d.getSelection():'');void(kaixin=window.open('http://www.kaixin001.com/~repaste/repaste.php?&rurl='+escape(d.location.href)+'&rtitle='+escape('"+document.title+"')+'&rcontent='+escape('"+document.title+"'),'kaixin'));kaixin.focus();",Core.Events.addEvent($E("sharekx"),function(){v7sendLog("80_01_06")}));var r=$E("sharemsn");if(r){var l=[];l.push("url="+encodeURIComponent("http://blog.sina.com.cn/s/blog_"+scope.$articleid+".html"));var c=$E("t_"+scope.$articleid);c=$IE?c.innerText:c.textContent,l.push("title="+encodeURIComponent(c));var d=scope.$album_pic?getImgStaticPath(scope.$album_pic,"bmiddle"):"http://portrait"+(parseInt(scope.$uid)%8+1)+".sinaimg.cn/"+scope.$uid+"/blog/180";l.push("screenshot="+encodeURIComponent(d));var h=$E("sina_keyword_ad_area2");if(h){h=$IE?h.innerText:h.textContent,h=h.replace(/\n/gi,""),h=h.replace(/^\s\s*/,"");for(var p=/\s/,u=h.length;p.test(h.charAt(--u)););l.push("description="+encodeURIComponent(h.substring(0,101)))}r.href="http://profile.live.com/badge/?"+l.join("&"),r.target="_blank",Core.Events.addEvent(r,function(){v7sendLog("80_01_05")})}}$E("moreshares")&&Core.Events.addEvent($E("moreshares"),function(){if($E("sharelayer")){if("none"==$E("sharelayer").style.display){var e=(Core.Events.fixEvent(Core.Events.getEvent()),Core.Dom.getXY($E("moreshares")));$E("sharelayer").style.left=e[0]-45+"px",$E("sharelayer").style.top=e[1]+15+"px",$E("sharelayer").style.display=""}}else{var i='<div id="sharelayer" style="z-index:100;width:120px;" class="tb_layer_Y tb_layer_w2"><div class="tb_layer_arrow"></div><div class="tb_layer_Y_main" ><div class="tb_ps_share" style="width:96px;"><span class="share"><a id="sharewb" href="#" title="分享到新浪微博"><img height="16" align="absmiddle" width="16" title="微博" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" class="SG_icon SG_icon51"></a></span><span class="share"><a id="sharexn" href="#" title="分享到人人"><img height="16" align="absmiddle" width="16" title="人人" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" class="SG_icon SG_icon113"></a></span><span class="share"><a id="sharedb" target="_blank" href="#" title="分享到豆瓣"><img height="16" align="absmiddle" width="16" title="豆瓣" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" class="SG_icon SG_icon116"></a></span><span class="share"><a id="sharekx" href="#" title="分享到开心001"><img height="16" align="absmiddle" width="16" title="开心001" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" class="SG_icon SG_icon117"></a></span><div class="clearit"></div></div></div></div>';Core.Dom.insertHTML(document.body,i,"beforeend");var e=(Core.Events.fixEvent(Core.Events.getEvent()),Core.Dom.getXY($E("moreshares")));$E("sharelayer").style.left=e[0]-45+"px",$E("sharelayer").style.top=e[1]+15+"px",$E("sharewb").href=t,$E("sharexn").href="javascript:u='http://share.xiaonei.com/share/buttonshare.do?link='+location.href+'&title='+encodeURIComponent(document.title);window.open(u,'xiaonei','toolbar=0,resizable=1,scrollbars=yes,status=1,width=626,height=436');void(0)",$E("sharedb").href="http://www.douban.com/recommend/?url="+window.location.href+"&title="+encodeURIComponent(document.title)+";window.open(u,'douban','toolbar=0,resizable=1,scrollbars=yes,status=1,width=450,height=330');void(0)",$E("sharekx").href="javascript:d=document;t=d.selection?(d.selection.type!='None'?d.selection.createRange().text:''):(d.getSelection?d.getSelection():'');void(kaixin=window.open('http://www.kaixin001.com/~repaste/repaste.php?&rurl='+escape(d.location.href)+'&rtitle='+escape('"+document.title+"')+'&rcontent='+escape('"+document.title+"'),'kaixin'));kaixin.focus();",Core.Events.addEvent($E("sharelayer"),function(){var e=Core.Events.fixEvent(Core.Events.getEvent()),t=Core.Dom.getXY($E("sharelayer")),i=Core.System.getScrollPos(document),n=t[0],o=t[1],s=i[1]+e.clientX,a=i[0]+e.clientY;
(s>=n+116||n>=s||a>=o+42||o>=a)&&($E("sharelayer").style.display="none")},"mouseout")}},"mouseover");var g=function(){var e,t,i,n=['<div class="layer_weimi">','<a href="javascript:;" class="close" id="weimiShareClose"></a>','<div class="title">微米分享</div>','<ol class="list">','<li class="step code"><img id="weimiQRCode" alt="二维码" /></li>','<li class="step step1">','<div class="pic"><img src="http://simg.sinajs.cn/blog7style/images/common/weimilayer/1.jpg" alt="步骤一" /></div>','<div class="desc"><span class="num">1</span><span class="txt">微米扫描左侧二维码</span></div>',"</li>",'<li class="step step2">','<div class="pic"><img src="http://simg.sinajs.cn/blog7style/images/common/weimilayer/2.jpg" alt="步骤二" /></div>','<div class="desc"><span class="num">2</span><span class="txt">点击右上角的分享按钮</span></div>',"</li>",'<li class="step step3">','<div class="pic"><img src="http://simg.sinajs.cn/blog7style/images/common/weimilayer/3.jpg" alt="步骤三" /></div>','<div class="desc"><span class="num">3</span><span class="txt">选择分享给朋友</span></div>',"</li>","</ol>","</div>"].join(""),o={},s={},a="http://comet.blog.sina.com.cn/qr?"+location.href.replace(/[#?](.*)/,"");return s.init=function(){i=$E("shareweimi"),i||o.createShareNode(),Core.Events.addEvent(i,o.showLayer,"click"),Core.Events.addEvent(window,o.resizeLayer,"resize")},o.createShareNode=function(){var e,t=$E("shareqing").parentNode,n=$E("shareqing");e=$C("a"),e.id="shareweimi",e.innerHTML='<img width="51" height="16" align="absmiddle" title="分享到微米" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" class="SG_icon SG_icon213">',t.insertBefore(e,n),i=$E("shareweimi")},o.createShareLayer=function(){var i=$C("div");i.id="weimiShareLayer",i.innerHTML=n,document.body.appendChild(i),$E("weimiQRCode").src=a,e=$E("weimiShareLayer"),t=$E("weimiShareClose"),Core.Events.addEvent(t,o.hideLayer,"click")},o.showLayer=function(){return e=$E("weimiShareLayer"),e||o.createShareLayer(),o.setPos(),e.style.display="",!1},o.hideLayer=function(){return e&&(e.style.display="none"),!1},o.resizeLayer=function(){e&&"none"!=e.style.display&&o.setPos()},o.setPos=function(){var t=(document.documentElement.clientHeight||document.body.clientHeight,document.documentElement.clientWidth||document.body.clientWidth),i=586;e.style.position=$IE6?"absolute":"fixed",e.style.left=Math.abs(t-i)/2+"px",e.style.zIndex="1025",e.style.top=$IE6?document.documentElement.scrollTop+50+"px":"50px"},s},m=g();m.init();var f=function(){var e,t={},i={};return i.init=function(){e=$E("shareweibo"),e&&Core.Events.addEvent(e,t.clickHandle,"click")},t.clickHandle=function(){var e,t=$E("t_"+scope.$articleid).innerHTML,i=$E("sina_keyword_ad_area2");t.length>60&&(t=t.substr(0,60)+"..."),e="string"==typeof i.innerText?i.innerText:i.textContent,e=e.replace(/\s+/g,""),e.length>60&&(e=e.substr(0,60)+"...");var n="http://service.weibo.com/share/share.php?appkey=&title="+encodeURIComponent("分享自"+scope.owenerNickName+" 《"+t+"》 -    ")+encodeURIComponent(e)+encodeURIComponent(" (来自 @头条博客) - ")+"&url="+encodeURIComponent(window.location.href)+"&source=blog&retcode=0&ralateUid=";return window.open(n,"","toolbar=0,status=0,resizable=1,scrollbars=1,width=634,height=634,left="+(screen.width-634)/2+",top="+(screen.height-634)/2),!1},i},v=f();v.init()}),$registJob("recordVisitor",function(){Lib.checkAuthor(),$isLogin&&!$isAdmin&&!function(){if(scope.unreadMsg){if(scope.unreadMsg.foot||(scope.unreadMsg.foot=0),!(1*scope.unreadMsg.foot)){var e={pid:1,uid:scope.$uid};"undefined"!=typeof scope.$articleid&&(e.subid=scope.$articleid),Utils.Io.JsLoad.request("http://footprint.cws.api.sina.com.cn/add.php",{GET:e})}}else setTimeout(arguments.callee,200)}()}),Utils.text2Copy=function(e){var t=function(){var e=navigator.mimeTypes&&navigator.mimeTypes["application/x-shockwave-flash"]?navigator.mimeTypes["application/x-shockwave-flash"].enabledPlugin:0;if(e){for(var t=navigator.plugins["Shockwave Flash"].description.split(" "),i=0;i<t.length;++i)if(!isNaN(parseInt(t[i],10)))var n=t[i];return n>=10}if($IE)try{return new ActiveXObject("ShockwaveFlash.ShockwaveFlash.10"),!0}catch(o){return!1}};if(window.clipboardData&&$IE6)return window.clipboardData.clearData(),window.clipboardData.setData("Text",e);if(!t()){var i="flashcopier";if(!$E(i)){var n=$C("div");n.id=i,document.body.appendChild(n)}e=e.replace(/%/g,escape("%")).replace(/&/g,escape("&"));var o='<embed src="http://simg.sinajs.cn/blog7common/clipboard.swf" FlashVars="clipboard='+e+'" width="0" height="0" type="application/x-shockwave-flash"></embed>';return $E(i).innerHTML=o,!0}if($IE)try{return window.clipboardData.clearData(),window.clipboardData.setData("Text",e)}catch(s){return!1}try{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");var a=Components.classes["@mozilla.org/widget/clipboard;1"].createInstance(Components.interfaces.nsIClipboard);if(!a)return;var r=Components.classes["@mozilla.org/widget/transferable;1"].createInstance(Components.interfaces.nsITransferable);if(!r)return;r.addDataFlavor("text/unicode");var l={};l=Components.classes["@mozilla.org/supports-string;1"].createInstance(Components.interfaces.nsISupportsString);var c=e;l.data=c,r.setTransferData("text/unicode",l,2*c.length);var d=Components.interfaces.nsIClipboard;return a?(a.setData(r,null,d.kGlobalClipboard),!0):!1}catch(s){return!1}},Lib.subscribe=Core.Class.create(),Lib.subscribe.prototype={initialize:function(){this.createDlg()},createDlg:function(){var e="http://blog.sina.com.cn/rss/"+scope.$uid+".xml",t=['<div id="rssDy"></div>'];t.push('<div class="clearit"></div></div><table><tr><th scope="row">订阅地址：</th><td><input type="text" id="subscribeText" class="SG_input" value="" /><a class="SG_aBtn SG_aBtnB" href="javascript:;" onclick="return false;"><cite id="subscribeCopy">复制</cite></a></td></tr><tr><th scope="row"></th><td>如果还没有RSS阅读器，请<strong><a href="http://down.tech.sina.com.cn/content/3034.html" target="_blank">立即下载</a></strong>。 </td></tr></table>'),t=t.join("");var i=['<table id="#{entity}" class="CP_w">','<thead id="#{titleBar}">',"<tr>",'<th class="tLeft"><span></span></th>','<th class="tMid">','<div class="bLyTop">','<strong id="#{titleName}"></strong>','<cite style="width:100px;"><a href="http://www.sina.com.cn/ddt/rsshelp.html" target="_blank">什么是RSS?</a><a title="关闭" class="CP_w_shut" id="#{btnClose}" href="javascript:;">关闭</a></cite>',"</div>","</th>",'<th class="tRight"><span></span></th>',"</tr>","</thead>","<tfoot>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid"><span></span></td>','<td class="tRight"><span></span></td>',"</tr>","</tfoot>","<tbody>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid">','<div class="CP_layercon2 rssLayer" id="#{content}">',"</div>","</td>",'<td class="tRight"><span></span></td>',"</tr>","</tbody>","</table>"].join("");this._dialog=winDialog.createCustomsDialog({tpl:i,title:"RSS订阅",content:t,width:415,height:104},"tips"),$E("subscribeText").value=e,this.bindEvent()},bindEvent:function(){var e=this;Core.Events.addEvent($E("subscribeCopy"),function(){var t=Utils.text2Copy($E("subscribeText").value);1==t&&winDialog.alert("复制成功",{funcOk:function(){e._dialog.hidden()},icon:"03"})})},show:function(){var e=function(){if($_GLOBAL.rssIcons){var e=scope.$uid;$_GLOBAL.rssMethod&&(e=scope[$_GLOBAL.rssMethod]);for(var t="http://blog.sina.com.cn/rss/"+e+".xml",i=['<div class="rss_title"><strong>在线阅读器直接订阅：</strong></div><div class="rss_list" style="display:inline-block;">'],n=0;$_GLOBAL.rssIcons[n];n++){var o=$_GLOBAL.rssIcons[n];"rss_shiye"===o.cls&&(t=e+"&sub=1"),i.push('<span><a target="_blank" href="'),i.push(o.href),i.push(o.encode?encodeURIComponent(t):t),i.push('" class="'),i.push(o.cls),i.push('" title="'),i.push(o.title),i.push('"></a></span>')}i.push('<span class="news"><img width="15" height="15" align="top" class="SG_icon SG_icon11" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" title="新"></span>'),$E("rssDy").innerHTML=i.join("")}};this._dialog.show(),this._dialog.setAreaLocked(!0),this._dialog.setMiddle(),$_GLOBAL.rssIcons?e():Utils.Io.JsLoad.request("http://sjs.sinajs.cn/blog7common/conf/rss_conf.js",{onComplete:function(){e()},noreturn:!0,isRemove:!1})},hidden:function(){this._dialog.hidden()}},$registJob("subscribe",function(){Core.Events.addEvent($E("SubscribeNewRss"),function(){window.mySubscribe||(window.mySubscribe=new Lib.subscribe),window.mySubscribe.show()})}),$registJob("updownurl",function(){var e=$E("new_nextprev_"+scope.$articleid);if(!e){if(Lib.checkAuthor(),"1"==scope.$pn_x_rank&&!$isAdmin)return!1;var t=$E("nextprev_"+scope.$articleid),i=new Interface("http://blogtj.sinajs.cn/api/get_prevnext_article.php","jsload"),n=$E("t_"+scope.$articleid).parentNode,o=Core.Dom.getChildrenByClass(n,"time")[0].innerHTML;o=o.replace("(","").replace(")",""),i.request({GET:{uid:scope.$uid,blog_id:scope.$articleid,varname:"prevnext",blog_pubdate:o,pn_x_rank:scope.$pn_x_rank},onSuccess:function(e){var i="";null!=e.prev&&(i+='<div><span class="SG_txtb">前一篇：</span><a href="'+e.prev.blog_url+'">'+e.prev.blog_title+"</a></div>"),null!=e.next&&(i+='<div><span class="SG_txtb">后一篇：</span><a href="'+e.next.blog_url+'">'+e.next.blog_title+"</a></div>"),t.innerHTML=i},onError:function(){}})}}),Lib.AudioCheck={};var random="";if((window.$Maxthon||window.$360||window.$TT)&&(random="?t="+(new Date).getTime()),Lib.AudioCheck.swfUrl=$_GLOBAL.flashBasicURL+"mp3.swf"+random,Lib.AudioCheck.soundUrl="http://interface.blog.sina.com.cn/riaapi/cksound/cksound.php",Lib.AudioCheck.render=function(e,t){$E(e).innerHTML='		<a style="margin-left:3px;" id="comment_get_vcode" href="javascript:;" onclick="Lib.AudioCheck.callAudioCheck();return false;">收听验证码</a>		<img id="play_img" name="play_img" src="http://image2.sina.com.cn/blog/tmpl/v3/images/blank.gif" align="absmiddle" style="margin-right:2px;" height="15">		<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=5,0,0,0" width="0" height="0" id="mp3_player" align="middle">		<param name="allowScriptAccess" value="always" />		<param name="movie" value="'+this.swfUrl+'" />		<param name="quality" value="high" />		<param name="bgcolor" value="#ffffff" />		<param name="FlashVars" value="mp3URL='+t+'" />		<embed src="'+this.swfUrl+'" FlashVars="mp3URL='+t+'" quality="high" bgcolor="#ffffff" width="0" height="0" name="mp3_player" swLiveConnect="true" align="middle" allowScriptAccess="always" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer"/>		</object>	'},Lib.AudioCheck.callAudioCheck=function(){setTimeout(function(){$E("play_img").src="http://blogimg.sinajs.cn/v5images/play_img.gif",window.document.mp3_player.SetVariable("isPlay","1"),$E("login_check").value="",$E("login_check").focus()},500),Utils.Io.JsLoad.request("http://hits.blog.sina.com.cn/hits?act=3&uid=00000203",{onComplete:function(){}})},$registJob("audioCheck",function(){if($E("article_comment_list")&&1!=scope.$private.cms&&1!=scope.$isCommentAllow){var e=$E("comment_get_vcode"),t=Core.Dom.wrap(e,"span");t&&Lib.AudioCheck.render(t,Lib.AudioCheck.soundUrl+"?"+(new Date).getTime())}}),Lib.RandomStroll=Core.Class.create(),Lib.RandomStroll.prototype={link_url:null,swf_url:$_GLOBAL.flashBasicURL+"lookViewSpring.swf?2",initialize:function(e){this.link_url=e&&e[Math.floor(Math.random()*e.length)];var t=SinaEx.createNode('<div id="ramdomVisitDiv" style="position:absolute;width:140px;z-index:101;"></div>');t.style.top=scope._AD_HEIGHT?scope._AD_HEIGHT+30+"px":"30px",document.body.appendChild(t),this.div=t,this.lock(),Core.Events.addEvent(window,function(){this.lock()}.bind2(this),"resize"),Core.Events.addEvent(window,function(){this.lock()}.bind2(this),"scroll")},load:function(){Utils.Flash.swfView.Add(this.swf_url,"ramdomVisitDiv","map","140","87","8.0.0.0","#000",{url:this.link_url},{scale:"noscale",allowScriptAccess:"always",wmode:"transparent"})},lock:function(){this.div.style.right="0px"},show:function(){$E("ramdomVisitDiv").style.display=""},hide:function(){$E("ramdomVisitDiv").style.display="none"}},$registJob("randomScroll",function(){Utils.Io.JsLoad.request("http://blog.sina.com.cn/lm/rndurllist.js",{onComplete:function(){if("undefined"!=typeof RND_URL_LIST&&RND_URL_LIST&&RND_URL_LIST.length){var e=new Lib.RandomStroll(RND_URL_LIST);e.load({target:"_self",URL:""})}}})}),"object"!=typeof sina)var sina={};sina.$=function(e){return e?document.getElementById(e):null};var sinaFlash=function(e,t,i,n,o,s,a,r,l,c,d){var h=this;if(document.createElement&&document.getElementById){h.id=t?t:"";var p=function(e,t){for(var i=0;i<e.length;i++)if(e[i]==t)return i;return-1},u="8.0.42.0";h.ver=p(["eladies.sina.com.cn","ent.sina.com.cn"],document.domain)>-1?u:o?o:u,h.ver=h.ver.replace(/\./g,","),h.__classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",h.__codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version="+h.ver,h.width=i,h.height=n,h.movie=e,h.src=h.movie,h.bgcolor=s?s:"",h.quality=r?r:"high",h.__pluginspage="http://www.macromedia.com/go/getflashplayer",h.__type="application/x-shockwave-flash",h.useExpressInstall="boolean"==typeof a?a:!1,h.xir=l?l:window.location,h.redirectUrl=c?c:window.location,h.detectKey="boolean"==typeof d?d:!0,h.escapeIs=!1,h.__objAttrs={},h.__params={},h.__embedAttrs={},h.__flashVars=[],h.__flashVarsStr="",h.__forSetAttribute("id",h.id),h.__objAttrs.classid=h.__classid,h.__forSetAttribute("codebase",h.__codebase),h.__forSetAttribute("width",h.width),h.__forSetAttribute("height",h.height),h.__forSetAttribute("movie",h.movie),h.__forSetAttribute("quality",h.quality),h.__forSetAttribute("pluginspage",h.__pluginspage),h.__forSetAttribute("type",h.__type),h.__forSetAttribute("bgcolor",h.bgcolor)}};sinaFlash.prototype={getFlashHtml:function(){var e=this,t="<object ";for(var i in e.__objAttrs)t+=i+'="'+e.__objAttrs[i]+'" ';t+=">\n";for(var i in e.__params)t+='	<param name="'+i+'" value="'+e.__params[i]+'" />\n';""!=e.__flashVarsStr&&(t+='	<param name="flashvars" value="'+e.__flashVarsStr+'" />\n'),t+="	<embed ";for(var i in e.__embedAttrs)t+=i+'="'+e.__embedAttrs[i]+'" ';return t+="></embed>\n</object>"},__forSetAttribute:function(e,t){var i=this;if("undefined"!=typeof e&&""!=e&&"undefined"!=typeof t&&""!=t)switch(e=e.toLowerCase()){case"classid":break;case"pluginspage":i.__embedAttrs[e]=t;break;case"onafterupdate":case"onbeforeupdate":case"onblur":case"oncellchange":case"onclick":case"ondblClick":case"ondrag":case"ondragend":case"ondragenter":case"ondragleave":case"ondragover":case"ondrop":case"onfinish":case"onfocus":case"onhelp":case"onmousedown":case"onmouseup":case"onmouseover":case"onmousemove":case"onmouseout":case"onkeypress":case"onkeydown":case"onkeyup":case"onload":case"onlosecapture":case"onpropertychange":case"onreadystatechange":case"onrowsdelete":case"onrowenter":case"onrowexit":case"onrowsinserted":case"onstart":case"onscroll":case"onbeforeeditfocus":case"onactivate":case"onbeforedeactivate":case"ondeactivate":case"codebase":i.__objAttrs[e]=t;break;case"src":case"movie":i.__embedAttrs.src=t,i.__params.movie=t;break;case"width":case"height":case"align":case"vspace":case"hspace":case"title":case"class":case"name":case"id":case"accesskey":case"tabindex":case"type":i.__objAttrs[e]=i.__embedAttrs[e]=t;break;default:i.__params[e]=i.__embedAttrs[e]=t}},__forGetAttribute:function(e){var t=this;return e=e.toLowerCase(),"undefined"!=typeof t.__objAttrs[e]?t.__objAttrs[e]:"undefined"!=typeof t.__params[e]?t.__params[e]:"undefined"!=typeof t.__embedAttrs[e]?t.__embedAttrs[e]:null},setAttribute:function(e,t){this.__forSetAttribute(e,t)},getAttribute:function(e){return this.__forGetAttribute(e)},addVariable:function(e,t){var i=this;i.escapeIs&&(e=escape(e),t=escape(t)),""==i.__flashVarsStr?i.__flashVarsStr=e+"="+t:i.__flashVarsStr+="&"+e+"="+t,i.__embedAttrs.FlashVars=i.__flashVarsStr},getVariable:function(e){var t=this,i=t.__flashVarsStr;t.escapeIs&&(e=escape(e));new RegExp(e+"=([^\\&]*)(\\&?)","i").exec(i);return t.escapeIs?unescape(RegExp.$1):RegExp.$1},addParam:function(e,t){this.__forSetAttribute(e,t)},getParam:function(e){return this.__forGetAttribute(e)},write:function(e){var t=this;"string"==typeof e?document.getElementById(e).innerHTML=t.getFlashHtml():"object"==typeof e&&(e.innerHTML=t.getFlashHtml())}},addAdvertise=function(){var e=$E("blogads");if(scope.$pageid.indexOf("article")>-1&&null!=e){var t=$C("div");t.id="blogads2",t.className="blogads2 borderc",t.innerHTML='<p><a href="javascript:;" id="adversite_bottom"></a></p><p class="SG_txtc">新浪广告共享计划</p>'+($isAdmin?'<div class="manage SinaAd_mg2"><a href="http://share.sass.sina.com.cn/widget_ad/index_out.php?done" class="SinaAd_linkcolor SinaAd_link" target="_blank">[管理]</a></div>':""),t.style.display="none",scope.$pn_x_rank&&0==window.parseInt(scope.$pn_x_rank)&&($E("nextprev_"+scope.$articleid)?Core.Dom.insertAfter(t,$E("nextprev_"+scope.$articleid)):$E("new_nextprev_"+scope.$articleid)&&Core.Dom.insertAfter(t,$E("new_nextprev_"+scope.$articleid)))}Utils.Io.JsLoad.request("http://sjs.sinajs.cn/blog7/adwidget.js?v1",{onComplete:function(){"undefined"!=typeof adShare&&adShare.init(scope.$uid,"sinablog","SINABLOG")},noreturn:!0,isRemove:!1})},addAdvertise2=function(){var e=$E("adps_person");null!=e&&Utils.Io.JsLoad.request("http://ba.sass.sina.com.cn/front/blog/deliver?p1="+scope.$uid+",adps000001|adps000002",{onComplete:function(){var t=$E("adps000001");if(null!=t)for(var i=$T(t,"div"),n=0,o=i.length;o>n;n++)if("widgetconn"==i[n].className){t.innerHTML=i[n].innerHTML,t.style.paddingTop="10px",e.style.display="";break}},noreturn:!0})},$registJob("renderAd",function(){scope.$private.ad=scope.$private.ad||0,scope.$private.ad>0&&(addAdvertise(),addAdvertise2())}),$TEMPLATECLONE_MSG={A00001:"操作失败，可能系统繁忙或系统遇到未知错误，请稍后再试。也可联系新浪客服：致电4006900000。",A00002:"操作失败，可能系统繁忙或系统遇到未知错误，请稍后再试。也可联系新浪客服：致电4006900000。",A00003:"操作失败，可能系统繁忙或系统遇到未知错误，请稍后再试。也可联系新浪客服：致电4006900000。",A00004:"未登录",A00005:"抱歉，你暂时不能复制该模板",A00006:"操作成功",A11007:'你还未开通新浪博客，请先 <a href="http://login.sina.com.cn/hd/reg_sec.php?entry=blog"  id="cloneTemplateButNoReg">开通博客</a>'},Lib.TemplateClone=Core.Class.create(),Lib.TemplateClone.prototype={type:"1",version:"7",interfaceClone:null,btnClone:null,initialize:function(e,t){var i=this;this.interfaceClone=new Interface("http://control.blog.sina.com.cn/riaapi/conf/template_clone.php","jsload"),this.btnClone=e,this.btnClone&&Core.Events.addEvent(this.btnClone,function(){i.clone(t)},"click")},clone:function(e,t){var i=this,n="<a style='color:red' href='http://finance.sina.com.cn/333/2010-02-05/guest920.shtml' target='_blank'>315十大行业满意度调查</a>",o=t?n:"";if(Lib.checkAuthor(),$isLogin)winDialog.confirm("确定使用此模板吗?",{subText:o,funcOk:function(){scope.blogOpener.showDialog(function(){i.request(e)})}});else{var s=new Lib.Login.Ui;s.login(function(){winDialog.confirm("确定使用此模板吗?",{subText:o,funcOk:function(){scope.blogOpener.showDialog(function(){i.request(e)})},funcCancel:function(){location.reload()}})})}},request:function(e){var t=this;this.interfaceClone.request({GET:{uid_cloned:scope.$uid,type:t.type,version:t.version},onSuccess:function(){e&&e()},onError:function(e){if("A11007"==e.code){Lib.checkAuthor();var t=winDialog.alert($TEMPLATECLONE_MSG[e.code].replace(/#\{linkNewBlog\}/g,"http://control.blog.sina.com.cn/reg/reg_blog.php?version=7"),{icon:"01"});$E("cloneTemplateButNoReg").onclick=function(){t.hidden().destroy()}}else winDialog.alert($TEMPLATECLONE_MSG[e.code],{icon:"02"})},onFail:function(){}})}},$registJob("templateClone",function(){return Lib.checkAuthor(),$isAdmin?void trace("博主。不执行代码"):void Lib.getTplNum(function(){var e=function(){function e(e){var t=new Ui.Template($_GLOBAL.cloneTemplateConfig[scope.tpl].count_text),i={};i.template_pv=e,$E("template_clone_link").innerHTML=t.evaluate(i)}if(scope.tpl){var t,i=$_GLOBAL.cloneTemplateConfig[scope.tpl];i&&""!=i.template_clone_pic.replace(/\s/g,"")&&("8_52"==scope.tpl&&($E("template_clone_pic").parentNode.parentNode.style.top="0px",window.screen.width<1280&&($E("template_clone_pic").parentNode.parentNode.style.right="88px"),$E("template_clone_pic").parentNode.parentNode.style.zIndex=201),$E("template_clone_pic").innerHTML=i.template_clone_pic,$E("template_clone_link").innerHTML=i.template_clone_link,$E("template_clone_other").innerHTML=i.template_clone_other,i.count_id&&Utils.Io.JsLoad.request("http://hits.blog.sina.com.cn/hits?act=3&uid="+i.count_id+"&varname=templatecc",{onComplete:function(){"undefined"!=typeof templatecc?e(templatecc.pv):$E("template_clone_link").style.display="none"}}),t=new Lib.TemplateClone($E("template_clone_pic"),function(){winDialog.alert("克隆模板成功!",{icon:"03",funcOk:function(){Lib.checkAuthor(),window.location.href="http://blog.sina.com.cn/u/"+$UID}})}));var n=$_GLOBAL.GUANWANG[scope.tpl];n&&""!=n.template_clone_pic.replace(/\s/g,"")&&($E("template_clone_pic").innerHTML=n.template_clone_pic,$E("template_clone_other").innerHTML=n.template_clone_other,$E("template_clone_pic")&&"a"==$E("template_clone_pic").parentNode.tagName.toLowerCase()&&($E("template_clone_pic").parentNode.href=n.template_clone_link,$E("template_clone_pic").parentNode.target="_blank"));var o=$_GLOBAL.famous_conf[scope.tpl];o&&""!=o.template_clone_pic.replace(/\s/g,"")&&($E("template_clone_pic").innerHTML=o.template_clone_pic,$E("template_clone_link").innerHTML=o.template_clone_link,$E("template_clone_other").innerHTML=o.template_clone_other,$E("template_clone_pic")&&"a"==$E("template_clone_pic").parentNode.tagName.toLowerCase()&&($E("template_clone_pic").parentNode.href="http://ba.sass.sina.com.cn/front/tp/deliver?blogId="+scope.$uid+"&tp="+scope.tpl))}};$_GLOBAL.cloneTemplateConfig?e():Utils.Io.JsLoad.request("http://sjs.sinajs.cn/blog7common/conf/tmp_clone.js",{onComplete:function(){e()},noreturn:!0,isRemove:!1})})}),"undefined"==typeof Lib.flashComponent&&(Lib.flashComponent={}),Lib.FlashDetector=function(e){this.version=e}.$define({version:"",detect:function(){var e,t,i,n=window.navigator,o="0.0.0";if(n.plugins&&n.plugins.length){for(e=0,t=n.plugins.length;t>e;e++)if(-1!=n.plugins[e].name.toLowerCase().indexOf("shockwave flash")){o=n.plugins[e].description.toLowerCase().replace(/shockwave flash\s?/,"").split(" ")[0],i=!0;break}}else if(window.ActiveXObject)for(e=11;e>=1;e--)try{if(new ActiveXObject("ShockwaveFlash.ShockwaveFlash."+e)){o=e+".0",i=!0;break}}catch(s){}i?this._detectVersion(o):this.onUninstalled&&this.onUninstalled.call(this)},_detectVersion:function(e){var t,i=this._getFormatVersion(e).split("."),n=this._getFormatVersion(this.version).split("."),o=n.length;for(t=0;o>t;t++){if(+i[t]>+n[t])return void(this.onSuccess&&this.onSuccess.call(this));if(+i[t]<+n[t])return void(this.onVersionLower&&this.onVersionLower.call(this,e))}this.onSuccess&&this.onSuccess.call(this)},_getFormatVersion:function(e){var t=e+"";return-1==t.indexOf(".")&&(t+=".0.0"),t.split(".").length<3&&(t+=".0"),t},onVersionLower:function(){},onUninstalled:function(){},onSuccess:function(){}}),Lib.flashComponent.FlashContianer=function(e){this._initCfg(e),this._flashDetector=new Lib.FlashDetector(this.flashCfg.version),this._detect()}.$define({flashCfg:{url:"",width:0,height:0,containerID:"divContainer",flashID:"flashID",flashVar:"",version:"9",wmode:"transparent",allowScriptAccess:"always"},rerender:function(){this._initFlash()},_renderText:["#{reason}，为了能够正常显示，请您 ",'<a target="_blank" href="http://get.adobe.com/cn/flashplayer/">','<img src="http://simg.sinajs.cn/blog7style/images/common/baby/flash.png">',"下载最新版本","</a>","。"].join(""),_flash:null,_falshEntity:null,_flashDetector:null,_initFlash:function(){this._addFlash(),this._initFlashEntity()},_detect:function(){var e=this._flashDetector,t=this;e.onSuccess=function(){t._initFlash()},e.onUninstalled=function(){t._renderUninstalled()},e.onVersionLower=function(){t._renderVersionLower()},e.detect()},_renderVersionLower:function(){$E(this.flashCfg.containerID).innerHTML=this._renderText.replace(/\#\{reason\}/g,"您的Flash播放器版本过低")},_renderUninstalled:function(){$E(this.flashCfg.containerID).innerHTML=this._renderText.replace(/\#\{reason\}/g,"您的浏览器未安装Flash播放器")},_initCfg:function(e){var t;for(t in this.flashCfg)"undefined"!=typeof e[t]&&(this.flashCfg[t]=e[t])},_addFlash:function(){var e=this.flashCfg;this._flash=new Utils.Flash.swfObject(e.url,e.flashID,e.width,e.height,e.version,"#ffffff"),this._flash.addParam("allowScriptAccess",e.allowScriptAccess),this._flash.addParam("wmode",e.wmode),this._flash.addParam("flashVars",e.flashVar),this._flash.write(e.containerID)},_initFlashEntity:function(){this._flashEntity=$IE?window[this.flashCfg.flashID]:document[this.flashCfg.flashID]}}),Lib.flashComponent.HeadPhoto=function(){}.$extends(Lib.flashComponent.FlashContianer).$define({setMaskPosition:function(e,t){e=isNaN(e)?0:e,t=isNaN(t)?0:t,this._flashEntity.setMaskPosition&&this._flashEntity.setMaskPosition(e,t)},setPhotoURL:function(e){this._flashEntity.setPhotoURL&&this._flashEntity.setPhotoURL(e)},getPhotoURL:function(){return this._flashEntity.getPhotoURL?this._flashEntity.getPhotoURL():void 0},setPhotoPosition:function(e,t){e=isNaN(e)?0:e,t=isNaN(t)?0:t,this._flashEntity.setPhotoPosition&&this._flashEntity.setPhotoPosition(e,t)},setPhotoZoom:function(e){e=isNaN(e)?1:e,this._flashEntity.setPhotoZoom&&this._flashEntity.setPhotoZoom(e)},setPhotoAngle:function(e){e=isNaN(e)?0:e,this._flashEntity.setPhotoAngle&&this._flashEntity.setPhotoAngle(e)}}),Lib.flashComponent.HeadPhotoEditorConfig={t3_34:{middlePointX:350,middlePointY:100,maskX:108,maskY:0,maskURL:"http://simg.sinajs.cn/blog7swf/baby/mask3_34.swf",frameURL:"http://simg.sinajs.cn/blog7style/images/bring/baby_flashResource/frame3_34.png",defaultPhoto:"http://simg.sinajs.cn/blog7style/images/bring/baby_flashResource/babyPhoto.png"},t3_35:{middlePointX:200,middlePointY:100,maskX:6,maskY:0,maskURL:"http://simg.sinajs.cn/blog7swf/baby/mask3_35.swf",frameURL:"http://simg.sinajs.cn/blog7style/images/bring/baby_flashResource/frame3_35.png",defaultPhoto:"http://simg.sinajs.cn/blog7style/images/bring/baby_flashResource/babyPhoto.png"},t3_36:{middlePointX:300,middlePointY:120,maskX:131,maskY:23,maskURL:"http://simg.sinajs.cn/blog7swf/baby/mask3_36.swf",frameURL:"http://simg.sinajs.cn/blog7style/images/bring/baby_flashResource/frame3_36.png",defaultPhoto:"http://simg.sinajs.cn/blog7style/images/bring/baby_flashResource/babyPhoto.png"},t3_37:{middlePointX:230,middlePointY:100,maskX:71,maskY:0,maskURL:"http://simg.sinajs.cn/blog7swf/baby/mask3_37.swf",frameURL:"http://simg.sinajs.cn/blog7style/images/bring/baby_flashResource/frame3_37.png",defaultPhoto:"http://simg.sinajs.cn/blog7style/images/bring/baby_flashResource/babyPhoto.png"}},$registJob("baby_headPhoto",function(){var e=scope.UserBabyPic||{},t=$E("headflash"),i=scope.babyTpl_conf||["3_34","3_35","3_36","3_37"];scope.renderHeadPhoto=function(i){if(t){t.style.display="";var n=Lib.flashComponent.HeadPhotoEditorConfig["t"+i]||Lib.flashComponent.HeadPhotoEditorConfig.t3_34;scope.headPhoto=new Lib.flashComponent.HeadPhoto({url:$_GLOBAL.flashBasicURL+"baby/headPhoto.swf",width:540,height:285,containerID:"headflash",flashID:"flashHeadPhoto",flashVar:["maskURL=",n.maskURL,"&maskX=",n.maskX,"&maskY=",n.maskY,"&middlePointX=",n.middlePointX,"&middlePointY=",n.middlePointY,"&photoURL=",e.photoURL||n.defaultPhoto,"&photoX=",e.photoX||0,"&photoY=",e.photoY||0,"&photoZoom=",e.zoom||1,"&photoAngle=",e.angle||0].join("")})}};for(var n=0,o=i.length;o>n;n++)if(i[n]==scope.tpl){scope.renderHeadPhoto(scope.tpl);break}}),$registJob("baby_babyBarFlashDetect",function(){var e=$E("divBabyBarFlash"),t=new Lib.FlashDetector("9.0.0"),i=["#{reason}，为了能够正常显示，请您 ",'<a target="_blank" href="http://get.adobe.com/cn/flashplayer/">','<img src="http://simg.sinajs.cn/blog7style/images/common/baby/flash.png">',"下载最新版本","</a>","。"].join("");t.onUninstalled=function(){e&&(e.innerHTML=i.replace(/\#\{reason\}/g,"您的浏览器未安装Flash播放器"))},t.onVersionLower=function(){e&&(e.innerHTML=i.replace(/\#\{reason\}/g,"您的Flash播放器版本过低"))},t.detect()}),$SYSMSG.extend({B24001:"未同意服务条款",B24002:"你输入的手机号有误，请重新输入。",B24003:"你输入的验证码有误，请重新输入。<br/>若忘记验证码，可重新获取。",B24004:"此博客已绑定手机号",B24005:"此手机号已绑定博客",B24006:"你输入的手机号或验证码有误，请重新输入。<br/>若忘记验证码，可重新获取。",B24007:"此博客未开通手机订阅",B24008:"被访问者uid错误",B24009:"自己不能订阅自己",B24010:"你已手机订阅此用户。",B24011:"抱歉！你的手机订阅用户数已达上限，手机订阅失败。",B24012:"自己不能取消自己",B24013:"此用户未被订阅",B24014:"手机关注订阅失败！",B24015:"确定要取消对他的手机订阅吗？",B24017:"抱歉！您所在的地区暂不支持此服务。",B24018:"抱歉！系统繁忙，请稍后再试。",B24019:"抱歉！您输入的手机号码错误，请重新输入。",B24020:"抱歉！系统繁忙，请稍后再试。",B24021:"抱歉！为防止用户恶意骚扰，您今天尝试开通的次数已达上限。",B24022:"手机绑定但是没有开通，点击确定后将返回个人中心。"}),scope.PhoneAttentionAdd=Core.Class.create(),scope.PhoneAttentionAdd.prototype={initialize:function(){},add:function(e){try{Core.Events.stopEvent()}catch(t){}e=e||scope.$uid,this.addInterface||(this.addInterface=new Interface("http://control.blog.sina.com.cn/admin/iphoneattention/attention.php","jsload")),Lib.checkAuthor(),$isLogin?this.request(e):(v7sendLog("48_01_31"),(new Lib.Login.Ui).login(Core.Function.bind3(this.request,this,[e]),!1,"referer:"+location.hostname+location.pathname+",func:0005"))},request:function(e){this.addInterface.request({GET:{fuid:e},onSuccess:function(){var e='手机订阅成功！若此人有新博文发布，我们会短信提醒你。" <br/><span style="font-weight: 100; font-size: 12px;"><a target="_blank" href="http://i.blog.sina.com.cn/blogprofile/profilephone.php">管理我的手机订阅</a>>></span>';winDialog.alert(e,{icon:"03",funcOk:function(){("profile_phone"==scope.$pageid||"profile_attention"==scope.$pageid)&&window.location.reload()}})},onError:function(e){if("B24007"==e.code)window.location.href="http://i.blog.sina.com.cn/blogprofile/profilephone.php";else if("B24016"==e.code){var t="你还没有开通博客，现在立即开通？";winDialog.confirm(t,{icon:"04",textOk:"是",textCancel:"否",funcOk:function(){window.open("http://control.blog.sina.com.cn/reg/reg_blog.php?version=7")}})}else showError(e.code)},onFail:function(){}})}},$registJob("phone_attention_add",function(){scope.pa_add=new scope.PhoneAttentionAdd}),$registJob("quote",function(){$E("quote_set_sign")&&(scope.article_quote=new Quote("quote_set_sign")),$E("quote_set_sign2")&&(scope.article_quote=new Quote("quote_set_sign2")),$E("quote_set_sign")||$E("quote_set_sign2")||(!scope.article_quote&&(scope.article_quote=new Quote),scope.articel_quote_alert=function(e){scope.article_quote.check(e)})});var QuoteList=Core.Class.create();if(QuoteList.prototype={saving:!1,articleID:"",pageCount:0,initialize:function(e,t){this.container_id=t,this.articleID=scope.$articleid||"",this.initInterface(),this.bindEvent(e),$E(this.container_id)&&this.initHtml()},bindEvent:function(e){var t=this;$E(e)&&Core.Events.addEvent($E(e),function(){t.show()})},initInterface:function(){this.addInterface=new Interface("http://control.blog.sina.com.cn/myblog/htmlsource/quotelist.php","jsload"),this.delInterface=new Interface("http://control.blog.sina.com.cn/admin/article/article_quote_del.php","jsload")},show:function(e,t,i){if(this.pageCount=i||scope.$x_quote_c||0,t&&(this.container_id=t),this.container_id){if(this.articleID=e||scope.$articleid,t&&(this.container_id=t),$E(this.container_id)&&""===$E(this.container_id).innerHTML.replace(/\s/g,"")&&this.initHtml(),this.isShow)return void this.hidden();$E(this.container_id).style.display="block",this.loadData(),this.isShow=!0}},hidden:function(){$E(this.container_id).style.display="none",this.isShow=!1},initHtml:function(){var e=$E(this.container_id);if(e){var t=this.articleID||"",i='<h3><a href="#" onclick="return false" title="关闭" id="ql_close'+t+'" class="blogzz_closepic SG_floatR"></a>转载列表：</h3>                <ul class="ul_zzlist" id="ql_content'+t+'">                </ul>				<ul style="display:none"><li id="ql_tip'+t+'"></li></ul>                <div class="SG_clearB"></div>                <div class="blogzz_btn">					<a id="btnArticleQuote'+t+'" href="#" onclick="scope.article_quote && scope.article_quote.check(\''+t+'\');return false;" class="SG_aBtn SG_aBtn_ico SG_turn"><cite><img class="SG_icon SG_icon111" id="quoteList_quote'+t+'" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" align="absmiddle" />转载</cite></a>					<p id="quoteDescription'+t+'" class="SG_turntxt">转载是分享博文的一种常用方式...</p>				</div>				<div id="ql_page'+t+'" class="blogzz_paged"></div>				<div class="clearit"></div>';
e.innerHTML=i,Lib.checkAuthor(),$E("btnArticleQuote"+t)&&($E("btnArticleQuote"+t).style.display=$isAdmin?"none":""),$E("quoteDescription"+t)&&($E("quoteDescription"+t).style.display=$isAdmin?"":"none"),Core.Events.addEvent($E("ql_close"+t),this.hidden.bind2(this))}},setTip:function(e){var t=this.articleID||"",i=$E("ql_tip"+t),n=$E("ql_content"+t);"ok"!=e?(i.innerHTML="暂无转载。",n.style.display="none",i.parentNode.style.display="block"):(i.parentNode.style.display="none",n.style.display="block")},loadData:function(e){var t=this,e=e||1,i={blogid:t.articleID,version:7,page:e};this.addInterface.request({GET:i,onSuccess:function(t){t.length>0?(this.setTip("ok"),this.parseData(t),this.page(e)):this.setTip()}.bind2(this),onError:function(e){showError(e.code)},onFail:function(){}})},parseData:function(e){for(var t=this.articleID||"",i="",n=e.length,o=0;n>o;o++)i+=this.buildListHtml(e[o]);$E("ql_content"+t).innerHTML=i,scope.quoteList_quote=new Quote("quoteList_quote"+t)},page:function(e){var t=this.articleID||"",i=this.pageCount,n=Math.ceil(i/10,10);n>1?Ui.Pagination.init({pageNode:"ql_page"+t,nodeClassNamePrefix:"SG",curPage:e,maxPage:n,pageTpl:this.loadData.bind2(this),type:3}).show():$E("ql_page"+t).innerHTML=""},buildListHtml:function(e){e.isShow=$isAdmin?"":"none";var t=['<li id="pl_#{rp_blogid}">','<p class="blogzz_pinfo SG_txtb SG_floatL">','<a target="_blank" href="http://blog.sina.com.cn/u/#{rp_bloguid}">#{rp_bloguname}</a>','<span class="zzlist_mleft zzlist_mright">等级<em class="SG_txtc">(#{rp_ugrade})</em></span>','<span class="zzlist_mleft">转载了此文：</span><a target="_blank" href="http://blog.sina.com.cn/s/blog_#{rp_blogid}.html">#{rp_blogtitle}</a>',"</p>",'<p class="SG_floatR">','<em class="SG_txtc">#{rp_blogpubdate}</em>','<a href="#" style="display:#{isShow}" class="CP_a_fuc" onclick="scope.article_quoteList.del(\'#{rp_blogid}\',\''+this.articleID+'\');return false;">[<cite id="pl_del_#{rp_bloguid}">删除</cite>]</a>',"</p>","</li>"].join("");return e.rp_ugrade=e.rp_ugrade.toString(),new Ui.Template(t).evaluate(e)},del:function(e,t){var i=this,n={sblog_id:scope.$articleid||t,version:7,blog_id:e},i=this;$E("quote_sign_count")&&($E("quote_sign_count").innerHTML=+$E("quote_sign_count").innerHTML-1),Core.Dom.removeNode($E("pl_"+e));var o=i.articleID||"";$E("ql_content"+o)&&0==$E("ql_content"+o).getElementsByTagName("li").length&&i.setTip(),this.delInterface.request({GET:n,onSuccess:function(){i.onDeleted()}.bind2(this),onError:function(e){showError(e.code)},onFail:function(){}})},onDeleted:function(){}},$registJob("quote_list",function(){var e=$E("z_"+scope.$articleid);$E("quote_sign")?scope.article_quoteList=new QuoteList("quote_sign","blog_quote"):e&&(scope.article_quoteList=new QuoteList("z_"+scope.$articleid,"blog_quote"),"(0)"==e.innerHTML&&(e.style.display="none"))}),Core.String.StringBuffer=function(){this.buffer=[]},Core.String.StringBuffer.prototype.append=function(e){return this.buffer.push(e),this},Core.String.StringBuffer.prototype.toString=function(){return this.buffer.join("")},$SYSMSG.extend({B00901:"投票不存在。",B00902:"投票已截止。",B00903:"超出允许投票个数。",B00904:"你已投过票了!<br/>重复投票是没有意义的。",B00905:"投票主题过短<br/>至少要5个汉字或10个字符！",B00906:"投票选项至少要填写2项",B00907:"投票的截止时间不能小于当前时间，请重新选择 ",B00908:"投票选项最多可填写7项",B00909:"投票主题不能为空"}),"undefined"==typeof infosoftglobal)var infosoftglobal=new Object;"undefined"==typeof infosoftglobal.FusionChartsUtil&&(infosoftglobal.FusionChartsUtil=new Object),infosoftglobal.FusionCharts=function(e,t,i,n,o,s,a,r,l,c,d){document.getElementById&&(this.initialDataSet=!1,this.params=new Object,this.variables=new Object,this.attributes=new Array,e&&this.setAttribute("swf",e),t&&this.setAttribute("id",t),o=o?o:0,this.addVariable("debugMode",o),i=i.toString().replace(/\%$/,"%25"),i&&this.setAttribute("width",i),n=n.toString().replace(/\%$/,"%25"),n&&this.setAttribute("height",n),a&&this.addParam("bgcolor",a),this.addParam("quality","high"),this.addParam("allowScriptAccess","always"),this.addVariable("chartWidth",i),this.addVariable("chartHeight",n),this.addVariable("DOMId",t),s=s?s:0,this.addVariable("registerWithJS",s),r=r?r:"noScale",this.addVariable("scaleMode",r),l=l?l:"EN",this.addVariable("lang",l),this.detectFlashVersion=c?c:1,this.autoInstallRedirect=d?d:1,this.installedVer=infosoftglobal.FusionChartsUtil.getPlayerVersion(),!window.opera&&document.all&&this.installedVer.major>7&&(infosoftglobal.FusionCharts.doPrepUnload=!0))},infosoftglobal.FusionCharts.prototype={setAttribute:function(e,t){this.attributes[e]=t},getAttribute:function(e){return this.attributes[e]},addParam:function(e,t){this.params[e]=t},getParams:function(){return this.params},addVariable:function(e,t){this.variables[e]=t},getVariable:function(e){return this.variables[e]},getVariables:function(){return this.variables},getVariablePairs:function(){var e,t=new Array,i=this.getVariables();for(e in i)t.push(e+"="+i[e]);return t},getSWFHTML:function(){var e="";if(navigator.plugins&&navigator.mimeTypes&&navigator.mimeTypes.length){e='<embed type="application/x-shockwave-flash" src="'+this.getAttribute("swf")+'" width="'+this.getAttribute("width")+'" height="'+this.getAttribute("height")+'"  ',e+=' id="'+this.getAttribute("id")+'" name="'+this.getAttribute("id")+'" ';var t=this.getParams();for(var i in t)e+=[i]+'="'+t[i]+'" ';var n=this.getVariablePairs().join("&");n.length>0&&(e+='flashvars="'+n+'"'),e+="/>"}else{e='<object id="'+this.getAttribute("id")+'" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="'+this.getAttribute("width")+'" height="'+this.getAttribute("height")+'">',e+='<param name="movie" value="'+this.getAttribute("swf")+'" />';var t=this.getParams();for(var i in t)e+='<param name="'+i+'" value="'+t[i]+'" />';var n=this.getVariablePairs().join("&");n.length>0&&(e+='<param name="flashvars" value="'+n+'" />'),e+="</object>"}return e},setDataURL:function(e){if(0==this.initialDataSet)this.addVariable("dataURL",e),this.initialDataSet=!0;else{var t=infosoftglobal.FusionChartsUtil.getChartObject(this.getAttribute("id"));t.setDataURL||__flash__addCallback(t,"setDataURL"),t.setDataURL(e)}},encodeDataXML:function(e){var t=e.match(/=\s*\".*?\"/g);if(t)for(var i=0;i<t.length;i++){var n=t[i].replace(/^=\s*\"|\"$/g,"");n=n.replace(/\'/g,"%26apos;");var o=e.indexOf(t[i]),s="='"+n+"'",a=e.substring(0,o),r=e.substring(o+t[i].length),e=a+s+r}return e=e.replace(/\"/g,"%26quot;"),e=e.replace(/%(?![\da-f]{2}|[\da-f]{4})/gi,"%25"),e=e.replace(/\&/g,"%26")},setDataXML:function(e){if(0==this.initialDataSet)this.addVariable("dataXML",this.encodeDataXML(e)),this.initialDataSet=!0;else{var t=infosoftglobal.FusionChartsUtil.getChartObject(this.getAttribute("id"));t.setDataXML(e)}},setTransparent:function(e){"undefined"==typeof e&&(e=!0),e?this.addParam("WMode","transparent"):this.addParam("WMode","Opaque")},render:function(e){if(!(1==this.detectFlashVersion&&this.installedVer.major<8)){var t="string"==typeof e?document.getElementById(e):e;if(this.getVariable("scaleMode").search(/noscale/i)>=0&&(this.getAttribute("width").search("%")>0||this.getAttribute("height").search("%")>0)){var i=this;window.addEventListener?window.addEventListener("load",function(){t.innerHTML=i.getSWFHTML()},!1):window.attachEvent?window.attachEvent("onload",function(){t.innerHTML=i.getSWFHTML()}):t.innerHTML=this.getSWFHTML()}else t.innerHTML=this.getSWFHTML();return document.embeds[this.getAttribute("id")]||window[this.getAttribute("id")]||(window[this.getAttribute("id")]=document.getElementById(this.getAttribute("id"))),!0}if(1!=this.autoInstallRedirect)return!1;var n=window.confirm("You need Adobe Flash Player 8 (or above) to view the charts. It is a free and lightweight installation from Adobe.com. Please click on Ok to install the same.");return n?void(window.location="http://www.adobe.com/shockwave/download/download.cgi?P1_Prod_Version=ShockwaveFlash"):!1}},infosoftglobal.FusionChartsUtil.getPlayerVersion=function(){var e=new infosoftglobal.PlayerVersion([0,0,0]);if(navigator.plugins&&navigator.mimeTypes.length){var t=navigator.plugins["Shockwave Flash"];t&&t.description&&(e=new infosoftglobal.PlayerVersion(t.description.replace(/([a-zA-Z]|\s)+/,"").replace(/(\s+r|\s+b[0-9]+)/,".").split(".")))}else if(navigator.userAgent&&navigator.userAgent.indexOf("Windows CE")>=0)for(var i=1,n=3;i;)try{n++,i=new ActiveXObject("ShockwaveFlash.ShockwaveFlash."+n),e=new infosoftglobal.PlayerVersion([n,0,0])}catch(o){i=null}else{try{var i=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7")}catch(o){try{var i=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6");e=new infosoftglobal.PlayerVersion([6,0,21]),i.AllowScriptAccess="always"}catch(o){if(6==e.major)return e}try{i=new ActiveXObject("ShockwaveFlash.ShockwaveFlash")}catch(o){}}null!=i&&(e=new infosoftglobal.PlayerVersion(i.GetVariable("$version").split(" ")[1].split(",")))}return e},infosoftglobal.PlayerVersion=function(e){this.major=null!=e[0]?parseInt(e[0]):0,this.minor=null!=e[1]?parseInt(e[1]):0,this.rev=null!=e[2]?parseInt(e[2]):0},infosoftglobal.FusionChartsUtil.cleanupSWFs=function(){for(var e=document.getElementsByTagName("OBJECT"),t=e.length-1;t>=0;t--){e[t].style.display="none";for(var i in e[t])"function"==typeof e[t][i]&&(e[t][i]=function(){})}},infosoftglobal.FusionCharts.doPrepUnload&&(infosoftglobal.unloadSet||(infosoftglobal.FusionChartsUtil.prepUnload=function(){__flash_unloadHandler=function(){},__flash_savedUnloadHandler=function(){},window.attachEvent("onunload",infosoftglobal.FusionChartsUtil.cleanupSWFs)},window.attachEvent("onbeforeunload",infosoftglobal.FusionChartsUtil.prepUnload),infosoftglobal.unloadSet=!0)),!document.getElementById&&document.all&&(document.getElementById=function(e){return document.all[e]}),null==Array.prototype.push&&(Array.prototype.push=function(e){return this[this.length]=e,this.length}),infosoftglobal.FusionChartsUtil.getChartObject=function(e){var t=null;return t=-1==navigator.appName.indexOf("Microsoft Internet")?document.embeds&&document.embeds[e]?document.embeds[e]:window.document[e]:window[e],t||(t=document.getElementById(e)),t};var getChartFromId=infosoftglobal.FusionChartsUtil.getChartObject,FusionCharts=infosoftglobal.FusionCharts,voteValues=[];RenderFlash=Core.Class.create(),RenderFlash.prototype={flashId:null,data:null,current:null,eventDom:null,_labels:null,selected:[],initialize:function(){this.eventDom={tab:$E("tabDiv")?$E("tabDiv"):null,line:$E("lineView")?$E("lineView"):null,pie:$E("pieView")?$E("pieView"):null,column:$E("columnView")?$E("columnView"):null,content:$E("voteViewContent")?$E("voteViewContent"):null},this._refreshFlashId(),this._addClickEvent(this.eventDom.line),this._addClickEvent(this.eventDom.pie),this._addClickEvent(this.eventDom.column),this.combineData()},showTab:function(e,t,i){if(this.current!=e){var n=Core.Dom.getElementsByClass($E("voter"),"div","vShape")[0];if(n&&(n.style.display=""),window.clearAllInterval(),"line"==e){this.current="line",$E("voteViewContent").innerHTML=window.vote_cache_content_html,window.renderVoteNum();for(var o=document.getElementsByName("chb1"),s=0;s<o.length;s++){o[s].disabled="true";try{o[s].parentNode.childNodes[3].style.cursor="default"}catch(a){}}}else if("Pie3D.swf"==e){this.current="Pie3D.swf";for(var r=this._tabTemplate.chooses.join(""),l="",c=0;c<this._labels.length;c++){var d=this._tabTemplate.item.join("");d=d.replace("#{type}",window.vote_rc_type+""),d=d.replace(/([#][{]index[}])/gi,c+1),d=d.replace("#{text}",this._labels[c]),l+=d}r=r.replace("#{uls}",l),r+=this._tabTemplate.flash.join(""),this.eventDom.content.innerHTML=r;var h=30*this._labels.length;150>h&&(h=150);for(var p="<chart baseFontSize='12' baseFontColor='888888' numberSuffix='%25' showAboutMenuItem='0' decimals='2' chartTopMargin='0' chartBottomMargin='0' caption='' showValues='0' formatNumberScale='0' bgColor='99CCFF,FFFFFF' bgAlpha='0,0' startingAngle='60'>",c=0;c<this.data.length;c++){{this.data[c]}p+=null!=this.selected[c]?"<set label='"+(c+1)+"' value='"+voteValues[c].replace("%","")+"' displayValue='"+Core.String.shorten(this._labels[c],7,"…")+"' toolText='"+this._labels[c]+"("+voteValues[c]+")' isSliced='1' />":"<set label='"+(c+1)+"' value='"+voteValues[c].replace("%","")+"' displayValue='"+Core.String.shorten(this._labels[c],7,"…")+"' toolText='"+this._labels[c]+"("+voteValues[c]+")' />"}p+="</chart>";var u=new FusionCharts($_GLOBAL.flashBasicURL+"Pie3D.swf",t,"360",h,"0","0");u.setDataXML(p),u.setTransparent(!0),u.render(i)}else if("Column3D.swf"==e){this.current="Column3D.swf";for(var r=this._tabTemplate.chooses.join(""),l="",c=0;c<this._labels.length;c++){var d=this._tabTemplate.item.join("");d=d.replace("#{type}",window.vote_rc_type+""),d=d.replace(/([#][{]index[}])/gi,c+1),d=d.replace("#{text}",this._labels[c]),l+=d}r=r.replace("#{uls}",l),r+=this._tabTemplate.flash.join(""),this.eventDom.content.innerHTML=r;var h=30*this._labels.length;150>h&&(h=150);for(var p="<chart baseFontSize='12' baseFontColor='888888' showValues='1' outCnvBaseFontColor='999999' outCnvBaseFontSize='12' numberSuffix='%25' showAboutMenuItem='0' decimals='2' yAxisMaxValue='100' palette='2' enableRotation='1' canvasBgColor='ffffff' canvasBgAlpha='0' canvasBgDepth='3' canvasBaseColor='ffffff' divLineColor='d8d8d8' numDivLines='4' bgAlpha='0' divLineColor='d8d8d8' canvasPadding='8' chartLeftMargin='0' chartRightMargin='5' chartTopMargin='5' chartBottomMargin='0' maxColWidth='70' showValues='0'><styles><definition><style name='myToolTip' type='font' size='12' color='666666' /></definition><application><apply toObject='ToolTip' styles='myToolTip' /></application></styles>",c=0;c<this.data.length;c++){{this.data[c]}p+="<set label='"+(c+1)+"' value='"+voteValues[c].replace("%","")+"' toolText='"+this._labels[c]+"("+voteValues[c]+")' />"}p+="</chart>";var u=new FusionCharts($_GLOBAL.flashBasicURL+"Column3D.swf",t,"360",h,"0","0");u.setDataXML(p),u.setTransparent(!0),u.render(i)}$E("flashContent")&&($E("flashContent").style.padding="13px 0 0 ")}},_refreshFlashId:function(){this.flashId=Core.Math.getUniqueId()},_addClickEvent:function(e){var t=this;e&&(e.onclick=function(){t._onClickHandler(this)})},_onClickHandler:function(e){function t(e){i.eventDom.line.parentNode.className="",i.eventDom.pie.parentNode.className="",i.eventDom.column.parentNode.className="",i.eventDom[e].parentNode.className="cur SG_txtb"}var i=this;if(null!=e){var n=e.id;"lineView"==n?(this.showTab("line","lineId","voteViewContent"),t("line")):"pieView"==n?(this.showTab("Pie3D.swf","Pie3D_"+this.flashId,"flashContent"),t("pie")):"columnView"==n&&(this.showTab("Column3D.swf","Column3D_"+this.flashId,"flashContent"),t("column"))}},combineData:function(){this.data=[];for(var e=this._getLabel(),t=0;t<e.length;t++)this.data[this.data.length]={label:e[t],num:window.vote_count.detail[t]}},_getLabel:function(){for(var e=[],t=Core.Dom.getElementsByClass($E("voteViewContent"),"span",""),i=t.length,n=0;i>n;n++)e[e.length]=t[n].innerHTML;return this._labels=e,e},_tabTemplate:{chooses:['<div class="vContentRe">',"<ul>","#{uls}","</ul>","</div>"],item:['<li class="clearfix">','<div class="choosed">','<input type="#{type}" disabled="disabled" id="chb#{index}"/><label for="chb#{index}" style="cursor:default"><em>#{index}.</em><span>#{text}</span></label>',"</div>","</li>"],flash:['<div id="flashContent" class="vContentPic">',"</div>"]}},function(e){e.rf=null,e.changeType=function(e){$E("mutiple").style.display=e?"":"none",$E("voteType").value=e?$E("mutiple").value:1},e.checkNum=function(e,t){for(var i=document.getElementsByName("chb1"),n=0,o=0;o<i.length;o++){var s=i[o];s.checked&&n++}n>t&&(winDialog.alert("最多只能选"+t+"项！",{icon:"01"}),e.checked=!1)},e.isExpired=function(e){return e.replace(/(-)|\s/g,"")<getTimestamp("yyyy-MM-dd hh").replace(/(-)|\s/g,"")},e.getTimestamp=function(e){var t=new Date,i=t.getFullYear(),n=t.getMonth()+1;n=n>9?n:"0"+n;var o=t.getDate()>9?t.getDate():"0"+t.getDate(),s=t.getHours(),a=t.getMinutes()>9?t.getMinutes():"0"+t.getMinutes(),r=t.getSeconds()>9?t.getSeconds():"0"+t.getSeconds();return e.replace(/(y{2,4})/,i).replace("MM",n).replace("dd",o).replace("hh",s).replace("mm",a).replace("ss",r)},e.readyFun=function(){var e,t=!1;Lib.checkAuthor(),e=$isLogin?$UID:"0";var i=swfAPI.getC(e);if(i)for(var n=i.split("|"),o=0;o<n.length;o++){var s=n[o];if(s==scope.$articleid){t=!0;break}}if(t){var a=Core.Dom.getElementsByClass(document,"div","vBtn")[0];Core.Dom.removeParentNode($E("voteBtn")),a.innerHTML='<span class="voteState">已投票</span>';for(var r=document.getElementsByName("chb1"),l=0;l<r.length;l++){r[l].disabled="true";try{$IE?r[l].parentNode.childNodes[2].style.cursor="default":r[l].parentNode.childNodes[3].style.cursor="default"}catch(c){}}var d=Core.Dom.getElementsByClass($E("voter"),"div","vShape")[0];d&&(d.style.display="")}else Core.Events.addEvent("voteBtn",function(){function o(){try{var t=Core.Dom.getElementsByClass($E("voter"),"div","vShape")[0];t&&(t.style.display=""),i?n.length>99?swfAPI.clearK(e):i=scope.$articleid+"|"+i:i=scope.$articleid,swfAPI.setC(e,i.toString())}catch(o){Debug.error("投票种flash cookie失败！错误原因："+o)}}for(var s=$T($E("voteViewContent"),"input"),a=[],r=0;r<s.length;r++){var l=s[r];l.checked&&l.name&&"chb1"==l.name&&a.push(r+1)}if(a.length<1)return winDialog.alert("请选择要投票的项！",{icon:"01"}),!1;Lib.checkAuthor(),e=$isLogin?$UID:"0",this.flag=!0;var c=a.length;new Interface("http://control.blog.sina.com.cn/admin/vote/shot_vote.php?version=7","ijax").request({POST:{blog_id:scope.$articleid,vote_checklist:a.join(",")},onSuccess:function(){o();try{var e=Core.Dom.getElementsByClass(document,"div","vBtn")[0];Core.Dom.removeParentNode($E("voteBtn")),e.innerHTML='<span class="voteState">已投票</span>',clearAllInterval()}catch(t){}window.vote_count.total+=1;for(var i=Core.Dom.getElementsByClass($E("voteViewContent"),"span",""),n=[],s=0;c>s;s++){var r=a[s];window.vote_count.detail[r-1]+=1,n.push(i[r-1].innerHTML)}var l={};l.uid=$UID;var d=(new Date).getTime();d/=1e3,d=Math.ceil(d),l.time=d,l.vote=n;for(var h=window.vote_interface_result,p=[],u=0;u<h.length;u++)p[u+1]=h[u];p[0]=l,window.vote_interface_result=p,renderVoteNum(),initLoginBar()},onError:function(e){try{if(winDialog.alert($SYSMSG[e.code]),"B00902"==e.code){var i=Core.Dom.getElementsByClass(document,"div","vBtn")[0];Core.Dom.removeParentNode($E("voteBtn")),i.innerHTML='<span class="voteState">投票已截止</span>';for(var n=$N("chb1"),s=0;s<n.length;s++){n[s].disabled=!0;try{n[s].parentNode.childNodes[3].style.cursor="default"}catch(a){}}var r=Core.Dom.getElementsByClass($E("voter"),"div","vShape")[0];r&&(r.style.display="")}else if("B00904"==e.code){t||o();var i=Core.Dom.getElementsByClass(document,"div","vBtn")[0];Core.Dom.removeParentNode($E("voteBtn")),i.innerHTML='<span class="voteState">已投票</span>';for(var n=$N("chb1"),s=0;s<n.length;s++){n[s].disabled=!0;try{n[s].parentNode.childNodes[3].style.cursor="default"}catch(a){}}}}catch(a){}}})},"click",!1)},e.swfAPI={setC:function(e,t){$E("swfId").setC(e,t)},getC:function(e){return $E("swfId").getC(e)},clearK:function(e){$E("swfId").clearK(e)},clearC:function(){$E("swfId").clearC()}},e.insertList=function(e){function t(e){var t=new Date(1e3*e);return t.getFullYear()+"-"+(t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1)+"-"+t.getDate()+" "+t.getHours()+":"+(t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes())}var i='<li><span class="SG_dot"></span><span class="txt"><a target="_blank" href="#{url}">#{nick}</a>#{userV}&nbsp;<span class="SG_txtb">投票给 #{vote}</span><em class="SG_txtc">#{time}</em></span></li>',n="",o=Lib.blogv.getVHTML;if(this.vote_interface_result){for(var s=0;s<vote_interface_result.length;s++){var a=vote_interface_result[s],r=i;r=r.replace("#{url}","http://blog.sina.com.cn/u/"+a.uid),r=r.replace("#{nick}",e[a.uid]),r=r.replace("#{userV}",o(a.wtype)),r=r.replace("#{time}",t(a.time));for(var l="",c=0;c<a.vote.length;c++)l+='"'+a.vote[c]+'" ';if(r=r.replace("#{vote}",l),n+=r,10==s)break}$E("voterlist")&&($E("voterlist").innerHTML=n)}},e.initLoginBar=function(){Lib.checkAuthor(),$E("vote_login_txt")&&($isLogin?$E("vote_login_txt").style.display="none":($E("vote_login_txt").style.display="",$E("vote_login").onclick=function(){var e=new Lib.Login.Ui;e.login()}))},e.initNewVote=function(){Lib.checkAuthor(),$E("voteAD")&&($E("voteAD").innerHTML='<a class="SG_linka"><img height="15" align="top" width="15" class="SG_icon SG_icon33" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" title="投票"></a>&nbsp;<a target="_blank" href="http://control.blog.sina.com.cn/admin/article/article_add.php#voteadd">发起新投票</a>&nbsp;&nbsp;&nbsp;<a class="SG_linka"><img height="18" align="top" width="18" title="" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" class="SG_icon SG_icon110"></a>&nbsp;<a href="#" id="shareVote">分享此投票</a>',$E("shareVote").onclick=function(){var e=encodeURIComponent("分享投票："+$T($E("voter"),"span")[0].innerHTML+"——来自"+scope.owenerNickName+"的博文："+Core.Dom.byClz(document.body,"h2","titName")[0].innerHTML||""),t="新浪-博客",i="http://blog.sina.com.cn",n="http://v.t.sina.com.cn/share/share.php?searchPic=false&title="+e+"&url="+encodeURIComponent(document.location)+"&source="+t+"&sourceUrl="+encodeURIComponent(i)+"&content=utf-8&appkey=1617465124";return window.open(n,"mb","toolbar=0,status=0,resizable=1,width=440,height=430,left="+(screen.width-440)/2+",top="+(screen.height-430)/2),!1});var e=$E("cc_morevote");e||(e=$C("div"),e.id="cc_morevote",e.className="voteapp_btnMore",e.innerHTML='<a href="http://control.blog.sina.com.cn/blogprofile/profilevote.php?type=1" target="blank" title="查看更多投票">查看更多投票&gt;&gt;</a><img class="SG_icon SG_icon11" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" title="新" align="absmiddle" />',$E("voterlist").parentNode.parentNode.appendChild(e))},e.renderVoteNum=function(){for(var e=[],t=window.vote_interface_result,i=0;i<t.length;i++){var n=t[i];e[e.length]=n.uid}Lib.Uic.getNickName(e,insertList),this.initNewVote();var o=$E("chb1");window.vote_rc_type=null!=o&&"radio"==o.type?"radio":"checkbox",this.valueContents=Core.Dom.getElementsByClass($E("voter"),"div","num");var s=0;voteValues=[];var a,r=window.vote_count.detail,s=window.vote_count.total;$E("total").innerHTML=s+"人";for(var l=0,c=0;c<r.length;c++)l+=r[c];for(a=0;a<valueContents.length;a++){var d=r[a];if(0==l)var h="0%";else if(Math.round(d/l*100)>100)var h="100%";else var h=Math.round(d/l*100)+"%";voteValues.push(h),valueContents[a].innerHTML=d+'<span class="SG_txtc">('+h+")</span>"}renderProgress(voteValues)},e.renderProgress=function(){window.itvIds=[];var t,i=Core.Dom.getElementsByAttr($E("voter"),"name","voteResult"),n=Core.Dom.getElementsByClass($E("voter"),"div","num"),o=[];for(t=0;t<n.length;t++)/\((.*)\)/.test(n[t].innerHTML),o[t]=RegExp.$1;for(t=0;t<i.length;t++)i[t].className="color c"+(t+1),i[t].style.fontSize="8px",i[t].style.width="0px",window.itvIds[t]=window.setInterval(function(e){return function(){parseInt(i[e].style.width)<parseInt(o[e])?i[e].style.width=parseInt(i[e].style.width,10)+1+"%":window.clearInterval(itvIds[e])}}(t),10);this.rf||(e.rf=new RenderFlash)},e.clearAllInterval=function(){if(window.itvIds)for(var e=0;e<window.itvIds.length;e++)window.clearInterval(itvIds[e])}}(window),$registJob("dynamicVoteView",function(){$E("voter");if(window.vote_progress_css=["1px solid #8d458e","1px solid #578425","1px solid #89ba00","1px solid #008d8e","1px solid #7da4cf","1px solid #d54545","1px solid #ff8d46","1px solid #f6bd0e","1px solid #008dd5","1px solid #b2aa01"],$E("voterlist")){Lib.checkAuthor();var e="";try{e=Core.Dom.getElementsByClass($E("voter"),"span","voteState")[0].innerHTML}catch(t){}Utils.Io.JsLoad.request("http://control.blog.sina.com.cn/blog_rebuild/riaapi/blog/get_user_vote.php",{GET:{blog_id:scope.$articleid},onComplete:function(t){try{if("A00006"==t.code)window.vote_cache_content_html=$E("voteViewContent")?$E("voteViewContent").innerHTML:"",window.vote_interface_result=t.data&&t.data.newten,window.vote_count=t.data&&t.data.count,renderVoteNum();else if(winDialog.alert(t.code,{icon:"02"}),$E("voterlist")&&$isLogin&&"投票已截止"!=e)$E("voterlist").innerHTML="还没有博主投票呢，赶紧抢个沙发吧。";else if("投票已截止"==e)try{var i=Core.Dom.getElementsByClass($E("voter"),"div","vShape")[0];i&&(i.style.display="none"),Core.Dom.getElementsByClass($E("module_920"),"div","newVoteList SG_j_linedot1")[0].style.display="none"}catch(n){}else $E("voterlist").innerHTML=$isLogin?"加载中…":"还没有博主投票呢，赶紧抢个沙发吧。"}catch(o){trace("vote error")}},noencode:!0,onError:function(){if($E("voterlist")&&($E("voterlist").innerHTML="加载中…"),"投票已截止"==e)try{Core.Dom.getElementsByClass($E("module_920"),"div","newVoteList SG_j_linedot1")[0].style.display="none"}catch(t){}}})}}),function(){function e(e,t,i,n){var o=function(){var o=new Utils.Flash.swfObject(t,n,"1","1","9","#00ff00");o.addParam("quality","high"),o.addParam("allowScriptAccess","always"),o.addVariable("readyFun",i),o.write(e)};o()}var t="readyFun",i="";(window.$Maxthon||window.$360||window.$TT)&&(i="?uid="+Core.Math.getUniqueId(1,10)),e("swfbox",$_GLOBAL.flashBasicURL+"voteCookie.swf"+i,t,"swfId")}(),$SYSMSG.extend({B03020:"博文已收藏成功！",B03002:"已达收藏数2000条上限，不能继续收藏。",B03004:"已收藏过此博文，不能重复收藏。",B03005:"确实要取消此收藏吗？",B03006:"确实要删除此博文吗？删除后可在“回收站”恢复。",B03007:"确实要删除此草稿吗？删除后不可恢复。",B03008:"确实要彻底删除此博文吗？删除后不可恢复。",B03010:"确实要替换已置顶的博文吗？",B03011:"确实要取消置顶吗？取消后可在“博文”页恢复。",B03014:"博文已成功置顶到首页！",B03015:"抱歉，您的博客尚未升级，请<a href='http://blog.sina.com.cn/u/#UID' target='_blank'>升级</a>后再“收藏” 。",S01107:"已收藏过此博文，不能重复收藏。",B03016:"是否要彻底删除此博文？博文删除后不可恢复，博文内图片如被其他博文引用也将无法显示。",B03017:"私密博文不能被收藏。",B119000:"对不起，您短时间点击收藏过多，请多休息，注意身体！感谢您对新浪博客的支持和关注！"}),$SYSMSG.extend({B00007:"跳转到自动开通页",B00008:"自动开通用户(跳转到假页)",B00009:"跳转到自动开通页",B00010:"无权限。 ",B00011:"抱歉，Blog ID 错误，操作无法完成。",B00012:"抱歉，可能因为重复操作而无法执行，请刷新本页再试。",B00013:"用户ID被封杀",B00014:"很抱歉，您输入的验证码不正确。",B04101:"请输入您的昵称！",B04102:"请正确输入您的邮件地址！",B04103:"请选择您举报信息的位置！",B04104:"请选择您举报的不良信息的类型！",B04105:"简单描述最多只能输入500个字符！",B04106:"再次感谢您帮助我们进行不良信息的验证工作，我们将认真仔细地处理您提交的内容。",B07006:"您已发的博文正在审查中，请稍后再发文"}),App.ArticleMange=Core.Class.create(),Core.Class.extend(App.ArticleMange.prototype,{initialize:function(e,t){for(var i in t)this[i]=t[i];this.articleId=e,Lib.checkAuthor(),this.pretreat()},pretreat:function(){return null==this.articleId?void Debug.error("ArticleManage need the article id."):(this.checkLogin(),this)},checkLogin:function(){this.needLogin=this.needLogin(),Debug.log("checkLogin : "+this.needLogin);var e=function(e){(new Lib.Login.Ui).login(e)},t=Core.Function.bind2(this.confirm,this);Lib.checkAuthor(),this.needLogin||!$isLogin?e(t):t()},confirm:function(){$isLogin||(Lib.checkAuthor(),$tray.renderLogin()),this.needLogin=!1;var e=this.textOk||"确定",t=this.textCancel||"取消";this.confirmMSG?winDialog.confirm(this.confirmMSG,{funcOk:Core.Function.bind2(this.doAction,this),textOk:e,textCancel:t}):this.doAction()},doAction:function(){$IE&&Core.Events.getEvent()&&Core.Events.stopEvent();var e={};for(var t in this.param)e[t]="function"==typeof this.param[t]?Core.Function.bind2(this.param[t],this)():this.param[t];"POST"==e.getType?(e.getType&&delete e.getType,this.Interface.request({POST:e,onSuccess:this.callback||this.requestOk||function(){window.location.reload()},onError:this.requestError||function(e){showError(e.code)},onFail:function(){showError("A00001")}})):(e.getType&&delete e.getType,this.Interface.request({GET:e,onSuccess:this.callback||this.requestOk||function(){window.location.reload()},onError:this.requestError||function(e){showError(e.code)},onFail:function(){showError("A00001")}}))}}),Lib.IframeDialog=Core.Class.create(),Lib.IframeDialog.prototype={dialog:null,initialize:function(e){this.id=Core.Math.getUniqueId(),this.option=e},initDialog:function(){var e=this,t=this.option,i={ad:!1,drag:!0,tpl:t.tpl||e.tpl,title:t.title,content:'<iframe frameborder="0" id="ifrDialog_'+e.id+'" scrolling="no"></iframe>',renderer:Ui.SimpleRenderer,width:t.width,height:t.height};this.dialog=winDialog.createCustomsDialog(i),this.dialog.setAreaLocked(!0);var n=$E("ifrDialog_"+this.id);n.src=t.url,n.style.width=t.width+"px",n.style.height=t.height+"px",t.funcClose&&this.bindColseFunc()},tpl:'<table id="#{entity}" class="CP_w"><thead id="#{titleBar}"><tr><th class="tLeft"><span></span></th><th class="tMid"><div class="bLyTop"><strong id="#{titleName}">提示</strong><cite><a id="#{btnClose}" href="javascript:;" class="CP_w_shut" title="关闭">关闭</a></cite></div></th><th class="tRight"><span></span></th></tr></thead><tfoot><tr><td class="tLeft"><span></span></td><td class="tMid"><span></span></td><td class="tRight"><span></span></td></tr></tfoot><tbody><tr><td class="tLeft"><span></span></td><td class="tMid" id="#{content}"></td><td class="tRight"><span></span></td></tr></tbody></table>',reset:function(){if(this.dialog){this.hidden();var e=this.dialog.nodes.panel||this.dialog.nodes.entity;e.parentNode.removeChild(e),this.dialog=null}},bindColseFunc:function(){Core.Events.addEvent(this.dialog.nodes.btnClose,this.option.funcClose)},setSize:function(e,t){var i=this.dialog.nodes.content.firstChild;this.dialog.setSize(e,t),i.style.width=e+"px",i.style.height=t+"px"},show:function(){this.reset(),this.initDialog(),this.dialog.show(),this.dialog.setMiddle()},close:function(){this.dialog.hidden()}},Lib.AccountChecker=Core.Class.create(),Lib.AccountChecker.prototype={initialize:function(e){e.indexOf("vt=1")>0||e.indexOf("vt=2")>0?this.showDialog(e):window.location.href=e},showDialog:function(e){document.domain="sina.com.cn",window.accDialog||(window.accDialog=new Lib.IframeDialog({url:e,title:"账号安全",width:300,height:165}),scope.accCallback=function(){window.accDialog.close()}),window.accDialog.show();var t=window.accDialog.dialog.nodes,i=t.content;i.firstChild.style.marginLeft="25px",t.btnClose.style.display="none";var n=document.createElement("p");n.style.lineHeight="70px",n.innerHTML="　　为了您的账号安全，请输入验证码后再进行操作",i.insertBefore(n,i.firstChild)},hideDialog:function(){window.accDialog&&window.accDialog.hidden()}},App.deleteArticle=Core.Class.define(null,App.ArticleMange,{Interface:new Interface("http://control.blog.sina.com.cn/admin/article/article_del_recycle.php","ijax"),needLogin:function(){return trace("检查用户"),Lib.checkAuthor(),!$isAdmin},confirmMSG:$SYSMSG.B03006,param:{getType:"POST","blog_id[]":function(){return this.articleId},uid:scope.$uid},requestOk:function(){window.location.reload()},requestError:function(e){e&&"B30001"===e.code?new Lib.AccountChecker(e.data.ssoUseUrl):showError(e.code)}}),App.deleteDraftArticle=Core.Class.define(null,App.ArticleMange,{Interface:new Interface("http://control.blog.sina.com.cn/admin/article/article_draft_del.php","jsload"),needLogin:function(){return Lib.checkAuthor(),!$isAdmin},confirmMSG:$SYSMSG.B03016,textOk:"是",textCancel:"否",param:{"blog_id[]":function(){return this.articleId},uid:scope.$uid},requestOk:function(){window.location.reload()}}),App.clearRecycleBinArticle=Core.Class.define(null,App.ArticleMange,{Interface:new Interface("http://control.blog.sina.com.cn/admin/article/article_recycle_del.php","jsload"),needLogin:function(){return Lib.checkAuthor(),!$isAdmin},confirmMSG:$SYSMSG.B03016,textOk:"是",textCancel:"否",param:{"blog_id[]":function(){return this.articleId},uid:scope.$uid},requestOk:function(){window.location.reload()}}),App.restoreRecycleBinArticle=Core.Class.define(null,App.ArticleMange,{Interface:new Interface("http://control.blog.sina.com.cn/admin/article/article_recycle_resume.php","jsload"),needLogin:function(){return Lib.checkAuthor(),!$isAdmin},param:{blog_id:function(){return this.articleId},uid:scope.$uid},requestOk:function(){window.location.reload()}}),App.addFavoriteArticle=Core.Class.define(null,App.ArticleMange,{Interface:new Interface("http://control.blog.sina.com.cn/admin/article/favourites_save.php","jsload"),needLogin:function(){return Lib.checkAuthor(),!$isLogin},param:{blog_id:function(){return this.articleId},uid:scope.$uid},requestOk:function(){$E("f_"+scope.$articleid)&&($E("f_"+scope.$articleid).innerHTML=$E("f_"+scope.$articleid).innerHTML.replace(/\((\d*)\)/gi,function(e,t){return"("+(window.parseInt(t)+1)+")"
})),winDialog.alert($SYSMSG.B03020,{icon:"03"})}}),App.deleteFavoriteArticle=Core.Class.define(null,App.ArticleMange,{Interface:new Interface("http://control.blog.sina.com.cn/admin/article/favourites_del.php","jsload"),needLogin:function(){return Lib.checkAuthor(),!$isAdmin},confirmMSG:$SYSMSG.B03005,param:{resourceids:function(){return this.articleId},uid:scope.$uid},requestOk:function(){window.location.reload()}}),App.setTopArticle=Core.Class.define(null,App.ArticleMange,{Interface:new Interface("http://control.blog.sina.com.cn/admin/article/article_top.php","jsload"),needLogin:function(){return Lib.checkAuthor(),!$isAdmin},param:{blog_id:function(){return this.articleId},uid:scope.$uid},requestOk:function(){window.location.reload()}}),App.replaceTopArticle=Core.Class.define(null,App.ArticleMange,{Interface:new Interface("http://control.blog.sina.com.cn/admin/article/article_top.php","jsload"),needLogin:function(){return Lib.checkAuthor(),!$isAdmin},confirmMSG:$SYSMSG.B03010,param:{blog_id:function(){return this.articleId},uid:scope.$uid},requestOk:function(){window.location.reload()}}),App.unsetTopArticle=Core.Class.define(null,App.ArticleMange,{Interface:new Interface("http://control.blog.sina.com.cn/admin/article/article_top_del.php","jsload"),needLogin:function(){return Lib.checkAuthor(),!$isAdmin},confirmMSG:$SYSMSG.B03011,param:{blog_id:function(){return this.articleId},uid:scope.$uid},requestOk:function(){window.location.reload()}}),App.moreLayer=function(e){function t(e,i){if(e.hasChildNodes())for(var n=e.childNodes,o=0;n[o];o++)if(t(n[o],i))return!0;return e==i}var i="",n="",o="";scope.moreLayerId||(scope.moreLayerId=[0,0]),scope.moreLayerId.push(e),scope.moreLayerId.shift(),i=$E("a_layer_"+scope.moreLayerId[0]),o=$E("a_more_"+scope.moreLayerId[1]),n=$E("a_layer_"+scope.moreLayerId[1]),n.style.left=Core.Dom.getLeft(o)-30+"px",n.style.top=Core.Dom.getTop(o)+o.offsetHeight+"px",i&&(i.style.display="none"),n.style.height="80px",n.style.display="",n.onmouseout=function(e){return function(i){i=i||window.event;var n=i.relatedTarget||i.toElement;$FF?t(e,n)||(e.style.display="none"):e.contains(n)||(e.style.display="none")}}(n)},App.modifyCategory=Core.Class.define(null,App.ArticleMange,{Interface:new Interface("http://control.blog.sina.com.cn/riaapi/article/edit_cat.php","jsload"),param:{},requestOk:function(){window.location.reload()},requestError:function(){},needLogin:function(){return trace("检查用户"),Lib.checkAuthor(),!$isAdmin},confirmMSG:['<div id="#{content}" class="CP_layercon1">','<div class="CP_prompt" style="padding:0;">','<table class="CP_w_ttl"><tr><td id="#{text}">','<p style="font-size:13px; font-weight:normal; padding-left:30px;">文章分类：','<select id="#{cateSel}" style="width:130px;">{0}</select>',"</p>","</td></tr></table>",'<div id="#{subText}" class="CP_w_cnt SG_txtb"></div>','<p class="CP_w_btns" style="padding-left:60px;">','<a id="#{linkOk}" class="SG_aBtn SG_aBtnB" href="#" onclick="return false;"><cite id="#{btnOk}"><span id="#{ok}">确认</span></cite></a>','<a style="margin-left:5px;" id="#{linkCancel}" class="SG_aBtn SG_aBtnB" href="#" onclick="return false;"><cite id="#{btnCancel}"><span id="#{cancel}">取消</span></cite></a>',"</p>","</div>","</div>"].join(""),confirm:function(){if($isLogin||(Lib.checkAuthor(),$tray.renderLogin()),this.needLogin=!1,this.confirmMSG){var e=this;App.cacheSort?this.showLayer():App.getArticlesSort(function(t){App.cacheSort=t.data,e.showLayer()})}else this.doAction()},showLayer:function(){for(var e,t,i,n=this,o=+this.cateId,s=0,a="<option value='{1}'>{0}</option>",r="<option value='00'>选择分类</option>",l=0;l<App.cacheSort.length;l++)i=App.cacheSort[l],r+=a.format(i.name,i.id),i.id===o&&(s=l+1);r+="<option value='0'>私密博文</option>",this.confirmMSG=this.confirmMSG.format(r),e=winDialog.createCustomsDialog({title:"修改博文分类",content:this.confirmMSG}),e.setFixed(!0),e.setMiddle(),e.show(),t=e.nodes.cateSel,t.selectedIndex=s,e.nodes.linkCancel.onclick=function(){return e.close(),!1},e.nodes.btnClose.onclick=function(){return e.close(),!1},e.nodes.linkOk.onclick=function(){return n.param={old_cat:n.cateId,new_cat:t.options[t.selectedIndex].value,blog_id:n.articleId},Core.Function.bind2(n.doAction,n)(),e.close(),!1}},requestOk:function(){winDialog.alert("修改分类成功",{icon:"03",funcOk:function(){window.location.reload()}})}}),App.deleteClockpub=Core.Class.define(null,App.ArticleMange,{Interface:new Interface("http://control.blog.sina.com.cn/admin/article/article_clockpub_del.php","jsload"),needLogin:function(){return Lib.checkAuthor(),!$isAdmin},confirmMSG:"博文删除后将无法恢复，确定要删除吗？",textOk:"是",textCancel:"否",param:{"blog_id[]":function(){return this.articleId},uid:scope.$uid},requestOk:function(){window.location.reload()},requestError:function(e){"B00011"===e.code?winDialog.alert("博文已不在定时列表中",{funcOk:function(){window.location.reload()},icon:"01"}):showError(e.code)}}),App.sendClockpub=Core.Class.define(null,App.ArticleMange,{Interface:new Interface("http://control.blog.sina.com.cn/blog_rebuild/riaapi/blog/clockPubImmediate.php","jsload"),needLogin:function(){return Lib.checkAuthor(),!$isAdmin},param:{blog_id:function(){return this.articleId}},requestOk:function(e){winDialog.alert("博文已发布成功",{funcOk:function(){setTimeout(function(){window.location.href="http://blog.sina.com.cn/s/blog_"+e+".html"},1)},icon:"03"})},requestError:function(e){"B40003"===e.code||"B36101"===e.code?winDialog.alert("博文已不在定时列表中",{funcOk:function(){window.location.reload()},icon:"01"}):showError(e.code)}}),App.articleHide=Core.Class.define(null,App.ArticleMange,{Interface:new Interface("http://control.blog.sina.com.cn/riaapi/article/edit_cat.php?old_cat=0&new_cat=0","jsload"),param:{blog_id:function(){return this.articleId}},confirmMSG:"是否要隐藏此博文",needLogin:function(){return trace("检查用户"),Lib.checkAuthor(),!$isAdmin},requestOk:function(){winDialog.alert("隐藏成功",{icon:"03",funcOk:function(){window.location.reload()}})},requestError:function(){winDialog.alert("失败，请重试")}}),App.articleRestore=Core.Class.define(null,App.ArticleMange,{Interface:new Interface("http://control.blog.sina.com.cn/riaapi/article/edit_cat.php?old_cat=0&new_cat=00","jsload"),param:{blog_id:function(){return this.articleId}},confirmMSG:"是否恢复此博文",needLogin:function(){return Lib.checkAuthor(),!$isAdmin},requestOk:function(){winDialog.alert("恢复成功",{icon:"03",funcOk:function(){window.location.reload()}})},requestError:function(){winDialog.alert("恢复失败，请重试")}}),$articleManage=function(e,t,i){if($IE)try{Core.Events.stopEvent(),$E("a_layer_"+scope.moreLayerId[1]).style.display="none",$E("a_layer_"+scope.moreLayerId[0]).style.display="none"}catch(n){}switch(i=i||{},t){case 1:new App.deleteArticle(e,i);break;case 2:new App.deleteDraftArticle(e,i);break;case 3:new App.clearRecycleBinArticle(e,i);break;case 4:new App.restoreRecycleBinArticle(e,i);break;case 5:var o=function(){scope.blogOpener.showDialog(function(){new App.addFavoriteArticle(e,i)})};Lib.checkAuthor(),$isLogin?o():(v7sendLog("48_01_35"),(new Lib.Login.Ui).login(o));break;case 6:new App.deleteFavoriteArticle(e,i);break;case 7:new App.setTopArticle(e,i);break;case 8:new App.replaceTopArticle(e,i);break;case 9:new App.unsetTopArticle(e,i);break;case 10:App.moreLayer(e,Core.Events.getEvent());break;case 11:new App.modifyCategory(e,i);break;case 12:new App.articleHide(e,i);break;case 13:new App.articleRestore(e,i);break;case 14:new App.deleteClockpub(e,i);break;case 15:new App.sendClockpub(e,i)}},$registJob("report_bodyArticle",function(){var e=new Lib.BlogReport,t="";window.report=function(i){var n,o=scope.$uid,s="",a='<a target="_blank" href="http://blog.sina.com.cn/s/blog_'+i+'.html">'+$E("t_"+i).innerHTML+"</a>",r=$E("t_"+i).innerHTML;""===t?Lib.Uic.getNickName([o],function(t){if(t&&t[o]){var n=t[o];e.start("blog",n,i,o,'<a target="_blank" href="http://blog.sina.com.cn/u/'+scope.$uid+'">'+n+"</a>",s,a,r)}else e.start("blog","新浪网友",i,o,"新浪网友",s,a,r)}):(n='<a target="_blank" href="http://blog.sina.com.cn/u/'+scope.$uid+'">'+t+"</a>",e.start("blog",t,i,o,n,s,a,r))},window.article_report=function(i){var n,o=scope.$uid,s="",a='<a target="_blank" href="http://blog.sina.com.cn/s/blog_'+i+'.html">'+$E("t_"+i).innerHTML+"</a>",r=$E("t_"+i).innerHTML;""===t?Lib.Uic.getNickName([o],function(t){if(t&&t[o]){var n=t[o];e.start("blog",n,i,o,'<a target="_blank" href="http://blog.sina.com.cn/u/'+scope.$uid+'">'+n+"</a>",s,a,r)}else e.start("blog","新浪网友",i,o,"新浪网友",s,a,r)}):(n='<a target="_blank" href="http://blog.sina.com.cn/u/'+scope.$uid+'">'+t+"</a>",e.start("blog",t,i,o,n,s,a,r))}}),$registJob("flashtemplate",function(){Lib.getTplNum(function(){scope.tpl&&Lib.insertMoban()})}),$registJob("imageLazyLoad",function(){for(var e=document.getElementsByTagName("IMG"),t=[],i=0,n=e.length;n>i;i++)null!=e[i].getAttribute("real_src")&&t.push(e[i]);t.length>0&&Lib.LazyLoad(t,{callback:function(e){scope.sharePhoto&&scope.sharePhoto.bindFn&&scope.sharePhoto.bindFn(e,"real_src");var t=e.getAttribute("real_src");scope.showPicSlide&&scope.showPicSlide(e,t),e.src=t,"articletjTech"===scope.$pageid&&(e.complete&&e.width>550?e.width=550:e.onload=function(){e.width>550&&(e.width=550)})}})}),scope.$worldCupInfos={teams:{1:{name:"南非",group:"A",URL:"http://2010.sina.com.cn/teams/southafrica.shtml"},2:{name:"墨西哥",group:"A",URL:"http://2010.sina.com.cn/teams/mexico.shtml"},3:{name:"乌拉圭",group:"A",URL:"http://2010.sina.com.cn/teams/uruguay.shtml"},4:{name:"法国",group:"A",URL:"http://2010.sina.com.cn/teams/france.shtml"},5:{name:"阿根廷",group:"B",URL:"http://2010.sina.com.cn/teams/argentina.shtml"},6:{name:"尼日利亚",group:"B",URL:"http://2010.sina.com.cn/teams/nigeria.shtml"},7:{name:"韩国",group:"B",URL:"http://2010.sina.com.cn/teams/korearepublic.shtml"},8:{name:"希腊",group:"B",URL:"http://2010.sina.com.cn/teams/greece.shtml"},9:{name:"英格兰",group:"C",URL:"http://2010.sina.com.cn/teams/england.shtml"},10:{name:"美国",group:"C",URL:"http://2010.sina.com.cn/teams/usa.shtml"},11:{name:"阿尔及利亚",group:"C",URL:"http://2010.sina.com.cn/teams/algeria.shtml"},12:{name:"斯洛文尼亚",group:"C",URL:"http://2010.sina.com.cn/teams/slovenia.shtml"},13:{name:"德国",group:"D",URL:"http://2010.sina.com.cn/teams/germany.shtml"},14:{name:"澳大利亚",group:"D",URL:"http://2010.sina.com.cn/teams/australia.shtml"},15:{name:"塞尔维亚",group:"D",URL:"http://2010.sina.com.cn/teams/serbia.shtml"},16:{name:"加纳",group:"D",URL:"http://2010.sina.com.cn/teams/ghana.shtml"},17:{name:"荷兰",group:"E",URL:"http://2010.sina.com.cn/teams/netherlands.shtml"},18:{name:"丹麦",group:"E",URL:"http://2010.sina.com.cn/teams/denmark.shtml"},19:{name:"日本",group:"E",URL:"http://2010.sina.com.cn/teams/japan.shtml"},20:{name:"喀麦隆",group:"E",URL:"http://2010.sina.com.cn/teams/cameroon.shtml"},21:{name:"意大利",group:"F",URL:"http://2010.sina.com.cn/teams/italy.shtml"},22:{name:"巴拉圭",group:"F",URL:"http://2010.sina.com.cn/teams/paraguay.shtml"},23:{name:"新西兰",group:"F",URL:"http://2010.sina.com.cn/teams/newzealand.shtml"},24:{name:"斯洛伐克",group:"F",URL:"http://2010.sina.com.cn/teams/slovakia.shtml"},25:{name:"巴西",group:"G",URL:"http://2010.sina.com.cn/teams/brazil.shtml"},26:{name:"朝鲜",group:"G",URL:"http://2010.sina.com.cn/teams/koreadpr.shtml"},27:{name:"科特迪瓦",group:"G",URL:"http://2010.sina.com.cn/teams/cotedivoire.shtml"},28:{name:"葡萄牙",group:"G",URL:"http://2010.sina.com.cn/teams/portugal.shtml"},29:{name:"西班牙",group:"H",URL:"http://2010.sina.com.cn/teams/spain.shtml"},30:{name:"瑞士",group:"H",URL:"http://2010.sina.com.cn/teams/switzerland.shtml"},31:{name:"洪都拉斯",group:"H",URL:"http://2010.sina.com.cn/teams/honduras.shtml"},32:{name:"智利",group:"H",URL:"http://2010.sina.com.cn/teams/chile.shtml"}},games:{1:{teams:["1","2"],time:"2010-06-11 22:00:00",score:"",group:"A"},2:{teams:["3","4"],time:"2010-06-12 02:30:00",score:"",group:"A"},3:{teams:["5","6"],time:"2010-06-12 22:00:00",score:"",group:"B"},4:{teams:["7","8"],time:"2010-06-12 19:30:00",score:"",group:"B"},5:{teams:["9","10"],time:"2010-06-13 02:00:00",score:"",group:"C"},6:{teams:["11","12"],time:"2010-06-13 19:30:00",score:"",group:"C"},7:{teams:["13","14"],time:"2010-06-14 02:30:00",score:"",group:"D"},8:{teams:["15","16"],time:"2010-06-13 22:00:00",score:"",group:"D"},9:{teams:["17","18"],time:"2010-06-14 19:30:00",score:"",group:"E"},10:{teams:["19","20"],time:"2010-06-14 22:00:00",score:"",group:"E"},11:{teams:["21","22"],time:"2010-06-15 02:30:00",score:"",group:"F"},12:{teams:["23","24"],time:"2010-06-15 19:30:00",score:"",group:"F"},13:{teams:["27","28"],time:"2010-06-15 22:00:00",score:"",group:"G"},14:{teams:["25","26"],time:"2010-06-16 02:30:00",score:"",group:"G"},15:{teams:["31","32"],time:"2010-06-16 19:30:00",score:"",group:"H"},16:{teams:["29","30"],time:"2010-06-16 22:00:00",score:"",group:"H"},17:{teams:["1","3"],time:"2010-06-17 02:30:00",score:"",group:"A"},18:{teams:["2","4"],time:"2010-06-18 02:30:00",score:"",group:"A"},19:{teams:["6","8"],time:"2010-06-17 22:00:00",score:"",group:"B"},20:{teams:["5","7"],time:"2010-06-17 19:30:00",score:"",group:"B"},21:{teams:["13","15"],time:"2010-06-18 22:00:00",score:"",group:"D"},22:{teams:["12","10"],time:"2010-06-18 22:00:00",score:"",group:"C"},23:{teams:["9","11"],time:"2010-06-19 02:30:00",score:"",group:"C"},24:{teams:["16","14"],time:"2010-06-19 02:30:00",score:"",group:"D"},25:{teams:["17","19"],time:"2010-06-19 19:30:00",score:"",group:"E"},26:{teams:["18","20"],time:"2010-06-20 02:30:00",score:"",group:"E"},27:{teams:["22","24"],time:"2010-06-20 19:30:00",score:"",group:"F"},28:{teams:["21","23"],time:"2010-06-20 22:00:00",score:"",group:"F"},29:{teams:["25","27"],time:"2010-06-21 02:00:00",score:"",group:"G"},30:{teams:["26","28"],time:"2010-06-21 19:30:00",score:"",group:"G"},31:{teams:["30","32"],time:"2010-06-21 22:00:00",score:"",group:"H"},32:{teams:["29","31"],time:"2010-06-22 02:00:00",score:"",group:"H"},33:{teams:["2","3"],time:"2010-06-22 22:00:00",score:"",group:"A"},34:{teams:["1","4"],time:"2010-06-22 22:00:00",score:"",group:"A"},35:{teams:["6","7"],time:"2010-06-23 02:30:00",score:"",group:"B"},36:{teams:["5","8"],time:"2010-06-23 02:30:00",score:"",group:"B"},37:{teams:["9","12"],time:"2010-06-23 22:00:00",score:"",group:"C"},38:{teams:["10","11"],time:"2010-06-23 22:00:00",score:"",group:"C"},39:{teams:["13","16"],time:"2010-06-24 02:30:00",score:"",group:"D"},40:{teams:["15","14"],time:"2010-06-24 02:30:00",score:"",group:"D"},41:{teams:["21","24"],time:"2010-06-24 22:00:00",score:"",group:"F"},42:{teams:["22","23"],time:"2010-06-24 22:00:00",score:"",group:"F"},43:{teams:["18","19"],time:"2010-06-25 02:30:00",score:"",group:"E"},44:{teams:["17","20"],time:"2010-06-25 02:30:00",score:"",group:"E"},45:{teams:["25","28"],time:"2010-06-25 22:00:00",score:"",group:"G"},46:{teams:["26","27"],time:"2010-06-25 22:00:00",score:"",group:"G"},47:{teams:["29","32"],time:"2010-06-26 02:30:00",score:"",group:"H"},48:{teams:["30","31"],time:"2010-06-26 02:30:00",score:"",group:"H"},49:{},50:{},51:{},52:{},53:{},54:{},55:{},56:{},57:{},58:{},59:{},60:{},61:{},62:{},63:{},64:{}},teammatches:{1:["1","17","34"],2:["1","18","33"],3:["2","17","33"],4:["2","18","34"],5:["3","20","36"],6:["3","19","35"],7:["4","20","35"],8:["4","19","36"],9:["5","23","37"],10:["5","22","38"],11:["6","23","38"],12:["6","22","37"],13:["7","21","39"],14:["7","24","40"],15:["8","21","40"],16:["8","24","39"],17:["9","25","44"],18:["9","26","43"],19:["10","25","43"],20:["10","26","44"],21:["11","28","41"],22:["11","27","42"],23:["12","28","42"],24:["12","27","41"],25:["14","29","45"],26:["14","30","46"],27:["13","29","46"],28:["13","30","45"],29:["16","32","47"],30:["16","31","48"],31:["15","32","48"],32:["15","31","47"]}},$registJob("favGames",function(){function e(){var e,i,n=scope.wc_match_info,o=scope.wc_teams_info,s=attentionWorldCup.show_attentiongame,a=(attentionWorldCup.show_attentionteam,6),r=['<table border="0" cellpadding="0" cellspacing="1">',"<tr>",'<th scope="col" class="w1">日期</th>','<th scope="col" class="w2">时间</th>','<th scope="col">对阵</th>',"</tr>#{itemLines}","</table>"].join(""),l=["<tr>","<td>#{date}</td>",'<td class="wdc_ta">#{time}</td>','<td class="wdc_te"><span class="matchL">#{army1}</span><span class="vs wdc_ta"> VS </span><span class="matchR">#{army2}</span></td>',"</tr>"].join(""),c=$E("favGames"),d="",h=["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],p=[],u=[],g=[];for(e=0;e<s.length;e++)trace("userGameHash "+n[s[e]].score+"////"+e),g.push(n[s[e]]);var m=t(g,"score",a,!0);for(trace("length: "+m.length),e=0;e<m.length;e++){trace(e);var f=m[e].time.split(" ")[0].split("-"),v=m[e].time.split(" ")[1].split(":")[0],_=new Date;_.setMonth(f[1]-1),_.setDate(f[2]),_.setHours(v),p[e]=_.getTime()}u=u.concat(p);var y,b,w=[];for(i=0;i<p.length;i++){for(y=p[0],b=0,e=1;e<p.length;e++)p[e]<y&&(y=p[e],b=e);w.push(b),p[b]=1/0}for(e=0;e<p.length;e++){var f=m[w[e]].time.split(" ")[0].split("-"),_=new Date;_.setMonth(f[1]-1),_.setDate(f[2]);var E=_.getDay();_=_.getMonth()+1+"月"+_.getDate()+"日",d+=new Ui.Template(l).evaluate({army1:o[m[w[e]].teams[0]].name,army2:o[m[w[e]].teams[1]].name,date:_+" "+h[E],time:m[w[e]].time.split(" ")[1].slice(0,-3)})}c.innerHTML=new Ui.Template(r).evaluate({itemLines:d})}function t(e,t,i,n){var o,s=[],a=[];for(o=0;o<e.length;o++)(n?!e[o][t]:e[o][t])&&s.push(e[o]);for(o=0;i>o;o++){if(!s[o]){trace("src not enough");break}a.push(s[o])}return a}"undefined"!=typeof attentionWorldCup&&attentionWorldCup.show_attentiongame.length&&(scope.wc_match_info?e():Utils.Io.JsLoad.request("http://blog.sina.com.cn/2010worldcup/worldcup.js",{onComplete:function(){scope.wc_match_info=wc_match_info,scope.wc_teams_info=wc_team_info,e()}}))}),$registJob("teams_wc",function(){"undefined"!=typeof attentionWorldCup&&(new FavTeamsInfo,Utils.Io.JsLoad.request("http://hits.blog.sina.com.cn/hits?act=3&uid=00000300&tm"+(new Date).getTime(),{onComplete:function(){}}))});var FavTeamsInfo=function(){this.entity=$E("favTeams"),this.entity&&(this.allTeams=$T(this.entity,"li"),this.isTweenIn=[],this.isTweenOut=[],this.initialize())};FavTeamsInfo.prototype={initialize:function(){if(this.entity){var e=this,t=64;Core.Array.foreach(this.allTeams,function(i,n){var o=$T(i,"p")[1];o.style.zIndex=512,i.style.zIndex=t--,Core.Events.addEvent(i,function(){($IE||e.justIn(Core.Events.getEvent(),i))&&e.tweenIn(i,o,n)},$IE?"mouseenter":"mouseover"),Core.Events.addEvent(i,function(){($IE||e.justIn(Core.Events.getEvent(),i))&&e.tweenOut(i,o,n)},$IE?"mouseleave":"mouseout")})}},justIn:function(e,t){for(var i=e.relatedTarget;i&&i!=t;)i=i.parentNode;return i!=t},tweenIn:function(e,t){try{Ui.tween.stop(t)}catch(i){}e.className="hover",Core.Dom.setStyle(t,"opacity",1),t.style.display=""},tweenOut:function(e,t){new Ui.tween(t,["opacity"],[0],.3,"simple",{end:function(){t.style.display="none",e.className=""}})}};var CalendarWc=function(){this.entity=$E("wdc_calender"),this.closeBtn=$E("wcc_close"),this.fakeImg=$C("div"),this.switchOn=!1,this.isTween=!1,this.posRelDom=null,this.lockPosX,this.lockPosY,this.initialize()};CalendarWc.prototype={initialize:function(){if(this.entity){var e=this;this.fakeImg.style.cssText="z-index:612; position:absolute; border:2px solid #d2d9e6; background-color:white;",document.body.insertBefore(this.fakeImg,document.body.firstChild),this.renderNew(),this.renderToday(),Core.Events.addEvent(this.closeBtn,function(){e.resetCalendar()}),Core.Events.addEvent(window,function(){e.justiPos()},"resize")}},resetCalendar:function(){try{Ui.tween.stop(this.fakeImg)}catch(e){}Core.Dom.setStyle(this.entity,"display","none"),Core.Dom.setStyle(this.entity,"visibility","hidden"),Core.Dom.setStyle(this.fakeImg,"display","none"),this.switchOn=!1,this.isTween=!1},justiPos:function(){this.switchOn&&(Core.Dom.setStyle(this.entity,"left",Core.Dom.getLeft(this.posRelDom)-this.lockPosX+"px"),Core.Dom.setStyle(this.entity,"top",Core.Dom.getTop(this.posRelDom)-this.lockPosY+"px"))},renderNew:function(){var e=this,t=attentionWorldCup.show_attentiondate;if(t||t.length)for(var i=0;i<t.length;i++){var n,o=t[i].split("_");if(n=$E("wcc_"+o[0]+"_"+o[1]),!n)break;$T(n,"a")[0].title="有关注的赛事",this.addClass(n,"new"),Core.Events.addEvent(n,function(i){return function(){e.resetCalendar(),window.location.href="#"+t[i]}}(i))}},renderToday:function(){var e=(new Date).getMonth()+1,t=(new Date).getDate();this.addClass($E("wcc_"+e+"_"+t),"cur")},setPos:function(e,t,i){this.posRelDom=e;var n=Core.Dom.getLeft(e)+(t?t:0),o=Core.Dom.getTop(e)+(i?i:0);$IE6&&$IE7&&(n+=document.documentElement.scrollLeft,o+=document.documentElement.scrollTop),this.fakeImg.style.left=n+"px",this.fakeImg.style.top=o+"px"},arcFunc:function(e,t,i){return function(n){return e*n*n+t*n+i}},tweenPlay:function(){this.resetCalendar();var e=this;Core.Dom.setStyle(this.entity,"display",""),Core.Dom.setStyle(this.fakeImg,"display",""),Core.Dom.setStyle(this.fakeImg,"opacity",.6),Core.Dom.setStyle(this.fakeImg,"width","48px"),Core.Dom.setStyle(this.fakeImg,"height","15px"),this.isTween=!0,new Ui.tween(this.fakeImg,["opacity","height","width","left"],[1,this.entity.offsetHeight-4,this.entity.offsetWidth-4,Core.Dom.getLeft(this.posRelDom)-217],.3,"strongEaseIn",{end:function(){new Ui.tween(e.fakeImg,["opacity"],[1],.1,"simple",{end:function(){e.entity.style.left=Core.Dom.getLeft(e.fakeImg)+"px",e.entity.style.top=Core.Dom.getTop(e.fakeImg)+"px",e.fakeImg.style.display="none",e.entity.style.visibility="visible",e.switchOn=!0,e.lockPosX=Core.Dom.getLeft(e.posRelDom)-Core.Dom.getLeft(e.entity),e.lockPosY=Core.Dom.getTop(e.posRelDom)-Core.Dom.getTop(e.entity)}})}})},addClass:function(e,t){return e?void(this.hasClass(e,t)||(e.className=Core.String.trim(e.className.concat(" "+t)))):!1},delClass:function(e,t){if(!e)return!1;var i=new RegExp("(?: +|^)"+t+"(?=( |$))","ig");e.className=Core.String.trim(e.className.replace(i,""))},hasClass:function(e,t){if(!e)return!1;var i=new RegExp("(?: +|^)"+t+"(?=( |$))","ig");return i.test(e.className)}},$registJob("calendar_wc",function(){if("undefined"!=typeof attentionWorldCup){var e=new CalendarWc;$E("calendar_wc").onmouseover=function(){return e.isTween?void 0:(e.setPos(this,0,0),e.tweenPlay(),!1)}}}),$SYSMSG.extend({B00802:"抱歉，此篇图片已经被删除",B00803:"抱歉，此篇专辑已经被删除",B00804:"抱歉，此篇文章已经被删除"}),$registJob("digger",function(){function e(e){var i=0,n=setInterval(function(){i+=500,i>=$_GLOBAL.diggerFlashTimeout&&(trace("已超时，不再尝试放进flash cookie:"+e.res_id+"_"+(e.res_uid||scope.$uid)+"_"+r+"_"+e.res_type),clearInterval(n),c=!0),l&&(clearInterval(n),t(e))},500)}function t(t){return c?void trace("不等待,flash已经是不可靠的，顶没有放入flash cookie"):void(l?(p.setData(t.res_id+"_"+(t.res_uid||scope.$uid)+"_"+r+"_"+t.res_type),trace(t.res_id+"_"+(t.res_uid||scope.$uid)+"_"+r+"_"+t.res_type+"放入成功!")):e(t))}function i(e){var t=0,i=setInterval(function(){return t+=500,trace("waitOrExecute:等待flash加载..."+t),l&&(clearInterval(i),scope.digger.bindEvent(e)),t>=$_GLOBAL.diggerFlashTimeout?(trace("响应超时，直接执行代码"),clearInterval(i),n(e),void(c=!0)):void 0},500)}function n(e){for(var t in e.events)e.targetEle["on"+t]=e.events[t](e)}function o(e){u||(u=!0,new Interface(e.url,"jsload").request({GET:e.params,onSuccess:function(t){e.onSuccess&&e.onSuccess(t),u=!1},onError:function(t){e.onError&&e.onError(t),u=!1},onFail:function(){e.onFail&&e.onFail(),u=!1}}))}function s(){_.innerHTML='<div style="text-align:center;"><img src="http://simg.sinajs.cn/blog7style/images/common/loading.gif" />加载中…</div>'}var a=$E("d1_digg_"+scope.$articleid);if(scope.digger||(scope.digger={}),scope.digger.flashReady=function(){},scope.digger.diggerPer=function(){},scope.digger.diggerNums=function(){},scope.digger.setData=function(){},scope.digger.diggerPost=function(){},scope.digger.bindEvent=function(){},scope.digger.showLast10=function(){},scope.digger.hiddenLast10=function(){},!$E("diggerFla"))return void trace("no diggerFla");if(!$_GLOBAL.diggerOpenFlag)return void trace("close...");Lib.checkAuthor();var r="";$isLogin&&(r=$UID,trace("当前用户:"+$UID));var l=!1,c=!1;scope.digger.flashReady=function(){trace("--------顶踩加载完毕...."),l=!0},trace("--------顶踩开始加载完毕....");var d="";(window.$Maxthon||window.$360||window.$TT)&&(d="?t="+Core.Math.getUniqueId());var h=new Utils.Flash.swfObject($_GLOBAL.flashBasicURL+"digger.swf"+d,"digger","1","1","9","#00ff00");h.addParam("quality","high"),h.addParam("wmode","transparent"),h.addParam("allowScriptAccess","always"),h.write("diggerFla");var p=$E("digger");scope.digger.diggerPer=function(e){e.params||(e.params={res_id:e.res_id,res_uid:e.res_uid||scope.$uid}),e.url="http://control.blog.sina.com.cn/riaapi/digg/get_digg.php",o(e)},scope.digger.diggerNums=function(e){e.params||(e.params={res_id:e.res_id,res_uid:e.res_uid||scope.$uid}),e.url="http://blogtj.sinajs.cn/api/get_digg_num.php",o(e)},scope.digger.setData=function(e,i,n){t({res_id:e,res_uid:i,res_type:n})},scope.digger.diggerPost=function(e){if(e.params||(e.params={res_id:e.res_id,res_uid:e.res_uid||scope.$uid,action:e.action||"0",res_type:e.res_type}),e.url="http://control.blog.sina.com.cn/admin/digg/post_digg.php",e.onSuccess){var i=e.onSuccess;e.onSuccess=function(n){i(n),t(e)}}else e.onSuccess=function(){t(e)};o(e)},scope.digger.bindEvent=function(e){return c?(trace("不等待,flash已经是不可靠的，直接执行代码"),void n(e)):void(l?(trace("读取"+e.res_id+"_"+(e.res_uid||scope.$uid)+"_"+r+"_"+e.res_type+":"+p.getData(e.res_id+"_"+(e.res_uid||scope.$uid)+"_"+r+"_"+e.res_type)),p.getData(e.res_id+"_"+(e.res_uid||scope.$uid)+"_"+r+"_"+e.res_type)?(trace(e.res_id+"_"+(e.res_uid||scope.$uid)+"_"+r+"_"+e.res_type+": 找到，不绑定事件"),e.whenFind&&e.whenFind(e)):(trace(e.res_id+"_"+(e.res_uid||scope.$uid)+"_"+r+"_"+e.res_type+": 未找到，绑定事件"),n(e))):(trace("falsh还没有加载完毕"),i(e)))};var u=!1,g=document.createElement("div");g.className="tb_layer_Y tb_layer_w3",g.style.cssText="z-index: 511;position:absolute;display:none;width:160px";var m=document.createElement("div");m.className="tb_layer_arrow";var f=document.createElement("div");f.className="tb_layer_Y_main tip_ps",f.style.cssText="width:auto;",f.innerHTML=a&&"顶"===a.innerHTML?'<a style="margin-top: 5px;" title="关闭" class="tb_friend_inputDel" href="javascript:void(0)"></a>						<div style="text-align:left;color:#999999">最近顶了的博主：</div>						<div></div>':'<a style="margin-top: 5px;" title="关闭" class="tb_friend_inputDel" href="javascript:void(0)"></a>						<div style="text-align:left;color:#999999">最近喜欢了的博主：</div>						<div></div>',g.appendChild(m),g.appendChild(f),document.body.appendChild(g);var v=f.getElementsByTagName("a")[0],_=f.getElementsByTagName("div")[1];_.style.whiteSpace="nowrap",s(),v.onclick=function(){scope.digger.hiddenLast10()},scope.digger.showLast10=function(e){s(),scope.digger.diggerPer(e);var t=Core.Dom.getXY(e.ele);e.onError=function(){_.innerHTML='<div style="text-align:center;color:#999999;font-weight:bolder;">数据请求失败，请稍后重试</div>'},e.onFail=e.onError,e.onSuccess=function(e){if(g.style.display)return void trace("已经被关闭，不再往里面写入信息");for(var t=[],i=Lib.blogv.getVHTML,n=0;e[n];n++){var o=e[n],s=o.action_uname;t.push("<div>",'<a target="_blank" title="到',o.action_uname,'的博客去看看" href="http://blog.sina.com.cn/u/',o.action_uid,'">',s,"</a>",i(parseInt(o.wtype||-1)),"</div>")}_.innerHTML=t.length?t.join(""):a&&"顶"===a.innerHTML?'<div style="text-align:center;color:#999999;font-weight:bolder;">暂无登录用户顶过</div>':'<div style="text-align:center;color:#999999;font-weight:bolder;">暂无登录用户喜欢过</div>'};var i=0,n=(e.dx||-76)+t[0],o=(e.dy||10)+t[1];$IE&&(n-=1,o-=2),$SAFARI&&(n+=1),$CHROME&&(n+=1,o+=2),g.style.display="",g.style.left=n+"px",g.style.top=o+"px",Core.Dom.opacity(g,i),new Ui.tween(g,["opacity"],[1],.3,"strongEaseIn"),window.onresize=function(){var t=Core.Dom.getXY(e.ele);g.style.left=t[0]-76+"px",g.style.top=t[1]+10+"px"}},scope.digger.hiddenLast10=function(){new Ui.tween(g,["opacity"],[0],.3,"strongEaseOut")}}),$registJob("stylefix",function(){$IE6&&scope.UserPic&&scope.UserPic[1]&&"1"==scope.UserPic[1].apply&&($E("blognavBg").style.filter="none")}),$registJob("articleDigger",function(){function e(){var e=setInterval(function(){scope.useNewInterfaceToGetNum&&(trace("通过别的借口进行装载"),scope.useNewInterfaceToGetNum.onSuccess=function(e){scope.useNewInterfaceToGetNum=null,s(e)},scope.useNewInterfaceToGetNum.onError=function(){scope.useNewInterfaceToGetNum=null,s(null)},scope.useNewInterfaceToGetNum.onFail=function(){scope.useNewInterfaceToGetNum=null,s(null)},trace("装载完毕"),clearInterval(e))},50)}function t(e){e.ele.parentNode.className="SG_aBtn SG_aBtn_ico SG_turn SG_click",e.ele.children[1].innerHTML="已喜欢"}function i(e){var t;if("articletj"!==scope.$pageid){e.ele.className="upBox upBox_dis",e.ele.style.cursor="default",t=e.ele.getElementsByTagName("p")[1];var i=t.innerHTML,n=SinaEx.createNode("<div>"+i+"</div>"),o=SinaEx.findNode(n,"nextSibling","firstChild");n.removeChild(o);var s=n.innerHTML;t.innerHTML="顶"===s?'<img width="15" height="15" align="absmiddle" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" class="SG_icon SG_icon34">已顶':"已喜欢"}else{var a=e.ele.getElementsByTagName("span");t=a[0];var r=t.parentNode,l=r.parentNode.parentNode;l.className="upBox upBox_dis",t.style.cursor="default",r.style.cursor="default",a[1].style.cursor="default",a[2].style.cursor="default",t.innerHTML="已喜欢"}}function n(e){if("articletj"!==scope.$pageid)e.ele.className="upBox upBox_click",e.ele.getElementsByTagName("p")[0].innerHTML="+1";else{var t=e.ele.getElementsByTagName("span");states=t[0];var i=states.parentNode,n=i.parentNode.parentNode;n.className="upBox upBox_click",states.innerHTML='<span class="up1">+1</span>喜欢'}}function o(e){if("articletj"!==scope.$pageid){e.ele.className="upBox";var t=e.ele.getElementsByTagName("p")[0];t.innerHTML=t.getAttribute("mnum")}else{var i=e.ele.getElementsByTagName("span");states=i[0];var n=states.parentNode,o=n.parentNode.parentNode;o.className="upBox",states.innerHTML='<img class="SG_icon SG_icon34" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" title="推荐" align="absmiddle">喜欢'}}function s(e){var s="articletjTech"===scope.$pageid,r=e?e["digg_m_"+a]:0,l=$E("dbox2_"+a);if(!l)return void trace("没有找到计数模块，认为这是不需要顶踩功能的");l.innerHTML=r?r:"0";var c=a;l.setAttribute("mnum",r);var d=l.parentNode;d.style.cursor="pointer",scope.digger.bindEvent({ele:d,targetEle:d,ti_title:encodeURIComponent(l.getAttribute("ti_title")||""),disClass:"upBox upBox_dis",res_id:c,uid:scope.$uid,res_type:"1",whenFind:function(e){s?t(e):i(e)},events:{mouseover:function(e){return function(){s||n(e)}},mouseout:function(e){return function(){s||o(e)}},click:function(e){return function(){return scope.digger.diggerPost({params:{res_id:e.res_id,res_uid:e.res_uid||scope.$uid,action:"0",res_type:"1",ti_title:e.ti_title},res_id:e.res_id,res_uid:e.res_uid||scope.$uid,action:"0",res_type:"1",onSuccess:function(){e.targetEle.onmouseover=function(){},e.targetEle.onmouseout=function(){},e.targetEle.onclick=function(){},s?t(e):i(e);var n=$E("dbox2_"+e.res_id),o=parseInt(n.getAttribute("mnum"))+1;n.innerHTML=o},onError:function(n){if("B00801"==n.code){winDialog.alert("这篇博文您已经喜欢过啦!",{icon:"01"}),e.targetEle.onmouseover=function(){},e.targetEle.onmouseout=function(){},e.targetEle.onclick=function(){},s?t(e):i(e),scope.digger.setData(e.res_id,scope.$uid,1);var o=$E("dbox2_"+e.res_id),a=o.getAttribute("mnum");o.innerHTML=a}else showError(n.code)}}),!1}}}});var h=$E("d1_digg_"+a);h&&($E("d1_digg_"+a).onclick=function(e){return function(){return scope.digger.showLast10(e),!1}}({ele:$E("d1_digg_down_"+a),res_id:a,res_uid:scope.$uid}),$E("d1_digg_down_"+a).onclick=function(e){return function(){return scope.digger.showLast10(e),!1}}({ele:$E("d1_digg_down_"+a),res_id:a,res_uid:scope.$uid}))}if($E("diggerFla")&&$_GLOBAL.diggerOpenFlag){var a=scope.$articleid;e()}}),$registJob("miniBlogAttention",function(){new Interface("http://weibo.com/attention/aj_addfollow.php","jsload");scope.attMiniBlog=function(){Lib.checkAuthor(),$UID&&Utils.Io.JsLoad.request("http://weibo.com/attention/aj_addfollow.php?jsdomain=1&uid=1231759973&fromuid="+$UID,{onComplete:function(){}})}}),Lib.register("util.loadScript",function(){var e=!0,t=!1,i={},n=function(n){Utils.Io.JsLoad.request(n,{isRemove:t,noreturn:e,onComplete:function(e){i[n].isLoading=t;
for(var o=i[n].cb,s=0,a=o.length;a>s;s++)o[s](e);i[n].cb=null}})};return function(t,o){var s=i[t],a=s&&s.cb;s?s.isLoading?a.push(o):o():(a=[o],s={isLoading:e,cb:a},i[t]=s,n(t,s))}}),Lib.register("sendSuda",function(e){var t="http://www.sinaimg.cn/unipro/pub/suda_s_v851c.js";return function(i){e.util.loadScript(t,i)}}),$registJob("suda",function(){function e(e,t,i,o,s){switch(n&&v7sendLog(s),e){case"index":case"indexM":v7sendLog(t);break;case"editor":v7sendLog(i);break;case"articletj":v7sendLog(o)}}var t=scope&&scope.$pageid,i=window.location.href,n=i.indexOf("tj=1")>-1,o=t&&("articletj"===t||"index"===t||"indexM"===t||"editor"===t||n);if(o)var s=encodeURIComponent(i),a=encodeURIComponent(document.referrer);if("function"==typeof _S_pSt)return void(o&&v7sendLog("42_01_03_"+(new Date).getTime()+"_"+s+"_"+a));if(o){if($isLogin)var r="42_01_01_"+$UID+"_"+(new Date).getTime()+"_"+s+"_"+a;else var r="42_01_01_"+(new Date).getTime()+"_"+s+"_"+a;e(t,"42_01_08","42_01_14",r,"42_01_05")}Lib.sendSuda(function(){try{_S_pSt("")}catch(i){}if(o){if($isLogin)var n="42_01_02_"+$UID+"_"+(new Date).getTime()+"_"+s+"_"+a;else var n="42_01_02_"+(new Date).getTime()+"_"+s+"_"+a;e(t,"42_01_09","42_01_15",n,"42_01_06")}})}),Lib.register("execZhitou",function(e){var t="http://d5.sina.com.cn/litong/zhitou/sinaads/release/sinaads.js";return document.createElement("inc"),function(i){e.util.loadScript(t,i)}});var blogAd={};blogAd.getInitPermission=function(e){var t;return e&&e.ads&&e.ads[0]?(t=e&&e.ads&&e.ads[0],"mixed"==t.type||t.ref):!1},blogAd.insertIns=function(e,t,i,n){i=i||"beforeend",n=n||"display:block;";var o='<ins class="sinaads" data-ad-pdps="'+e+'" style="'+(n||"")+'"></ins>';return t=t||document.body,Core.Dom.insertHTML(t,o,i)},$registJob("scrollAd",function(){blogAd.insertIns("PDPS000000025949"),Lib.execZhitou(function(){(window.sinaads||[]).push({params:{sinaads_follow_top:40,sinaads_follow_mini_top:200}})})}),$registJob("SinglesDay",function(){scope.addFriendForSinglesDay=function(){Lib.checkAuthor(),$UID&&new Interface("http://control.blog.sina.com.cn/riaapi/profile/attention_add.php","ijax").request({POST:{uid:$UID,aid:1259295385}})}}),Core.Events.stopDefaultEvent=function(e){var t=e?e:Core.Events.getEvent();null!=t&&(t.preventDefault?t.preventDefault():t.returnValue=!1)},Utils.excBeforeCloseWin=function(e,t,i,n){closeVar={},closeVar.func=i,closeVar.tips1=e,closeVar.tips2=t,closeVar.args=n,closeVar.length=arguments.length,window.beforeunloadfunc=function(){function e(e){1==e&&(closeVar.args?Core.Function.bind3(closeVar.func,closeVar.func,[closeVar.args])():closeVar.func())}if(1==closeVar.length)return closeVar.tips1;if(!$IE)return e.call(this,confirm(closeVar.tips2));var t=Core.Events.fixEvent(Core.Events.getEvent());(t.clientY<0||t.altKey)&&confirm(closeVar.tips2)&&(closeVar.args?Core.Function.bind3(closeVar.func,closeVar.func,[closeVar.args])():closeVar.func())},Core.Events.addEvent(window,beforeunloadfunc,"beforeunload")};var StaticUser=Core.Class.create();StaticUser.prototype={container_id:null,is_init:!1,localDB:null,initialize:function(e){if(this.container_id=e,Lib.LocalDB.FlaDom)this.loaded();else{trace("first 加载");var t=this;Lib.LocalDB.registerFun(function(){setTimeout(function(){t.loaded()},10)}),Lib.LocalDB.loadFlash("trayFlashConnetion")}},loaded:function(){var e=this;Lib.LocalDB.get("SUKeya",31536e6)?(window.staticunload=function(){if($IE){{Core.Events.fixEvent(Core.Events.getEvent())}this.record()}else this.record()},Core.Events.addEvent(window,Core.Function.bind2(window.staticunload,e),"beforeunload")):(Lib.LocalDB.set("SUKeya",window.staticTime+parseInt(1e5*Math.random()).toString()),this.record(),this.send());Lib.LocalDB.get("SUInfo",31536e6);if(Lib.LocalDB.get("SULastTime",31536e6)){var t=Lib.LocalDB.get("SULastTime",31536e6);(new Date).getTime()-t>36e5&&this.send()}else Lib.LocalDB.set("SULastTime",(new Date).getTime())},record:function(){var e=decodeURIComponent(Lib.LocalDB.get("SUInfo",31536e6)),t="",i=document.referrer;""!=(ts=Utils.Cookie.getCookie("SUP"))?(ts=decodeURIComponent(ts),""!=ts&&(t+="|lu:"+ts.split("&uid=")[1].split("&")[0]),scope.unreadMsg&&scope.unreadMsg.isbloguser&&(t+="|ib:"+scope.unreadMsg.isbloguser),t+=Lib.LocalDB.get("SULoginFlag")?""==i?"|al:4":i.indexOf("blog.sina.com.cn")>-1?"|al:2":"|al:3":"|al:1|at:"+(new Date).getTime(),""!=Utils.Cookie.getCookie("ALF")&&(t+="|pu:1"),Lib.LocalDB.set("SULoginFlag",!0)):Lib.LocalDB.set("SULoginFlag",!1);var n="et:"+window.staticTime+"|r:"+i+"|u:"+window.location.href+"|lt:"+(new Date).getTime().toString()+"|vu:"+scope.$uid+t+";";Lib.LocalDB.set("SUInfo",encodeURIComponent(e+n))},send:function(){var e=Lib.LocalDB.get("SUKeya",31536e6),t=decodeURIComponent(Lib.LocalDB.get("SUInfo",31536e6)),i=t.split(";");if(i.length>5){for(var n="",o=0;o<i.length;o++)(o+1)%5==0?(v7sendLog("StaticUser","",encodeURIComponent("k:"+e+";"+n)),n=""):n+=i[o]+";";""!=n&&v7sendLog("StaticUser","",encodeURIComponent("k:"+e+";"+n))}else v7sendLog("StaticUser","",encodeURIComponent("k:"+e+";"+t));Lib.LocalDB.set("SUInfo",""),Lib.LocalDB.set("SULastTime",(new Date).getTime())}},$registJob("static",function(){window.staticClass=new StaticUser;var e=function(){var e=document.createElement("div");e.className="dowAndroidTip",e.id="dow_AndroidTip",e.innerHTML='<div class="dowAndroidTipInner"><p style="cursor:pointer;" id="save2mobile">将此博客<span>保存到手机</span></p><p style="cursor:pointer;" id="save2mobile2">阅读随时随地</p><span class="arrowMod"><span class="arrowModInner"></span></span><a id="close_discover" class="close" href="javascript:;" title="关闭">关闭</a></div>',$E("headarea").appendChild(e);var t=Core.Dom.getXY(document.body),i=Core.Dom.getXY($E("blogtopoption"));e.style.position="absolute",e.style.left=t[0]+728+"px",e.style.top=i[1]-45+"px",$E("close_discover").onclick=function(){return v7sendLog("70_01_05_"+($UID||0)),$E("dow_AndroidTip").style.visibility="hidden",!1},$E("save2mobile").onclick=$E("save2mobile2").onclick=function(e){Core.Events.stopEvent(e),v7sendLog("70_01_06_"+($UID||0)),window.open("http://appmaster.hudee.com/sina/download.jsp?uid="+scope.$uid),$E("dow_AndroidTip").style.visibility="hidden"}},t=Core.Dom.byClz($E("blogtopoption"),"a","dwnAndroid");t.length&&(t=t[0],"下载应用"===Core.String.trim(t.innerText||t.textContent||"")&&e(),Core.Events.addEvent(t,function(){var e,i=Core.String.trim(t.innerText||t.textContent||"");switch(i){case"下载应用":e="70_01_01_"+($UID||0);break;case"制作应用":e="70_01_02_"+$UID;break;case"管理应用":e="70_01_04_"+$UID;break;case"制作中":e="70_01_03_"+$UID}e&&v7sendLog(e)}))}),$registJob("sharePhoto",function(){function e(){if(this.width<165||this.height<f)return!1;var e=Core.Dom.getXY(this)[0]+this.width-124;e=Math.min(e,c-134),E.left=e+"px",E.top=Core.Dom.getXY(this)[1]+this.height-f+4+"px",v&&(E.display=""),r=encodeURIComponent(this.getAttribute("real_src")||this.src),l=this}function t(){var e=Core.Events.getEvent(),t=e.relatedTarget||e.toElement;t&&Core.Dom.contains(_,t)||(E.display="none")}function i(i,o){(i.getAttribute(o)||"").indexOf("http://www.sinaimg.cn/uc/myshow/blog/misc/gif/E___")&&Core.Dom.contains(m,i)&&(n(),d=new Image,Core.Events.addEvent(d,function(){this.width>165&&this.height>35&&(Core.Events.addEvent(i,e.bind2(i),"mouseover"),Core.Events.addEvent(i,t.bind2(i),"mouseout"))}.bind2(d),"load"),d.src=i.getAttribute(o))}function n(){c=Core.Dom.getXY(m)[0]+m.clientWidth}function o(e){if(!u)for(var t;e=e.parentNode;)if("content"==e.className&&"DIV"==e.nodeName&&"tagMore"==(t=e.nextElementSibling||e.nextSibling).className)return($T(t,"a")[0]||{}).href||""}function s(){v=1,h($T(m,"img"),function(e){i(e,"src")})}var a,r,l,c,d,h=Core.Array.foreach,p=scope.$pageid,u="article"==p||"articleM"==p,g=scope.$uid,m=$E("sina_keyword_ad_area2")||document.body,f=62,v=1,_=SinaEx.createNode('<div id="sharePhoto" style="display:none;width:120px;position:absolute;"><div class="picShareQing"><div class="share SG_txtb"><span>分享到新浪Qing</span></div></div><div class="picShareFlt"><div class="share SG_txtb" style="margin-top:5px;"><span>分享到新浪微博</span></div></div></div>'),y=_.children[0],b=y.nextSibling;document.body.appendChild(_),setTimeout(function(){Lib.Uic.getNickName([g],function(e){a=e[g]})},500);var w=_,E=w.style;if(Core.Events.addEvent(y,function(){var e=u?"的《"+Core.Dom.byClz(document.body,"h2","titName")[0].innerHTML+"》":"",t=$_GLOBAL.qingURL+"blog/controllers/share.php?searchPics=0&content="+encodeURIComponent("分享"+a+e+"的博文图片，查看原文：")+"&url="+encodeURIComponent(o(l)||location.href)+"&ralateNick="+encodeURIComponent("新浪博客")+"&pics="+r;return window.open(t,"shareQing","toolbar=0,status=0,resizable=1,width=600,height=520,left="+(screen.width-600)/2+",top="+(screen.height-520)/2),v7sendLog("80_01_02"),!1}),Core.Events.addEvent(b,function(){var e=encodeURIComponent("分享"+a+"的博文图片："+(u?Core.Dom.byClz(document.body,"h2","titName")[0].innerHTML:"")),t="新浪-博客",i="http://blog.sina.com.cn",n="http://v.t.sina.com.cn/share/share.php?searchPic=false&title="+e+"&url="+encodeURIComponent(o(l)||document.location)+"&source="+t+"&sourceUrl="+encodeURIComponent(i)+"&content=utf-8&appkey=1617465124&pic="+r;window.open(n,"mb","toolbar=0,status=0,resizable=1,width=440,height=430,left="+(screen.width-440)/2+",top="+(screen.height-430)/2),v7sendLog("80_01_09"),Core.Events.stopEvent()}),Core.Events.addEvent(window,n,"resize"),("index"==p||"indexM"==p)&&h([$E("module_10001"),$E("module_10002"),$E("module_10003")],function(e){e&&e.clientWidth>500&&(m=e,s())}),Lib&&Lib.Component.Comp_10001){var C=Lib.Component.Comp_10001.prototype.afterLoadList;Lib.Component.Comp_10001.prototype.afterLoadList=function(){v=0,E.display="none",C.apply(this,arguments),setTimeout(s,100)}}scope.sharePhoto={bindFn:i}}),$registJob("selectionShare",function(){function e(){l=null,c=null;var e=Core.String.trim;if(document.selection){var t=document.selection.createRange(),i=t.text;i.length>=10&&(l=i);var n=t.htmlText,o=/<img[\s\S]+src="(\S+)"[\s\S]+>/gim;o.test(n)&&(c=RegExp.$1)}else try{var t=window.getSelection().getRangeAt(0);if(!Core.Dom.contains($E("sina_keyword_ad_area2"),t.commonAncestorContainer))return;var i=t.toString();i.length>=10&&(l=i);var s=$C("div");s.appendChild(t.cloneContents());var a=$T(s,"img");a.length>0&&(c=a[0].src||a[0].real_src)}catch(r){}return l&&(l=e(l).replace(/\r|\n/g,"")),l}function t(){l&&l.length>80&&(l=l.substr(0,80)+"……");var e=Core.Dom.byClz(document.body,"h2","titName")[0],t=e.textContent||e.innerHTML;if(l)var i=encodeURIComponent(l+"——博文片段来自"+r+"："+t);else var i=encodeURIComponent("分享"+r+"的博文图片："+t);var o="新浪-博客",s="http://blog.sina.com.cn",a="http://v.t.sina.com.cn/share/share.php?searchPic=false&title="+i+"&url="+document.location+"&source="+o+"&sourceUrl="+encodeURIComponent(s)+"&content=utf-8&appkey=1617465124";c&&(a=a+"&pic="+c),window.open(a,"selectionshare","toolbar=0,status=0,resizable=1,width=440,height=430,left="+(screen.width-440)/2+",top="+(screen.height-430)/2),n()}function i(){a.style.left=d+"px",a.style.top=h+"px",a.style.display=""}function n(){a.style.display="none"}function o(e){if(!$IE)return void s();var t=document.selection.createRange(),i=t.duplicate();for(i.collapse(!1),i.moveStart("word",-1);0==i.text.length;)i.moveStart("word",-1);var n=!1;if(e.pageY-u<=-i.boundingHeight&&(n=!0,trace(11111)),Math.abs(e.pageY-u)<i.boundingHeight&&(e.pageX-p<0?(n=!0,trace(11111)):(n=!1,trace(22222))),t.collapse(n),!n)for(t.moveStart("word",-1);0==t.text.length;)t.moveStart("word",-1),t.moveEnd("word",-1);var o=t.htmlText,a="temp_"+parseInt(1e3*Math.random()),r=t.boundingWidth,l=t.boundingHeight;t.pasteHTML('<a id="'+a+'" >$</a>'+o);var c=$E(a);n?(d=Core.Dom.getLeft(c)+10,h=Core.Dom.getTop(c)-26-7):(d=Core.Dom.getLeft(c)+r-36,h=Core.Dom.getTop(c)+l),c.parentNode.removeChild(c)}function s(){var e,t,i,n=window.getSelection(),o=n.rangeCount-1,s=n.getRangeAt(o),a=$C("span"),r=s.cloneRange(),l=!1;e=s.startContainer,s.startContainer!=s.endContainer?n.focusNode!=s.startContainer&&(l=!0,e=s.endContainer):n.focusOffset>n.anchorOffset&&(l=!0),r.collapse(!l),r.insertNode(a),i=Core.Dom.getXY(a),3==e.nodeType&&(e=e.parentNode),"IMG"==e.tagName.toUpperCase()?t=e.offsetWidth:(t=Core.Dom.getStyle(e,"fontSize"),t=parseInt(t.substring(0,t.length-2))),l?(d=i[0]-33,h=i[1]+10,$FF||(h+=t)):(d=i[0]+7,h=i[1]-36,$FF&&(h-=t)),a.parentNode.removeChild(a),n.removeAllRanges(),n.addRange(s)}if($E("sina_keyword_ad_area2")){var a=$C("div");a.innerHTML='<img src="http://simg.sinajs.cn/blog7style/images/common/share.gif" title="将选中内容分享到新浪微博"/>',a.id="selectionShare",a.style.display="none",a.style.position="absolute",a.style.cursor="pointer",document.body.appendChild(a),Core.Events.addEvent(document.body,function(){n()}),Core.Events.addEvent(a,function(){t(),Core.Events.stopEvent()});var r=null;Lib.Uic.getNickName([scope.$uid],function(e){r=e[scope.$uid]});var l,c,d=0,h=0,p=0,u=0;Core.Events.addEvent($E("sina_keyword_ad_area2"),function(t){var t=Core.Events.getEvent();t=Core.Events.fixEvent(t),setTimeout(function(){var s=e();s?(setTimeout(function(){i()},100),o(t)):n()})},"mouseup"),Core.Events.addEvent($E("sina_keyword_ad_area2"),function(e){var e=Core.Events.getEvent();e=Core.Events.fixEvent(e),p=e.pageX,u=e.pageY},"mousedown")}}),$registJob("toZoneStatic",function(){("1513474044"==scope.$uid||"1632440911"==scope.$uid||"1311747503"==scope.$uid||"1374847633"==scope.$uid||"1265252974"==scope.$uid||"1218670734"==scope.$uid||"1156966391"==scope.$uid)&&Utils.Io.JsLoad.request("http://sjs.sinajs.cn/blog7activity/zoneStatic.js",{isRemove:!1,onComplete:function(){"function"==typeof zoneStatic&&zoneStatic(),"function"==typeof traceFunction&&traceFunction()},noreturn:!0})}),Lib.templateUtils=function(){},Lib.templateUtils.prototype.getTemplateNodes=function(e){var t=document.createElement("div"),i={},n=[],o=(new Date).getTime().toString().slice(-5)+Math.floor(1e5*Math.random()),s=/#{([a-z0-9_]+)}/gi;e=e.replace(s,function(e,t){return n.push(t),t+"_"+o}),t.innerHTML=e;var a,r,l=n.length;for(a=0;l>a;a++)r=n[a],i[r]=this.findById(r+"_"+o,t);return i},Lib.templateUtils.prototype.getIdNodes=function(e){var t,i,n,o,s,a,r={},l=[],c=[],d=[],h=document.createElement("div");for(h.innerHTML=e,d=h.getElementsByTagName("*"),e.replace(/id *= *"([^{ ]+?)"/gi,function(e,t){l[l.length]=t}),n=d.length,t=0;n>t;t++)d[t].id&&(c[c.length]=d[t]);for(n=l.length,t=0;n>t;t++)for(s=l[t],i=0,o=c.length;o>i;)a=c[i],s==a.id&&(r[s]=a,c.splice(i,1)),i++;return r},Lib.templateUtils.prototype.findById=function(e,t,i){var n,t=t||document,o=t.getElementsByTagName(i||"*"),s=o.length;for(n=0;s>n;n++)if(o[n].getAttribute("id")==e)return o[n]},Lib.templateUtils.prototype.formatTemplate=function(e,t){var e,i=new RegExp("#{([a-z0-9]+)}","ig");return e=e.replace(i,function(e,i){return t[i]})},function(){function e(e){function t(){}return t.prototype=e,new t}Function.prototype.$defineProto=function(e){var t;for(t in e)this.prototype[t]=e[t];if(this.__interface__)for(t in this.prototype)if("NI"===this.prototype[t])throw new Error("类定义错误，接口方法["+t+"]未实现");return this.prototype.constructor=this,this.$extendClass=this.$defineProto=this.$implements=function(){throw new Error("$defineProto 语句定义后面不能再作其它定义")},this},Function.prototype.$extendClass=function(){var t,i,n=this,o=arguments.length;if(0===o)throw new Error("$extendClass 语句错误：未指定父类");return t=arguments[0],i=function(){var e=this;this.$super={};for(var i in t.prototype)t.prototype[i]&&(this.$super[i]=function(i){return function(){t.prototype[i].apply(e,arguments)}}(i));t.apply(this,arguments),n.apply(this,arguments)},i.prototype=e(t.prototype),i.prototype.constructor=i,i},Function.prototype.$implements=function(){for(var e,t=Array.prototype.slice.call(arguments,0),i=t.length;i--;){if("object"!=typeof t[i])throw new Error("$implements 语句错误：参数必须为 object 类型");for(e in t[i])"undefined"==typeof this.prototype[e]&&(this.prototype[e]="NI")}return this.__interface__=!0,this.$extendClass=function(){throw new Error("$extendClass 语句错误：$extendClass 语句不能出现在 $implements 定义之后")},this},Function.prototype.$mixProto=function(){this.$extendClass=this.$defineProto=function(){throw new Error("$mixProto 必须放在最后使用")};var e=arguments[0],t=e.prototype;for(var i in t){if(this[i])throw new Error("目标类有同名方法");t[i]&&(this.prototype[i]=t[i])}return this}}(),blogAd.CommAd=function(e){Lib.checkAuthor();var t,i,n,o=$E("commAd_1"),s=$E("commAd_2");if(!o)for(trace("no id"),t=$E("articlebody"),i=articlebody.getElementsByTagName("strong"),n=0;n<i.length;n++)"评论"==i[n].innerHTML?o=i[n].parentNode.getElementsByTagName("span")[0]:"发评论"==i[n].innerHTML&&(s=i[n].parentNode.getElementsByTagName("span")[0]);this.MARK_ID=2,this.LIMITED=24;var a=(['<span style="margin-left:15px; width:220px; display:inline-block;">','<a target="_blank" href="http://blog.sina.com.cn/lm/8/2009/0325/105340.html">重要提示：警惕虚假中奖信息</a>',"</span>"].join(""),'<span style="display:inline-block;width:220px;white-space:nowrap;">#{link}</span>'),r="",l="",c="",d=!1;!$isAdmin&&e&&!+e.code&&e.ads&&(e.ads[0]&&e.ads[0].link&&(d=!0,r=this.formatTemplate(a,{link:e.ads[0].link}),e.ads[0].status&&e.ads[0].status.adstart&&((new Image).src=e.ads[0].status.adstart)),e.ads[1]&&e.ads[1].link&&(d=!0,l=this.formatTemplate(a,{link:e.ads[1].link}),e.ads[1].status&&e.ads[1].status.adstart&&((new Image).src=e.ads[1].status.adstart)),e.ads[2]&&e.ads[2].link&&(d=!0,c=this.formatTemplate(a,{link:e.ads[2].link}),e.ads[2].status&&e.ads[2].status.adstart&&((new Image).src=e.ads[2].status.adstart))),o&&(o.style.display="inline-block"),s&&(s.style.display="inline-block"),d&&commonLog("http://1092.adsina.allyes.com/main/adfshow?user=AFP6_for_SINA|2012_add|2012_blog_tjbw_plq_wzl&db=sina&border=0&local=yes&js=ie")}.$defineProto({}).$mixProto(Lib.templateUtils),blogAd.insertIns=function(e,t,i,n){i=i||"beforeend",n=n||"display:block;";var o='<ins class="sinaads" data-ad-pdps="'+e+'" style="'+(n||"")+'"></ins>';return t=t||document.body,Core.Dom.insertHTML(t,o,i)};var Article={};Article.getSearchReferrer=function(){var e={},t=document.URL;if(-1!=t.indexOf("blog.sina.com.cn")&&-1!=t.indexOf("k=")){var i=new Utils.Url(t);return e.key=i.getParam("k"),e.type=i.getParam("t"),e}var n=document.referrer;if(!n||""===n)return!1;var o={"www.google.co.jp":{param:"q",type:"utf-8"},"www.google.com.hk":{param:"q",type:"utf-8"},"www.baidu.com":{param:"wd",type:"GBK",needTrans:!0},"www.soso.com":{param:"query",type:"GBK",needTrans:!0},"search.yahoo.com":{param:"p",type:"utf-8"},"cn.bing.com":{param:"q",type:"utf-8"},"www.youdao.com":{param:"q",type:"utf-8"},"www.sogou.com":{param:"query",type:"GBK",needTrans:!0},"www.so.com":{param:"q",type:"utf-8"}};for(var s in o){var a=new Utils.Url(n);if(-1!=n.indexOf(s)){e.key=a.getParam(o[s].param),e.type=o[s].type,e.needTrans=o[s].needTrans;break}}return e.key&&""!==e.key?e:!1},window.sendLogToQing=function(e,t){"undefined"==typeof scope&&(window.scope={},scope.$uid=scope.$pageid="");var i=e||"",n=t||scope.$uid,o=scope.$pageid,s=(new Date).getTime(),a=i+"|"+s+"|"+o+"|"+n,r=window.actlog_img=new Image;r.onLoad=r.onError=function(){window.actlog_img=null},r.src=$_GLOBAL.qingURL+"blog/api/actlog.php?msg="+encodeURIComponent(a),r=null},$registJob("searchToQing",function(){function e(){var e,t,o=130,s=i.clientHeight||n.clientHeight,a="http://blog.sina.com.cn/lm/iframe/article/searchqing.html?t="+ +new Date;e=$C("iframe"),e.src=a,e.width="100%",e.scrolling="no",e.style.border="0px",e.frameBorder="no",closeBtn=$C("a"),closeBtn.className="nblog_searchBtmBtn",closeBtn.href="javascript:void(0);",closeBtn.title="关闭",closeBtn.innerHTML="关闭",closeBtn.id="serachToQingCloseBtn",closeBtn.onClick="return false",t=$C("div"),t.id="searchToQing",t.style.width="100%",t.style.height="100px",t.style.left="0px",t.style.top=s-o+"px",t.style.position="fixed",t.style.zIndex=201,t.appendChild(closeBtn),t.appendChild(e),Core.Events.addEvent(closeBtn,function(){trace("add events to closeBtn"),$E("searchToQing").parentNode.removeChild($E("searchToQing"))},"click"),$IE6&&(t.style.position="absolute",t.style.overflow="hidden",Core.Events.addEvent(window,function(){var e=i.scrollTop||n.scrollTop,t=i.clientHeight||n.clientHeight,s=Math.abs(t-o);$IE6&&(s=Math.abs(t+e-o)),$E("searchToQing").style.top=s+"px"},"scroll"),e.style.left=t.style.left,e.style.top=t.style.top),n.appendChild(t),Core.Events.addEvent(window,function(){setTimeout(function(){var e=i.scrollTop||n.scrollTop,t=i.clientHeight||n.clientHeight,s=Math.abs(t-o);$IE6&&(s=Math.abs(t+e-o)),$E("searchToQing").style.top=s+"px"},20)},"resize"),Core.Events.addEvent($E("serachToQingCloseBtn"),function(){sendLogToQing("79_01_12|blog7",$UID||"")},"click"),t=null,e=null,$E("searchToQing")&&SUDA&&SUDA.uaTrack("blog_sflow","v_sflow")}var t=scope.isFromSearchEngine||Article.getSearchReferrer();if(t){var i=document.documentElement,n=document.body;e()}}),Lib.BlogRecommendDialog=Core.Class.create(),Lib.BlogRecommendDialog.prototype={template:['<div class="blogreco" id="#{panel}">','<div id="#{frame}">','<div class="TB" id="#{titleBar}">','<a id="blogNorAd_Cls" class="btnClose" style="position:absolute;left:240px;" href="javascript:">&nbsp;</a>','<a class="btnMin" style="position:absolute;left:220px;" id="#{btnMin}" href="javascript:">&nbsp;</a>',"</div>",'<div id="#{content}"></div>',"</div>","</div>"].join(""),contentUrl:'<iframe frameborder="0" scrolling="no" class="IF" src="http://blog.sina.com.cn/lm/mini/01.html"></iframe>',name:"blogRecoDialog",_slide:null,_dialog:null,_cookie:"dlg680",_mode:null,_timePoints:null,_toolbarHeight:0,width:260,height:190,isMin:!1,displayState:"max",closedADLayer:null,closedFlashTemplate:"",_evt:null,initialize:function(e,t,i){var n,o=this;this._mode=e,this._timePoints=t,this.oParam=i,this.isShowClosedAD=!+i.code,this._dialog||(this._dialog=new Ui.Panel,this._dialog.setTemplate(this.template),n=this._dialog.nodes,n.btnClose=$E("blogNorAd_Cls"),this._dialog.entity.style.zIndex="100",this._dialog.ifm&&(this._dialog.ifm.style.zIndex="100"),this._dialog.setContent(this.contentUrl),this._dialog.setFixed(!0),this.setPos(),scope.isFromSearchEngine&&this._searchToQing()),this._evt=new Core.Events.EventDispatcher(this),Core.Events.addEvent(n.btnClose,this.close.bind2(this)),Core.Events.addEvent(n.btnMin,this.toggle.bind2(this)),Core.Events.addEvent(window,function(){if(o._dialog&&o._dialog.entity){var e=document.documentElement.clientWidth||document.body.clientWidth,t=document.documentElement.clientHeight||document.body.clientHeight,i=Math.max(e)-o.width,n=Math.max(t)-o.height-o._toolbarHeight;scope.isFromSearchEngine&&(n-=100),o._dialog.setPosition({x:i,y:n})}},"resize")},setPos:function(){var e=document.documentElement.clientWidth||document.body.clientWidth,t=document.documentElement.clientHeight||document.body.clientHeight,i=e-this.width,n=t-this.height-this._toolbarHeight;scope.isFromSearchEngine&&(n-=100),this._dialog.setPosition({x:i,y:n})},show:function(){var e=this;this._dialog.show(),this._evt.dispatchEvent("show"),this.uiStatus="2",this._slide=new Ui.Slide($E(this._dialog.entity.id));var t=this._slide.container.style;if($IE6?(t.overflow="visible",t.height=0):t.position="absolute",this._slide.onSlideMax=function(){e._evt.dispatchEvent("max")},this._slide.slideMax=function(){this.node.style.marginTop=this.offset+"px",new Ui.tween(this.node,"marginTop",0,this.duration,this.animation,{tween:function(){}.bind2(this),end:this.onSlideMax})}.bind2(this._slide),this._slide.onSlideMin=function(){e._evt.dispatchEvent("min")},this._slide.slideMin=function(){new Ui.tween(this.node,"marginTop",this.offset-28,this.duration,this.animation,{tween:function(){}.bind2(this),end:this.onSlideMin})}.bind2(this._slide),this._slide.slideIn=function(){new Ui.tween(this.node,"marginTop",this.offset,5*this.duration,this.animation,{tween:function(){}.bind2(this),end:this.onSlideIn})}.bind2(this._slide),this._slide.onSlideIn=function(){Core.Dom.removeNode(this._dialog.entity),this._dialog.entity=null,e._evt.dispatchEvent("close"),setTimeout(function(){var e=$E("rightADWrap");e&&Core.Dom.setStyle(e,"right","0")},1e3)}.bind2(this),this._slide.slideMax(),blogAd.getInitPermission(this.oParam)){this.oParam=this.oParam.ads[0];var i=$E("rightADWrap"),n=this.width;i&&Core.Dom.setStyle(i,"right",n+"px")}},toggle:function(){if(this._dialog.nodes.btnMin){var e=this._dialog.nodes.btnMin.className;"btnMin"==e?(e="btnMax",this.uiStatus="1",this._slide.slideMin()):(e="btnMin",this.uiStatus="2",this._slide.slideMax()),this._dialog.nodes.btnMin.className=e,e=null,this.onToggle()}},close:function(){Utils.Cookie.setCookie(this._cookie,(new Date).getHours(),24,"/");var e=this;e.uiStatus="0",Lib.execZhitou(function(){var e=new sinaadToolkit.Box({position:"right bottom",width:260,height:190,follow:1});e.getMain().innerHTML='<ins class="sinaads" id="PDPS000000025956" data-ad-status="async" data-ad-pdps="PDPS000000025956"></ins>',setTimeout(function(){(sinaads=window.sinaads||[]).push({element:$E("PDPS000000025956"),params:{sinaads_success_handler:function(){e.show(),setTimeout(function(){e.hide()},5e3)}}})},1e3)}),this._slide.slideIn()},createNode:function(e){var t=$C("div");return t.innerHTML=e,t.childNodes[0]},_initClosedAD:function(){this.closedFlashTemplate=['<div id="#{panel}">','<div id="#{content}">','<div id="blogVideoAd" width="'+this.oParam.width+'" height="'+this.oParam.height+'"></div>',"</div>","</div>"].join(""),this.closedADLayer=new Ui.Panel,this.closedADLayer.setTemplate(this.closedFlashTemplate),this.closedADLayer.entity.style.zIndex="100",this.closedADLayer.__iframe&&(this.closedADLayer.__iframe.style.zIndex="100");var e=Core.System.pageSize(),t=Math.min(e[2],document.documentElement.clientWidth)-this.oParam.width,i=Math.min(e[3],document.documentElement.clientHeight)-this.oParam.height;scope.isFromSearchEngine&&(i-=100),this.closedADLayer.setFixed(!0).setPosition({x:t,y:i});var n=this.oParam,o=this.closedADLayer.nodes,s=$E("blogVideoAd");if(s)switch(n.type){case"mixed":s.innerHTML=n.content,trace(n.content);break;case"pic":s.innerHTML='<img src="'+n.ref+'" style="width:'+n.width+"px; height:"+n.height+'px;" />',n.click&&(s.style.position="relative",o.cantSeeMe=this.createNode('<a href="#" target="_blank"></a>'),o.cantSeeMe.href=n.click,o.cantSeeMe.style.cssText=($IE?"filter:alpha(opacity=0);":"opacity:0")+"; height:"+n.height+"px; width:"+n.width+"px; background:#F00; display:block;z-index:1020; position:absolute; left:0; top:0;",s.appendChild(o.cantSeeMe));break;case"swf":this.appendSwf(n.ref,"",n.width,n.height,s.id),n.click&&(s.style.position="relative",o.cantSeeMe=this.createNode('<a href="#" target="_blank"></a>'),o.cantSeeMe.href=n.click,o.cantSeeMe.style.cssText=($IE?"filter:alpha(opacity=0);":"opacity:0")+"; height:"+n.height+"px; width:"+n.width+"px; background:#F00; display:block;z-index:1020; position:absolute; left:0; top:0;",s.appendChild(o.cantSeeMe))}},appendSwf:function(e,t,i,n,o){if("undefined"!=typeof sinaFlash){var s=new sinaFlash(e,t,i+"",n+"","9","#FFFFFF",!1,"High","http://www.sina.com.cn/","http://www.sina.com.cn/",!1);s.addParam("allowScriptAccess","always"),s.addParam("wmode","transparent"),s.write(o)}},onToggle:function(){},addEventListener:function(e,t){this._evt.addEventListener(e,t)},getHeight:function(){var e=this.closedADLayer,t=0;return this._dialog.entity&&(trace("dialog height"),t=this._dialog.entity.clientHeight-parseInt(this._slide.node.style.marginTop),trace("dialog height"+t)),e&&(trace("flash height===="),t=e.clientHeight,trace("flash height===="+t)),t},_searchToQing:function(){var e=this;Core.Events.addEvent($E("serachToQingCloseBtn"),function(){if(scope.isFromSearchEngine){if(scope.isFromSearchEngine=!1,e._dialog&&e._dialog.entity){var t=Math.max(document.documentElement.clientHeight)-e.height-e._toolbarHeight,i=Math.max(document.documentElement.clientWidth)-e.width;e._dialog.setPosition({x:i,y:t})}if(e.closedADLayer&&e.closedADLayer.entity){var n=e.closedADLayer.entity,o=n.style.top;n.style.top=parseInt(o)+100+"px"}}},"click")}},Lib.ADBlogRecommendDialog=Core.Class.create(),Lib.ADBlogRecommendDialog.prototype={template:['<div id="#{panel}" class="popBox">','<div id="#{frame}" class="popBox_bg">','<div id="#{popFlashContent}" class="popFlash" style="z-index:10;">','<a target="_blank" id="#{clickURL}" style="display:none;position:absolute;"></a>',"</div>",'<div id="#{popMain_bg}" class="popMain_bg" style="z-index:11;"></div>','<div class="popMain" style="z-index:12">','<div id="#{content}">',"</div>","</div>",'<div id="#{titleBar}" class="popBox_btn" style="z-index:12;">','<a id="#{btnMin}" href="#" onclick="return false;" title="" class="mini"></a>','<a id="blogNorAd_Cls" href="#" onclick="return false;" title="" class="close"></a>',"</div>","</div>","</div>"].join(""),contentUrl:'<iframe style="width:100%;height:185px;" allowtransparency="yes" frameborder="0" scrolling="no" src="http://blog.sina.com.cn/lm/mini/noborder/01.html"></iframe>',name:"blogRecoDialog",_slide:null,_dialog:null,_cookie:"ad680",_mode:null,_timePoints:null,flashURL:"",picURL:"",flashWidth:0,flashHeight:0,tjURL:"",btnURL:"",clickURL:"",_toolbarHeight:0,width:262,height:255,isMin:!1,displayState:"max",closedADLayer:null,closedFlashTemplate:"",_evt:null,initialize:function(e,t,i,n,o,s,a,r,l,c){var d,h=this;this._mode=e,this.flashURL=n,this.picURL=i,this.flashWidth=o,this.flashHeight=s,this.tjURL=a,this.btnURL=r,this.clickURL=l,this._timePoints=t,this.oParam=c,+c.code||(this.isShowClosedAD=!0),this._dialog||(this._dialog=new Ui.Panel,this._dialog.setTemplate(this.template),d=this._dialog.nodes,d.btnClose=$E("blogNorAd_Cls"),this._dialog.entity.style.zIndex="100",this._dialog.ifm&&(this._dialog.ifm.style.zIndex="100"),this._dialog.setContent(this.contentUrl),this._dialog.setFixed(!0),this.setPos(),scope.isFromSearchEngine&&this._searchToQing()),this._evt=new Core.Events.EventDispatcher(this),Core.Events.addEvent(d.btnClose,this.close.bind2(this)),Core.Events.addEvent(d.btnMin,this.toggle.bind2(this)),Core.Events.addEvent(window,function(){if(h._dialog&&h._dialog.entity){var e=Math.max(document.documentElement.clientHeight)-h.height-h._toolbarHeight,t=Math.max(document.documentElement.clientWidth)-h.width;scope.isFromSearchEngine&&(e-=100),h._dialog.setPosition({x:t,y:e})}},"resize"),!this.clickURL&&this.initFlashAD(d.popFlashContent.id)},setPos:function(){var e=document.documentElement.clientWidth||document.body.clientWidth,t=document.documentElement.clientHeight||document.body.clientHeight,i=e-this.width,n=t-this.height-this._toolbarHeight;scope.isFromSearchEngine&&(n-=100),this._dialog.setPosition({x:i,y:n})},initFlashAD:function(e){var t=new sinaFlash(this.flashURL,"popSmallFlash",this.flashWidth,this.flashHeight,"8","#FFFFFF",!1,"High","http://www.sina.com.cn/","http://www.sina.com.cn/",!1);t.addParam("allowScriptAccess","always"),t.addParam("wmode","transparent"),t.write(e)},show:function(){var e=this._dialog.nodes;e.frame.style.backgroundImage="url("+this.picURL+")",e.btnClose.style.backgroundImage="url("+this.btnURL+")",e.btnMin.style.backgroundImage="url("+this.btnURL+")",e.popMain_bg.style.backgroundImage="url("+this.tjURL+")",this.clickURL&&(e.clickURL.style.display="",e.clickURL.style.width=(this.flashWidth||260)+"px",e.clickURL.style.height=(this.flashHeight||50)+"px",e.clickURL.href=this.clickURL);var t=this;this._dialog.show(),this._evt.dispatchEvent("show"),this.uiStatus="2",this._slide=new Ui.Slide($E(this._dialog.entity.id));var i=this._slide.container.style;if($IE6?(i.overflow="visible",i.height=0):i.position="absolute",this._slide.onSlideMax=function(){t._evt.dispatchEvent("max")},this._slide.slideMax=function(){this.node.style.marginTop=this.offset+"px",new Ui.tween(this.node,"marginTop",0,this.duration,this.animation,{tween:function(){}.bind2(this),end:this.onSlideMax})}.bind2(this._slide),this._slide.onSlideMin=function(){t._evt.dispatchEvent("min")},this._slide.slideMin=function(){new Ui.tween(this.node,"marginTop",this.offset-55,this.duration,this.animation,{tween:function(){}.bind2(this),end:this.onSlideMin})}.bind2(this._slide),this._slide.slideIn=function(){new Ui.tween(this.node,"marginTop",this.offset,5*this.duration,this.animation,{tween:function(){}.bind2(this),end:this.onSlideIn})
}.bind2(this._slide),this._slide.onSlideIn=function(){Core.Dom.removeNode(this._dialog.entity),this._dialog.entity=null,t._evt.dispatchEvent("close"),setTimeout(function(){var e=$E("rightADWrap");e&&Core.Dom.setStyle(e,"right","0")},1e3)}.bind2(this),this._slide.slideMax(),blogAd.getInitPermission(this.oParam)){this.oParam=this.oParam.ads[0],commonLog("http://1088.adsina.allyes.com/main/adfshow?user=AFP6_for_SINA|2012_add|2012_blog_fdtc_bk&db=sina&border=0&local=yes&js=ie");var n=$E("rightADWrap");n&&Core.Dom.setStyle(n,"right","260px")}},toggle:function(){this._dialog.nodes.btnMin&&("max"==this.displayState?(this.uiStatus="1",this._slide.slideMin(),this.displayState="min"):(this.uiStatus="2",this._slide.slideMax(),this.displayState="max"),this.onToggle())},close:function(){Utils.Cookie.setCookie(this._cookie,(new Date).getHours(),24,"/");var e=this;e.uiStatus="0",Lib.execZhitou(function(){var e=new sinaadToolkit.Box({position:"right bottom",width:260,height:190,follow:1});e.getMain().innerHTML='<ins class="sinaads" id="PDPS000000025956" data-ad-status="async" data-ad-pdps="PDPS000000025956"></ins>',setTimeout(function(){(sinaads=window.sinaads||[]).push({element:$E("PDPS000000025956"),params:{sinaads_success_handler:function(){e.show(),setTimeout(function(){e.hide()},5e3)}}})},1e3)}),this._slide.slideIn()},createNode:function(e){var t=$C("div");return t.innerHTML=e,t.childNodes[0]},appendSwf:function(e,t,i,n,o){if("undefined"!=typeof sinaFlash){var s=new sinaFlash(e,t,i+"",n+"","9","#FFFFFF",!1,"High","http://www.sina.com.cn/","http://www.sina.com.cn/",!1);s.addParam("allowScriptAccess","always"),s.addParam("wmode","transparent"),s.write(o)}},onToggle:function(){},addEventListener:function(e,t){this._evt.addEventListener(e,t)},getHeight:function(){var e=this.closedADLayer,t=0;return this._dialog.entity&&(trace("dialog height"),t=this._dialog.entity.clientHeight-parseInt(this._slide.node.style.marginTop),trace("dialog height"+t)),e&&"none"!=e.entity.style.display&&(trace("flash height===="),t=this.oParam.height,trace("flash height===="+t)),t},_searchToQing:function(){var e=this;Core.Events.addEvent($E("serachToQingCloseBtn"),function(){if(scope.isFromSearchEngine){if(scope.isFromSearchEngine=!1,e._dialog&&e._dialog.entity){var t=Math.max(document.documentElement.clientHeight)-e.height-e._toolbarHeight,i=Math.max(document.documentElement.clientWidth)-e.width;e._dialog.setPosition({x:i,y:t})}if(e.closedADLayer&&e.closedADLayer.entity){var n=e.closedADLayer.entity,o=n.style.top;n.style.top=parseInt(o)+100+"px"}}},"click")}},Core.System.getParam=function(e){var t=window.location.search.match(new RegExp("(\\?|&)"+e+"=([^&]*)(&|$)"));return null!=t?unescape(t[2]):null},scope.searchEngineList={"www.google.com":{param:"q",encode:"utf-8"},"www.google.com.hk":{param:"q",encode:"utf-8"},"www.baidu.com":{param:"wd",encode:"gbk"},"www.soso.com":{param:"w",encode:"gbk"},"cn.yahoo.com":{param:"p",encode:"utf-8"},"search.yahoo.com":{param:"p",encode:"utf-8"},"web.gougou.com":{param:"search",encode:"utf-8"},"cn.bing.com":{param:"q",encode:"utf-8"},"www.youdao.com":{param:"q",encode:"utf-8"},"www.sogou.com":{param:"query",encode:"gbk"},"uni.sina.com.cn":{param:"k",encode:"gbk"},"search.sina.com.cn":{param:"q",encode:"utf-8"}},scope.searchFloatingLayerTemplate=['<div id="statBottomforniangs" class="blog_sfout">','<div class="blog_srhflt">','<div id="searchFloatingLayer_LeftContentArea" class="blog_sfL">','<div class="blog_sfTit"><a href="#" onclick="v7sendLog && v7sendLog(\'85_01_01\');return false;" id="searchFloatingLayer_RelatedArticle" target="_blank">相关博文</a></div>','<div class="blog_sflist">','<ul id="searchFloatingLayer_RelatedArticleList"></ul>','<span class="SG_more"><a href="#" onclick="v7sendLog && v7sendLog(\'85_01_04\');return false;" id="searchFloatingLayer_More" target="_blank">更多&gt;&gt;</a></span>',"</div>","</div>",'<div class="blog_sM" id="searchFloatingLayer_ad"></div>','<div class="blog_sfR">','<div class="mren">',"<strong>看看名嘴们都在说什么</strong>",'<ul class="mren_list" id="searchFloatingLayer_CelebrityList"></ul>','<div class="clear"></div>',"</div>","</div>",'<div class="clear"></div>',"</div>",'<div class="blog_sfClo"><a id="searchFloatingLayer_CloseBtn" href="#" onclick="return false;"></a></div>',"</div>"].join(""),scope.searchFloatingLayer={dataURL:"http://control.blog.sina.com.cn/riaapi/article/search_recommend.php",isDisplay:function(){var e=new Utils.Url(window.location.href).anchor||{},t=e.sFLKeyword,i=document.referrer;if("blog.sina.com.cn"===window.location.host&&t)return this.keyword=t,this.encode=e.sFLEncode||"utf-8",!0;if(i){var n=scope.searchEngineList,o=new Utils.Url(i);for(var s in n)if(o.url.indexOf(s)>-1)return this.keyword=o.getParam(n[s].param),this.encode="search.sina.com.cn"!==s&&"www.baidu.com"!==s||!o.getParam("ie")?n[s].encode:o.getParam("ie"),!0}},displayFloatingLayer:function(e){var t=this;blogAd.getInitPermission(e)&&(e=e.ads[0],Utils.Io.JsLoad.request(this.dataURL,{charset:"utf-8",noencode:!0,GET:{encode:this.encode,keyword:this.keyword},onComplete:function(i){i&&"A00006"===i.code&&t.createFloatingLayerWithData(i.data,e)}}))},createFloatingLayerWithData:function(e,t){function i(e){var t=document.documentElement.clientWidth,i=document.documentElement.clientHeight;n.setPosition({x:0,y:i-(e?0:n.entity.offsetHeight)}),$E("statBottomforniangs").style.width=t+"px"}if(!e.relatedArticle||0!==e.relatedArticle.length){var n=new Ui.Panel;n.setTemplate('<div id="#{panel}">'+scope.searchFloatingLayerTemplate+"</div>").setFixed(!0),n.show(),n.entity.style.zIndex="9999",i($IE6?"":"first"),Core.Events.addEvent($E("searchFloatingLayer_CloseBtn"),function(){n.destroy()}),Core.Events.addEvent(window,function(){i()},"resize",!1),this.updateContent(e,t),!$IE6&&this.playDisplayEffect(n)}},updateContent:function(e,t){var i,n,o=e.relatedArticle,s=e.celebrity,a=[],r=[],l="http://search.sina.com.cn/?c=blog&by=title&range=all&q="+this.keyword+"&ie="+this.encode,c=$E("searchFloatingLayer_ad");for(i=0;i<o.length&&2>i;i++)a[a.length]="<li>",o[i].isRecommend&&(a[a.length]='<img class="SG_icon SG_icon107" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="18" height="18" title="推荐" align="absmiddle" />'),a[a.length]="<a onclick=\"v7sendLog && v7sendLog('85_01_0"+(2+i)+'\');" href="'+o[i].url.replace(/\?.*/,"")+"#sFLKeyword="+this.keyword+"&sFLEncode="+this.encode+'" target="_blank">'+o[i].title.replace(e.keyword,'<span class="blog_sfNm">'+e.keyword+"</span>")+"</a>",a[a.length]="</li>";for(1===o.length&&($E("searchFloatingLayer_LeftContentArea").className="blog_sfL blog_onlyone"),1===e.type&&($E("searchFloatingLayer_RelatedArticle").parentNode.className="blog_sfTit blog_nofTit"),$E("searchFloatingLayer_RelatedArticleList").innerHTML=a.join(""),i=0;i<s.length&&5>i;i++)r[r.length]="<li>",r[r.length]="<a onclick='v7sendLog && v7sendLog(\"85_01_0"+(5+i)+"\");' href='http://blog.sina.com.cn/u/"+s[i].uid+"#sFLKeyword="+encodeURIComponent(s[i].uname)+"&sFLEncode=utf-8' target='_blank'>"+s[i].uname+"</a>",r[r.length]="</li>";$E("searchFloatingLayer_CelebrityList").innerHTML=r.join(""),$E("searchFloatingLayer_RelatedArticle").href=l,$E("searchFloatingLayer_More").href=l+"&s=2",t&&c&&("swf"==t.type?this.appendSwf(t.ref,"",t.width,t.height,c):(c.style.cssText="height:"+t.height+"px; width:"+t.width+"px;",c.innerHTML="<img src='"+t.ref+"' alt=''/>"),t.click&&(c.style.position="relative",n=this.createNode('<a href="#" target="_blank"></a>'),n.href=t.click,n.style.cssText=($IE?"filter:alpha(opacity=0);":"opacity:0")+"; height:"+t.height+"px; width:"+t.width+"px; background:#F00; display:block;z-index:1020; position:absolute; left:0; top:0;",c.appendChild(n)),c.style.marginTop=parseInt((70-t.height)/2)+"px")},createNode:function(e){var t=$C("div");return t.innerHTML=e,t.childNodes[0]},playDisplayEffect:function(e){var t=e.entity,i=parseInt(t.style.top),n=new Ui.TweenStrategy(i,i-t.offsetHeight,.5);n.onTween=function(e){t.style.top=e+"px"},n.onEnd=function(){e.setPosition({x:0,y:document.documentElement.clientHeight-t.offsetHeight})},n.start()},appendSwf:function(e,t,i,n,o){if("undefined"!=typeof sinaFlash){var s=new sinaFlash(e,t,i+"",n+"","9","#FFFFFF",!1,"High","http://www.sina.com.cn/","http://www.sina.com.cn/",!1);s.addParam("allowScriptAccess","always"),s.addParam("wmode","transparent"),s.write(o)}}},$registJob("outSearch",function(){function e(){Utils.Io.JsLoad.request("http://pfp.sina.com.cn/blog/js/blogad.js",{charset:"gb2312",onComplete:function(){"undefined"!=typeof BlogAd&&t()},isRemove:!1})}function t(){new BlogAd({pos:"jumpin"}).getAd(function(e){+e.code||Utils.Io.loadExternalCSS($_GLOBAL.cssBasicURL+"module/layer/re_seach.css",function(){var t=scope.searchFloatingLayer;t.isDisplay()&&t.displayFloatingLayer(e)})})}("undefined"==typeof BlogAd?e:t)()}),blogAd.popAd=function(){function e(){var e=document.cookie.match(/(?:ad|dlg)680=(\d+)/);return e?t(e[1])!==t((new Date).getHours()):!0}function t(e){return e>21?1:e>14?3:e>7?2:1}function i(){o._dialog.entity?"none"==o._dialog.entity.style.display&&$callJob("outSearch"):$callJob("outSearch")}function n(e){for(var t=0;t<e.length;t++)commonLog&&commonLog(e[t])}var o,s=1,a=!1,r={code:"2101",ads:{0:{type:"mixed"}}},l={};return null==scope.handler_680?(scope.handler_680=null,l.renderPopAd=function(t){if(0==e())return void $callJob("outSearch");var l=t&&t.isAD;if(l){var c="?"+(new Date).getTime();t.flashURL&&(t.flashURL+=c),t.picURL&&(t.picURL+=c),t.borderImg&&(t.borderImg+=c),t.btnImg&&(t.btnImg+=c),o=new Lib.ADBlogRecommendDialog("once",s,t.picURL,t.flashURL,t.flashWidth,t.flashHeight,t.borderImg,t.btnImg,t.clickUrl,r),o.onToggle=function(){a=!0};var d=new Image;d.onload=function(){scope.handler_680=o,scope.Bind680EventHandler&&scope.Bind680EventHandler(),o.show(),i(),setTimeout(function(){!a&&o._slide&&"max"==o.displayState&&o.toggle()},6e4),d=null},d.src=t.picURL;var h=!1;t.logurls&&o.addEventListener("show",function(){h||(h=!0,Core.Events.addEvent(o._dialog.nodes.popFlashContent,Core.Function.bind3(n,this,[t.logurls]),"click"))})}else o=new Lib.BlogRecommendDialog("once",s,r),o.onToggle=function(){a=!0},scope.handler_680=o,scope.Bind680EventHandler&&scope.Bind680EventHandler(),o.show(),i(),setTimeout(function(){!a&&o._slide&&"btnMin"==o._dialog.nodes.btnMin.className&&o.toggle()},6e4)},l):void 0},$registJob("tjAd",function(){scope.isFromSearchEngine=Article.getSearchReferrer();var e=window.location.href.indexOf("tj=1")>-1,t=scope.$pageid.indexOf("articletj")>-1;new blogAd.CommAd,function(){if(!t&&e&&Lib.execZhitou(function(){function e(){var e=$E("sinabloga");if(e){var t=$E("ramdomVisitDiv");t&&(t.style.top=e.offsetTop+"px")}}var t=Lib.Listener,i=blogAd.insertIns("PDPS000000049439",$E("trayFlashConnetion").parentNode,"beforebegin");t.notify("topad680-show-start",{}),(window.sinaads||[]).push({element:i,params:{sinaads_success_handler:function(){e(),t.notify("topad680-show-end",{show:!0})},sinaads_fail_handler:function(){e(),t.notify("topad680-show-end",{show:!1})}}})}),Lib.execZhitou(function(){var e=blogAd.insertIns("PDPS000000051781");e.style.display="none";var t=blogAd.popAd();(window.sinaads||[]).push({element:e,params:{sinaads_success_handler:function(e,i){function n(e){var t={};return 0===i.content[0].src[0].replace(/(^\s*)|(\s*$)/g,"").length?t.isAD=!1:t={isAD:!0,flashURL:"http://d3.sina.com.cn/litong/kuaijieweibo/yafeng/boke/sc/bk.swf",flashWidth:293,flashHeight:60,picURL:e.content[0].src[0],clickUrl:e.content[0].link[0],borderImg:"http://d1.sina.com.cn/litong/kuaijieweibo/yafeng/boke/images/imgbgnn.gif",btnImg:"http://d1.sina.com.cn/201007/09/237719_btn.gif",logurls:e.content[0].monitor},t}e.style.display="none";var o;o=n(i),t.renderPopAd(o)},sinaads_fail_handler:function(e){e.style.display="none",t.renderPopAd({isAD:!1})}}})}),!t){Lib.checkAuthor();var i=!$isAdmin;if(!i)return;Lib.execZhitou(function(){var e,t=$E("module_910")||$E("module_911");if(t&&(e=SinaEx.prev(t)),!e){var i=$E("module_904")||$E("module_903"),n=i.parentNode.children;e=3>n.length?i.parentNode.lastChild:n[2]}var o=blogAd.insertIns("PDPS000000033239",e,"afterend");(window.sinaads||[]).push({element:o,params:{sinaads_success_handler:function(){o.style.marginBottom="10px"}}})})}}()}),Utils.Io.TimeoutJsLoad=function(e,t){if(this._opts={url:"",charset:"utf-8",noreturn:!1,noencode:!1,timeout:-1,GET:{},onComplete:null,onException:null,type:"blogScript",jsonpParamName:"callback"},!e||"string"!=typeof e)throw new Error("url参数不能为空!");this._opts.url=e,this.isAborted=!1,this.scriptIdentifier="",this.varname="",this.loadComplete=!1,this.timeObj,Core.System.parseParam(this._opts,t),this.loadScript()},Utils.Io.TimeoutJsLoad.prototype={constructor:Utils.Io.TimeoutJsLoad,__jsonpCounter:(new Date).getTime(),loadScript:function(){function e(e){var a=t.type;if("blogScript"!==a||!i||!i.readyState||"loaded"==i.readyState||"complete"==i.readyState){if(o.loadComplete=!0,"jsonp"===a){window[s]=void 0;try{delete window[s]}catch(r){}}else"blogScript"===a&&(i.onload=i.onreadystatechange=i.onerror=null);n.removeChild(i),o.isAborted||"function"!=typeof t.onComplete||(o.timeObj&&clearTimeout(o.timeObj),t.onComplete("blogScript"===a?window[o.varname]:e))}}var t=this._opts,i=$C("script"),n=$T(document,"head")[0],o=this,s=this._processUrl();i.async=!0,i.src=t.url,i.charset=t.charset,i.id="script"+this.scriptIdentifier,"jsonp"===t.type?window[s]=e:"blogScript"===t.type&&(i.onload=i.onerror=i.onreadystatechange=e),n.insertBefore(i,n.firstChild),t.timeout>0&&(this.timeObj=setTimeout(function(){o.abortRequest()},t.timeout))},abortRequest:function(){this.loadComplete||(this.isAborted=!0,/opera/i.test(navigator.userAgent)&&$E("script"+this.scriptIdentifier)&&($E("script"+this.scriptIdentifier).src=""),"function"==typeof this._opts.onException&&this._opts.onException())},_processUrl:function(){var e,t=this._opts,i=t.url,n=t.GET,o=window.parseInt(1e8*Math.random()),s=new Utils.Url(i);for(e in n)s.setParam(e,t.noencode===!0?n[e]:Core.String.encodeDoubleByte(n[e]));if(this.scriptIdentifier=o,"blogScript"===t.type)this.varname=s.getParam("varname")||"requestId_"+o,t.noreturn!==!0&&s.setParam("varname",this.varname);else if("jsonp"===t.type){var a="jsonp"+this.constructor.prototype.__jsonpCounter++;s.setParam(t.jsonpParamName,a)}return t.url=s.toString(),a}},$registJob("tranVideo",function(){function e(){var e=navigator.userAgent.toLowerCase();return{isIpad:null!=e.match(/ipad/i),isIphone:null!=e.match(/iphone/i),isIpod:null!=e.match(/ipod/i)}}var t=e();if(t.isIpad||t.isIphone||t.isIpod){var i=(Utils.Io.JsLoad.request,Utils.Io.TimeoutJsLoad),n=(Core.Dom.insertHTML,Core.String.j2o,{getVid:function(e){var t=new RegExp("vid=([^&]*)?&","i"),i=e.match(t);return i?i[1]||"":""},createVideoTag:function(e){var t="http://video.sina.com.cn/api/getIpadUrl.php?url="+encodeURIComponent(e.src.replace(".swf",""));new i(t,{type:"blogScript",GET:{rmd:Math.random()},onComplete:function(t){if(""!=t.ipad_url){e.style.display="none";var i=$C("video");i.className="video",i.setAttribute("width","482px"),i.setAttribute("height","388px"),i.setAttribute("controls","controls"),i.setAttribute("src",t.ipad_url),e.parentNode.insertBefore(i,e)}},onException:Function()})}});allEmbed=document.getElementsByTagName("embed");for(var o=0;o<allEmbed.length;o++)(-1!=allEmbed[o].src.indexOf("http://p.you.video.sina.com.cn")||-1!=allEmbed[o].src.indexOf("http://you.video.sina.com.cn"))&&n.createVideoTag(allEmbed[o])}}),$registJob("errorTips",function(){function e(e){var t=$C("div");return t.innerHTML=e,t.firstChild}Lib.checkAuthor(),$isLogin&&Utils.Io.JsLoad.request("http://control.blog.sina.com.cn/riaapi/warning.php",{GET:{uid:$UID},onComplete:function(t){function i(){var e=Core.Dom.getXY(o),t=n.offsetWidth;n.style.visibility="inherit",n.style.top=e[1]+23+"px",n.style.left=e[0]-t+41+"px"}var n,o;if(t&&1==t.iswarning){var s=Utils.Cookie.getCookie("i8t9c"+$UID)!==t.date?"block":"none",a='<div id="err_i8t9c" class="tb_layer_Y tb_layer_w6" style="display:'+s+';z-index:500;position:absolute;top:-300px;"><div class="tb_layer_arrow" style="margin:0 0;left:219px"></div><div class="tb_layer_Y_main"><div class="tb_mas"><span style="float:right;"><a class="conn" href="javascript:;" onclick="scope.i8t9c()">×</a></span></div><div class="tb_mas">'+t.msg+'<p style="text-align:center;padding:6px;"><input type="button" value="知道了" onclick="scope.i8t9c()" /></p></div></div></div></div>';scope.i8t9c=function(){$E("err_i8t9c").style.display="none",Utils.Cookie.setCookie("i8t9c"+$UID,t.date,8760,"/"),Utils.Cookie.setCookie("i8t9c"+$UID,t.date,8760,"/","blog.sina.com.cn")},scope.i8t9c.show=function(){$E("err_i8t9c").style.display="",i()},n=e(a),document.body.appendChild(n);var r=$E("loginBarActivity");o=e('<div class="topbar_activity"><a href="javascript:;" onclick="scope.i8t9c&&scope.i8t9c.show();">[公告]</a></div>'),r.parentNode.insertBefore(o,r),setTimeout(i,10),Core.Events.addEvent(window,function(){i()},"resize");{document.documentElement.scrollTop+document.body.scrollTop}}}})});var ReblogToQing=Core.Class.create();ReblogToQing.prototype={saving:!1,blogId:"",initialize:function(){},reblog:function(e){if(this.blogId=e,!this.blogId)throw new Error("转载博文ID未定义");this.checkUser(this.blogId)},checkUser:function(e){this.blogId=e||scope.$blogId,Lib.checkAuthor();var t=this;if($isLogin){var t=this;scope.blogOpener.showDialog(function(){t.save()})}else v7sendLog("48_01_32"),(new Lib.Login.Ui).login(function(){scope.blogOpener.showDialog(function(){t.save.bind2(t)()})})},save:function(){var e=this;if(!this.saving){this.saving=!0;var t={version:7,blogId:e.blogId,rnd:+new Date},i=function(){winDialog.alert("对不起，系统繁忙请稍后！",{icon:"01",funcOk:function(){}})},n="http://control.blog.sina.com.cn/blog_rebuild/riaapi/blog/share2qing.php?rnd="+ +new Date;Utils.Io.Ijax.request(n,{POST:t,returnType:"json",onComplete:function(n){if(this.saving=!1,!n)return void i();try{n=new Function("return "+n)()}catch(o){i()}"A00006"==n.code?(winDialog.alert(["已成功转载到Qing博客！<br/><span style='font-weight: 100; font-size: 12px;'>",n.data.qingId?"<a target='_blank' href='"+$_GLOBAL.qingURL+n.data.userId+"/"+n.data.qingId+".html'>去查看已转载的文章>></a>":"","</span>"].join(""),{icon:"03"}),e.onSuccess(n,t)):"A00420"==n.code?e.showOpenQingWnd():"A00421"==n.code?e.showShareToQingFailure():i()}.bind2(this),onException:function(e){return this.saving=!1,e?void 0:void i()}.bind2(this)})}},showOpenQingWnd:function(){var e=winDialog.createCustomsDialog({content:['<div class="CP_layercon2 unilayer">','<div class="CP_prompt toQing">','<table class="CP_w_ttl"><tbody><tr><td>您的新浪博客账号未开通Qing。开通后可转载到Qing中。</td></tr></tbody></table>','<p class="CP_w_btns_Mid"><a id="#{openQing}" class="SG_aBtn SG_aBtnB" href="'+$_GLOBAL.qingURL+'home" target="_blank"><cite>开通Qing</cite></a>','&nbsp;&nbsp;<a id="#{cancel}" class="SG_aBtn SG_aBtnB" href="javascript:void(0);"><cite>取消</cite></a></p>',"</div>","</div>"].join(""),shadow:1},"openQing");e.setMiddle(),e.show(),e.nodes.openQing.onclick=function(){setTimeout(function(){e.close(),e.onclick=null,e=null},200)},e.nodes.cancel.onclick=function(){setTimeout(function(){e.close(),e.onclick=null,e=null},200)}},showShareToQingFailure:function(){var e="对不起，转载至Qing博客失败。";winDialog.alert(e,{icon:"01",funcOk:function(){}})},onSuccess:function(){},onError:function(){}},$registJob("renderReblogDiv",function(){function showError(e,t){if(e.message)var i=e.message;winDialog.alert(i,{icon:t||"01"})}var _addEvent=Core.Events.addEvent,_getEventTarget=Core.Events.getEventTarget,_getXY=Core.Dom.getXY,delegateEl,delegateElId,reblogDivId="reblog_"+ +new Date,reblogDivInnerHTML='<ul><li><a action-type="click_reblog" action-data="{action:\'toQing\'}" href="javascript:void(0);" title="转载到Qing博客"><img width="15" height="15" align="absmiddle" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" class="SG_icon SG_icon205"/>Qing</a></li><li><a action-type="click_reblog" action-data="{action:\'toBlog\'}" href="javascript:void(0);" title="转载到博客"><img width="18" height="18" align="absmiddle" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" class="SG_icon SG_icon141"/>博客</a></li><li style="display:none;"><a action-type="click_reblog" action-data="{action:\'toBlog\'}" href="javascript:void(0);" title="转载原文"><img width="18" height="18" align="absmiddle" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" class="SG_icon SG_icon141"/>转载原文</a></li><li style="display:none"><a action-type="click_reblog" action-data="{action:\'editor\'}" href="javascript:void(0);" title="采编"><img width="18" height="18" align="absmiddle" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" class="SG_icon SG_icon142"/>采编</a></li><li><a action-type="click_reblog" action-data="{action:\'cwb\'}" href="javascript:;" title="发布长微博"><img width="18" height="18" align="absmiddle" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" class="SG_icon SG_icon143"/>长微博</a></li></ul>',reblogDiv=SinaEx.createNode('<div id="'+reblogDivId+'" class="turnList" style="display:none;position:absolute;z-index:20;">'+reblogDivInnerHTML+"</div>");document.body.appendChild(reblogDiv);var getActionData=Lib.util.getActionData,sinablogbody=$E("sinablogbody"),idCard,reblogBtn,isIdCard=!1,isValidateIdentity=0,onMouseOverReblogBtn=function(e){var srcEl=$E(this.id),tEl=_getEventTarget(e),eventData=getActionData(e,"reblog");if(eventData){$E("sinablogbody").setAttribute("ismouseover","1");var data=eval("("+eventData.data+")");reblogBtn=eventData.targetEl.parentNode.parentNode,setTimeout(function(){var e=$E("sinablogbody").getAttribute("ismouseover")||0;if(e=parseInt(e)||parseInt($E(reblogDivId).getAttribute("ismouseover")||0)){var t=$E(reblogDivId),i=_getXY(eventData.targetEl);t.style.display="",t.style.top=i[1]+23+"px",t.style.left=$IE6||$IE7?i[0]-2+"px":i[0]+"px",t.setAttribute("blogId",data.blogId),Lib.checkAuthor();var n=t.children[0].children[3].children[0];n.innerHTML=reblogBtn.getAttribute("isreblog")?'<img width="18" height="18" align="absmiddle" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" class="SG_icon SG_icon142"/>已采编':'<img width="18" height="18" align="absmiddle" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" class="SG_icon SG_icon142"/>采编';var o=t.children[0];setTimeout(function(){if(data.srcBlog?(t.children[0].children[2].style.display="none",o.children[1].style.display=$isAdmin?"none":""):(o.children[1].style.display="none",o.children[2].style.display=$isAdmin?"none":""),"0"==data.srcBlog&&(t.children[0].children[3].style.display="none"),!isIdCard||!reblogBtn.getAttribute("isshow"))if("1"==data.srcBlog&&$isLogin){if(isValidateIdentity)return;Utils.Io.Ijax.request("http://control.blog.sina.com.cn/blog_rebuild/riaapi/blog/qingEditing.php",{onComplete:function(e){var t=Core.String.j2o(e);"A00006"===t.code&&(idCard=t.data.message,idCard&&(o.children[3].style.display="")),isIdCard=!0,reblogBtn.setAttribute("isshow","1")}})}else o.children[3].style.display="none"},2)}},400)}},onMouseOutReblogBtn=function(e){var t=($E(this.id),_getEventTarget(e),getActionData(e,"reblog"));if(t){$E("sinablogbody").setAttribute("ismouseover","0");var i=$E("sinablogbody").getAttribute("timer");if(!i)var i=setInterval(function(){var e=$E("sinablogbody").getAttribute("ismouseover")||0,t=$E(reblogDivId).getAttribute("ismouseover")||0;e=parseInt(e)||parseInt(t),e||($E(reblogDivId).style.display="none",$E("sinablogbody").removeAttribute("timer"),clearInterval(i))},1e3)}},MOUSEOVER="mouseover",MOUSEOUT="mouseout",addModuleMouseEvent=function(e){if(!$E(e))return void trace("没有组件："+e);try{"articletjTech"===scope.$pageid&&(t=$E(e),_addEvent(t,Core.Function.bind2(onMouseOverReblogBtn,t),MOUSEOVER),_addEvent(t,Core.Function.bind2(onMouseOutReblogBtn,t),MOUSEOUT));var t=$E(e).children[1];t&&"SG_connBody"==t.className&&(t.id=e+"_SG_connBody",_addEvent(t,Core.Function.bind2(onMouseOverReblogBtn,t),MOUSEOVER),_addEvent(t,Core.Function.bind2(onMouseOutReblogBtn,t),MOUSEOUT))}catch(i){trace("注册转载博问按钮事件代理出错，组件ID："+e)}};addModuleMouseEvent("module_10001"),addModuleMouseEvent("module_10002"),addModuleMouseEvent("module_10003"),addModuleMouseEvent("module_920"),addModuleMouseEvent("module_921"),addModuleMouseEvent("module_3001_SG_connBody");var onMouseOverReblogDiv=function(){$E(reblogDivId).setAttribute("ismouseover",1)},onMouseOutReblogDiv=function(){$E(reblogDivId).setAttribute("ismouseover",0)};_addEvent(reblogDiv,onMouseOverReblogDiv,MOUSEOVER),_addEvent(reblogDiv,onMouseOutReblogDiv,MOUSEOUT),!scope.article_quote&&(scope.article_quote=new Quote),scope.articel_quote_alert=function(e){scope.article_quote.check(e)};var reblogToQing=new ReblogToQing,reblog=function(e){var srcEl=$E(reblogDivId),tEl=_getEventTarget(e),eventData=getActionData(e,"click_reblog");if(eventData&&"1"!==reblogBtn.getAttribute("isreblog")){var blogId=$E(reblogDivId).getAttribute("blogId"),data=eval("("+eventData.data+")");"toQing"===data.action?reblogToQing.reblog(blogId):"cwb"===data.action?window.open("http://control.blog.sina.com.cn/admin/article/changWeiBo.php?url="+encodeURIComponent("http://blog.sina.com.cn/s/blog_"+blogId+".html")):"editor"===data.action?winDialog.confirm("确定采编至 #"+idCard+" 标签下",{icon:"04",funcOk:function(){var e="http://control.blog.sina.com.cn/blog_rebuild/riaapi/blog/editing2qing.php?rnd="+ +new Date;Utils.Io.Ijax.request(e,{POST:{blogId:blogId},returnType:"json",onComplete:function(e){var t=Core.String.j2o(e);t&&"B00015"===t.code?(winDialog.alert("采编 #"+idCard+" 成功",{icon:"03"}),tEl.innerHTML='<img width="18" height="18" align="absmiddle" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" class="SG_icon SG_icon142"/>已采编',reblogBtn.setAttribute("isReblog","1")):t&&t.code?showError(t.data,"01"):winDialog.alert("系统繁忙，请稍后在试！",{icon:"01"})}})},funcClose:function(){},textOk:"确定",isAdamant:$IE}):scope.articel_quote_alert(blogId),v7sendLog&&v7sendLog("79_01_22",scope.$pageid,"qingLink")}};_addEvent(reblogDiv,reblog,"click"),reblogDiv=null,delegateEl=null}),Core.Dom.findNode=function(e,t,i){for(var n=e[i];n;n=n[t])if(1==n.nodeType)return n;return null},Core.Dom.nextNode=function(e){return Core.Dom.findNode(e,"nextSibling","nextSibling")},blogAd.shareToWeibo=function(e){var t=new Utils.Url("http://v.t.sina.com.cn/share/share.php"),i=encodeURIComponent;e.clickCode&&((new Image).src=e.clickCode);for(var n in e)e.hasOwnProperty(n)&&t.setParam(n,i(e[n]));e.title||t.setParam("title",i(e.title||document.title)),t.setParam("content","utf-8");var o=function(){t=t.toString(),window.open(t,"mb",["toolbar=0,status=0,resizable=1,width=440,height=430,left=",(screen.width-440)/2,",top=",(screen.height-430)/2].join(""))||(location.href=t)};/Firefox/.test(navigator.userAgent)?setTimeout(o,0):o()},blogAd.nickTrayAd=function(e,t){t.innerHTML=e.adLink;var i=this,n=['<div id="#{entity}" class="tips_layer1 tips_bg_a" style="z-index:150;position:absolute;top:23px;left:0px;display:none;">','<div id="#{body}" class="tips_bd">','<a id="#{imageLink}" href="" class="link" title="" target="_blank"></a>','<div class="tips_detail"> <span id="#{closeBtn}" class="close" title="关闭">×</span>','<p id="#{userNick}" class="tips_nickname"></p>','<p id="#{tipsTitle}" class="tips_txt"></p>','<p id="#{tipsTxtLink}" class="tips_ad"></p>','<p id="#{tipsBtn}" class="tips_btn"></p>',"</div>","</div>","</div>"].join("");this.relativeNodeId=t.id,this.MARK_ID=1,this.LIMITED=24;var o=this.nodes=this.getTemplateNodes(n);if(Core.Dom.insertAfter(o.entity,document.body.lastChild),$IE6&&e.ie6BackgroundPic)o.entity.style.backgroundImage="url("+e.ie6BackgroundPic+")";else if(e.backgroundPic)try{o.entity.style.backgroundImage="url("+e.backgroundPic+")"}catch(s){}o.imageLink.href=e.imageLinkHref;var a=typeof $nick;a="undefined"==a?"亲爱的网友":$nick,o.userNick.innerHTML="HI，"+a.replace(/</g,"&lt;"),o.tipsTitle.innerHTML=e.tipsTitle,e.tipsTxtLink&&(o.tipsTxtLink.innerHTML=e.tipsTxtLink);var r=o.tipsTxtLink.children[0],l=r.style;!$IE6&&e.tipsTxtLinkBgPic?(l.backgroundImage="url("+e.tipsTxtLinkBgPic+")",l.backgroundRepeat="no-repeat"):$IE6&&e.ie6TipsTxtLinkBgPic&&(l.backgroundImage="url("+e.ie6TipsTxtLinkBgPic+")",l.backgroundRepeat="no-repeat"),o.tipsBtn.innerHTML=e.tipsBtn,Core.Events.addEvent(o.closeBtn,function(){i.hide(),scope.$channel=null;var t=e.status.adclose;t&&((new Image).src=t)},"click"),setTimeout(function(){i.setPos(),i.show(),i.initResizeEvent()},15);e.status&&e.status.adclose;Core.Events.addEvent(o.entity,function(t){var n=t.target||t.srcElement,s=o.entity;do if("A"===n.nodeName.toUpperCase()&&-1!=n.href.indexOf("http")){i.hide(),scope.$channel=null;var a=e.status.adclose;a&&((new Image).src=a);break}while(n&&n==s)},"click"),e.status.adstart&&((new Image).src=e.status.adstart),e.blogTip?v7sendLog(e.logCode):commonLog("http://1090.adsina.allyes.com/main/adfshow?user=AFP6_for_SINA|2012_add|2012_blog_tip&db=sina&border=0&local=yes&js=ie")}.$defineProto({setMark:function(){var e=(new Date).getHours(),t=24-e;Utils.Cookie.setCookie("blogTipsAd",1,t,"/",".blog.sina.com.cn")},setPos:function(){var e=$E(this.relativeNodeId),t=Core.Dom.getXY(e),i=e.offsetWidth,n=this.nodes.entity.style;n.left=parseInt(t[0])+(i-100)+"px",n.top=parseInt(t[1])+23+"px"},show:function(){this.isHidden=!1;var e=this.nodes.entity,t=Core.Dom.setStyle,i=new Ui.TweenStrategy(0,1,.5,function(e,t,i,n){return-i*(e/=n)*(e-2)+t});i.onTween=function(i){t(e,"opacity",i)},i.onEnd=function(){$IE?e.style.filter="none":t(e,"opacity","none")},t(e,"opacity",0),e.style.display="block",i.start()},hide:function(){this.setMark(),this.isHidden=!0;var e=this.nodes.entity,t=Core.Dom.setStyle,i=new Ui.TweenStrategy(1,0,.5,function(e,t,i,n){return-i*(e/=n)*(e-2)+t});i.onTween=function(i){t(e,"opacity",i)},i.onEnd=function(){$IE?e.style.filter="none":t(e,"opacity","none"),e.style.display="none"},i.start()},initResizeEvent:function(){var e=this;Core.Events.addEvent(window,function(){e.isHidden||e.setPos()},"resize")}}).$mixProto(Lib.templateUtils),blogAd.loadNickTrayAd=function(e){var t=(Lib.Listener,$E("loginBarActivity")||$E("divPopularize")),i=(t.getAttribute("shouldShow"),(new Date).getDay()),n=Utils.Cookie.getCookie("blogTipsAd");t.style.display="";var o=1==i||3==i||5==i;if(o&&!n){var s="http://simg.sinajs.cn/blog7style/css/module/layer/layer20.css";Utils.Io.loadExternalCSS(s,function(){if(e){if(!e||!e.isShow)return;e.logCode&&(e.logCode=e.logCode+"|"+$UID),blogAd.trayAdHandle=new blogAd.nickTrayAd(e,t),t=null}})}},$registJob("trayTipsAd",function(){var e,t,i,n=Lib.Listener,o=function(t){t=t&&t.weicaopan&&t.weicaopan.weicaopan_con,Lib.execZhitou(function(){function i(e){for(var t=n.firstChild,i=e?"":"none";t;)"a"===t.nodeName.toLowerCase()&&(t.style.display=i),t=t.nextSibling}var n=$E("loginBarActivity")||$E("divPopularize");n.style.display="";var o,s,a=n.parentNode,r=a.parentNode.offsetHeight;if(i(!1),"none"===a.style.display){a.style.position="absolute",a.style.top="-40px",a.style.display="",s=Core.Dom.getXY(n);var l=$E("login_bar_logo_link_350");l.style.display="";var c=l.children[0].offsetWidth;o=c+s[0],e&&(r+=90),a.style.position="",a.style.top="",a.style.display="none",l.style.display="none"}else s=Core.Dom.getXY(n),r+=s[1],o=s[0];var d=blogAd.insertIns("PDPS000000033238",n);(window.sinaads||[]).push({element:d,params:{sinaads_tip_top:r,sinaads_tip_left:o,sinaads_success_handler:function(){i(!1),window.BLOG_AD_TIPS=1},sinaads_fail_handler:function(){i(!0),blogAd.loadNickTrayAd(t)},sinaads_ad_zindex:590}})}),n.off({name:"ad_show_hide_conditions",callBack:o}),o=null};n.on({name:"ad_show_hide_conditions",callBack:function(n){"undefined"!=typeof e?o(n):i=n,t=!0}}),n.on({name:"topad680-show-end",callBack:function(n){e=n.show,t&&o(i)}})}),SinaEx.enterLeave=function(e,t,i,n){var o=Core.Events.addEvent,s=null,a=0,r=0;t=t||function(){},i=i||function(){},n=n||0,o(e,function(e){clearTimeout(r);var o=e||window.event,l=o.target||o.srcElement;a=setTimeout(function(){if(!s||!SinaEx.contains(s,l)){var e=SinaEx.parent(l,"li");
e?(s&&i(s),t(e),s=e):s&&(i(s),s=null)}},n)},"mouseover"),o(e,function(){clearTimeout(a),r=setTimeout(function(){s&&(i(s),s=null)},n)},"mouseout")},$registJob("qingRecommend",function(){function e(e){if(e=parseInt(e),c!==e){clearTimeout(s),clearTimeout(a),SinaEx.removeClass(SinaEx.parent(r[c],"li"),"current"),SinaEx.addClass(SinaEx.parent(r[e],"li"),"current"),p(o,0);var n=r[e];$E("module_911")?0==e?o.innerHTML='<a suda-uatrack="key=blog_qing_g&value=h_SLOT_49" href="'+n.parentNode.href+'" target="_blank" onclick="v7sendLog(\''+(n.parentNode.getAttribute("bigcode")||"00_00_qzj")+'\');return true;"><img src="'+n.getAttribute("bigsrc")+'" /><span>'+(n.getAttribute("alt")||"")+"</span></a>":1==e?o.innerHTML='<a suda-uatrack="key=blog_qing_g&value=h_SLOT_50" href="'+n.parentNode.href+'" target="_blank" onclick="v7sendLog(\''+(n.parentNode.getAttribute("bigcode")||"00_00_qzj")+'\');return true;"><img src="'+n.getAttribute("bigsrc")+'" /><span>'+(n.getAttribute("alt")||"")+"</span></a>":2==e&&(o.innerHTML='<a suda-uatrack="key=blog_qing_g&value=h_SLOT_51" href="'+n.parentNode.href+'" target="_blank" onclick="v7sendLog(\''+(n.parentNode.getAttribute("bigcode")||"00_00_qzj")+'\');return true;"><img src="'+n.getAttribute("bigsrc")+'" /><span>'+(n.getAttribute("alt")||"")+"</span></a>"):o.innerHTML='<a href="'+n.parentNode.href+'" target="_blank" onclick="v7sendLog(\''+(n.parentNode.getAttribute("bigcode")||"00_00_qzj")+'\');return true;"><img src="'+n.getAttribute("bigsrc")+'" /><span>'+(n.getAttribute("alt")||"")+"</span></a>",h=30,t(),c=e,a=setTimeout(i,5e3)}}function t(){p(o,h),h+=d,100>h?s=setTimeout(t,15):p(o,100)}function i(){var t=c+1;t>=l&&(t=0),e(t)}function n(){for(var e,t=0;l>t;t++)e=SinaEx.parent(r[t],"li"),e&&e.setAttribute("noo",t);setTimeout(function(){o.style.background="",i()},5e3)}var o=$E("qingRecWindow");if(o){var s=0,a=0,r=$T($E("qingRecPic"),"img"),l=r.length,c=0,d=$IE?5:2,h=0,p=Core.Dom.opacity;n(),SinaEx.enterLeave($E("qingRecPic"),function(t){var i=t.getAttribute("noo");e(i)},function(){},100)}}),$registJob("qingRecomNew",function(){function e(e){if(l!==e){clearTimeout(o),clearTimeout(s);var r=a[e];SinaEx.removeClass(a[l],"current"),SinaEx.addClass(r,"current"),p(n,0),n.innerHTML='<a href="'+r.getAttribute("imghref")+'" target="_blank" onclick="v7sendLog(\''+(r.getAttribute("imgcode")||"00_00_qzj")+'\');return true;"><img src="'+r.getAttribute("imgsrc")+'" /><span>'+r.getAttribute("imgtitle")+"</span></a>",d=30,t(),l=e,s=setTimeout(i,3e3)}}function t(){p(n,d),d+=c,100>d?o=setTimeout(t,15):p(n,100)}function i(){var t=l+1;t>=r&&(t=0),e(t)}var n=$E("qingRecNew");if(n){for(var o=0,s=0,a=$E("qingRecPic").children,r=a.length,l=0,c=$IE?5:2,d=0,h=Core.Events.addEvent,p=Core.Dom.opacity,u=0;r>u;u++)!function(t){var i=0;h(a[t],function(){i=setTimeout(function(){e(t)},100)},"mouseover"),h(a[t],function(){clearTimeout(i)},"mouseout")}(u);n.children[0].innerHTML='<img src="'+a[0].getAttribute("imgsrc")+'" /><span>'+a[0].getAttribute("imgtitle")+"</span>",n.style.background="",setTimeout(i,3e3)}}),$registJob("adNoticeChannel",function(){var e=(Core.Events.addEvent,Lib.Listener),t=scope.$pageid,i=(window.location.href.indexOf("tj=1")>-1,document.referrer);if(i){var n=i.match(/(\:\/\/)(.*?)(\/)/g);i=n&&n[0].replace(/(\:\/\/){0,}(\/){0,}/g,"")}else i="";Lib.checkAuthor();var o="http://blogtj.sinajs.cn/riaapi/afterLoadChannel/after_load_channel.php";Utils.Io.JsLoad.request(o,{GET:{uid:$UID,bloguid:scope.$uid,refer:i},onComplete:function(i){i&&"A00006"===i.code&&(scope.$channel=i.data,("article"===t||"articleM"===t||"index"===t||"indexM"===t||"articlelist"===t||"articlelistM"===t||"wanwan_index"===t)&&e.notify("notice_ad_layer",scope.$channel||{}),e.notify("ad_show_hide_conditions",scope.$channel||{}))}})}),function(){var e=function(e){for(var t=e.split("-"),i=t[0],n=1;n<t.length;n++)i+=t[n].charAt(0).toUpperCase()+t[n].substring(1);return i};Core.Dom.setStyle2=function(t,i){"string"==typeof t&&(t=$E(t));for(var n in i)styleAttr=e(n),Core.Dom.setStyle(t,styleAttr,i[n])}}(),$registJob("blogNotice",function(){function e(e){if($isLogin&&e.announce.result&&("indexM"===v||"articleM"===v||"articlelistM"===v)){_.noticeLayer.style.display="",_.adLayer.style.display="none";var t=e.announce;Core.Dom.insertHTML(_.noticeIcon,t.announce_con,"AfterEnd")}else _.adLayer.style.display="";if(e.advertise){var n=e.advertise,o=decodeURIComponent(n.advertise_con1.content),s=decodeURIComponent(n.advertise_con2.content),a=decodeURIComponent(n.advertise_con1.link),r=decodeURIComponent(n.advertise_con2.link);_.noticeAdCon1.innerHTML=o,_.noticeAdCon1.href=a,_.noticeAdCon2.innerHTML=s,_.noticeAdCon2.href=r,_.adContent1.innerHTML=o,_.adContent1.href=a,_.adContent2.innerHTML=s,_.adContent2.href=r,_.close&&d(_.close,function(){p("closeNotice_fzp",$UID,24,"/",".blog.sina.com.cn"),i()})}}function t(){var e=document.body.scrollTop+document.documentElement.scrollTop;e>height?(s(_.guideLayer),$IE6||(_.guideLayer.style.top="0"),r||(r=1,v7sendLog("48_01_11"))):a(_.guideLayer)}function i(){Core.Dom.removeNode(_.guideLayer),h(window,t,"scroll"),h(window,o,"scroll"),scope.$channel=null}function n(e){Core.Dom.setStyle2(e,w.mid)}function o(){_.guideLayer.style.top=document.documentElement.scrollTop+"px",_.guideLayer.style.left="0px"}function s(e){if(!l){l=1;var t=new Ui.TweenStrategy(0,1,.6,function(e,t,i,n){return-i*(e/=n)*(e-2)+t});t.onTween=function(t){g(e,"opacity",t)},t.onEnd=function(){$IE?e.style.filter="none":g(e,"opacity","none")},g(e,"opacity",0),e.style.display="block",t.start()}}function a(e){if(l){l=0;var t=new Ui.TweenStrategy(1,0,.6,function(e,t,i,n){return-i*(e/=n)*(e-2)+t});t.onTween=function(t){g(e,"opacity",t)},t.onEnd=function(){$IE?e.style.filter="none":g(e,"opacity","none"),e.style.display="none"},t.start()}}var r,l,c=$E("login_bar_logo_link_350"),d=Core.Events.addEvent,h=Core.Events.removeEvent,p=Utils.Cookie.setCookie,u=Utils.Cookie.getCookie,g=Core.Dom.setStyle,m=Lib.Listener,f=u("closeNotice_fzp");if(Lib.checkAuthor(),!f||f!==$UID){{var v=scope.$pageid;scope.$uid,window.location.href.indexOf("tj=1")>-1}if(c&&"ntopbar_main"===c.parentNode.className)return void m.on({name:"notice_ad_layer",callBack:function(e){m.notify("tray-announce-loaed",e)}});var _,y=document.documentElement,b={guideLayer:'<div class="l_hornbg" id="#{guideLayer}" style="display:none;"><div class="l_horn"><span class="close" title="关闭" id="#{close}">&times;</span><div class="horn1" id="#{noticeLayer}" style="display:none;"><div class="horn_left"><span class="horn_icon" id="#{noticeIcon}"></span></div><div class="horn_right" id="#{noticeAdLayer}">推荐：<a href="" target="blank" id="#{noticeAdCon1}" onclick="v7sendLog(\'48_01_12\');"></a><a href="" target="blank" id="#{noticeAdCon2}" onclick="v7sendLog(\'48_01_13\');"></a></div></div><div class="horn2" id="#{adLayer}">推荐：<a href="" target="blank" id="#{adContent1}" onclick="v7sendLog(\'48_01_12\');"></a><a href="" target="blank" id="#{adContent2}" onclick="v7sendLog(\'48_01_13\');"></a></div></div></div>'},w={mid:{"z-index":"500",position:$IE6?"absolute":"fixed"}},E=$_GLOBAL.cssBasicURL+"module/layer/layer24.css";Utils.Io.loadExternalCSS(E);var C=function(i){_=Utils.insertTemplate($E("sinabloga"),b.guideLayer,"BeforeBegin"),n(_.guideLayer),$IE6&&(_.guideLayer.style.position="absolute",y.style.backgroundImage="url(ablout:blank)",y.style.backgroundAttachment="fixed",d(window,o,"scroll")),d(window,t,"scroll"),e(i)};m.on({name:"notice_ad_layer",callBack:C})}}),$registJob("trashPv",function(){}),Ui.LayerCount=function(){var e=500,t=1024;return function(i){return"mode"===i?t:(e+=24,e>t?t-50:e)}}(),Lib.OnlyShadow=function(e,t,i,n){this.entity=null,this.parent=t||document.body,n=Lib.apply({zIndex:1024,backgroundColor:"black"},n),this._ie6Fixed=function(){if(o.entity){o.entity.style.top=document.documentElement.scrollTop+"px";var e=document.documentElement.scrollLeft-o._ie6EntityXY[0],t=e+o.entity.offsetWidth,i=document.documentElement.scrollWidth||document.body.scrollWidth;i>=t&&(o.entity.style.left=e+"px"),o.ifm&&(o.ifm.style.top=o.entity.style.top,i>=t&&(o.ifm.style.left=o.entity.style.left))}};var o=this;this.resetShadowDiv=Core.Function.bind3(function(){o.entity&&setTimeout(function(){if(o.updateSize(),$IE6&&o.isShow()){o.entity.style.left="0px";var e=Core.Dom.getXY(o.entity);o._ie6EntityXY=e,o._ie6Fixed()}},1)},this),this._create=function(){if(o.entity=$C("div"),i&&(o.entity.id=i),o.entity.style.position="absolute",o.entity.style.width=o.getAreaWidth()+"px",o.entity.style.height=o.getAreaHeight()+"px",o.entity.style.left="0px",o.entity.style.top="0px",o.entity.style.zIndex=n.zIndex,o.entity.style.backgroundColor=n.backgroundColor,o.parent.appendChild(o.entity),o._setOpacity(o.entity,isNaN(e)?.5:e),$IE6){var t=Core.Dom.getXY(o.entity);o._ie6EntityXY=t;var s=document.documentElement.scrollLeft-o._ie6EntityXY[0];o.entity.style.left=s+"px"}o.addIframe(),Core.Events.addEvent(window,o.resetShadowDiv,"resize"),o.setFixed(!0),o.hidden()},function(){i&&$E(i)?o.entity=$E(i):o._create()}()},Lib.OnlyShadow.prototype={isShow:function(){return this.entity.offsetHeight>0?!0:!1},show:function(){if(this.entity.style.display="",this.ifm&&(this.ifm.style.display=""),$IE6){this.updateSize(),this.entity.style.left="0px";var e=Core.Dom.getXY(this.entity);this._ie6EntityXY=e,this._ie6Fixed()}this.onShow()},hidden:function(){this.entity.style.display="none",this.ifm&&(this.ifm.style.display="none"),this.onHidden()},close:function(){this.hidden(),this.destroy()},destroy:function(){Core.Events.removeEvent(window,this._ie6Fixed,"scroll"),Core.Events.removeEvent(window,this.resetShadowDiv,"resize"),this.entity.parentNode.removeChild(this.entity),this.entity=null,this.ifm&&(this.ifm.parentNode.removeChild(this.ifm),this.ifm=null)},addIframe:function(){this.ifm=$C("iframe"),this._setOpacity(this.ifm,0),this.ifm.style.position="absolute",this.ifm.style.zIndex=this.entity.style.zIndex,this.ifm.style.left=this.entity.style.left,this.ifm.style.top=this.entity.style.top,this.ifm.style.width=this.entity.style.width,this.ifm.style.height=this.entity.style.height,this.entity.parentNode.insertBefore(this.ifm,this.entity)},insertBefore:function(e){e.parentNode.insertBefore(this.entity,e),this.ifm&&this.entity.parentNode.insertBefore(this.ifm,this.entity)},updateSize:function(){var e=this.getAreaWidth(),t=this.getAreaHeight();this.entity.style.width=e+"px",this.entity.style.height=t+"px",this.ifm&&(this.ifm.style.width=e+"px",this.ifm.style.height=t+"px")},getAreaHeight:function(){var e=Math.max(document.documentElement.clientHeight,document.body.clientHeight);return e},getAreaWidth:function(){var e=document.documentElement.clientWidth||document.body.clientWidth;return e},setFixed:function(e){if($IE6){var t=this;e?(t._ie6Fixed(),Core.Events.addEvent(window,t._ie6Fixed,"scroll")):Core.Events.removeEvent(window,t._ie6Fixed,"scroll")}else this.entity.style.position=e?"fixed":"absolute"},_setOpacity:function(e,t){$IE?e.style.filter="alpha(opacity="+100*t+")":e.style.opacity=t},onShow:function(){},onHidden:function(){}},Article.SlideTJCover=function(e){var t=arguments,i=t.callee._instance;if(this.cfg=e=Lib.apply(this.cfg||{},e),i)return i;var n=this;t.callee._instance=this;var o=function(e,t,i){var n=new Image;n.src=t,$E(e).setAttribute("blogId",i);var o=function(e,t){var n=$E(e).getAttribute("blogId");n===i&&($E(e).src=t)};n.complete?$E(e).src=t:($E(e).src=g,n.onload=function(){o(e,t)},n.onerror=function(){$E(e).src="http://s4.sinaimg.cn/image/default_cover.gif#4"})},s=function(e,t,i){e=$E(e),t=t||"查看原文",e.textContent?e.textContent=t:e.innerText=t;var n;n=i?"http://blog.sina.com.cn/s/blog_"+i+".html":"javascript:;",e.href=n},a=function(e,t){var i=(e.offsetHeight-t.offsetHeight)/2,n=(e.offsetWidth-t.offsetWidth)/2;0>i&&(i=0),t.style.top=i+"px",0>n&&(n=0),t.style.left=n+"px"},r=function(e){var t=Lib.util.getActionData(e,"show-next-slide");if(t){var i=decodeURIComponent(t.data).split("###"),n=i[0],o=new Article.MultipleImgLayer;o.showNextSlide(n)}},l=function(e){var t=Lib.util.getActionData(e,"show-next-tj");if(t){var i=decodeURIComponent(t.data).split("###"),o=i[0],s=i[1]||"",a=i[2]||"next",r=new Article.MultipleImgLayer;return r.setDirection("next"),r.getNextSlideData(o,s,function(e){e.pre.blogId||e.next.blogId?(h(),n.show(e)):d(a)},a),!1}},c=function(e,t,i,n){t&&$E(e).setAttribute("action-data",encodeURIComponent(t+"###"+i+"###"+n))},d=function(e){$E(v[e+"Btn"]).style.visibility="hidden"},h=function(){$E(v.nextBtn).style.visibility="",$E(v.preBtn).style.visibility=""},p=function(e){s(v[e+"Title"],""),o(v[e+"Img"],"http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif"),c(v[e+"Btn"],""),$E(v[e+"Img"]).style.visibility="hidden",$E(v[e+"Title"]).style.visibility="hidden",d(e)},u=function(e){var t=/(?:(?:ww\d+|s\d+).sinaimg.cn|photo\.sina\.com\.cn)\/(mw690|mw600|middle|bmiddle)/,i=e.match(t);if(!i)return e;switch(i[1]){case"bmiddle":return e.replace(/\/bmiddle\//,"/cover/");case"mw690":return e.replace(/\/mw690\//,"/cover/");case"middle":return e.replace(/\/middle\//,"/cover/");case"mw600":return e.replace(/\/mw600\//,"/cover/");default:return e}},g="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif",m='<div id="#{entity}" class="showEnd" style="position:absolute;visibility:hidden;"><div class="tit"><strong>该篇博文浏览结束</strong><a id="#{review}" href="javascript:;" class="replay" title="重新浏览" hidefocus="true"></a></div><div class="pages"><a id="#{preBtn}" href="javascript:void(0);" class="preview" action-type="show-next-tj" hidefocus="true">&lt;&lt;上一篇</a><a id="#{nextBtn}" href="javascript:void(0);" class="next" action-type="show-next-tj" hidefocus="true">下一篇&gt;&gt;</a></div><div class="content"><ul><li><a id="#{preImgBtn}" action-type="show-next-slide" href="javascript:;" hidefocus="true"><img id="#{preImg}" src="'+g+'" /></a><a id="#{preTitle}" href="javascript:;" target="_blank" hidefocus="true">标题</a></li><li class="nomgr"><a id="#{nextImgBtn}" action-type="show-next-slide" href="javascript:;" hidefocus="true"><img id="#{nextImg}" src="'+g+'" /></a><a id="#{nextTitle}" href="javascript:;" target="_blank" hidefocus="true">标题</a></li></ul></div></div>',f=new Lib.HtmlTemplate(m);Core.Dom.addHTML(e.renderTo,f.getHtmlString());var v=f.getNodeIds(),_=Core.Events.addEvent;_($E(v.review),function(){v7sendLog("49_01_06"),this.cfg.review(this)}.bind2(this)),_($E(v.preBtn),function(){v7sendLog("49_01_07")}),_($E(v.nextBtn),function(){v7sendLog("49_01_08")}),_($E(v.preImgBtn),function(){v7sendLog("49_01_09")}),_($E(v.nextImgBtn),function(){v7sendLog("49_01_10")}),_($E(v.entity),r),_($E(v.entity),l);var y={isHidden:!0,getEntity:function(){return $E(v.entity)},fixPos:function(){this.isHidden||a(this.cfg.renderTo,this.getEntity())},show:function(e){var t=$E(v.preImgBtn).parentNode.parentNode.parentNode,i=$E(v.preBtn).parentNode;e?(t.style.display="",i.style.display=""):(t.style.display="none",i.style.display="none",e={});var n=this.cfg,r=n.renderTo,l=this.getEntity();if(0==l.offsetHeight||0==l.offsetWidth)return!1;a(r,l),this.isHidden=!1,l.style.visibility="inherit";var d=$E(v.preTitle),h=$E(v.nextTitle),g=!1;if(e.pre&&e.pre.images&&e.pre.images.length>0){var m=e.pre.blogId,f=e.pre.publishTime;$E(v.preTitle).style.visibility="inherit",s(d,e.pre.title,m),o(v.preImg,u(e.pre.images[0]),m),$E(v.preImg).style.visibility="inherit",c(v.preBtn,m,f,"pre"),$E(v.preBtn).style.visibility="inherit",c(v.preImgBtn,m)}else g=!0,p("pre");if(e.next&&e.next.images&&e.next.images.length>0){var _=e.next.blogId,y=e.next.publishTime;$E(v.nextTitle).style.visibility="inherit",s(h,e.next.title,_),o(v.nextImg,u(e.next.images[0]),_),$E(v.nextImg).style.visibility="inherit",c(v.nextBtn,_,y,"next"),$E(v.nextBtn).style.visibility="inherit",c(v.nextImgBtn,_)}else g=!0,p("next");return g?t.style.backgroundImage="none":$IE6?t.style.backgroundImage="url("+b+")":t.style.background="url("+b+") 235px 100px no-repeat",this.cfg.data=e,!0},hide:function(){var e=this.getEntity();return e.style.visibility="hidden",this.isHidden=!0,!0}},b="http://simg.sinajs.cn/blog7style/images/common/multishow_or."+(6==$IE?"gif":"png");Lib.apply(this,y)},Lib.register("diYuanXinLog",function(){var e,t=!1,i=[],n="undefined"!=typeof $_GLOBAL&&null!=$_GLOBAL.ver?$_GLOBAL.ver.di_yuan_xin||"-1":"-1",o="http://sjs.sinajs.cn/xblogtheme/js/di_yuan_xin.js?ver="+n+".js",t=function(){Utils.Io.JsLoad.request(o,{isRemove:!1,noreturn:!0,onComplete:function(){e=!1,t=!0;for(var n=0,o=i.length;o>n;n++)i[n]();i=[]}})};return function(n){!0===t?n():!0===e?i.push(n):(i.push(n),t())}}),Article.MultipleImgLayer=function(){var e=arguments,t=e.callee._instance;if(t)return t;e.callee._instance=this;var i=this,n=function(){$FF&&(i.scrollTop=document.documentElement.scrollTop),$IE6?document.body.setAttribute("scroll","no"):(document.documentElement.style.overflow="hidden",!$IE8&&(document.body.style.overflow="hidden"))},o=function(){$IE6?document.body.removeAttribute("scroll"):(document.documentElement.style.overflow="auto",!$IE8&&(document.body.style.overflow="auto")),$FF&&(document.documentElement.scrollTop=i.scrollTop)},s=function(){var e=function(e){var t=document,i=t.documentElement["client"+e],n=t.body;return"CSS1Compat"===t.compatMode&&i||n&&n["client"+e]||i};return{height:e("Height"),width:e("Width")}},a=function(e){var t=$E(V.multiPicLoading),i=Math.max(e.height,500),n=Math.max(e.width,500);t.style.top=(i-181)/2+"px",t.style.left=(n-141)/2+"px",d()},r=function(){$E(V.multiPicLoading).style.top="-1000px"},l=function(e){var t=s(),i=Math.max(t.height,500),n=Math.max(t.width,500),o=document,a=o.documentElement.scrollTop+o.body.scrollTop;e.style.height=i+"px",e.style.width=n+"px",e.style.top=a+"px";var r=$E(V.multiPicContent);r.style.height=i-88+"px"},c=function(){for(var e,t,i=$E(V.multiPicContent),n=i.getElementsByTagName("IMG"),o=0,s=n.length;s>o;o++)if(e=n[o],t=e.getAttribute("origin-size"))return e;return null},d=function(){var e=c();e&&e.parentNode.removeChild(e)},h=function(e,t){var i=Math.max(e.height-88,412),n=Math.max(e.width,500),o=t.height,s=t.width;t.setAttribute("origin-size",s+"*"+o);var a=(e.height-88)/o,r=e.width/s;if(isFinite(a)&&isFinite(r)){var l,c,d=1;1>a&&r>a?(c=Math.min(o,i),d=c/o,l=d*s,t.height=c,t.width=l):1>r&&(l=Math.min(s,n),d=l/s,c=d*o,t.width=l,t.height=c),$IE&&8>$IE&&(t.style.zoom=1)}},p=function(e,t){if(0!=t.offsetHeight&&0!=t.offsetWidth){var i=(e.offsetHeight-t.offsetHeight)/2,n=(e.offsetWidth-t.offsetWidth)/2;0>i&&(i=0),t.style.top=i+"px",0>n&&(n=0),t.style.left=n+"px",trace("left: "+n+" top:"+i);var o=$E(V.orignalPic);o.style.top=i+10+"px",o.style.left=n+10+"px"}},u=function(){var e=$E(V.orignalPic);e.style.visibility="inherit"},g=function(){var e=$E(V.orignalPic);e.style.visibility="hidden"},m=function(e){var t="___$image"+(new Date).getTime(),i=window[t]=new Image;blogId=$E(V.multiPicLike).getAttribute("blog-id"),i.src="http://control.blog.sina.com.cn/riaapi/article/filmslide.php?"+t+"&blogId="+blogId+"&img="+e,i.onload=i.onerror=function(){i=null,window[t]=null}},f=!1,v=function(e,t,i){f||(f=!0,winDialog.alert(e,{icon:"01",textOk:"知道了",funcOk:function(){Y=0,f=!1,E(),t&&t()},funcClose:function(){Y=0,f=!1,E(),i&&i()}},"slide-box-tips"))},_=function(e){Z||(J=0,v(e||"图片太小啦，无法展示！"))},y=function(e){{var t=/(?:(?:ww\d+|s\d+).sinaimg.cn|photo\.sina\.com\.cn)\/large/;e.match(t)}t.test(e)&&(e=e.replace(/\/large\//,"/orignal/")),$E(V.orignalLink).href=e},b="",w=function(t,i,n,o){if(!Z){var l=C(t.url);if(!o){var o=new Image;o.src=l}b=l;var c="<em>"+(et+1)+"</em>/<span>"+i+"</span>";$E(V.multiPicIndex).innerHTML=c,d();var u=s();o.style.top="-10000px",o.style.position="absolute",ot.appendChild(o);var g=o.width>200||o.height>200;if(!$IE6&&g||o.complete&&g)K(o,"opacity",.5),r(),setTimeout(function(e){var t=$E(V.multiPicContent);return function(){return e.src!==b?void ot.removeChild(e):(m(e.src),e.setAttribute("action-type","show-large-layer"),e.setAttribute("action-data",encodeURIComponent(e.src)),t.appendChild(e),void setTimeout(function(){h(s(),e),p(t,e);var i=new Ui.TweenStrategy(.5,1,.5);i.onTween=function(t){return o.src!==b?(e.parentNode&&e.parentNode.removeChild(e),i.stop(),void(e=null)):void K(e,"opacity",t)},i.start(),y(e.src)}))}}(o));else{e=arguments,a(u);var f=0,w=15,L=setInterval(function(t,i){return function(){if(!X)return void clearInterval(L);var n=t.offsetWidth>200||t.offsetHeight>200,o=f*w/1e3;f++;var s=t.complete&&t.width>0&&t.height>0&&t.width<200&&t.height<200;if(s&&!X[i].recordSmall&&(J++,X[i].recordSmall=1),X&&X.length==J+Y)return clearInterval(L),void(0==Y&&_());if(o>5||s)return clearInterval(L),Y++,void(i===et&&(d(),E()));if(t.complete&&n){clearInterval(L);for(var a=[],r=0,l=e.length;l>r;r++)a.push(e[r]);return a.push(t),void e.callee.apply(null,a)}}}(o,n),w);o.onerror=function(e){return function(){return X[e].recordError||(Y++,X[e].recordError=1),Y+J>=i?(clearInterval(L),void v("抱歉，图片读取失败。")):(o.onerror=null,d(),void E())}}(n)}}},E=function(){"pre"===$E(V.multiPicEntity).getAttribute("direction")?B():P()},C=function(e){var t=/(?:(?:ww\d+|s\d+).sinaimg.cn|photo\.sina\.com\.cn)\/(mw690|mw600|middle|bmiddle)/,i=e.match(t);if(!i)return e;switch(i[1]){case"bmiddle":return e.replace(/\/bmiddle\//,"/large/");case"mw690":return e.replace(/\/mw690\//,"/large/");case"middle":return e.replace(/\/middle\//,"/large/");case"mw600":return e.replace(/\/mw600\//,"/large/");default:return e}},L=function(e,t){for(var i=null,n=Math.abs(t),o=(e.length,1);n>o;o++){var s=t>0?et+o:et-o;i=e[s],i&&0===i.loaded&&!function(e,t){setTimeout(function(){var i=new Image;i.onload=i.onerror=function(){i=null},i.src=e,X[t].loaded=1},40)}(C(i.url),s)}},S=function(e){return-1!==e.indexOf("sinaimg.cn/uc/myshow")?!0:-1!==e.indexOf("img.t.sinajs.cn")?!0:-1!==e.indexOf("simg.sinajs.cn")?!0:-1!==e.indexOf("sinaimg.cn/small")?!0:-1!==e.indexOf("sinaimg.cn/square")?!0:!1},k=function(e){var t,i=e.length,n=s();if(X=e,i>0){a(n),A();var o=!1;for(t=0;i>t;t++)if(X[t].click){et=t,w(X[t],i,t),o=!0;break}o||(et=0,w(X[0],i,0)),L(X,3),L(X,-3)}else $()},$=function(e){if(e){var t=Core.Events.getEventTarget(e);if("IMG"===t.nodeName.toUpperCase())return}it&&it.hide(),ot&&(ot.innerHTML="",document.body.removeChild(ot),ot=null),Z=!0;s();o();var i=V.multiPicEntity,n=$E(i);n.style.display="none",R.hidden(),X=[],et=0,Y=0,J=0,nt=null,z.data=null,st&&st.dialog&&st.dialog.hidden()},x=!1,T=function(e){$E(e).style.visibility="hidden"},I=function(e){$E(e).style.visibility="inherit"},D=function(e){T(V.multiPicLike),T(V.multiPicTitle),T(V.multiPicIndex),T("next"===e?V.multiPicNext:V.multiPicPre)},A=function(){I(V.multiPicLike),I(V.multiPicTitle),I(V.multiPicIndex),I(V.multiPicNext),I(V.multiPicPre)},M=function(){it&&it.hide()},N=function(e){x=!0;var t=c();t&&(t.style.visibility="hidden",t=null),D(e),g(),it||(it=new Article.SlideTJCover({renderTo:$E(V.multiPicContent),review:function(){A(),et=-1,P(),it.hide()}}));var i=$E(V.multiPicEntity).getAttribute("blog-id"),n=$E(V.multiPicTitle),o=decodeURIComponent(n.getAttribute("publish-time")||"");z.getNextSlideData(i,o,function(e){it.show(e)},"")},B=function(e){e&&Core.Events.stopEvent(e),Lib.sendSuda(function(){try{SUDA.log("","blog_slide_page")}catch(e){}}),Lib.diYuanXinLog(function(){try{vjEventTrack("")}catch(e){}});var t=X.length;if(0>=et)return N("pre"),void(et=-1);et--,x&&M(),x&&A(),x=!1;var i=X[et];w(i,t,et),$E(V.multiPicEntity).setAttribute("direction","pre"),L(X,-3)},P=function(e){Lib.sendSuda(function(){try{SUDA.log("","blog_slide_page")}catch(e){}}),Lib.diYuanXinLog(function(){try{vjEventTrack("")}catch(e){}}),e&&Core.Events.stopEvent(e);var t=X.length;if(et>=t-1)return N("next"),void(et=t);et++,x&&M(),x&&A(),x=!1;var i=X[et];w(i,t,et),$E(V.multiPicEntity).setAttribute("direction","next"),L(X,3)},j=function(e){Core.Events.stopEvent(e);var t=$E(V.multiPicLike),i=t.getAttribute("blog-id"),n="http://control.blog.sina.com.cn/admin/digg/post_digg.php",o=t.getAttribute("block");if("1"!==o){var s=$E(V.multiPicTitle),a=s.innerText||s.textContent;t.setAttribute("block","1"),Utils.Io.JsLoad.request(n,{onComplete:function(e){t.setAttribute("block","0");var n=e.code;if("A00006"===n||"B00801"===n){t.className="ico_unlike ico_liked",t.innerHTML="已喜欢",scope.digger&&scope.digger.setData(i,scope.$uid,1);var o=$E("dbox_"+i);o.onmouseover=function(){},o.onmouseout=function(){},o.onclick=function(){},o.className="upBox upBox_dis";var s=$E("dbox2_"+i);o.style.cursor="default";var a=o.getElementsByTagName("p")[1],r=a.innerHTML,l=SinaEx.createNode("<div>"+r+"</div>"),c=SinaEx.findNode(l,"nextSibling","firstChild");l.removeChild(c);var d=l.innerHTML;a.innerHTML="顶"===d?'<img width="15" height="15" align="absmiddle" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" class="SG_icon SG_icon34">已顶':"已喜欢";var h=parseInt(s.getAttribute("mnum"))+1;s.innerHTML=h}else"A00800"===n?v("对不起，您短时间点击喜欢过多，请多休息，注意身体！感谢您对新浪博客的支持和关注！",function(){},function(){}):v(e.message||"发生错误，请稍候再试",function(){},function(){})},GET:{res_id:i,res_uid:scope.$uid,action:"0",res_type:"1",ti_title:encodeURIComponent(a)},onException:function(){aObj.setAttribute("block","false"),v(result.message||"发生错误，请稍候再试",function(){},function(){})}})}},U=function(){l($E(V.multiPicEntity)),setTimeout(function(){var e=s(),t=null;x?it&&!it.isHidden&&it.fixPos():(t=c(),t&&h(e,t),t&&p($E(V.multiPicContent),t))},25)},F=function(){if(!Z){{var e=s();document.body}setTimeout(function(){var t=s();t.height===e.height&&t.width===e.width&&U()},80)}},H=Ui.LayerCount(),O='<div id="#{multiPicEntity}" class="dialogMultiShow"                 style="display:none;z-index:'+(H+1)+';">              <a id="#{multiPicClose}" href="javascript:void(0);" title="关闭" class="close" style="z-index:'+(H+2)+'" hidefocus="true">关闭</a>              <a id="#{multiPicPre}" href="javascript:void(0);" class="btn_preview" style="z-index:'+(H+2)+'" hidefocus="true"></a>              <a id="#{multiPicNext}" href="javascript:void(0);" class="btn_next" style="z-index:'+(H+2)+'" hidefocus="true"></a>              <a id="#{multiPicLike}" href="javascript:void(0);" class="ico_unlike" style="z-index:'+(H+2)+'" hidefocus="true">喜欢</a>              <div class="bd">                <div id="#{multiPicIndex}" class="count"><em>5</em>/<span>20</span></div>                <div id="#{multiPicContent}" class="pic" style="position:relative;">                    <div class="con" id="#{orignalPic}" style="position:absolute;z-index:1025;">                        <a id="#{orignalLink}" target="_blank" href="#" class="opic" title="查看原图"  hidefocus="true">查看原图</a>                    </div>                    <div id="#{multiPicLoading}" class="loadding" style="top:-10000px;">图片加载中......</div>                </div>                <div class="title"><a id="#{multiPicTitle}" target="_blank" href="javascript:void(0);"  hidefocus="true">标题</a></div>              </div>            </div>',G=document,R=null,z=this,q=new Lib.HtmlTemplate(O),V=q.getNodeIds(),W=q.getHtmlString(),Y=0,J=0,X=[],Q=Core.Events.addEvent,K=Core.Dom.setStyle,Z=!0,et=0,tt="http://simg.sinajs.cn/blog7style/css/common/multishow.css",it=null,nt=null;Utils.Io.loadExternalCSS(tt,function(){}),Core.Dom.addHTML(document.body,W),Q($E(V.multiPicClose),$),Q($E(V.multiPicPre),B),Q($E(V.multiPicNext),P),Q($E(V.multiPicLike),j),Q(document,function(e){if(!Z){var t=$E(V.multiPicEntity).getAttribute("direction");37!==e.keyCode||x&&"pre"===t?39!==e.keyCode||x&&"next"===t||P():B()}},"keydown"),Q($E(V.multiPicTitle),function(e){Core.Events.stopBubble(e)}),Q($E(V.multiPicContent),function(e){var t=Lib.util.getActionData(e,"show-large-layer");t&&u()},"mouseover"),Q($E(V.multiPicContent),function(e){var t=Lib.util.getActionData(e,"show-large-layer");if(t){var i=e.toElement||e.relatedTarget,n=e.srcElement||e.target;("A"!==i.nodeName.toUpperCase()||"IMG"!==n.nodeName.toUpperCase())&&g()}},"mouseout"),Q(window,F,"resize");var ot=null,st=null;Lib.checkAuthor(),$isLogin||(st=new Lib.Login.Ui);var at={scrollTop:0,show:function(e,i,o,a,r,c){var d=V.multiPicEntity,h=$E(d);if(h&&e.length){Lib.checkAuthor(),x=!1,ot||(ot=document.createElement("DIV"),ot.id="_sile-img-box"+(new Date).getTime(),ot.style.position="absolute",ot.style.top="-10000px",this.imgContainer=ot,document.body.appendChild(ot)),g(),Y=0,J=0,o=o||"",Z=!1;{s()}n(),r=r||scope.$articleid,$E(V.multiPicEntity).setAttribute("blog-id",r),setTimeout(function(){R||(R=new Lib.OnlyShadow(.9,G.body,"mask_mutiplepic",{zIndex:H}),R.entity.style.zIndex=H,R.entity.style.backgroundColor="black");var n=s();R.entity.style.width=n.width+"px",R.show(),h.style.display="",l(h);for(var d=[],p=0,u=e.length;u>p;p++)t=e[p],S(t.url)||d.push(t);if(0<d.length?k(d,r):_(),i){var g="string"!=typeof i?i.href:i,m=$E(V.multiPicTitle);m.href=g,m.innerHTML="",m.setAttribute("publish-time",encodeURIComponent(c));var f=document.createTextNode(Core.String.trim(o)||"查看原文");m.appendChild(f);var v=$E(V.multiPicLike);v.setAttribute("blog-id",r),a?(v.className="ico_unlike ico_liked",v.innerHTML="已喜欢"):(v.className="ico_unlike",v.innerHTML="喜欢")}},25)}},getNextSlideData:function(e,t,i,n){var o=this;Utils.Io.JsLoad.request("http://control.blog.sina.com.cn/riaapi/article/getArticlePrevNextPic.php?rnd="+Math.random(),{GET:{blog_id:e,blog_pubdate:t,uid:$UID||"",action:n||""},onComplete:function(e){o.data="A00006"===e.code?e.data:{pre:{},next:{}},i&&i(o.data)},onException:function(){}})},setDirection:function(e){$E(V.multiPicEntity).setAttribute("direction",e)},showNextSlide:function(e){var t=this.data;if(t){this.recordPV(e);var i;for(var n in t)if(i=t[n],i&&e===i.blogId)break;if(i){for(var o,s="http://blog.sina.com.cn/s/blog_"+i.blogId+".html",a=[],r=i.images,l=r.length-1;l>=0;l--)o=i.images[l],a.unshift({url:o,loaded:0,click:0});this.show(a,s,i.title,i.isLiked,i.blogId,i.publishTime),it&&it.hide()}}},recordPV:function(e){if(e!==scope.$articleid){var t=new Image,i=parseInt(1e3*Math.random()),n="http://hits.blog.sina.com.cn/hits?act=4&aid="+e+"&ref="+encodeURIComponent(location.href)+"&rnd="+i;t.src=n,window["log_pv"+i]=t,t.onload=t.onerror=function(){window["log_pv"+i]=null,t=null}}},hide:function(){$()},destroy:function(){$(),o(),document.body.removeChild($E(V.multiPicEntity)),W=null,X=null,V=null,it&&(it.destroy(),it=null)}};Lib.apply(this,at)},$registJob("showSlideBox",function(){var e=Lib.util.getActionData,t=Core.Events.addEvent,i=/([^\/]+)$/,n=function(e,t,i,n,o,s){Lib.sendSuda(function(){try{SUDA.log("","blog_slide_page")}catch(e){}}),Lib.diYuanXinLog(function(){try{vjEventTrack("")}catch(e){}});var a=new Article.MultipleImgLayer;a.show(e,t,i,n,o,s)},o=function(e){return-1!==e.indexOf("sinaimg.cn/uc/myshow")?!0:-1!==e.indexOf("img.t.sinajs.cn")?!0:-1!==e.indexOf("simg.sinajs.cn")?!0:-1!==e.indexOf("sinaimg.cn/small")?!0:-1!==e.indexOf("sinaimg.cn/square")?!0:!1},s=function(e,t,n){var s=e===t,a=null,r=o(e);return-1!==e.indexOf("/blog7style")||-1!==e.indexOf("sg_trans.gif")||s||r||(a={url:e,loaded:0,click:n===e.match(i)[1].replace(/\&amp;690/,"&690")}),a};t(document.body,function(t){var o=e(t,"show-slide");if(o){Core.Events.stopDefaultEvent(t);var a,r,c,d,h,p,u,g,m,u=scope.$articleid,f=location.protocol+"//"+location.host+location.pathname,v=[],_=scope.$pageid;if("article"===_||"articleM"===_){var y=$E("dbox_"+u),d=location.href,b=$E("t_"+u),h=b.innerText||b.textContent,p=/\bupBox_dis\b/.test(y.className),w=$E("sina_keyword_ad_area2"),E=$T(w,"img"),C=decodeURIComponent(o.data);for(m=C.match(i)[1],I=0,l=E.length;l>I;I++){c=E[I],a=c.getAttribute("real_src"),r=c.getAttribute("src");var L=a===r;if(L){var S=c.width>1&&c.width<200,k=c.height>1&&c.height<200;if(S&&k)continue}r=a||r;var $=s(r,f,m);$&&v.push($)}var x,T=$T(document.body,"span"),g=scope.$publishTime;if(!g){for(var I=T.length-1;I>=0;I--)if(x=T[I],"time SG_txtc"===x.className){g=x.innerText||x.textContent;break}g=g.replace("(","").replace(")","")}n(v,d,h,p,scope.$articleid,g)}else{var D=o.data.split("&"),r=decodeURIComponent(D[0]),A=decodeURIComponent(D[1]),M=decodeURIComponent(D[2]),h=decodeURIComponent(D[3]),g=decodeURIComponent(D[4]);
Utils.Io.JsLoad.request("http://control.blog.sina.com.cn/riaapi/article/getArticlePic.php?rnd="+Math.random(),{GET:{blog_id:A,blog_pubdate:g,uid:$UID||""},onComplete:function(e){if("A00006"===e.code){var t=e.data,o=t.images;for(m=r.match(i)[1],I=0,l=o.length;l>I;I++){r=o[I];var a=s(r,f,m);a&&v.push(a)}n(v,M,h,t.isLiked,A,t.publishTime)}},onException:function(){}})}}})}),$registJob("showSlideBtn",function(){function e(){if(this.width<200&&this.height<200)return!1;var e=this.getAttribute("real_src")||this.getAttribute("src");this.setAttribute("action-data",encodeURIComponent(e)),this.setAttribute("action-type","show-slide");var t=Core.Dom.getXY(this)[0]+10;t=Math.min(t,l-134),m.style.left=t+"px",m.style.top=Core.Dom.getXY(this)[1]+10+"px",u&&(m.style.display="",m.setAttribute("action-data",encodeURIComponent(this.src)))}function t(){if(this.width<200&&this.height<200)return!1;var e=Core.Events.getEvent(),t=e.relatedTarget||e.toElement;t&&Core.Dom.contains(m,t)||(m.style.display="none")}function i(e){var t=e.getAttribute("real_src")||e.getAttribute("src")||"";return-1!==t.indexOf("sinaimg.cn/uc/myshow")?!0:-1!==t.indexOf("img.t.sinajs.cn")?!0:-1!==t.indexOf("simg.sinajs.cn")?!0:-1!==t.indexOf("sinaimg.cn/small")?!0:-1!==t.indexOf("sinaimg.cn/square")?!0:!1}function n(i){g(i,e.bind2(i),"mouseover"),g(i,t.bind2(i),"mouseout")}function o(e){if(!i(e)&&Core.Dom.contains(p,e)){s();var t=a(e);if(!t||-1!==t.href.indexOf("photo.blog.sina.com.cn")){var o=e.getAttribute("src"),r=-1!==o.indexOf("sg_trans.gif");e.complete&&!r?n(e):e.onload=function(){n(this);var t=this.getAttribute("real_src"),i=this.getAttribute("src");t||t!==i||(e.onload=null)}.bind2(e)}}}function s(){l=Core.Dom.getXY(p)[0]+p.clientWidth}function a(e){if(!h)return null;for(;e=e.parentNode;)if("A"==e.nodeName.toUpperCase())return e;return null}function r(){u=1,c($T(p,"img"),function(e){o(e,"src")})}var l,c=Core.Array.foreach,d=scope.$pageid,h="article"==d||"articleM"==d,p=(scope.$uid,$E("sina_keyword_ad_area2")||document.body),u=1,g=Core.Events.addEvent,m=SinaEx.createNode('<div style="left: -1000px; top: -1000px;position:absolute;" class="picSlideBtn" action-type="show-slide" action-data="http%3A%2F%2Fww4.sinaimg.cn%2Flarge%2F697db644jw1dw1s1zljvaj.jpg"><a href="javascript:void(0);">幻灯播放</a></div>');document.body.appendChild(m),Core.Events.addEvent(window,s,"resize"),r(),scope.showPicSlide=function(e){o(e)}}),Core.Dom.byClass=function(e,t,i){if(i=i||document,i.getElementsByClassName)return i.getElementsByClassName(e);var n,o=new RegExp("\\b"+e+"\\b"),s=[],a=i.getElementsByTagName(t),r=a.length;for(n=0;r>n;n++)i=a[n],1===i.nodeType&&i.className&&o.test(i.className)&&s.push(i);return s},$registJob("xingqu",function(){var e,t={171:"娱乐博客",172:"财经博客",173:"股票博客",174:"体育博客",175:"IT博客",176:"博客首页",177:"文化博客",178:"教育博客",179:"军事博客",180:"女性博客",181:"育儿博客",182:"健康博客",183:"星座博客",184:"游戏博客",185:"美食博客",186:"旅游博客",187:"杂谈博客",191:"汽车博客",192:"房产博客",193:"佛学博客",194:"宠物博客"},i=function(e){window._cateIdForThisPage_=e,Utils.Io.JsLoad.request("http://news.sina.com.cn/js/694/2013/0220/guess.boot.blog.js",{charset:"gb2312",isRemove:!1,onComplete:function(){}})},n=window.location.href;if(-1!==n.indexOf("tj=")){var o,s,a=Core.Dom.byClass("SG_icon107","img",$E("articlebody"));if(a&&(o=a[0].title),o)for(s in t)if(o.indexOf(t[s])>-1){e=s;break}i(e)}else(e=scope.$cate_id)&&i(e);Utils.Io.JsLoad.request("http://ent.sina.com.cn/js/470/2013/0506/collect.js",{charset:"gb2312",isRemove:!1,onComplete:function(){}})}),Lib.countOSLink=function(e){for(var t,i,n,o,s,a=Core.Events.addEvent,r=/^http:\/\/[\w\.]*?blog.sina.com.cn/i,l=e.length;l--;)for(i=e[l].blogid,n=e[l].uid,o=e[l].container?$T(e[l].container,"a"):document.links,t=o.length;t--;)s=o[t].href,!s||s.match(r)||s.indexOf("javascript:")>-1||!function(e,t,i,n){e?a(t,function(){commonLog("http://interface.blog.sina.com.cn/riaapi/article/click_url.php?blogid="+e+"&url="+encodeURIComponent(i))}):a(t,function(){commonLog("http://interface.blog.sina.com.cn/riaapi/article/click_url.php?uid="+n+"&url="+encodeURIComponent(i))}),t=null}(i,o[t],s,n);o=null,a=null},$registJob("osl_article",function(){Lib.countOSLink([{blogid:scope.$articleid||"",container:$E("sina_keyword_ad_area2")}])}),slideBox=Core.Class.create(),slideBox.prototype={assertNull:function(e,t){if(null==e)throw Error(t)},initialize:function(e,t,i,n,o){this.assertNull(e,"boxBody不能为null"),this.assertNull(t,"slideBody不能为null"),this.assertNull(i,"previousBtn不能为null"),this.assertNull(n,"nextBtn不能为null"),this.boxBody=e,this.slideBody=t,this.previousBtn=i,this.nextBtn=n,this.isFirst=!0,this.isLast=!1,this.currentPage=1,this.cfg=o;var s=Core.Function.bind2,a={direction:"leftToRight",motion:Ui.Transition.simple,duration:.5,slideChildCount:1,onTweenBegin:function(){},onTweenEnd:function(){}};Core.Events.addEvent(i,s(function(){this.cfg.onTweenBegin("",this.currentPage,"previous"),this.previousPage()},this)),Core.Events.addEvent(n,s(function(){this.cfg.onTweenBegin("",this.currentPage,"next"),this.nextPage()},this));var r=function(e,t){var i;for(i in t)e[i]=t[i];return e};this.cfg=r(a,o||{}),this.startTweenStyle=parseInt(this._getSlideBeginValue()||0),t.style[this._getTweenStyle()]=this.startTweenStyle+"px"},getCurrentSlideLength:function(){var e=0,t=this.slideBody.style;switch(this.cfg.direction){case"leftToRight":e=t.left;break;case"bottomToTop":e=t.bottom;break;case"topToBottom":e=t.left}return parseInt(e||0)},hasNextPage:function(){return this.slideBody.children.length>this.currentPage*this.cfg.slideChildCount},hasPreviousePage:function(){return this.currentPage>1},getSlideLegnth:function(){var e=this.cfg.slideLength||0;if(e)return e;var t=this.slideBody,i=t.children,n=i.length;if(1>n)return 0;var o,s,a,r,l=i[0],c=c||(window.getComputedStyle?window.getComputedStyle(l,""):l.currentStyle),d=0;switch(this.cfg.direction){case"leftToRight":var h=l.offsetWidth;o=this._getCurrentStyle(l,"margin-right",c)||0,s=this._getCurrentStyle(l,"margin-left",c)||0,d=h+parseInt(o)+parseInt(s);break;case"bottomToTop":case"topToBottom":var p=l.offsetHeight,u=0;a=parseInt(this._getCurrentStyle(l,"margin-top",c)||0,10),r=parseInt(this._getCurrentStyle(l,"margin-bottom",c)||0,10),u=Math.max(a,r),d=p+(n-1)*u+a+r}var g=d*this.cfg.slideChildCount;return this.cfg.slideLength=g,g},previousPage:function(){var e=!this.hasPreviousePage();if(e||this.onTweening)return void(e&&this.cfg.onTweenEnd("begin",this.currentPage,"previous"));var t,i=(this.boxBody,this.slideBody),n=window.getComputedStyle?window.getComputedStyle(i,""):i.currentStyle,o=this.getCurrentSlideLength(n),s=this.getSlideLegnth();this.currentPage--,t=o+s,this._tween(o,t)},nextPage:function(){var e=!this.hasNextPage();if(e||this.onTweening)return void(e&&this.cfg.onTweenEnd("end",this.currentPage,"next"));var t,i=(this.boxBody,this.slideBody),n=window.getComputedStyle?window.getComputedStyle(i,""):i.currentStyle,o=this.getCurrentSlideLength(n),s=this.getSlideLegnth();this.currentPage++,t=o-s,this._tween(o,t)},_getCurrentStyle:function(e,t,i){var n,i=i||(window.getComputedStyle?window.getComputedStyle(e,""):e.currentStyle);try{n=i.getPropertyValue(t)}catch(o){t=t.replace(/^(-)/,"").replace(/-(\S)/g,function(e,t){return t.toUpperCase()}),n=i[t]}return n},_getSlideBeginValue:function(e){var t=this.slideBody,i=0;switch(this.cfg.direction){case"leftToRight":i=this._getCurrentStyle(t,"left",e)||0;break;case"bottomToTop":i=this._getCurrentStyle(t,"top",e)||0;break;case"topToBottom":i=this._getCurrentStyle(t,"bottom",e)||0}return parseInt(i)},_getTweenStyle:function(){switch(this.cfg.direction){case"leftToRight":return"left";case"bottomToTop":return"bottom";case"topToBottom":return"top"}return"left"},_tween:function(e,t){var i=this.slideBody.style,n=this._getTweenStyle();tween=new TweenStrategyEx([e],[t],this.cfg.duration,this.cfg.motion),this.onTweening=!0,tween.onTween=function(e){i[n]=parseInt(e[0],10)+"px"};var o=this;tween.onEnd=function(){var e=!o.hasNextPage(),t=!o.hasPreviousePage(),i="";e?(o.isLast=!0,o.isFirst=!1,i="end"):t?(o.isFirst=!0,o.isLast=!1,i="begin"):(o.isFirst=!1,o.isLast=!1),o.onTweening=!1,o.cfg.onTweenEnd(i,o.currentPage)},tween.start()}},$registJob("blog365Slide",function(){$E("calendarCon")&&($E("calendarCon").style.width="9999px",new slideBox($E("swrap"),$E("calendarCon"),$E("btn_preview"),$E("btn_next"),{slideChildCount:7,duration:1}))}),Lib.classUtils=function(){},Lib.classUtils.prototype.addClass=function(e,t){return e?void(this.hasClass(e,t)||(e.className=Core.String.trim(e.className.concat(" "+t)))):!1},Lib.classUtils.prototype.delClass=function(e,t){if(!e)return!1;var i=new RegExp("( +|^)"+t+"(?=( |$))","ig");e.className=Core.String.trim(e.className.replace(i,""))},Lib.classUtils.prototype.hasClass=function(e,t){if(!e)return!1;var i=new RegExp("( +|^)"+t+"(?=( |$))","ig");return i.test(e.className)},function(){function e(){var e=$C("div");e.className="module365",e.style.position="absolute",e.style.top="0px",e.style.right="0px",e.style.zIndex="200",e.innerHTML=n,$E("headarea")&&$E("headarea").appendChild(e);var t=$E("blog365_calCon")&&$E("blog365_calCon").children,o=new Date,s=o.getDate(),a=o.getFullYear(),r=o.getMonth()+1,l=o.getTime(),c=new Date(a,0,1).getTime(),d=l-c;if(d=0==d?1:Math.floor(d/864e5)+1,$E("blog365_dateNum").innerHTML=d,$isAdmin){var h=t[s-1];todayDiv=h.getElementsByTagName("div")[0],h.className+=" today";var p='<a onclick="v7sendLog(\'48_01_22\')" href="http://control.blog.sina.com.cn/admin/article/article_add.php?tag365" target="_blank"><span class="rectoday" title="记录今天"></span></a>';todayDiv.innerHTML=p;for(var u=i(a,r),g=s;u>g;g++){var m=t[g],f=m.getElementsByTagName("div")[0];m.className+=" coming";var v=a+"-"+r+"-"+(g+1),p='<a onclick="v7sendLog(\'48_01_23\')" href="http://control.blog.sina.com.cn/admin/article/article_add.php?tag365='+v+'" target="_blank"><span class="tq">提前<br>记录</span></a>';f.innerHTML=p}}}function t(e){{var t=$E("blog365_calCon")&&$E("blog365_calCon").children,i=new Date,n=i.getDate();i.getFullYear(),i.getMonth()+1}for(var o in e){var s=o.split("-")[2]-1,a=t[s],r=a.getElementsByTagName("div")[0];if(e[o].pre&&e[o].href){a.className="d"+(s+1)+" writed";var l="";$isAdmin&&(l='<a href="'+e[o].href+'" target="_blank" ><span class="date">'+(s+1)+"日</span></a>",r.innerHTML=l),r.innerHTML=l}else{s===n-1&&(a.className="d"+n);var c,l;c=e[o].href?e[o].href:"javascript:void(0);",target=e[o].href?"_blank":"",l=e[o].src&&e[o].src.indexOf("sinaimg.cn")>=0?'<a href="'+c+'" target="'+target+'"><img src="'+e[o].src+'"/><span class="date">'+(s+1)+"日</span></a>":'<a href="'+c+'" target="'+target+'"><span class="date">'+(s+1)+"日</span></a>",r.innerHTML=l}}}function i(e,t){var i=function(e){return e%400?e%100?e%4?0:1:0:1};if(!e*t)return 0;var n=31;switch(t){case 4:case 6:case 9:case 11:n=30;break;case 2:n=i(e)?29:28}return n}if("8_52"===scope.tpl){Lib.checkAuthor();var n='<ul id="blog365_calCon"><li class="d1"><div class="pic"></div></li><li class="d2"><div class="pic"></div></li><li class="d3"><div class="pic"></div></li><li class="d4"><div class="pic"></div></li><li class="d5"><div class="pic"></div></li><li class="d6"><div class="pic"></div></li><li class="d7"><div class="pic"></div></li><li class="d8"><div class="pic"></div></li><li class="d9"><div class="pic"></div></li><li class="d10"><div class="pic"></div></li><li class="d11"><div class="pic"></div></li><li class="d12"><div class="pic"></div></li><li class="d13"><div class="pic"></div></li><li class="d14"><div class="pic"></div></li><li class="d15"><div class="pic"></div></li><li class="d16"><div class="pic"></div></li><li class="d17"><div class="pic"></div></li><li class="d18"><div class="pic"></div></li><li class="d19"><div class="pic"></div></li><li class="d20"><div class="pic"></div></li><li class="d21"><div class="pic"></div></li><li class="d22"><div class="pic"></div></li><li class="d23"><div class="pic"></div></li><li class="d24"><div class="pic"></div></li><li class="d25"><div class="pic"></div></li><li class="d26"><div class="pic"></div></li><li class="d27"><div class="pic"></div></li><li class="d28"><div class="pic"></div></li><li class="d29"><div class="pic"></div></li><li class="d30"><div class="pic"></div></li><li class="d31"><div class="pic"></div></li><li class="actpage"><div class="pic"><a title="活动页" target="_blank" href="http://qing.blog.sina.com.cn/tag/365"></a></div></li></ul><div class="wdate" id="blog365_dateNum"></div>',o="http://control.blog.sina.com.cn/riaapi/activity/get_blog365.php?data=1";e(),Utils.Io.JsLoad.request(o,{GET:{uid:scope.$uid||""},onComplete:function(e){e.code&&"A00006"===e.code&&t(e.data)}})}}(),$registJob("loginStatus",function(){Lib.checkAuthor();var e=Utils.Cookie.getCookie,t=Utils.Cookie.setCookie,i=e("_s_loginStatus"),n=e("_s_loginuid");if($isLogin){if(n===$UID)return}else if(!i||i===n)return;t("_s_loginuid",$UID||i,24-(new Date).getHours(),"","blog.sina.com.cn");var o="http://control.blog.sina.com.cn/blog_rebuild/riaapi/padblog/padInfo.php?rnd="+Math.random();Utils.Io.JsLoad.request(o,{onComplete:function(){},onException:function(){}})}),$registJob("showTB680",function(){var e=document.getElementById("column_1"),t=Core.Dom.byClass("SG_conn","div",e),i=t[2]||t[t.length-1],n="<div class='SG_conn'><iframe frameborder=0 scrolling='no' marginwidth='0' marginheight='0' width='210' height='220' src='http://d1.sina.com.cn/litong/tanx2014/tanx_blog.html'></iframe></div>";if(e.insertAdjacentHTML)i.insertAdjacentHTML("BeforeBegin",n);else{var o=el.ownerDocument.createRange();o.setStartBefore(i);var s=o.createContextualFragment(n);i.parentNode.insertBefore(s,i)}}),$registJob("padSwitch",function(){function e(e){var t=new Date;t.setTime(t.getTime()-1),document.cookie=e+"=_pass;path=/;domain=.blog.sina.com.cn;expires="+t.toGMTString()}var t=navigator.userAgent,i=/(iPad).*OS\s([\d_]+)/.test(t),n='<div class="webSelect"><a id="sw_web" class="current" href="javascript:void(0);">电脑版</a><a id="sw_pad" href="javascript:void(0)">PAD版</a></div>',o=Core.Events.addEvent,s=window.location.href;i&&(Core.Dom.insertHTML($E("sinablogfooter"),n,"AfterBegin"),o($E("sw_pad"),function(t){t.target.className="current",Core.Dom.removeClass($E("sw_web"),"current"),e("ipad4web"),s=s.replace("blog","m.blog"),window.location.href=s}))}),$registJob("loginFollow",function(){Lib.checkAuthor();var e=$E("loginFollow"),t=unescape(Utils.Cookie.getCookie("onceloggedonblog")),i=Lib.Login.info(),n=i.uid,o=i.nick;if(e&&t&&!$isLogin&&n&&o&&n!==scope.$uid){var s='<div class="loginFollow"><div class="con"><p id="#{loginFollowCon}"></p><div class="btm"><a id="#{loginBtn}" href="javascript:void(0);" class="btn" title="登录并关注"></a><span>还没有博客账号？点此<a href="https://login.sina.com.cn/signup/signupmail.php?entry=blog&r=&srcuid=&src=blogicp" target="_blank" onclick="v7sendLog(\'44_01_03_'+n+"')\">注册</a>一个</span></div></div></div>",a=Utils.insertTemplate(e,s,"BeforeEnd");a.loginFollowCon.innerHTML="Hi，"+o+"！我是"+(scope.owenerNickName||$E("ownernick").innerHTML.replace(/(\r|\n)/g,""))+"。  现在就登录关注我的博客，不要错过我的任何更新！",v7sendLog("44_01_01_"+n);var r=new Lib.Login.Ui;Core.Events.addEvent(a.loginBtn,function(){v7sendLog("44_01_02_"+n),r.login(function(){v7sendLog("44_01_04_"+n),Lib.Component.Attention($UID,scope.$uid,function(){location.reload()})})},"click")}}),$registJob("blogTip",function(){var e=Lib.Listener;e.on({name:"article-msg-loaded",callBack:function(e){a(e)},scope:this});var t="",i="",n="",o="",s=function(e){t=e;var i=i||50,n=parseInt(e)%8+1;o="http://portrait"+n+".sinaimg.cn/"+e+"/blog/"+i},a=function(e){if(e){if(e.cms_id==i)return;s(e.uid),i=e.cms_id+"",n=e.nick_name,r(),h()}},r=function(){if(!$E("blogTip")){var e='<div id="blogTip" class="mDynaState" style="position:fixed;z-index:300; left:580px; top:92px; opacity:0.0;"><div class="con"><a onclick="v7sendLog(\'40_01_47\')" href="###"><img id="UIMG" width="30" height="30" alt=""></a><a href="###" onclick="v7sendLog(\'40_01_47\')" id="NName" class="nickname"></a>刚刚对此博文进行了评论<span id="blogTipShowBtn">,<a href="###" onclick="v7sendLog(\'40_01_46\')">查看</a></span></div><a href="###" onclick="v7sendLog(\'40_01_48\');" class="close" title="关闭" id="blogTip_closeBtn">×</a></div>';Core.Dom.addHTML(document.body,e);var s=Core.Dom.getXY($E("sinabloga"));$E("blogTip").style.top=s[1]+"px",Core.Events.addEvent(blogTip,function(){if(p(),$E("article_comment_list").childNodes[0].childNodes.length<1){var e=new Comment.List;e.load(1),scope.$comment_is_load_page_1=1,setTimeout(l,1e3)}else l();Core.Events.stopEvent()},"click"),Core.Events.addEvent(blogTip_closeBtn,function(){p(),Core.Events.stopEvent()},"click"),Core.Events.addEvent(UIMG,function(){window.open("http://blog.sina.com.cn/u/"+t),p(),Core.Events.stopEvent()},"click"),Core.Events.addEvent(NName,function(){window.open("http://blog.sina.com.cn/u/"+t),p(),Core.Events.stopEvent()},"click")}$E(UIMG).src=o;for(var a=0,r=n.split(""),c=0,d=0;d<r.length;d++)a+=r[d].charCodeAt(0)<299?.75:1,a>=8&&0==c&&(c=d);$E(NName).innerHTML=c>0?n.substr(0,c)+"...":n,$E("blogTipShowBtn").style.display=i?"":"none"},l=function(){if($E("cmt_"+i))d();else{var e="http://control.blog.sina.com.cn/blog_rebuild/riaapi/profile/note/getCms.php?uid="+scope.$uid+"&cms_id="+i;Utils.Io.JsLoad.request(e,{onComplete:function(e){e&&"A00006"===e.code&&(e.data.cid=i,c(e.data))},onException:function(){location.hash="commonComment"},timeout:3e3})}},c=function(e){var t=$E("article_comment_list"),i=new CommentV2.Add,n=e;n.action_data=Utils.Json.flatten({articleid:scope.$articleid,commentid:n.id,fromProduct:n.fromProduct,comm_uid:n.uid,uname:n.nick_name,ulink:n.ulink,src_uid:n.src_uid,cms_reply_num:n.cms_reply_num}),n.uname=n.nick_name,n.action_data=encodeURIComponent(n.action_data);var o=i.render(n);t.insertBefore(o,t.firstChild),d()},d=function(){location.hash="cmt_"+i},h=function(){v7sendLog("40_01_45"),$E("blogTip").style.display="";var e=new Ui.TweenStrategy(0,1,.5);e.onTween=function(e){Core.Dom.setStyle($E("blogTip"),"opacity",e)},e.onEnd=function(){e=null,setTimeout(p,5e3)},e.start()},p=function(){var e=new Ui.TweenStrategy(1,0,.5);e.onTween=function(e){Core.Dom.setStyle($E("blogTip"),"opacity",e)},e.onEnd=function(){e=null,$E("blogTip").style.display="none"},e.start()}}),CommentV2.CommentForCheck=Core.Class.create(),CommentV2.CommentForCheck.prototype={initialize:function(e){this._opt=e,scope.$commentlistIsReady?this.load():Lib.Listener.on({name:"commentlist-isready",callBack:this.load,scope:this})},getParam:function(){return this._opt},load:function(){if($E("cmt_"+this._opt.cms_id))return void this.setHashPos();var e=this.getParam();this.getInterface=new Interface("http://control.blog.sina.com.cn/blog_rebuild/riaapi/profile/note/getCms.php","jsload"),this.getInterface.request({GET:e,onSuccess:function(e){this.rander(e)}.bind2(this),onError:function(){},onFail:function(){}})},rander:function(e){var t=$E("article_comment_list"),i=new CommentV2.Add;e.action_data=Utils.Json.flatten({commentid:e.id,articleid:scope.$articleid,fromProduct:e.fromProduct,comm_uid:e.comm_uid,uname:e.nick_name,ulink:e.ulink}),e.uname=e.nick_name,e.action_data=encodeURIComponent(e.action_data),"weibo"==e.fromProduct&&(e.from='<img height="15" align="absmiddle" width="15" class="SG_icon SG_icon51" src="http://simg.sinajs.cn/images/common/sg_trans.gif">');var n=i.render(e);t.insertBefore(n,t.firstChild),this.setHashPos()},setHashPos:function(){var e=window.location.hash;window.location.hash="cmt_"+this._opt.cms_id,window.location.hash=e}},$registJob("commentForCheck",function(){if(/cmtforcheck_/.test(location.hash)){var e=location.hash.split("_"),t={cms_id:e[1],uid:e[2]};new CommentV2.CommentForCheck(t)}}),$registJob("diYuanXin",function(){Lib.diYuanXinLog(function(){try{vjEventTrack("")}catch(e){}})}),$registJob("uatrack",function(){Lib.sendSuda(function(){var e=scope.$pageid,t=Core.Dom.byClass;switch(e){case"editor":var i=t("msnTips_lx","div");i&&(v7sendLog("41_01_05"),SUDA.uaTrack("blog_post","v_post1"));break;case"article":case"articleM":var n=$E("module_910"),o=$E("module_911"),s=$E("module_909"),a=$E("module_903"),r=$E("module_904");n&&SUDA.uaTrack("blog_wqing_g","v_wqing_g"),o&&(v7sendLog("41_01_03"),SUDA.uaTrack("blog_bjqing_g","v_bjqing_g"),SUDA.uaTrack("blog_qing_g","v_SLOT_49"),SUDA.uaTrack("blog_qing_g","v_SLOT_50"),SUDA.uaTrack("blog_qing_g","v_SLOT_51")),s&&SUDA.uaTrack("blog_btjblog","v_btjblog"),a&&(v7sendLog("41_01_06"),SUDA.uaTrack("blog_xg","v_blogxg")),r&&SUDA.uaTrack("blog_tjblog","v_tjblog")}})}),$registJob("hotAdvertise",function(){var e=document.getElementById("column_1"),t=Core.Dom.byClass("SG_conn","div",e),i=document.getElementById("module_911")||t[t.length-1],n='<div class="SG_conn" id="hotShangPin"></div>';Utils.insertTemplate(i,n,"AfterEnd"),Lib.execZhitou(function(){blogAd.insertIns("PDPS000000052389",$E("hotShangPin"),"Afterbegin"),(window.sinaads||[]).push({})});var o=document.getElementById("module_903")||t[t.length-1],s='<div class="SG_conn" id="recommendShangXun"><div class="SG_connHead"><span class="title">推荐商讯</span></div><div class="SG_connBody"><div class="atcTitList relaList"><ul></ul></div></div></div>';Utils.insertTemplate(o,s,"AfterEnd"),Lib.execZhitou(function(){blogAd.insertIns("PDPS000000052390",$E("recommendShangXun").children[1].children[0].children[0],"Afterbegin"),(window.sinaads||[]).push({params:{sinaads_ad_tpl:'<li class="SG_j_linedot1"><p class="atcTitCell_tit SG_dot"><a target="_blank" href="#{link}" onclick="try{#{monitor}}catch(e){}">#{src}</a></p><p class="atcTitCell_nm"><a target="_blank" href="#{link}" onclick="try{#{monitor}}catch(e){}" class="SG_linkb" style="display:inline-block;height:14px; line-height:14px; white-space:normal; overflow:hidden;">#{src1}</a></p></li>'}})})}),$registJob("xgBlogAD",function(){function e(e,t){var i,n,o;for(n in t)o=new RegExp("{{"+n+"}}","ig"),i=(i||e).replace(o,t[n]);return i}function t(){Utils.Io.JsLoad.request(d,{GET:{id:h,uid:$UID||0,blogerid:scope.$uid||0},onComplete:function(t){var n=null;if(t[h]&&(n=t[h].res[0]),n){if("articletj"==scope.$pageid){var s=e(u,n);l(o,s,"AfterEnd")}else{var a=e(p,n);l(o,a,"AfterEnd")}SUDA&&SUDA.uaTrack(n.a_v_suda_key,n.a_v_suda_value)}i()},onException:function(){}})}function i(){var t=scope.$articleid,i=scope.$cate_id,o=scope.$sort_id;if(t){var d="http://blog.sina.com.cn/s/related_"+t+".js",h={cate_id:i,sort_id:o};if(n=r(c,"div","SG_connBody"),a=r(c,"div","atcTit_more"),s="articletj"==scope.$pageid?r(n[0],"li","reco_bloglist_con").length:r(n[0],"li","SG_j_linedot1").length,s>3)return;Utils.Io.Ajax.request(d,{returnType:"json",GET:h,onComplete:function(t){var i=t.slideReads,t=t.relatedReads;if("articletj"==scope.$pageid){var s=r(n[0],"ul","reco_bloglist have_user")[0];if(s)for(var c=0;c<t.length;c++){var d=e(m,t[c]);l(s,d,"BeforeEnd")}}else{var s=r(n[0],"ul","")[0];if(s)for(var c=0;c<t.length;c++){var h=e(g,t[c]);l(s,h,"BeforeEnd")}}var p=r(a[0],"a","")[0];p&&("111"==o?p.setAttribute("href","http://finance.sina.com.cn/blog/8.html"):"153"==o&&p.setAttribute("href","http://finance.sina.com.cn/blog/2.html")),"function"==typeof window.scope.___fnForListenerSlot?window.scope.___fnForListenerSlot(i):window.scope.___fnForListenerSlot=i},onException:function(){}})}}var n,o,s,a,r=Core.Dom.getElementsByClass,l=Core.Dom.insertHTML,c=$E("module_903"),d="http://interface.blog.sina.com.cn/riaapi/pageslot/pagexg.php",h="SLOT_89",p='<li class="SG_j_linedot1"><p class="atcTitCell_tit SG_dot"><a {{a_c_suda}} href="{{a_href}}" target="_blank" title="{{a_title}}">{{words}}</a></p><p class="atcTitCell_nm"><a {{a_c_suda}} href="{{a_href}}" class="SG_linkb" target="_blank">{{author}}</a></p></li>',u='<li class="reco_bloglist_con"><span class="blogname"><a {{a_c_suda}} onclick="v7sendLog(\'41_01_07\');" href="{{a_href}}" target="_blank" title="{{a_title}}">{{words}}</a></span><span class="bloguser"><a {{a_c_suda}} onclick="v7sendLog(\'41_01_07\');" class="SG_linkb" href="{{a_href}}" target="_blank">{{author}}</a></span></li>',g='<li class="SG_j_linedot1"><p class="atcTitCell_tit SG_dot"><a {{a_c_suda}} href="{{a_href}}" target="_blank" title="{{a_title}}">{{a_title}}</a></p><p class="atcTitCell_nm"><a {{a_c_suda}} href="http://blog.sina.com.cn/u/{{uid}}" class="SG_linkb" target="_blank">{{author}}</a></p></li>',m='<li class="reco_bloglist_con"><span class="blogname"><a {{a_c_suda}} onclick="v7sendLog(\'41_01_07\');" href="{{a_href}}" target="_blank" title="{{a_title}}">{{a_title}}</a></span><span class="bloguser"><a {{a_c_suda}} onclick="v7sendLog(\'41_01_07\');" class="SG_linkb" href="http://blog.sina.com.cn/u/{{uid}}" target="_blank">{{author}}</a></span></li>';"articletj"==scope.$pageid?(n=r(c,"div","SG_connBody"),o=r(n[0],"li","reco_bloglist_con")[1]):(n=r(c,"div","SG_connBody"),o=r(n[0],"li","SG_j_linedot1")[1]),o&&t()}),Core.Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)},$registJob("rightAD",function(){function e(){Core.Dom.setStyle(c,"right","-"+u+"px"),t(v,_)}function t(e,t){if(c){var n={id:t};"undefined"!=typeof scope&&(n.blogeruid=scope.$uid),$UID&&(n.loginuid=$UID);var o=function(n){function o(o){o&&o.length>=2&&(o[0].words=o[0].a_title,o[1].words=o[1].a_title,n[t[1]]&&o[0].a_title&&(n[t[1]].res=[o[0]]),n[t[3]]&&o[1].a_title&&(n[t[3]].res=[o[1]])),i(e,t,n),window.clearTimeout(s)}var s;t.splice(0,2),window.scope.___fnForListenerSlot?o(window.scope.___fnForListenerSlot):window.scope.___fnForListenerSlot=o,s=window.setTimeout(function(){i(e,t,n)},5e3)};"waitting"===scope.__subscribeSlot?scope.__subscribeSlotFunc=o:"object"==typeof scope.__subscribeSlot?o(scope.__subscribeSlot):(scope.__subscribeSlot="waitting",Utils.Io.JsLoad.request(y,{GET:n,onComplete:function(e){o(e),scope.__subscribeSlot=e,"function"==typeof scope.__subscribeSlotFunc&&scope.__subscribeSlotFunc(e)},onException:function(){}}))}}function i(e,t,i){for(var n=0;n<e.length;n++){var o=i[t[n]],s=$E(e[n]);if(s&&o){var a=o.materialtype,r=null,l="",c="";if(Core.Array.isArray(o.res)&&(r={a_c_suda:o.res[0].a_c_suda||"",a_h_suda_key:o.res[0].a_h_suda_key||"",a_h_suda_value:o.res[0].a_h_suda_value||"",a_v_suda_key:o.res[0].a_v_suda_key||"",a_v_suda_value:o.res[0].a_v_suda_value||"",a_href:o.res[0].a_href||"",a_title:o.res[0].a_title||"",imgurl:o.res[0].imgurl||"",words:o.res[0].words||"",author:o.res[0].author||""}),1===a&&r&&(c="v7sendLog('30_01_02')",l="<a "+r.a_c_suda+' onmousedown="'+c+'" target="_blank" href="'+r.a_href+'"><img titlelink="'+r.a_href+'" destxt="'+(r.words||"")+'" title="'+r.a_title+'" src="'+r.imgurl+'" /></a>',s.innerHTML=l),2===a&&r){switch(t[n]){case"SLOT_99":var d=o.res?o.res[0].type:"";c="relative_0"==d?"v7sendLog('30_01_03')":"relative_1"==d?"v7sendLog('30_01_07')":"topic"==d?"v7sendLog('30_01_09')":"v7sendLog('30_01_03')";break;case"SLOT_100":c="v7sendLog('30_01_04')";break;case"SLOT_101":var d=o.res?o.res[0].type:"";c="relative_0"==d?"v7sendLog('30_01_05')":"relative_1"==d?"v7sendLog('30_01_08')":"topic"==d?"v7sendLog('30_01_10')":"v7sendLog('30_01_05')";break;case"SLOT_102":c="v7sendLog('30_01_06')"}l='<span class="SG_dot"></span><a onmousedown="'+c+'" title="'+r.a_title+'" href="'+r.a_href+'" '+r.a_c_suda+' target="_blank">'+r.words+"</a>",s.innerHTML=l}"undefined"!=typeof SUDA&&r.a_v_suda_key&&r.a_v_suda_value&&SUDA.uaTrack(r.a_v_suda_key,r.a_v_suda_value)}}}function n(){if(!f){var e=$E("sina_keyword_ad_area2"),t=Core.Dom.getElementsByClass($E("articlebody"),"div","shareUp")[0],i=Core.System.getScrollPos(),n=Core.System.winSize(),s=(Core.Dom.getTop(e),Core.Dom.getTop(t)),a=m.getCookie("dajiakan_layer_close");($E("SLOT_98_dajiakan").innerHTML||$E("SLOT_99_dajiakan").innerHTML||$E("SLOT_100_dajiakan").innerHTML||$E("SLOT_101_dajiakan").innerHTML||$E("SLOT_102_dajiakan").innerHTML)&&(i[0]+n.height>=s?(Core.Dom.setStyle(d,"display",""),a?o(2):18!==parseInt(Core.Dom.getStyle(c,"right"),10)&&o(0)):o(1))}}function o(e){var t=0;switch(e){case 0:Core.Dom.removeClass(c,"blog-layer-seeclose"),t=-18;break;case 1:t=u;break;case 2:t=g}Ui.tween(c,"right",-t,.5,"simple",{end:function(){0===e&&(Core.Dom.removeClass(c,"blog-layer-seeclose"),"undefined"!=typeof SUDA&&SUDA.uaTrack("blog_slide_g","v_slide_g"),"undefined"!=typeof v7sendLog&&v7sendLog("30_01_01")),1===e&&Core.Dom.setStyle(d,"display","none"),2===e&&Core.Dom.addClass(c,"blog-layer-seeclose")}})}function s(){f=!0,Core.Dom.setStyle(d,"display","none"),m.setCookie("dajiakan_layer_close",!0,8,"/",".blog.sina.com.cn")}function a(){var e=parseInt(Core.Dom.getStyle(c,"right"),10);f=!0,o(18===e?2:0)}var r=scope.isFromSearchEngine||Article.getSearchReferrer();if(!r){var l='<div id="rightADWrap" style="display:none;z-index:98;position:fixed;right:0;bottom:0;width:398px;height:160px;overflow:hidden;"><div id="rightAD" class="blog-layer-see blog-layer-seeclose" style="position:absolute;right:0;bottom:15px;z-index:99;"><div data-role="arrow" class="boxarrow"><a class="arrow" href="javascript:void(0);"></a></div><div class="con"><span data-role="close" class="close" title="关闭">×</span><h1 class="title">大家在看：</h1><div id="SLOT_98_dajiakan" class="pic"></div><ul class="txtul"><li id="SLOT_99_dajiakan"></li><li id="SLOT_100_dajiakan"></li><li id="SLOT_101_dajiakan"></li><li id="SLOT_102_dajiakan"></li></ul></div></div></div>';Core.Dom.insertHTML("body",l,"BeforeEnd");var c=$E("rightAD"),d=$E("rightADWrap"),h=Core.Dom.getElementsByAttr(c,"data-role","close")[0],p=Core.Dom.getElementsByAttr(c,"data-role","arrow")[0],u=380,g=333,m=Utils.Cookie,f=!1;$IE6&&(d.style.position="absolute");var v=["SLOT_98_dajiakan","SLOT_99_dajiakan","SLOT_100_dajiakan","SLOT_101_dajiakan","SLOT_102_dajiakan"],_=["SLOT_58","SLOT_59","SLOT_98","SLOT_99","SLOT_100","SLOT_101","SLOT_102"],y="http://interface.blog.sina.com.cn/riaapi/pageslot/pageslot.php";c&&(u=parseInt(Core.Dom.getStyle(c,"width"),10)+20,g=u-48,e()),Core.Events.addEvent(window,n,"scroll"),h&&Core.Events.addEvent(h,s,"click"),p&&Core.Events.addEvent(p,a,"click")}});;
